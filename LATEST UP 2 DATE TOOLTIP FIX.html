<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yoco Admin Suite — Site Data Manager • Product Loader
  </title><style>
    :root { --bg:#0f0f10; --surface:#17171a; --muted:#9aa0a6; --text:#fff; --primary:#00A3FF; }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    .bar{position:sticky;top:0;z-index:50;background:linear-gradient(0deg,rgba(0,0,0,.25),rgba(0,0,0,.25)),var(--surface);border-bottom:1px solid #24262b;padding:10px;display:flex;gap:10px;align-items:center}
    .bar h1{font-size:15px;margin:0 8px 0 0;color:var(--muted);font-weight:600}
    .tab-btn{background:#23252a;color:#cfd3d7;border:1px solid #30333a;padding:8px 12px;border-radius:9px;cursor:pointer;font-weight:600}
    .tab-btn.active{background:var(--primary);color:#fff;border-color:transparent}
    .wrap{height:calc(100vh - 52px)}
    iframe{width:100%;height:100%;border:0;background:#fff;display:none}
    iframe.active{display:block}
  </style>
  <script>
// Global show(): toggles visible iframe and active tab
window.show = window.show || function(id){
  ['main','app1','app2'].forEach(function(x){ var f=document.getElementById(x); if(f) f.classList.toggle('active', x===id); });
  document.querySelectorAll('.tab-btn').forEach(function(btn){ btn.classList.toggle('active', btn.getAttribute('data-target')===id); });
};

    const B64_IDS = {main: 'b64-main', app1: 'b64-product', app2: 'b64-recipe' };

    function decodeB64Utf8(b64) {
      if (window.TextDecoder) {
        const binStr = atob(b64);
        const len = binStr.length;
        const bytes = new Uint8Array(len);
        for (let i=0;i<len;i++) bytes[i] = binStr.charCodeAt(i);
        return new TextDecoder('utf-8').decode(bytes);
      }
    }

    function show(id){
      document.querySelectorAll('iframe').forEach(f=>f.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      const btn = document.querySelector('[data-target="'+id+'"]');
      if (btn) btn.classList.add('active');
    }

    function ensureMounted(id){
      const frame = document.getElementById(id);
      if (frame.dataset.mounted) return;
      const holderId = B64_IDS[id];
      const dataEl = document.getElementById(holderId);
      if (dataEl) {
        frame.srcdoc = decodeB64Utf8(dataEl.textContent.trim());
        frame.dataset.mounted = '1';
      }
    }

    function patchMainUI(){
      const frame = document.getElementById('main');
      const doc = frame && frame.contentDocument;
      if (!doc) return;

      // Hide internal "Product Loader" / "Recipe Loader" buttons
      const kill = ['product loader','recipe loader'];
      const candidates = doc.querySelectorAll('button, .btn, a[role="button"], [role="button"], input[type="button"], input[type="submit"]');
      candidates.forEach(el => {
        const txt = (el.textContent || el.value || '').trim().toLowerCase();
        if (kill.includes(txt)) el.style.display = 'none';
      });

      // Update any "Step 6 of 8" text to reference tabs
      const nodes = doc.body.querySelectorAll('h1,h2,h3,h4,h5,h6,.step-title,.tutorial-step,p,li,div,span');
      for (const el of nodes) {
        const t = el.textContent || '';
        if (/(^|\b)step\s*6\s*of\s*8\b/i.test(t)) {
          let target = el.nextElementSibling || el;
          target.innerHTML = 'Use the <strong>tabs at the top</strong> to open the <strong>Product Loader</strong> inside this combined page.';
          break;
        }
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
// Fresh state: only mount main initially; others mount on first click
      ensureMounted('main');
      document.getElementById('main').addEventListener('load', patchMainUI);

      const b1 = document.querySelector('[data-target="app1"]');
      const b2 = document.querySelector('[data-target="app2"]');
if (b1) b1.addEventListener('click', (ev) => {
        ev.preventDefault();
        // Always mount the Product Loader iframe so it never stays blank
        ensureMounted('app1');
        const def = (function(){ try { return JSON.parse(localStorage.getItem('yoco.product.sessionDefaults')||'{}'); } catch(e){ return {}; } })();
        // If no siteName saved yet, open the modal prefilled; otherwise just show Product Loader
        if (!def.siteName) {
          // define continuation that shows Product Loader
          window.__yocoProceedToProductLoader = function(){
            show('app1');
          };
          if (typeof window.__yocoOpenSessionModal === 'function') window.__yocoOpenSessionModal();
        }
      });
if (b2) b2.addEventListener('click', () => {  });

      show('main');
    
});
</script>
<script>
// Delegated tab wiring so Recipe Loader always opens
(function(){
  function onTabClick(e){
    var t = e.target;
    while (t && t !== document && !t.matches('.tab-btn')) t = t.parentElement;
    if (!t || !t.matches('.tab-btn')) return;
    var target = t.getAttribute('data-target');
    if (!target) return;
    e.preventDefault();
    try { if (typeof ensureMounted === 'function') ensureMounted(target); } catch(_) {}
    try { if (typeof show === 'function') show(target); } catch(_) {}
  }
  if (!document.__yocoDelegatedTabs){
    document.addEventListener('click', onTabClick, true);
    document.__yocoDelegatedTabs = true;
  }
})();
</script>
</head>
<body>
  <div class="bar">
    <h1>Yoco Admin Suite</h1>
    <button class="tab-btn active" data-target="main" onclick="show('main')">Site Data Manager</button>
    <button class="tab-btn" data-target="app1" onclick="show('app1')">Product Loader</button>
    <button class="tab-btn" data-target="app2">Recipe Loader</button>
    </div>
  <div class="wrap">
    <iframe id="main" class="active" title="Site Data Manager"></iframe>
    <iframe id="app1" title="Product Loader"></iframe>
<iframe id="app2" title="Recipe Loader"></iframe></iframe>
</div>

  <!-- Base64 payloads (lint-safe, won't break parser). Decoded at runtime into srcdoc. -->
  <script type="application/json" id="b64-main">PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIiBjbGFzcz0iaC1mdWxsIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4KICA8dGl0bGU+VGFibGUgQnkgWW9jbyBTaXRlIERhdGEgTWFuYWdlcjwvdGl0bGU+CiAgPCEtLSBVc2luZyBhIG1vZGVybiBmYXZpY29uIGZvciBhIHByb2Zlc3Npb25hbCBsb29rIC0tPgogIDxsaW5rIHJlbD0iaWNvbiIgaHJlZj0iZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJyUzRSUzQ2RlZnMlM0UlM0NsaW5lYXJHcmFkaWVudCBpZD0nZycgeDE9JzAlMjUnIHkxPScwJTI1JyB4Mj0nMTAwJTI1JyB5Mj0nMTAwJTI1JyUzRSUzQ3N0b3Agb2Zmc2V0PScwJTI1JyBzdHlsZT0nc3RvcC1jb2xvcjolMjMwMEEzRkY7c3RvcC1vcGFjaXR5OjEnIC8lM0UlM0NzdG9wIG9mZnNldD0nMTAwJTI1JyBzdHlsZT0nc3RvcC1jb2xvcjolMjMwMDc4RkY7c3RvcC1vcGFjaXR5OjEnIC8lM0UlM0MvbGluZWFyR3JhZGllbnQlM0UlM0MvZGVmcyUzRSUzQ3JlY3Qgd2lkdGg9JzEwMCcgaGVpZ2h0PScxMDAnIHJ4PScyMCcgZmlsbD0ndXJsKCUyM2cpJy8lM0UlM0N0ZXh0IHg9JzUwJyB5PSc2OCcgZm9udC1zaXplPSc1MCcgZm9udC1mYW1pbHk9J1BvcHBpbnMsIHNhbnMtc2VyaWYnIGZvbnQtd2VpZ2h0PSdib2xkJyBmaWxsPSd3aGl0ZScgdGV4dC1hbmNob3I9J21pZGRsZSclM0VUJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIj4KICAKICA8IS0tIFNoZWV0SlMgbGlicmFyeSBmb3IgRXhjZWwgaW1wb3J0L2V4cG9ydCAtLT4KICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcyI+PC9zY3JpcHQ+CiAgCiAgPCEtLSBUYWlsd2luZCBDU1MgZm9yIG1vZGVybiBzdHlsaW5nIC0tPgogIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi50YWlsd2luZGNzcy5jb20iPjwvc2NyaXB0PgogIAogIDwhLS0gR29vZ2xlIEZvbnRzIGZvciB0eXBvZ3JhcGh5IC0tPgogIDxsaW5rIHJlbD0icHJlY29ubmVjdCIgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbSI+CiAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tIiBjcm9zc29yaWdpbj4KICA8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVBvcHBpbnM6d2dodEA0MDA7NTAwOzYwMDs3MDAmZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiPgogIAogIDxzdHlsZT4KICAgIC8qIFJldmVydGVkIHRvIG9yaWdpbmFsIGJsdWUgY29sb3Igc2NoZW1lICovCiAgICA6cm9vdCB7CiAgICAgIC0teW9jby1iZzogIzEyMTIxMjsKICAgICAgLS15b2NvLXN1cmZhY2U6ICMxZTFlMWU7CiAgICAgIC0teW9jby1wcmltYXJ5OiAjMDBBM0ZGOwogICAgICAtLXlvY28tcHJpbWFyeS1ob3ZlcjogIzAwNzhGRjsKICAgICAgLS15b2NvLXRleHQ6ICNlMGUwZTA7CiAgICAgIC0teW9jby10ZXh0LXNlY29uZGFyeTogI2EwYTBhMDsKICAgICAgLS15b2NvLWJvcmRlcjogIzMzMzsKICAgICAgLS15b2NvLXN1Y2Nlc3M6ICMyOGE3NDU7CiAgICAgIC0teW9jby1lcnJvcjogI2RjMzU0NTsKICAgICAgLS15b2NvLXdhcm5pbmc6ICNmZmMxMDc7CiAgICB9CgogICAgYm9keSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0KTsKICAgICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsKICAgICAgLXdlYmtpdC1mb250LXNtb290aGluZzogYW50aWFsaWFzZWQ7CiAgICAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7CiAgICB9CgogICAgLmJ0biB7CiAgICAgIHBhZGRpbmc6IDAuNzVyZW0gMS41cmVtOwogICAgICBib3JkZXItcmFkaXVzOiAwLjVyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZS1pbi1vdXQ7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgZGlzcGxheTogaW5saW5lLWZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGdhcDogMC41cmVtOwogICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgfQogICAgCiAgICAuYnRuLWljb24gewogICAgICAgIHBhZGRpbmc6IDAuNzVyZW07CiAgICB9CgogICAgLmJ0bjpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0ycHgpOwogICAgICAgIGJveC1zaGFkb3c6IDAgNnB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgfQogICAgCiAgICAuYnRuOmRpc2FibGVkIHsKICAgICAgICBvcGFjaXR5OiAwLjU7CiAgICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsKICAgIH0KCiAgICAuYnRuLXByaW1hcnkgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICBjb2xvcjogd2hpdGU7CiAgICB9CiAgICAuYnRuLXByaW1hcnk6aG92ZXI6bm90KDpkaXNhYmxlZCkgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnktaG92ZXIpOwogICAgfQogICAgLmJ0bi1zZWNvbmRhcnkgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0KTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgfQogICAgIC5idG4tc2Vjb25kYXJ5OmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1ib3JkZXIpOwogICAgfQogICAgLmJ0bi1kYW5nZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tZXJyb3IpOwogICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgIH0KICAgIC5idG4tZGFuZ2VyOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjYzgyMzMzOwogICAgfQoKICAgIC50YWItYnRuIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCB0cmFuc3BhcmVudDsKICAgICAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlLWluLW91dDsKICAgIH0KICAgIC50YWItYnRuLmFjdGl2ZSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudGFiLWJ0bjpob3ZlciB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAKICAgIC50YWJsZS1jb250YWluZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuNzVyZW07CiAgICAgICAgb3ZlcmZsb3cteDogYXV0bzsKICAgICAgICBtYXgtaGVpZ2h0OiA1NXZoOwogICAgICAgIGJveC1zaGFkb3c6IDAgOHB4IDI0cHggcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgfQoKICAgIHRhYmxlIHsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwogICAgfQoKICAgIHRoLCB0ZCB7CiAgICAgICAgcGFkZGluZzogMXJlbSAxLjI1cmVtOwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgfQoKICAgIHRoZWFkIHRoIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMik7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBwb3NpdGlvbjogc3RpY2t5OwogICAgICAgIHRvcDogMDsKICAgICAgICB6LWluZGV4OiAxMDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0KTsKICAgIH0KCiAgICB0Ym9keSB0cjpob3ZlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTsKICAgIH0KICAgIAogICAgdGRbY29udGVudGVkaXRhYmxlPSJ0cnVlIl0gewogICAgICAgIGN1cnNvcjogY2VsbDsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTsKICAgIH0KICAgIHRkW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdOmZvY3VzIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDE2MywgMjU1LCAwLjEpOwogICAgICAgIG91dGxpbmU6IDFweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAvKiBUb29sdGlwIHN0eWxlcyAqLwogICAgLnRvb2x0aXAgewogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICBjdXJzb3I6IGhlbHA7CiAgICB9CiAgICAudG9vbHRpcDo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6IGF0dHIoZGF0YS10b29sdGlwKTsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgYm90dG9tOiAxMDAlOwogICAgICAgIGxlZnQ6IDUwJTsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSkgc2NhbGUoMC45KTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOwogICAgICAgIGNvbG9yOiAjZmZmOwogICAgICAgIHBhZGRpbmc6IDAuNXJlbSAxcmVtOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuMzc1cmVtOwogICAgICAgIGZvbnQtc2l6ZTogMC44NzVyZW07CiAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsOwogICAgICAgIHdpZHRoOiBtYXgtY29udGVudDsKICAgICAgICBtYXgtd2lkdGg6IDI1MHB4OwogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsKICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlLWluLW91dDsKICAgICAgICB6LWluZGV4OiAyMDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAwLjVyZW07CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjQpOwogICAgfQogICAgLnRvb2x0aXA6aG92ZXI6OmFmdGVyIHsKICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHNjYWxlKDEpOwogICAgfQoKICAgIC5hY3Rpb24tYnRuIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcGFkZGluZzogMC4yNXJlbTsKICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlOwogICAgfQogICAgLmFjdGlvbi1idG46aG92ZXIgewogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIH0KCiAgICAvKiBNb2RhbCBzdHlsZXMgKi8KICAgIC5tb2RhbC1iYWNrZHJvcCB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIHRvcDogMDsKICAgICAgICBsZWZ0OiAwOwogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNyk7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIHotaW5kZXg6IDEwMDA7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2UsIHZpc2liaWxpdHkgMC4zcyBlYXNlOwogICAgfQogICAgLm1vZGFsLWJhY2tkcm9wLnNob3cgewogICAgICAgIG9wYWNpdHk6IDE7CiAgICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAgIH0KICAgIC5tb2RhbC1jb250ZW50IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIHBhZGRpbmc6IDJyZW07CiAgICAgICAgYm9yZGVyLXJhZGl1czogMC43NXJlbTsKICAgICAgICB3aWR0aDogOTAlOwogICAgICAgIG1heC13aWR0aDogNTAwcHg7CiAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOwogICAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzIGVhc2U7CiAgICB9CiAgICAubW9kYWwtYmFja2Ryb3Auc2hvdyAubW9kYWwtY29udGVudCB7CiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsKICAgIH0KICAgIC5tb2RhbC1pY29uIHsKICAgICAgICB3aWR0aDogNTBweDsKICAgICAgICBoZWlnaHQ6IDUwcHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW46IDAgYXV0byAxLjVyZW0gYXV0bzsKICAgIH0KICAgIC5tb2RhbC1pY29uLnN1Y2Nlc3MgeyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1Y2Nlc3MpOyB9CiAgICAubW9kYWwtaWNvbi5lcnJvciB7IGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tZXJyb3IpOyB9CiAgICAubW9kYWwtaWNvbi53YXJuaW5nIHsgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby13YXJuaW5nKTsgfQogICAgCiAgICAjbG9nby1hbmltYXRpb24tY29udGFpbmVyIHsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICB9CiAgICAubG9nby1wYXJ0LTEgewogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgIGFuaW1hdGlvbjogbG9vcEFuaW1hdGlvbjEgNHMgZWFzZS1pbi1vdXQgaW5maW5pdGU7CiAgICB9CiAgICAubG9nby1wYXJ0LTIgewogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgIGFuaW1hdGlvbjogbG9vcEFuaW1hdGlvbjIgNHMgZWFzZS1pbi1vdXQgaW5maW5pdGU7CiAgICB9CgogICAgQGtleWZyYW1lcyBsb29wQW5pbWF0aW9uMSB7CiAgICAgICAgMCUsIDEwMCUgeyBvcGFjaXR5OiAwOyB9CiAgICAgICAgMTAlLCA4MCUgeyBvcGFjaXR5OiAxOyB9CiAgICB9CgogICAgQGtleWZyYW1lcyBsb29wQW5pbWF0aW9uMiB7CiAgICAgICAgMCUsIDIwJSB7IG9wYWNpdHk6IDA7IH0KICAgICAgICAzMCUsIDgwJSB7IG9wYWNpdHk6IDE7IH0KICAgIH0KCiAgICAvKiBUdXRvcmlhbCBTdHlsZXMgKi8KICAgIC50dXRvcmlhbC1vdmVybGF5IHsKICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgdG9wOiAwOwogICAgICAgIGxlZnQ6IDA7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIHotaW5kZXg6IDk5OTg7CiAgICAgICAgZGlzcGxheTogbm9uZTsKICAgIH0KICAgIC50dXRvcmlhbC1vdmVybGF5LXBhcnQgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuODUpOwogICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjRzIGVhc2UtaW4tb3V0OwogICAgfQogICAgLmhpZ2hsaWdodC1lbGVtZW50IHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgei1pbmRleDogOTk5OTsKICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgdHJhbnNpdGlvbjogYm94LXNoYWRvdyAwLjNzIGVhc2UtaW4tb3V0OwogICAgICAgIGJveC1zaGFkb3c6IDAgMCAxNXB4IDVweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOwogICAgICAgIGFuaW1hdGlvbjogcHVsc2UtZ2xvdyAycyBpbmZpbml0ZSBlYXNlLWluLW91dDsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyIHsKICAgICAgICBwb3NpdGlvbjogZml4ZWQ7IAogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgY29sb3I6ICNGRkZGRkY7IC8qIEJyaWdodGVyIHRleHQgY29sb3IgKi8KICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuOHJlbTsKICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIHotaW5kZXg6IDEwMDAxOwogICAgICAgIHdpZHRoOiA5MCU7CiAgICAgICAgbWF4LXdpZHRoOiAzODBweDsKICAgICAgICBib3gtc2hhZG93OiAwIDEwcHggNDBweCByZ2JhKDAsMCwwLDAuNyksIDAgMCAzMHB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNSk7CiAgICAgICAgYW5pbWF0aW9uOiBmYWRlSW5Qb3BvdmVyIDAuNHMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgICAgZGlzcGxheTogbm9uZTsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLWhlYWRlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgICAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDAuNzVyZW07CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IHsKICAgICAgICBwYWRkaW5nOiAxLjVyZW07CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsKICAgICAgICBmb250LXNpemU6IDEuMDVyZW07CiAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQgYiB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLW5hdiB7CiAgICAgICAgcGFkZGluZzogMXJlbSAxLjVyZW07CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLDAsMCwwLjIpOwogICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIH0KCiAgICAudHV0b3JpYWwtcG9wb3Zlcjo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBib3JkZXItd2lkdGg6IDEwcHg7CiAgICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKICAgICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50OwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctdG9wOjphZnRlciB7CiAgICAgICAgYm90dG9tOiAxMDAlOyBsZWZ0OiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgIGJvcmRlci1ib3R0b20tY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1ib3R0b206OmFmdGVyIHsKICAgICAgICB0b3A6IDEwMCU7IGxlZnQ6IDUwJTsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgYm9yZGVyLXRvcC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LWxlZnQ6OmFmdGVyIHsKICAgICAgICByaWdodDogMTAwJTsgdG9wOiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICAgIGJvcmRlci1yaWdodC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LXJpZ2h0OjphZnRlciB7CiAgICAgICAgbGVmdDogMTAwJTsgdG9wOiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICAgIGJvcmRlci1sZWZ0LWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICBAa2V5ZnJhbWVzIGZhZGVJblBvcG92ZXIgewogICAgICBmcm9tIHsKICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45NSk7CiAgICAgIH0KICAgICAgdG8gewogICAgICAgIG9wYWNpdHk6IDE7CiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsKICAgICAgfQogICAgfQoKICAgIEBrZXlmcmFtZXMgcHVsc2UtZ2xvdyB7CiAgICAgIDAlIHsgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7IH0KICAgICAgNTAlIHsgYm94LXNoYWRvdzogMCAwIDI1cHggMTBweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9CiAgICAgIDEwMCUgeyBib3gtc2hhZG93OiAwIDAgMTVweCA1cHggcmdiYSgwLCAxNjMsIDI1NSwgMC43KTsgfQogICAgfQoKICAgIC8qIE1ha2UgdGFicyBtb3JlIHJlYWRhYmxlIGR1cmluZyB0dXRvcmlhbCAqLwogICAgYm9keS50dXRvcmlhbC1hY3RpdmUgLnRhYi1idG4gewogICAgICAgIGNvbG9yOiAjZmZmZmZmOwogICAgICAgIG9wYWNpdHk6IDE7CiAgICB9CiAgICBib2R5LnR1dG9yaWFsLWFjdGl2ZSAudGFiLWJ0bi5hY3RpdmUgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHkgY2xhc3M9ImgtZnVsbCI+CgogIDwhLS0gTE9HSU4gUEFHRSAtLT4KICA8ZGl2IGlkPSJsb2dpbi1jb250YWluZXIiIGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBtaW4taC1zY3JlZW4gcC00Ij4KICAgIDxkaXYgY2xhc3M9ImJnLVt2YXIoLS15b2NvLXN1cmZhY2UpXSBwLTggcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHNoYWRvdy0yeGwgdy1mdWxsIG1heC13LW1kIHRleHQtY2VudGVyIj4KICAgICAgPGgyIGNsYXNzPSJ0ZXh0LTJ4bCBmb250LWJvbGQgbWItMiB0ZXh0LXdoaXRlIj5XZWxjb21lPC9oMj4KICAgICAgPHAgY2xhc3M9InRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi02Ij5UaGUgc2ltcGxlIHdheSB0byBtYW5hZ2UgeW91ciBzaXRlIGRhdGEuPC9wPgogICAgICAgPGRpdiBpZD0ibG9nby1hbmltYXRpb24tY29udGFpbmVyIiBjbGFzcz0iZmxleCBqdXN0aWZ5LWNlbnRlciBpdGVtcy1jZW50ZXIgYmctYmxhY2sgcC00IHJvdW5kZWQtbGcgbWItNiBteC1hdXRvIHctZnVsbCBoLTMyIG1heC13LXNtIj4KICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXh0LXdoaXRlIHRleHQtNHhsIGZvbnQtYm9sZCB0cmFja2luZy13aWRlc3Qgd2hpdGVzcGFjZS1ub3dyYXAiIHN0eWxlPSJmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmOyI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsb2dvLXBhcnQtMSI+VEFCTEU8L3NwYW4+PHNwYW4gY2xhc3M9ImxvZ28tcGFydC0yIj4gQlkgWU9DTzwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxidXR0b24gaWQ9InNob3ctc3VtbWFyeS1idG4iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgdy1mdWxsIGp1c3RpZnktY2VudGVyIj5Db250aW51ZTwvYnV0dG9uPgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDwhLS0gTUFJTiBBUFBMSUNBVElPTiAoSW5pdGlhbGx5IGhpZGRlbikgLS0+CiAgPGRpdiBpZD0ibWFpbi1hcHAtY29udGFpbmVyIiBjbGFzcz0iaGlkZGVuIHAtNCBzbTpwLTgiPgogICAgPGRpdiBjbGFzcz0ibWF4LXctN3hsIG14LWF1dG8iPgogICAgICA8IS0tIEhlYWRlciBTZWN0aW9uIC0tPgogICAgICA8aGVhZGVyIGNsYXNzPSJtYi04IiBpZD0idHV0b3JpYWwtaGVhZGVyIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciBtYi02Ij4KICAgICAgICAgICAgICAgPGEgaWQ9InR1dG9yaWFsLWhvdy10by1ndWlkZSIgaHJlZj0iaHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xbFFvMlRtSzV1UURZWU9JVGljN2VmcHUwMVZwdlU1RzQvdmlldz91c3A9c2hhcmluZyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSBidG4taWNvbiB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IlZpZXcgSG93IFRvIEd1aWRlIj4KICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0xNCAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWOHoiPjwvcGF0aD48cG9seWxpbmUgcG9pbnRzPSIxNCAyIDE0IDggMjAgOCI+PC9wb2x5bGluZT48bGluZSB4MT0iMTYiIHkxPSIxMyIgeDI9IjgiIHkyPSIxMyI+PC9saW5lPjxsaW5lIHgxPSIxNiIgeTE9IjE3IiB4Mj0iOCIgeTI9IjE3Ij48L2xpbmU+PHBvbHlsaW5lIHBvaW50cz0iMTAgOSA5IDkgOCA5Ij48L3BvbHlsaW5lPjwvc3ZnPgogICAgICAgICAgICAgIDwvYT4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBmbGV4LXdyYXAganVzdGlmeS1jZW50ZXIgc206anVzdGlmeS1lbmQiIGlkPSJ0dXRvcmlhbC1hY3Rpb25zIj4KICAgICAgICAgICAgICAgICAgPGRpdiBpZD0idHV0b3JpYWwtbG9hZGVycyIgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGdhcC0zIj4KICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vdGFibGVhZG1pbi1sYWIuZ2l0aHViLmlvL3Byb2R1Y3Rsb2FkZXJWMi8iIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPgogICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJtMjEuMjEgMTUuODktMS40Mi0xLjQyYTIgMiAwIDAgMC0yLjgyIDBMMTIgMTkuNDFsLTIuOTMtMi45M2EyIDIgMCAwIDAtMi44MiAwTDQuODMgMTcuOWEyIDIgMCAwIDAgMCAyLjgybDEuNDIgMS40MmEyIDIgMCAwIDAgMi44MiAwTDEyIDE5LjQxbDIuOTMgMi45M2EyIDIgMCAwIDAgMi44MiAwbDEuNDItMS40MmEyIDIgMCAwIDAgMC0yLjgyeiI+PC9wYXRoPjxwYXRoIGQ9Ik03LjE3IDE0LjgzIDIuMDcgOS43M2EyIDIgMCAwIDEgMC0yLjgybDEuNDItMS40MmEyIDIgMCAwIDEgMi44MiAwTDkuMjQgOC40MiI+PC9wYXRoPjxwYXRoIGQ9Im0xMiAxMi4wMSA0Ljk1LTQuOTVhMiAyIDAgMCAxIDIuODIgMGwxLjQyIDEuNDJhMiAyIDAgMCAxIDAgMi44MmwtNS4wNSA1LjA1Ij48L3BhdGg+PHBhdGggZD0iTTE0LjgzIDcuMTcgMTkuODMgMi4xNyI+PC9wYXRoPjxwYXRoIGQ9Im0xMiAxOS40MSAyLjEyLTIuMTIiPjwvcGF0aD48cGF0aCBkPSJtOC40MiAxMi4wMSAyLjEyLTIuMTIiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUHJvZHVjdCBMb2FkZXIKICAgICAgICAgICAgICAgICAgICAgIDwvYT4KICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vdGFibGVhZG1pbi1sYWIuZ2l0aHViLmlvL1JlY2lwZUxvYWRlcnYyL1JlY2lwZUxvYWRlcnYyLmh0bWwiIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPgogICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMTQgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjh6Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iMTQgMiAxNCA4IDIwIDgiPjwvcG9seWxpbmU+PGxpbmUgeDE9IjE2IiB5MT0iMTMiIHgyPSI4IiB5Mj0iMTMiPjwvbGluZT48bGluZSB4MT0iMTYiIHkxPSIxNyIgeDI9IjgiIHkyPSIxNyI+PC9saW5lPjxwb2x5bGluZSBwb2ludHM9IjEwIDkgOSA5IDggOSI+PC9wb2x5bGluZT48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVjaXBlIExvYWRlcgogICAgICAgICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0iZXhwb3J0QnRuIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5Ij4KICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTIxIDE1djRhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJ2LTQiPjwvcGF0aD48cG9seWxpbmUgcG9pbnRzPSI3IDEwIDEyIDE1IDE3IDEwIj48L3BvbHlsaW5lPjxsaW5lIHgxPSIxMiIgeTE9IjE1IiB4Mj0iMTIiIHkyPSIzIj48L2xpbmU+PC9zdmc+CiAgICAgICAgICAgICAgICAgICAgRXhwb3J0IEFsbCB0byBFeGNlbAogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0iY2xlYXJCdG4iIGNsYXNzPSJidG4gYnRuLWRhbmdlciI+CiAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwb2x5bGluZSBwb2ludHM9IjMgNiA1IDYgMjEgNiI+PC9wb2x5bGluZT48cGF0aCBkPSJNMTkgNnYxNGEyIDIgMCAwIDEtMiAySDdhMiAyIDAgMCAxLTItMlY2bTMgMFY0YTIgMiAwIDAgMSAyLTJoNGEyIDIgMCAwIDEgMiAydjIiPjwvcGF0aD48bGluZSB4MT0iMTAiIHkxPSIxMSIgeDI9IjEwIiB5Mj0iMTciPjwvbGluZT48bGluZSB4MT0iMTQiIHkxPSIxMSIgeDI9IjE0IiB5Mj0iMTciPjwvbGluZT48L3N2Zz4KICAgICAgICAgICAgICAgICAgICBDbGVhciBBbGwgRGF0YQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC1jZW50ZXIiPgogICAgICAgICAgICAgIDxoMSBjbGFzcz0idGV4dC00eGwgZm9udC1ib2xkIHRleHQtd2hpdGUgdHJhY2tpbmctdGlnaHQgbGVhZGluZy10aWdodCI+CiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJibG9jayB0ZXh0LXhsIGZvbnQtbGlnaHQgdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIHRyYWNraW5nLXdpZGVyIHVwcGVyY2FzZSI+VGFibGUgQnkgWW9jbzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj5TaXRlIERhdGEgTWFuYWdlcjwvc3Bhbj4KICAgICAgICAgICAgICA8L2gxPgogICAgICAgICAgPC9kaXY+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPCEtLSBUYWIgTmF2aWdhdGlvbiAtLT4KICAgICAgPGRpdiBpZD0idHV0b3JpYWwtdGFicyIgY2xhc3M9ImJvcmRlci1iIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBtYi02Ij4KICAgICAgICA8bmF2IGlkPSJ0YWItbmF2IiBjbGFzcz0iZmxleCBmbGV4LXdyYXAgLW1iLXB4IGp1c3RpZnktY2VudGVyIj4KICAgICAgICAgIDwhLS0gVGFiIGJ1dHRvbnMgd2lsbCBiZSBpbnNlcnRlZCBoZXJlIGJ5IEpTIC0tPgogICAgICAgIDwvbmF2PgogICAgICA8L2Rpdj4KCiAgICAgIDwhLS0gVGFiIENvbnRlbnQgLS0+CiAgICAgIDxtYWluIGlkPSJ0YWItY29udGVudCI+CiAgICAgICAgPCEtLSBUYWIgcGFuZWxzIHdpbGwgYmUgaW5zZXJ0ZWQgaGVyZSBieSBKUyAtLT4KICAgICAgPC9tYWluPgogICAgICAKICAgICAgPCEtLSBGb290ZXIgU2VjdGlvbiAtLT4KICAgICAgPGZvb3RlciBjbGFzcz0ibXQtMTIgcHktNiBmbGV4IGp1c3RpZnktY2VudGVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJiZy1bdmFyKC0teW9jby1zdXJmYWNlKV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBweC01IHB5LTMgcm91bmRlZC1sZyBmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTggc2hhZG93LWxnIj4KICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vd3d3LnlvY28uY29tL3phL2xlZ2FsLyIgdGFyZ2V0PSJfYmxhbmsiIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIgY2xhc3M9InRleHQtYmFzZSBmb250LWJvbGQgdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIGhvdmVyOnRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIHRyYW5zaXRpb24tY29sb3JzIj4KICAgICAgICAgICAgUHJpdmFjeQogICAgICAgICAgPC9hPgogICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cueW9jby5jb20vemEvbGVnYWwvIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciBub3JlZmVycmVyIiBjbGFzcz0idGV4dC1iYXNlIGZvbnQtYm9sZCB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gaG92ZXI6dGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0gdHJhbnNpdGlvbi1jb2xvcnMiPgogICAgICAgICAgICBUZXJtcwogICAgICAgICAgPC9hPgogICAgICAgIDwvZGl2PgogICAgICA8L2Zvb3Rlcj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8IS0tIE1vZGFsIFRlbXBsYXRlIC0tPgogIDxkaXYgaWQ9Im1vZGFsIiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiPgogICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCB0ZXh0LWNlbnRlciI+CiAgICAgIDxkaXYgaWQ9Im1vZGFsLWljb24iIGNsYXNzPSJtb2RhbC1pY29uIj4KICAgICAgICA8c3ZnIGlkPSJtb2RhbC1zdmciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48L3N2Zz4KICAgICAgPC9kaXY+CiAgICAgIDxwIGlkPSJtb2RhbC1tZXNzYWdlIiBjbGFzcz0idGV4dC1sZyBtYi02Ij48L3A+CiAgICAgIDxkaXYgaWQ9Im1vZGFsLWJ1dHRvbnMiIGNsYXNzPSJmbGV4IGp1c3RpZnktY2VudGVyIGdhcC00Ij4KICAgICAgICA8YnV0dG9uIGlkPSJtb2RhbC1jb25maXJtIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5Ij5Db25maXJtPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0ibW9kYWwtY2FuY2VsIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPkNhbmNlbDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgogIDwvZGl2PgogIAogIDwhLS0gU3VtbWFyeSBNb2RhbCAtLT4KICA8ZGl2IGlkPSJzdW1tYXJ5LW1vZGFsIiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiPgogICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50IHRleHQtbGVmdCI+CiAgICAgICAgICA8aDMgY2xhc3M9InRleHQteGwgZm9udC1ib2xkIG1iLTQgdGV4dC13aGl0ZSI+QXBwbGljYXRpb24gU3VtbWFyeTwvaDM+CiAgICAgICAgICA8cCBpZD0ic3VtbWFyeS10ZXh0IiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby10ZXh0KV0gbWItNiI+PC9wPgogICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBqdXN0aWZ5LWVuZCBnYXAtNCI+CiAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cueW9jby5jb20vemEvbGVnYWwvIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciBub3JlZmVycmVyIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPlByaXZhY3kgUG9saWN5PC9hPgogICAgICAgICAgICAgIDxidXR0b24gaWQ9InByb2NlZWQtdG8tYXBwLWJ0biIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+T0ssIFByb2NlZWQ8L2J1dHRvbj4KICAgICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICA8L2Rpdj4KCiAgPCEtLSBUdXRvcmlhbCBQcm9tcHQgTW9kYWwgLS0+CiAgPGRpdiBpZD0idHV0b3JpYWwtcHJvbXB0LW1vZGFsIiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiPgogICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCB0ZXh0LWNlbnRlciI+CiAgICAgIDxoMyBjbGFzcz0idGV4dC14bCBmb250LWJvbGQgbWItNCB0ZXh0LXdoaXRlIj5RdWljayBUdXRvcmlhbDwvaDM+CiAgICAgIDxwIGNsYXNzPSJ0ZXh0LVt2YXIoLS15b2NvLXRleHQpXSBtYi02Ij5Xb3VsZCB5b3UgbGlrZSBhIHF1aWNrIHRvdXIgb2YgdGhlIG1haW4gZmVhdHVyZXM/PC9wPgogICAgICA8ZGl2IGNsYXNzPSJmbGV4IGp1c3RpZnktY2VudGVyIGdhcC00Ij4KICAgICAgICA8YnV0dG9uIGlkPSJzdGFydC10dXRvcmlhbC1idG4iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPlllcywgcGxlYXNlPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2tpcC10dXRvcmlhbC1idG4iIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSI+Tm8sIHRoYW5rczwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8IS0tIFR1dG9yaWFsIE92ZXJsYXkgJiBQb3BvdmVyIC0tPgogIDxkaXYgaWQ9InR1dG9yaWFsLW92ZXJsYXkiIGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5Ij4KICAgICAgPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS10b3AiPjwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LWJvdHRvbSI+PC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktbGVmdCI+PC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktcmlnaHQiPjwvZGl2PgogIDwvZGl2PgogIDxkaXYgaWQ9InR1dG9yaWFsLXBvcG92ZXIiIGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyIj4KICAgICAgPGRpdiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1oZWFkZXIiPgogICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0xMiAyMnM4LTQgOC0xMFY1bC04LTMtOCAzdjdjMCA2IDggMTAgOCAxMHoiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgIDxzcGFuPlF1aWNrIEd1aWRlPC9zcGFuPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBpZD0idHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1jb250ZW50Ij48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1uYXYiPgogICAgICAgICAgPHNwYW4gaWQ9InR1dG9yaWFsLXN0ZXAtY291bnRlciIgY2xhc3M9InRleHQtc20gdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIj48L3NwYW4+CiAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxidXR0b24gaWQ9InR1dG9yaWFsLXByZXYtYnRuIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPlByZXY8L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJ0dXRvcmlhbC1uZXh0LWJ0biIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+TmV4dDwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogIDwvZGl2PgoKCjxzY3JpcHQ+Ci8vIC0tLSBEQVRBIElOSVRJQUxJWkFUSU9OIC0tLQpjb25zdCBpbml0aWFsRGF0YSA9IHsKICAgIHNpdGVEZXRhaWxzOiB7CiAgICAgICAgaWQ6ICdzaXRlRGV0YWlscycsCiAgICAgICAgbmFtZTogJ1NpdGUgRGV0YWlscycsCiAgICAgICAgaGVhZGVyczogWyJTaXRlIE5hbWUiLCJSZWdpc3RlcmVkIENvbXBhbnkgTmFtZSIsIlRyYWRpbmcgTmFtZSIsIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciIsIkNvbXBhbnkgVkFUIE51bWJlciIsIlNpdGUgQWRkcmVzcyIsIk93bmVyIE5hbWUiLCJPd25lciBTdXJuYW1lIiwiT3duZXIgVGVsZXBob25lIE51bWJlciIsIk93bmVyIEVtYWlsIEFkZHJlc3MiXSwKICAgICAgICBmb3JtSGVhZGVyczogWyJTaXRlIE5hbWUiLCJSZWdpc3RlcmVkIENvbXBhbnkgTmFtZSIsIlRyYWRpbmcgTmFtZSIsIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciIsIkNvbXBhbnkgVkFUIE51bWJlciIsIlNpdGUgQWRkcmVzcyIsIk93bmVyIEZ1bGwgTmFtZSIsIk93bmVyIFRlbGVwaG9uZSBOdW1iZXIiLCJPd25lciBFbWFpbCBBZGRyZXNzIl0sCiAgICAgICAgZGF0YTogW10KICAgIH0sCiAgICBlbXBsb3llZXM6IHsKICAgICAgICBpZDogJ2VtcGxveWVlcycsCiAgICAgICAgbmFtZTogJ0VtcGxveWVlcycsCiAgICAgICAgaGVhZGVyczogWyJFbXBsb3llZSBOYW1lIiwiU3VybmFtZSIsIkVtYWlsIEFkZHJlc3MgKElmIEFkbWluL01hbmFnZXIpIiwiQ29udGFjdCBOdW1iZXIgKElmIEFkbWluL01hbmFnZXIpIiwiUm9sZSIsIkxvZ2luIENvZGUiXSwKICAgICAgICBmb3JtSGVhZGVyczogWyJFbXBsb3llZSBGdWxsIE5hbWUiLCJFbWFpbCBBZGRyZXNzIChJZiBBZG1pbi9NYW5hZ2VyKSIsIkNvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKSIsIlJvbGUiLCJMb2dpbiBDb2RlIl0sCiAgICAgICAgZGF0YTogW10gCiAgICB9LAogICAgc3VwcGxpZXJzOiB7CiAgICAgICAgaWQ6ICdzdXBwbGllcnMnLAogICAgICAgIG5hbWU6ICdTdXBwbGllcnMnLAogICAgICAgIGhlYWRlcnM6IFsiTmFtZSIsIkFkZHJlc3MgTGluZSAxIiwiVG93biIsIkNvbnRhY3QgRmlyc3QgTmFtZSIsIkNvbnRhY3QgRW1haWwiLCJDb250YWN0IFBob25lIE51bWJlciJdLAogICAgICAgIGZvcm1IZWFkZXJzOiBbIk5hbWUiLCJBZGRyZXNzIExpbmUgMSIsIlRvd24iLCJDb250YWN0IEZpcnN0IE5hbWUiLCJDb250YWN0IEVtYWlsIiwiQ29udGFjdCBQaG9uZSBOdW1iZXIiXSwKICAgICAgICBkYXRhOiBbXSAKICAgIH0sCiAgICBzaXRkb3duQXJlYXM6IHsKICAgICAgICBpZDogJ3NpdGRvd25BcmVhcycsCiAgICAgICAgbmFtZTogJ1NpdCBEb3duIEFyZWFzJywKICAgICAgICBoZWFkZXJzOiBbIkFyZWEgTG9jYXRpb24iLCAiVGFibGUgIyJdLAogICAgICAgIGZvcm1IZWFkZXJzOiBbIkFyZWEgTG9jYXRpb24iLCAiVGFibGUgIyJdLAogICAgICAgIGRhdGE6IFtdCiAgICB9LAogICAgaW50ZWdyYXRpb25zOiB7CiAgICAgICAgaWQ6ICdpbnRlZ3JhdGlvbnMnLAogICAgICAgIG5hbWU6ICczcmQgUGFydHkgSW50ZWdyYXRpb25zJywKICAgICAgICBoZWFkZXJzOiBbIkludGVncmF0aW9uIiwgIkRldGFpbCAxIiwgIlZhbHVlIDEiLCAiRGV0YWlsIDIiLCAiVmFsdWUgMiIsICJEZXRhaWwgMyIsICJWYWx1ZSAzIl0sCiAgICAgICAgZm9ybUhlYWRlcnM6IFtdLCAvLyBDdXN0b20gZm9ybSwgc28gdGhpcyBpcyBlbXB0eQogICAgICAgIGRhdGE6IFtdLAogICAgICAgIHR5cGU6ICdjdXN0b20nIC8vIEZsYWcgZm9yIHNwZWNpYWwgaGFuZGxpbmcKICAgIH0KfTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAvLyAtLS0gTE9HSU4gUEFHRSBMT0dJQyAtLS0KICAgIGNvbnN0IGxvZ2luQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWNvbnRhaW5lcicpOwogICAgY29uc3QgbWFpbkFwcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWFwcC1jb250YWluZXInKTsKICAgIGNvbnN0IHNob3dTdW1tYXJ5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3ctc3VtbWFyeS1idG4nKTsKICAgIGNvbnN0IHN1bW1hcnlNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5LW1vZGFsJyk7CiAgICBjb25zdCBzdW1tYXJ5VGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5LXRleHQnKTsKICAgIGNvbnN0IHByb2NlZWRUb0FwcEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWVkLXRvLWFwcC1idG4nKTsKICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5OwogICAgY29uc3QgdHV0b3JpYWxQcm9tcHRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcm9tcHQtbW9kYWwnKTsKICAgIGNvbnN0IHN0YXJ0VHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQtdHV0b3JpYWwtYnRuJyk7CiAgICBjb25zdCBza2lwVHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2tpcC10dXRvcmlhbC1idG4nKTsKCiAgICBjb25zdCBzdW1tYXJ5Q29udGVudCA9ICJUaGlzIHRvb2wgaXMgYSBTaXRlIERhdGEgTWFuYWdlciBmb3IgWW9jbyBUYWJsZSBNZXJjaGFudHMuIEl0IGFsbG93cyB5b3UgdG8gaW5wdXQgYW5kIG1hbmFnZSBlc3NlbnRpYWwgc2l0ZSBpbmZvcm1hdGlvbiwgaW5jbHVkaW5nIHNpdGUgZGV0YWlscywgZW1wbG95ZWVzLCBzdXBwbGllcnMsIGFuZCB0aGlyZC1wYXJ0eSBpbnRlZ3JhdGlvbnMsIGFsbCBpbiBvbmUgcGxhY2UgZm9yIHN0cmVhbWxpbmVkIHNldHVwIGFuZCBlYXN5IGRhdGEgZXhwb3J0LiI7CgogICAgLy8gIkNvbnRpbnVlIiBidXR0b24gc2hvd3MgdGhlIHN1bW1hcnkKICAgIHNob3dTdW1tYXJ5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHN1bW1hcnlUZXh0LnRleHRDb250ZW50ID0gc3VtbWFyeUNvbnRlbnQ7CiAgICAgICAgc3VtbWFyeU1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0pOwogICAgCiAgICAvLyAiUHJvY2VlZCIgYnV0dG9uIG9uIHN1bW1hcnkgbW9kYWwgaGlkZXMgbG9naW4sIHNob3dzIGFwcCwgdGhlbiBhc2tzIGFib3V0IHR1dG9yaWFsCiAgICBwcm9jZWVkVG9BcHBCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgc3VtbWFyeU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2dpbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgICAgICBtYWluQXBwQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaC1mdWxsJyk7IC8vIEFsbG93IGJvZHkgdG8gZ3JvdwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3ZWxjb21lU2NyZWVuU2hvd24nLCAndHJ1ZScpOwogICAgICAgIAogICAgICAgIC8vIE5vdyBhc2sgYWJvdXQgdGhlIHR1dG9yaWFsCiAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9KTsKCiAgICBzdGFydFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIHN0YXJ0VHV0b3JpYWwoKTsKICAgIH0pOwoKICAgIHNraXBUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgIH0pOwogICAgCiAgICAvLyBDaGVjayBpZiB0aGUgd2VsY29tZSBzY3JlZW4gc2hvdWxkIGJlIHNraXBwZWQKICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd2VsY29tZVNjcmVlblNob3duJykgPT09ICd0cnVlJykgewogICAgICAgIGxvZ2luQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIG1haW5BcHBDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdoLWZ1bGwnKTsKICAgIH0KCgogICAgLy8gLS0tIE1BSU4gQVBQIExPR0lDIC0tLQogICAgY29uc3QgdGFiTmF2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYi1uYXYnKTsKICAgIGNvbnN0IHRhYkNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFiLWNvbnRlbnQnKTsKCiAgICAvLyAtLS0gRFlOQU1JQyBVSSBHRU5FUkFUSU9OIC0tLQogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaCgoc2hlZXQsIGluZGV4KSA9PiB7CiAgICAgICAgLy8gQ3JlYXRlIFRhYiBCdXR0b24KICAgICAgICBjb25zdCB0YWJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICB0YWJCdXR0b24uY2xhc3NOYW1lID0gYHRhYi1idG4gJHtpbmRleCA9PT0gMCA/ICdhY3RpdmUnIDogJyd9YDsKICAgICAgICB0YWJCdXR0b24udGV4dENvbnRlbnQgPSBzaGVldC5uYW1lOwogICAgICAgIHRhYkJ1dHRvbi5kYXRhc2V0LnRhYiA9IHNoZWV0LmlkOwogICAgICAgIHRhYk5hdi5hcHBlbmRDaGlsZCh0YWJCdXR0b24pOwoKICAgICAgICAvLyBDcmVhdGUgVGFiIFBhbmVsCiAgICAgICAgY29uc3QgdGFiUGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICB0YWJQYW5lbC5pZCA9IHNoZWV0LmlkOwogICAgICAgIHRhYlBhbmVsLmNsYXNzTmFtZSA9IGB0YWItcGFuZWwgJHtpbmRleCAhPT0gMCA/ICdoaWRkZW4nIDogJyd9YDsKICAgICAgICAKICAgICAgICAvLyAtLS0gQ1VTVE9NIFRBQiBMT0dJQyAtLS0KICAgICAgICBpZiAoc2hlZXQudHlwZSA9PT0gJ2N1c3RvbScgJiYgc2hlZXQuaWQgPT09ICdpbnRlZ3JhdGlvbnMnKSB7CiAgICAgICAgICAgIHRhYlBhbmVsLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxmb3JtIGlkPSJpbnRlZ3JhdGlvbnMtZm9ybSIgY2xhc3M9Im1iLTggYmctW3ZhcigtLXlvY28tc3VyZmFjZSldIHAtNiByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0iIGF1dG9jb21wbGV0ZT0ib2ZmIiBub3ZhbGlkYXRlPgogICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzcz0idGV4dC14bCBmb250LWJvbGQgbWItNCB0ZXh0LXdoaXRlIj5BZGQgM3JkIFBhcnR5IEludGVncmF0aW9uPC9oMz4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtYi02Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iaW50ZWdyYXRpb24tc2VsZWN0IiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSI+U2VsZWN0IEludGVncmF0aW9uPC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iaW50ZWdyYXRpb24tc2VsZWN0IiBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tIFNlbGVjdCBhbiBPcHRpb24gLS08L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InphcHBlciI+WmFwcGVyPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJzbmFwc2NhbiI+U25hcFNjYW48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InlveW8iPllveW88L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgIDwhLS0gU25hcFNjYW4gRmllbGRzIC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InNuYXBzY2FuLWZpZWxkcyIgY2xhc3M9ImhpZGRlbiBzcGFjZS15LTQiPgogICAgICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3M9InRleHQtbGcgZm9udC1zZW1pYm9sZCB0ZXh0LVt2YXIoLS15b2NvLXByaW1hcnkpXSBib3JkZXItYiBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcGItMiI+U25hcFNjYW4gRGV0YWlsczwvaDQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJzbmFwc2Nhbi1jb2RlIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IkVudGVyIHlvdXIgdW5pcXVlIFNuYXBTY2FuIFFSIGNvZGUgaWRlbnRpZmllci4iPllvdXIgU25hcFNjYW4gQ29kZSA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ic25hcHNjYW4tY29kZSIgbmFtZT0ic25hcHNjYW4tY29kZSIgcGxhY2Vob2xkZXI9IllvdXIgU25hcFNjYW4gQ29kZSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNuYXBzY2FuLWVtYWlsIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IlRoZSBlbWFpbCBhZGRyZXNzIGxpbmtlZCB0byB5b3VyIG1lcmNoYW50IGFjY291bnQuIj5SZWdpc3RlcmVkIEVtYWlsIEFkZHJlc3MgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iZW1haWwiIGlkPSJzbmFwc2Nhbi1lbWFpbCIgbmFtZT0ic25hcHNjYW4tZW1haWwiIHBsYWNlaG9sZGVyPSJZb3VyIHJlZ2lzdGVyZWQgZW1haWwiIGNsYXNzPSJ3LWZ1bGwgYmctWyMyYTJhMmFdIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcm91bmRlZC1tZCBweC0zIHB5LTIgdGV4dC13aGl0ZSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctW3ZhcigtLXlvY28tcHJpbWFyeSldIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCB0cmFuc2l0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJzbmFwc2Nhbi1zaXRlLW5hbWUiIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iVGhlIHNpdGUgbmFtZSBhcyBpdCBhcHBlYXJzIGluIHlvdXIgU25hcFNjYW4gcG9ydGFsLiI+UmVnaXN0ZXJlZCBTaXRlIE5hbWUgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InNuYXBzY2FuLXNpdGUtbmFtZSIgbmFtZT0ic25hcHNjYW4tc2l0ZS1uYW1lIiBwbGFjZWhvbGRlcj0iWW91ciByZWdpc3RlcmVkIHNpdGUgbmFtZSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgPCEtLSBaYXBwZXIgRmllbGRzIC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InphcHBlci1maWVsZHMiIGNsYXNzPSJoaWRkZW4gc3BhY2UteS00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzcz0idGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIGJvcmRlci1iIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBwYi0yIj5aYXBwZXIgRGV0YWlsczwvaDQ+CiAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iemFwcGVyLW1lcmNoYW50LWlkIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IllvdXIgdW5pcXVlIFphcHBlciBNZXJjaGFudCBJRC4iPk1lcmNoYW50IElEIDxzcGFuIGNsYXNzPSJ0ZXh0LVt2YXIoLS15b2NvLXByaW1hcnkpXSI+Kjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ6YXBwZXItbWVyY2hhbnQtaWQiIG5hbWU9InphcHBlci1tZXJjaGFudC1pZCIgcGxhY2Vob2xkZXI9IllvdXIgTWVyY2hhbnQgSUQiIGNsYXNzPSJ3LWZ1bGwgYmctWyMyYTJhMmFdIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcm91bmRlZC1tZCBweC0zIHB5LTIgdGV4dC13aGl0ZSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctW3ZhcigtLXlvY28tcHJpbWFyeSldIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCB0cmFuc2l0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ6YXBwZXItc2l0ZS1pZCIgY2xhc3M9ImJsb2NrIHRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIG1iLTEgdG9vbHRpcCIgZGF0YS10b29sdGlwPSJUaGUgdW5pcXVlIElEIGZvciB0aGlzIHNwZWNpZmljIHNpdGUgcHJvdmlkZWQgYnkgWmFwcGVyLiI+U2l0ZSBJRCA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iemFwcGVyLXNpdGUtaWQiIG5hbWU9InphcHBlci1zaXRlLWlkIiBwbGFjZWhvbGRlcj0iWW91ciBTaXRlIElEIiBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iemFwcGVyLXBvcy1rZXkiIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iWW91ciBaYXBwZXIgUE9TIGludGVncmF0aW9uIGtleS4iPlBPUyBLZXkgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InphcHBlci1wb3Mta2V5IiBuYW1lPSJ6YXBwZXItcG9zLWtleSIgcGxhY2Vob2xkZXI9IllvdXIgUE9TIEtleSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgPCEtLSBZb3lvIEZpZWxkcyAtLT4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ5b3lvLWZpZWxkcyIgY2xhc3M9ImhpZGRlbiBzcGFjZS15LTQiPgogICAgICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzPSJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0gYm9yZGVyLWIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHBiLTIiPllveW8gV2FsbGV0IERldGFpbHM8L2g0PgogICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtdC00IGJnLVsjMmEyYTJhXSBwLTQgcm91bmRlZC1tZCBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIj5UbyBpbnRlZ3JhdGUgd2l0aCBZb3lvIFdhbGxldCwgcGxlYXNlIHJlZ2lzdGVyIHlvdXIgYnVzaW5lc3Mgd2l0aCBZb3lvIGRpcmVjdGx5LiBPbmNlIHlvdXIgcmVnaXN0cmF0aW9uIGlzIGNvbXBsZXRlLCBZb3lvIHdpbGwgcHJvdmlkZSB5b3Ugd2l0aCB0aGUgbmVjZXNzYXJ5IFNpdGUgSUQgdG8gY29tcGxldGUgdGhlIHNldHVwLjwvcD4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdC02IGZsZXgganVzdGlmeS1lbmQgZ2FwLTQiPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IGhpZGRlbiBjbGVhci1mb3JtLWJ0biI+Q2FuY2VsPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPkFkZCBFbnRyeTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0iaW50ZWdyYXRpb25zLXRhYmxlIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjwvdGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT48L3Rib2R5PgogICAgICAgICAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im10LTQgZmxleCBqdXN0aWZ5LWVuZCI+CiAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IHJlZnJlc2gtbGlzdC1idG4iIGRhdGEtdGFibGUtaWQ9ImludGVncmF0aW9ucy10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEuNSAydjZoLTZNMi41IDIydi02aDZNMiAxMS41YTEwIDEwIDAgMCAxIDE4LjgtNC4zTTIyIDEyLjVhMTAgMTAgMCAwIDEtMTguOCA0LjMiLz48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVmcmVzaCBMaXN0CiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyAtLS0gU1RBTkRBUkQgVEFCIExPR0lDIC0tLQogICAgICAgICAgICBjb25zdCBmb3JtRmllbGRzID0gc2hlZXQuZm9ybUhlYWRlcnMubWFwKGhlYWRlciA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dElkID0gYCR7c2hlZXQuaWR9LSR7aGVhZGVyLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnLScpfWA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCByZXF1aXJlZCA9ICcnOwogICAgICAgICAgICAgICAgY29uc3QgcmVxdWlyZWRTaXRlRGV0YWlsc0ZpZWxkcyA9IFsiU2l0ZSBOYW1lIiwgIlJlZ2lzdGVyZWQgQ29tcGFueSBOYW1lIiwgIlRyYWRpbmcgTmFtZSIsICJTaXRlIEFkZHJlc3MiLCAiT3duZXIgRnVsbCBOYW1lIiwgIk93bmVyIFRlbGVwaG9uZSBOdW1iZXIiLCAiT3duZXIgRW1haWwgQWRkcmVzcyJdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBVcGRhdGVkIGxvZ2ljIGZvciByZXF1aXJlZCBmaWVsZHMKICAgICAgICAgICAgICAgIGlmIChzaGVldC5pZCA9PT0gJ3NpdGVEZXRhaWxzJyAmJiByZXF1aXJlZFNpdGVEZXRhaWxzRmllbGRzLmluY2x1ZGVzKGhlYWRlcikpIHsKICAgICAgICAgICAgICAgICAgICByZXF1aXJlZCA9ICdyZXF1aXJlZCc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoZWV0LmlkID09PSAnc2l0ZG93bkFyZWFzJykgewogICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gJ3JlcXVpcmVkJzsgLy8gQWxsIGZpZWxkcyBpbiBzaXRkb3duQXJlYXMgYXJlIHJlcXVpcmVkCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoZWV0LmlkID09PSAnc3VwcGxpZXJzJyAmJiBoZWFkZXIgPT09ICdOYW1lJykgewogICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gJ3JlcXVpcmVkJzsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hlZXQuaWQgPT09ICdlbXBsb3llZXMnICYmIFsnRW1wbG95ZWUgRnVsbCBOYW1lJywgJ1JvbGUnXS5pbmNsdWRlcyhoZWFkZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgPSAncmVxdWlyZWQnOwogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICBsZXQgaW5wdXRUeXBlID0gJ3RleHQnOwogICAgICAgICAgICAgICAgbGV0IGlucHV0RXh0cmEgPSAnJzsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckxvd2VyID0gaGVhZGVyLnRvTG93ZXJDYXNlKCk7CgogICAgICAgICAgICAgICAgaWYgKGhlYWRlckxvd2VyLmluY2x1ZGVzKCdlbWFpbCcpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gJ2VtYWlsJzsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGVhZGVyTG93ZXIuaW5jbHVkZXMoJ3RlbGVwaG9uZScpIHx8IGhlYWRlckxvd2VyLmluY2x1ZGVzKCdwaG9uZSBudW1iZXInKSB8fCBoZWFkZXJMb3dlci5pbmNsdWRlcygnY29udGFjdCBudW1iZXInKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0RXh0cmEgPSBgb25pbnB1dD0idGhpcy52YWx1ZSA9IHRoaXMudmFsdWUucmVwbGFjZSgvW14wLTldL2csICcnKSIgbWlubGVuZ3RoPSIxMCIgbWF4bGVuZ3RoPSIxMCJgOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoZWFkZXJMb3dlci5pbmNsdWRlcygnbG9naW4gY29kZScpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXRFeHRyYSA9IGBvbmlucHV0PSJ0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5yZXBsYWNlKC9bXjAtOV0vZywgJycpIiBtaW5sZW5ndGg9IjQiIG1heGxlbmd0aD0iNCJgOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxldCBpbnB1dEh0bWwgPSBgCiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9IiR7aW5wdXRUeXBlfSIgaWQ9IiR7aW5wdXRJZH0iIG5hbWU9IiR7aGVhZGVyfSIgcGxhY2Vob2xkZXI9IiR7aGVhZGVyfSIgJHtyZXF1aXJlZH0gJHtpbnB1dEV4dHJhfSBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgaWYgKHNoZWV0LmlkID09PSAnZW1wbG95ZWVzJyAmJiBoZWFkZXIgPT09ICdSb2xlJykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RJZCA9IGBSb2xlLWxpc3RgOwogICAgICAgICAgICAgICAgICAgIGlucHV0SHRtbCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSIke2lucHV0SWR9IiBuYW1lPSIke2hlYWRlcn0iIHBsYWNlaG9sZGVyPSIke2hlYWRlcn0iIGxpc3Q9IiR7bGlzdElkfSIgJHtyZXF1aXJlZH0gY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGF0YWxpc3QgaWQ9IiR7bGlzdElkfSI+PC9kYXRhbGlzdD4KICAgICAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsVGV4dCA9IHJlcXVpcmVkID8gYCR7aGVhZGVyfSA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+YCA6IGhlYWRlcjsKCiAgICAgICAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9IiR7aW5wdXRJZH0iIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iJHtnZXRUb29sdGlwVGV4dChoZWFkZXIpfSI+JHtsYWJlbFRleHR9PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnB1dEh0bWx9CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICB9KS5qb2luKCcnKTsKCiAgICAgICAgICAgIHRhYlBhbmVsLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxmb3JtIGlkPSIke3NoZWV0LmlkfS1mb3JtIiBjbGFzcz0ibWItOCBiZy1bdmFyKC0teW9jby1zdXJmYWNlKV0gcC02IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSIgYXV0b2NvbXBsZXRlPSJvZmYiIG5vdmFsaWRhdGU+CiAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzPSJ0ZXh0LXhsIGZvbnQtYm9sZCBtYi00IHRleHQtd2hpdGUiPkFkZC9VcGRhdGUgJHtzaGVldC5uYW1lLnNsaWNlKDAsIC0xKX08L2gzPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQgZ3JpZC1jb2xzLTEgc206Z3JpZC1jb2xzLTIgbGc6Z3JpZC1jb2xzLTMgZ2FwLTQiPgogICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1GaWVsZHN9CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXQtNiBmbGV4IGp1c3RpZnktZW5kIGdhcC00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSBoaWRkZW4gY2xlYXItZm9ybS1idG4iPkNhbmNlbDwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPkFkZCBFbnRyeTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ0dXRvcmlhbC10YWJsZS0ke3NoZWV0LmlkfSIgY2xhc3M9InRhYmxlLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGlkPSIke3NoZWV0LmlkfS10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48L3RoZWFkPgogICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+PC90Ym9keT4KICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdC00IGZsZXgganVzdGlmeS1lbmQiPgogICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSByZWZyZXNoLWxpc3QtYnRuIiBkYXRhLXRhYmxlLWlkPSIke3NoZWV0LmlkfS10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEuNSAydjZoLTZNMi41IDIydi02aDZNMiAxMS41YTEwIDEwIDAgMCAxIDE4LjgtNC4zTTIyIDEyLjVhMTAgMTAgMCAwIDEtMTguOCA0LjMiLz48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVmcmVzaCBMaXN0CiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICB9CiAgICAgICAgdGFiQ29udGVudC5hcHBlbmRDaGlsZCh0YWJQYW5lbCk7CiAgICB9KTsKICAgIAogICAgLy8gSW5pdGlhbCBsb2FkCiAgICBsb2FkQWxsVGFibGVzRnJvbVN0b3JhZ2UoKTsKICAgIGxvYWRBbGxTdWdnZXN0aW9ucygpOwoKICAgIC8vIC0tLSBFVkVOVCBMSVNURU5FUlMgLS0tCiAgICAKICAgIHRhYk5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoJy50YWItYnRuJykpIHsKICAgICAgICAgICAgY29uc3QgdGFiSWQgPSBlLnRhcmdldC5kYXRhc2V0LnRhYjsKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1idG4nKS5mb3JFYWNoKGJ0biA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLXBhbmVsJykuZm9yRWFjaChwYW5lbCA9PiBwYW5lbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKSk7CiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgfQogICAgfSk7CgogICAgdGFiQ29udGVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0KTsKICAgIHRhYkNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcuY2xlYXItZm9ybS1idG4nKSkgewogICAgICAgICAgICBjb25zdCBmb3JtID0gZS50YXJnZXQuY2xvc2VzdCgnZm9ybScpOwogICAgICAgICAgICBpZiAoZm9ybS5pZCA9PT0gJ2ludGVncmF0aW9ucy1mb3JtJykgewogICAgICAgICAgICAgICAgcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXNldEZvcm0oZm9ybSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVmcmVzaC1saXN0LWJ0bicpLmZvckVhY2goYnV0dG9uID0+IHsKICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBjb25zdCB0YWJsZUlkID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudGFibGVJZDsKICAgICAgICAgICAgbG9hZFRhYmxlRnJvbVN0b3JhZ2UodGFibGVJZCk7CiAgICAgICAgICAgIHNob3dNb2RhbCgnTGlzdCBoYXMgYmVlbiByZWZyZXNoZWQgZnJvbSBzYXZlZCBkYXRhLicsICdzdWNjZXNzJyk7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRBbGxUb0V4Y2VsKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhckJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICBzaG93TW9kYWwoCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIGRhdGEgZnJvbSBhbGwgdGFibGVzPyBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLicsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgKCkgPT4gY2xlYXJBbGxEYXRhKHRydWUpLAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKICAgIH0pOwoKICAgIHRhYkNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoJ3RkW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdJykpIHsKICAgICAgICAgICAgY29uc3QgdGFibGUgPSBlLnRhcmdldC5jbG9zZXN0KCd0YWJsZScpOwogICAgICAgICAgICBpZiAodGFibGUpIHNhdmVUYWJsZVRvU3RvcmFnZSh0YWJsZS5pZCk7CiAgICAgICAgfQogICAgfSwgdHJ1ZSk7CiAgICAKICAgIC8vIEludGVncmF0aW9ucyBUYWIgTG9naWMKICAgIGNvbnN0IGludGVncmF0aW9uU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludGVncmF0aW9uLXNlbGVjdCcpOwogICAgaWYgKGludGVncmF0aW9uU2VsZWN0KSB7CiAgICAgICAgaW50ZWdyYXRpb25TZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgWydzbmFwc2NhbicsICd6YXBwZXInLCAneW95byddLmZvckVhY2goaWQgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtpZH0tZmllbGRzYCk7CiAgICAgICAgICAgICAgICBpZiAoZWwpIGVsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICBjb25zdCBlbFRvU2hvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3NlbGVjdGVkfS1maWVsZHNgKTsKICAgICAgICAgICAgICAgIGlmIChlbFRvU2hvdykgZWxUb1Nob3cuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KfSk7CgoKLy8gLS0tIE5BTUUgSEVMUEVSUyAtLS0KY29uc3Qgc3BsaXROYW1lID0gKGZ1bGxOYW1lKSA9PiB7CiAgICBjb25zdCBwYXJ0cyA9IChmdWxsTmFtZSB8fCAnJykudHJpbSgpLnNwbGl0KCcgJyk7CiAgICBjb25zdCBmaXJzdE5hbWUgPSBwYXJ0cy5zaGlmdCgpIHx8ICcnOwogICAgY29uc3QgbGFzdE5hbWUgPSBwYXJ0cy5qb2luKCcgJyk7CiAgICByZXR1cm4geyBmaXJzdE5hbWUsIGxhc3ROYW1lIH07Cn07CgovLyAtLS0gREFUQSBQRVJTSVNURU5DRSAtLS0KZnVuY3Rpb24gc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpIHsKICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGVJZCk7CiAgICBpZiAoIXRhYmxlKSByZXR1cm47CgogICAgY29uc3QgaGVhZGVycyA9IEFycmF5LmZyb20odGFibGUucXVlcnlTZWxlY3RvckFsbCgndGhlYWQgdGgnKSkubWFwKHRoID0+IHRoLnRleHRDb250ZW50KS5zbGljZSgwLCAtMSk7CiAgICBjb25zdCBkYXRhID0gQXJyYXkuZnJvbSh0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpKS5tYXAocm93ID0+IHsKICAgICAgICBjb25zdCByb3dEYXRhID0ge307CiAgICAgICAgQXJyYXkuZnJvbShyb3cucXVlcnlTZWxlY3RvckFsbCgndGQnKSkuc2xpY2UoMCwgLTEpLmZvckVhY2goKHRkLCBpKSA9PiB7CiAgICAgICAgICAgIHJvd0RhdGFbaGVhZGVyc1tpXV0gPSB0ZC50ZXh0Q29udGVudDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcm93RGF0YTsKICAgIH0pOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYHRhYmxlX2RhdGFfJHt0YWJsZUlkfWAsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgIGlmICh0YWJsZUlkID09PSAnc2l0ZURldGFpbHMtdGFibGUnKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKZnVuY3Rpb24gbG9hZEFsbFRhYmxlc0Zyb21TdG9yYWdlKCkgewogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaChzaGVldCA9PiB7CiAgICAgICAgbG9hZFRhYmxlRnJvbVN0b3JhZ2UoYCR7c2hlZXQuaWR9LXRhYmxlYCk7CiAgICB9KTsKfQoKZnVuY3Rpb24gbG9hZFRhYmxlRnJvbVN0b3JhZ2UodGFibGVJZCkgewogICAgY29uc3Qgc2hlZXQgPSBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5maW5kKHMgPT4gYCR7cy5pZH0tdGFibGVgID09PSB0YWJsZUlkKTsKICAgIGlmICghc2hlZXQpIHJldHVybjsKCiAgICBjb25zdCBzYXZlZERhdGFKU09OID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYHRhYmxlX2RhdGFfJHt0YWJsZUlkfWApOwogICAgbGV0IGRhdGFUb1JlbmRlciA9IHNoZWV0LmRhdGE7CgogICAgaWYgKHNhdmVkRGF0YUpTT04pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YUpTT04pOwogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzYXZlZERhdGEpKSBkYXRhVG9SZW5kZXIgPSBzYXZlZERhdGE7CiAgICAgICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKGBDb3VsZCBub3QgcGFyc2Ugc2F2ZWQgZGF0YSBmb3IgJHt0YWJsZUlkfTpgLCBlKTsgfQogICAgfQogICAgcmVuZGVyVGFibGUodGFibGVJZCwgc2hlZXQuaGVhZGVycywgZGF0YVRvUmVuZGVyKTsKfQoKZnVuY3Rpb24gc2F2ZVN1Z2dlc3Rpb25zKGxpc3RJZCwgdmFsdWUpIHsKICAgIGlmICghdmFsdWUpIHJldHVybjsKICAgIGNvbnN0IGtleSA9IGBzdWdnZXN0aW9uc18ke2xpc3RJZH1gOwogICAgbGV0IHN1Z2dlc3Rpb25zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKSB8fCBbXTsKICAgIGlmICghc3VnZ2VzdGlvbnMuaW5jbHVkZXModmFsdWUpKSB7CiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh2YWx1ZSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShzdWdnZXN0aW9ucykpOwogICAgfQp9CgpmdW5jdGlvbiBsb2FkQWxsU3VnZ2VzdGlvbnMoKSB7CiAgICB1cGRhdGVEYXRhbGlzdCgnUm9sZS1saXN0Jyk7Cn0KCi8vIC0tLSBDT1JFIFVJIEZVTkNUSU9OUyAtLS0KZnVuY3Rpb24gcmVuZGVyVGFibGUodGFibGVJZCwgaGVhZGVycywgZGF0YSkgewogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgIGlmICghdGFibGUpIHJldHVybjsKCiAgICBjb25zdCB0aGVhZCA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3RoZWFkJyk7CiAgICB0aGVhZC5pbm5lckhUTUwgPSBgPHRyPiR7aGVhZGVycy5tYXAoaCA9PiBgPHRoIGNsYXNzPSJ0b29sdGlwIiBkYXRhLXRvb2x0aXA9IiR7Z2V0VG9vbHRpcFRleHQoaCl9Ij4ke2h9PC90aD5gKS5qb2luKCcnKX08dGg+QWN0aW9uczwvdGg+PC90cj5gOwogICAgY29uc3QgdGJvZHkgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keScpOwogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7CiAgICBkYXRhLmZvckVhY2gocm93RGF0YSA9PiBhcHBlbmRSb3dUb1RhYmxlKHRhYmxlSWQsIGhlYWRlcnMsIHJvd0RhdGEpKTsKCiAgICBpZiAodGFibGVJZCA9PT0gJ3NpdGVEZXRhaWxzLXRhYmxlJykgewogICAgICAgIHVwZGF0ZVNpdGVEZXRhaWxzRm9ybVN0YXRlKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFwcGVuZFJvd1RvVGFibGUodGFibGVJZCwgaGVhZGVycywgcm93RGF0YSkgewogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIGlmICghdGJvZHkpIHJldHVybjsKICAgIAogICAgY29uc3QgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOwogICAgaGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7CiAgICAgICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgIHRkLnRleHRDb250ZW50ID0gcm93RGF0YVtoZWFkZXJdIHx8ICcnOwogICAgICAgIHRkLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgJ3RydWUnKTsKICAgICAgICB0ci5hcHBlbmRDaGlsZCh0ZCk7CiAgICB9KTsKICAgIHRyLmFwcGVuZENoaWxkKGNyZWF0ZUFjdGlvbnNDZWxsKHRhYmxlSWQpKTsKICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsKICAgIHJldHVybiB0cjsKfQoKZnVuY3Rpb24gY3JlYXRlQWN0aW9uc0NlbGwodGFibGVJZCkgewogICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgdGQuY2xhc3NOYW1lID0gJ2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJzsKICAgIAogICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgZWRpdEJ0bi5jbGFzc05hbWUgPSAnYWN0aW9uLWJ0bic7CiAgICBlZGl0QnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idmFyKC0teW9jby13YXJuaW5nKSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0xMSA0SDRhMiAyIDAgMCAwLTIgMnYxNGEyIDIgMCAwIDAgMiAyaDE0YTIgMiAwIDAgMCAyLTJ2LTciPjwvcGF0aD48cGF0aCBkPSJNMTguNSAyLjVhMi4xMjEgMi4xMjEgMCAwIDEgMyAzTDEyIDE1bC00IDEgMS00IDkuNS05LjV6Ij48L3BhdGg+PC9zdmc+YDsKICAgIGlmICh0YWJsZUlkID09PSAnaW50ZWdyYXRpb25zLXRhYmxlJykgewogICAgICAgIGVkaXRCdG4ub25jbGljayA9IChlKSA9PiBoYW5kbGVJbnRlZ3JhdGlvbkVkaXRDbGljayhlLmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgndHInKSk7CiAgICB9IGVsc2UgewogICAgICAgIGVkaXRCdG4ub25jbGljayA9IChlKSA9PiBoYW5kbGVFZGl0Q2xpY2soZS5jdXJyZW50VGFyZ2V0LmNsb3Nlc3QoJ3RyJykpOwogICAgfQogICAgdGQuYXBwZW5kQ2hpbGQoZWRpdEJ0bik7CgogICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBkZWxldGVCdG4uY2xhc3NOYW1lID0gJ2FjdGlvbi1idG4nOwogICAgZGVsZXRlQnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idmFyKC0teW9jby1lcnJvcikiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cG9seWxpbmUgcG9pbnRzPSIzIDYgNSA2IDIxIDYiPjwvcG9seWxpbmU+PHBhdGggZD0iTTE5IDZ2MTRhMiAyIDAgMCAxLTIgMkg3YTIgMiAwIDAgMS0yLTJWNm0zIDBWNGEyIDIgMCAwIDEgMi0yaDRhMiAyIDAgMCAxIDIgMnYyIj48L3BhdGg+PC9zdmc+YDsKICAgIGRlbGV0ZUJ0bi5vbmNsaWNrID0gKGUpID0+IHsKICAgICAgICBjb25zdCByb3cgPSBlLmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgndHInKTsKICAgICAgICBzaG93TW9kYWwoCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcm93PycsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgKCkgPT4gewogICAgICAgICAgICAgICAgcm93LnJlbW92ZSgpOwogICAgICAgICAgICAgICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgICAgICAgICB9LAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKICAgIH07CiAgICAKICAgIHRkLmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7CiAgICByZXR1cm4gdGQ7Cn0KCmZ1bmN0aW9uIHVwZGF0ZURhdGFsaXN0KGxpc3RJZCkgewogICAgY29uc3QgZGF0YWxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsaXN0SWQpOwogICAgaWYgKCFkYXRhbGlzdCkgcmV0dXJuOwogICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBzdWdnZXN0aW9uc18ke2xpc3RJZH1gKSkgfHwgW107CiAgICBkYXRhbGlzdC5pbm5lckhUTUwgPSBzdWdnZXN0aW9ucy5tYXAocyA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtzfSI+PC9vcHRpb24+YCkuam9pbignJyk7Cn0KCi8vIC0tLSBFVkVOVCBIQU5ETEVSUyAmIEZPUk0gTE9HSUMgLS0tCmZ1bmN0aW9uIHVwZGF0ZVNpdGVEZXRhaWxzRm9ybVN0YXRlKCkgewogICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaXRlRGV0YWlscy1mb3JtJyk7CiAgICBjb25zdCB0YWJsZUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZURldGFpbHMtdGFibGUnKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIGlmICghZm9ybSB8fCAhdGFibGVCb2R5KSByZXR1cm47CgogICAgY29uc3QgaGFzRW50cnkgPSB0YWJsZUJvZHkucm93cy5sZW5ndGggPiAwOwogICAgY29uc3QgaXNFZGl0aW5nID0gISFmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4OwogICAgY29uc3QgaW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpOwogICAgY29uc3Qgc3VibWl0QnRuID0gZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT0ic3VibWl0Il0nKTsKCiAgICBpZiAoaGFzRW50cnkgJiYgIWlzRWRpdGluZykgewogICAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IGlucHV0LmRpc2FibGVkID0gdHJ1ZSk7CiAgICAgICAgc3VibWl0QnRuLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICBzdWJtaXRCdG4ucXVlcnlTZWxlY3RvcignLmJ0bi10ZXh0JykudGV4dENvbnRlbnQgPSAnRW50cnkgTGltaXQgUmVhY2hlZCc7CiAgICB9IGVsc2UgewogICAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IGlucHV0LmRpc2FibGVkID0gZmFsc2UpOwogICAgICAgIHN1Ym1pdEJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgIHN1Ym1pdEJ0bi5xdWVyeVNlbGVjdG9yKCcuYnRuLXRleHQnKS50ZXh0Q29udGVudCA9IGlzRWRpdGluZyA/ICdVcGRhdGUgRW50cnknIDogJ0FkZCBFbnRyeSc7CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZUVkaXRDbGljayhyb3cpIHsKICAgIGNvbnN0IHRhYmxlID0gcm93LmNsb3Nlc3QoJ3RhYmxlJyk7CiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGUuaWQucmVwbGFjZSgnLXRhYmxlJywgJy1mb3JtJykpOwogICAgY29uc3Qgc2hlZXQgPSBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5maW5kKHMgPT4gYCR7cy5pZH0tdGFibGVgID09PSB0YWJsZS5pZCk7CiAgICBpZiAoIWZvcm0gfHwgIXNoZWV0KSByZXR1cm47CgogICAgY29uc3QgY2VsbHMgPSBBcnJheS5mcm9tKHJvdy5jZWxscykubWFwKGNlbGwgPT4gY2VsbC50ZXh0Q29udGVudCk7CiAgICBjb25zdCByb3dEYXRhID0gc2hlZXQuaGVhZGVycy5yZWR1Y2UoKG9iaiwgaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgb2JqW2hlYWRlcl0gPSBjZWxsc1tpXTsKICAgICAgICByZXR1cm4gb2JqOwogICAgfSwge30pOwoKICAgIHNoZWV0LmZvcm1IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHsKICAgICAgICBjb25zdCBpbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgW25hbWU9IiR7aGVhZGVyfSJdYCk7CiAgICAgICAgaWYgKCFpbnB1dCkgcmV0dXJuOwoKICAgICAgICBsZXQgdmFsdWUgPSByb3dEYXRhW2hlYWRlcl07CiAgICAgICAgaWYgKGhlYWRlciA9PT0gJ093bmVyIEZ1bGwgTmFtZScpIHsKICAgICAgICAgICAgdmFsdWUgPSBgJHtyb3dEYXRhWydPd25lciBOYW1lJ10gfHwgJyd9ICR7cm93RGF0YVsnT3duZXIgU3VybmFtZSddIHx8ICcnfWAudHJpbSgpOwogICAgICAgIH0gZWxzZSBpZiAoaGVhZGVyID09PSAnRW1wbG95ZWUgRnVsbCBOYW1lJykgewogICAgICAgICAgICB2YWx1ZSA9IGAke3Jvd0RhdGFbJ0VtcGxveWVlIE5hbWUnXSB8fCAnJ30gJHtyb3dEYXRhWydTdXJuYW1lJ10gfHwgJyd9YC50cmltKCk7CiAgICAgICAgfQogICAgICAgIGlucHV0LnZhbHVlID0gdmFsdWUgfHwgJyc7CiAgICB9KTsKICAgIAogICAgZm9ybS5kYXRhc2V0LmVkaXRpbmdSb3dJbmRleCA9IHJvdy5yb3dJbmRleDsKICAgIGZvcm0ucXVlcnlTZWxlY3RvcignLmNsZWFyLWZvcm0tYnRuJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICBmb3JtLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwoKICAgIGlmKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdChlKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBjb25zdCBmb3JtID0gZS50YXJnZXQ7CiAgICBjb25zdCBzaGVldElkID0gZm9ybS5pZC5yZXBsYWNlKCctZm9ybScsICcnKTsKCiAgICBpZiAoc2hlZXRJZCA9PT0gJ2ludGVncmF0aW9ucycpIHsKICAgICAgICBoYW5kbGVBZGRJbnRlZ3JhdGlvbihmb3JtKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFmb3JtLmNoZWNrVmFsaWRpdHkoKSkgewogICAgICAgIGZvcm0ucmVwb3J0VmFsaWRpdHkoKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7CiAgICBjb25zdCB2YWxpZGF0aW9ucyA9IHsKICAgICAgICBzaXRlRGV0YWlsczogW3sgZmllbGQ6ICdPd25lciBUZWxlcGhvbmUgTnVtYmVyJywgbGVuZ3RoOiAxMCB9XSwKICAgICAgICBlbXBsb3llZXM6IFsKICAgICAgICAgICAgeyBmaWVsZDogJ0NvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKScsIGxlbmd0aDogMTAsIG9wdGlvbmFsOiB0cnVlIH0sCiAgICAgICAgICAgIHsgZmllbGQ6ICdMb2dpbiBDb2RlJywgbGVuZ3RoOiA0LCBvcHRpb25hbDogdHJ1ZSB9CiAgICAgICAgXSwKICAgICAgICBzdXBwbGllcnM6IFt7IGZpZWxkOiAnQ29udGFjdCBQaG9uZSBOdW1iZXInLCBsZW5ndGg6IDEwLCBvcHRpb25hbDogdHJ1ZSB9XQogICAgfTsKCiAgICBpZiAodmFsaWRhdGlvbnNbc2hlZXRJZF0pIHsKICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgdmFsaWRhdGlvbnNbc2hlZXRJZF0pIHsKICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBmb3JtRGF0YS5nZXQocnVsZS5maWVsZCk7CiAgICAgICAgICAgIGlmIChydWxlLm9wdGlvbmFsICYmICF2YWx1ZSkgY29udGludWU7CiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggIT09IHJ1bGUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwoYFRoZSBmaWVsZCAiJHtydWxlLmZpZWxkfSIgbXVzdCBiZSBleGFjdGx5ICR7cnVsZS5sZW5ndGh9IGRpZ2l0cyBsb25nLmAsICdlcnJvcicpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBjb25zdCB0YWJsZUlkID0gZm9ybS5pZC5yZXBsYWNlKCctZm9ybScsICctdGFibGUnKTsKICAgIGNvbnN0IHNoZWV0ID0gT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZmluZChzID0+IHMuaWQgPT09IHNoZWV0SWQpOwogICAgaWYgKCFzaGVldCkgcmV0dXJuOwoKICAgIGNvbnN0IG5ld1Jvd0RhdGEgPSB7fTsKICAgIHNoZWV0LmZvcm1IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IG5ld1Jvd0RhdGFbc2hlZXQuaGVhZGVycy5maW5kKGggPT4gaC5yZXBsYWNlKC8gL2csICcnKSA9PT0gaGVhZGVyLnJlcGxhY2UoLyAvZywnJykucmVwbGFjZSgnRnVsbE5hbWUnLCdOYW1lJykpIHx8IGhlYWRlcl0gPSBmb3JtRGF0YS5nZXQoaGVhZGVyKSB8fCAnJyk7CgogICAgaWYgKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnKSB7CiAgICAgICAgY29uc3QgeyBmaXJzdE5hbWUsIGxhc3ROYW1lIH0gPSBzcGxpdE5hbWUoZm9ybURhdGEuZ2V0KCdPd25lciBGdWxsIE5hbWUnKSk7CiAgICAgICAgbmV3Um93RGF0YVsnT3duZXIgTmFtZSddID0gZmlyc3ROYW1lOwogICAgICAgIG5ld1Jvd0RhdGFbJ093bmVyIFN1cm5hbWUnXSA9IGxhc3ROYW1lOwogICAgfQogICAgaWYgKHNoZWV0LmlkID09PSAnZW1wbG95ZWVzJykgewogICAgICAgIGNvbnN0IHsgZmlyc3ROYW1lLCBsYXN0TmFtZSB9ID0gc3BsaXROYW1lKGZvcm1EYXRhLmdldCgnRW1wbG95ZWUgRnVsbCBOYW1lJykpOwogICAgICAgIG5ld1Jvd0RhdGFbJ0VtcGxveWVlIE5hbWUnXSA9IGZpcnN0TmFtZTsKICAgICAgICBuZXdSb3dEYXRhWydTdXJuYW1lJ10gPSBsYXN0TmFtZTsKICAgICAgICBjb25zdCByb2xlID0gZm9ybURhdGEuZ2V0KCdSb2xlJyk7CiAgICAgICAgc2F2ZVN1Z2dlc3Rpb25zKCdSb2xlLWxpc3QnLCByb2xlKTsKICAgICAgICB1cGRhdGVEYXRhbGlzdCgnUm9sZS1saXN0Jyk7CiAgICB9CgogICAgaWYgKGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXgpIHsgLy8gVXBkYXRlIGV4aXN0aW5nIHJvdwogICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGVJZCk7CiAgICAgICAgY29uc3Qgcm93SW5kZXggPSBwYXJzZUludChmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4LCAxMCk7CiAgICAgICAgY29uc3Qgcm93ID0gdGFibGUucm93c1tyb3dJbmRleF07CiAgICAgICAgaWYocm93KSB7CiAgICAgICAgICAgIHNoZWV0LmhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgICAgICAgICByb3cuY2VsbHNbaV0udGV4dENvbnRlbnQgPSBuZXdSb3dEYXRhW2hlYWRlcl0gfHwgJyc7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0gZWxzZSB7IC8vIEFkZCBuZXcgcm93CiAgICAgICAgaWYgKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhYmxlSWQpLnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5Jykucm93cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnT25seSBvbmUgc2l0ZSBkZXRhaWxzIGVudHJ5IGlzIGFsbG93ZWQuJywgJ2Vycm9yJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYXBwZW5kUm93VG9UYWJsZSh0YWJsZUlkLCBzaGVldC5oZWFkZXJzLCBuZXdSb3dEYXRhKTsKICAgIH0KICAgIAogICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgcmVzZXRGb3JtKGZvcm0pOwp9CgpmdW5jdGlvbiBoYW5kbGVBZGRJbnRlZ3JhdGlvbihmb3JtKSB7CiAgICBjb25zdCBzZWxlY3RlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGlvbi1zZWxlY3QnKS52YWx1ZTsKICAgIGlmICghc2VsZWN0ZWQpIHsKICAgICAgICBzaG93TW9kYWwoJ1BsZWFzZSBzZWxlY3QgYW4gaW50ZWdyYXRpb24gdHlwZS4nLCAnZXJyb3InKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdGFibGVJZCA9ICdpbnRlZ3JhdGlvbnMtdGFibGUnOwogICAgY29uc3Qgc2hlZXQgPSBpbml0aWFsRGF0YS5pbnRlZ3JhdGlvbnM7CiAgICBjb25zdCBuZXdSb3dEYXRhID0geyAiSW50ZWdyYXRpb24iOiAiIiwgIkRldGFpbCAxIjogIiIsICJWYWx1ZSAxIjogIiIsICJEZXRhaWwgMiI6ICIiLCAiVmFsdWUgMiI6ICIiLCAiRGV0YWlsIDMiOiAiIiwgIlZhbHVlIDMiOiAiIiB9OwoKICAgIGlmIChzZWxlY3RlZCA9PT0gJ3NuYXBzY2FuJykgewogICAgICAgIG5ld1Jvd0RhdGFbIkludGVncmF0aW9uIl0gPSAnU25hcFNjYW4nOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAxIl0gPSAnU25hcFNjYW4gQ29kZSc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMSJdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NuYXBzY2FuLWNvZGUnKS52YWx1ZTsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMiJdID0gJ1JlZ2lzdGVyZWQgRW1haWwnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDIiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbmFwc2Nhbi1lbWFpbCcpLnZhbHVlOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAzIl0gPSAnU2l0ZSBOYW1lJzsKICAgICAgICBuZXdSb3dEYXRhWyJWYWx1ZSAzIl0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tc2l0ZS1uYW1lJykudmFsdWU7CiAgICAgICAgaWYgKCFuZXdSb3dEYXRhWyJWYWx1ZSAxIl0gfHwgIW5ld1Jvd0RhdGFbIlZhbHVlIDIiXSB8fCAhbmV3Um93RGF0YVsiVmFsdWUgMyJdKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnUGxlYXNlIGZpbGwgaW4gYWxsIHJlcXVpcmVkIFNuYXBTY2FuIGZpZWxkcy4nLCAnZXJyb3InKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWQgPT09ICd6YXBwZXInKSB7CiAgICAgICAgbmV3Um93RGF0YVsiSW50ZWdyYXRpb24iXSA9ICdaYXBwZXInOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAxIl0gPSAnTWVyY2hhbnQgSUQnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDEiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItbWVyY2hhbnQtaWQnKS52YWx1ZTsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMiJdID0gJ1NpdGUgSUQnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDIiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItc2l0ZS1pZCcpLnZhbHVlOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAzIl0gPSAnUE9TIEtleSc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMyJdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3phcHBlci1wb3Mta2V5JykudmFsdWU7CiAgICAgICAgaWYgKCFuZXdSb3dEYXRhWyJWYWx1ZSAxIl0gfHwgIW5ld1Jvd0RhdGFbIlZhbHVlIDIiXSB8fCAhbmV3Um93RGF0YVsiVmFsdWUgMyJdKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnUGxlYXNlIGZpbGwgaW4gYWxsIHJlcXVpcmVkIFphcHBlciBmaWVsZHMuJywgJ2Vycm9yJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHNlbGVjdGVkID09PSAneW95bycpIHsKICAgICAgICBuZXdSb3dEYXRhWyJJbnRlZ3JhdGlvbiJdID0gJ1lveW8gV2FsbGV0JzsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMSJdID0gJ1N0YXR1cyc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMSJdID0gJ1JlZ2lzdHJhdGlvbiBSZXF1aXJlZCc7CiAgICB9CiAgICAKICAgIGlmIChmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4KSB7CiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgICAgICBjb25zdCByb3dJbmRleCA9IHBhcnNlSW50KGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXgsIDEwKTsKICAgICAgICBjb25zdCByb3cgPSB0YWJsZS5yb3dzW3Jvd0luZGV4XTsKICAgICAgICBpZiAocm93KSB7CiAgICAgICAgICAgIHNoZWV0LmhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgICAgICAgICByb3cuY2VsbHNbaV0udGV4dENvbnRlbnQgPSBuZXdSb3dEYXRhW2hlYWRlcl0gfHwgJyc7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgYXBwZW5kUm93VG9UYWJsZSh0YWJsZUlkLCBzaGVldC5oZWFkZXJzLCBuZXdSb3dEYXRhKTsKICAgIH0KICAgIAogICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSk7CiAgICBzaG93TW9kYWwoZm9ybS5kYXRhc2V0LmVkaXRpbmdSb3dJbmRleCA/ICdJbnRlZ3JhdGlvbiBlbnRyeSB1cGRhdGVkLicgOiAnSW50ZWdyYXRpb24gZW50cnkgYWRkZWQuJywgJ3N1Y2Nlc3MnKTsKfQoKZnVuY3Rpb24gcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSkgewogICAgZm9ybS5yZXNldCgpOwogICAgZGVsZXRlIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXg7CgogICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludGVncmF0aW9uLXNlbGVjdCcpOwogICAgaWYgKHNlbGVjdCkgewogICAgICAgIHNlbGVjdC52YWx1ZSA9ICcnOwogICAgICAgIHNlbGVjdC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwogICAgfQoKICAgIGNvbnN0IGJ0blRleHQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpOwogICAgaWYgKGJ0blRleHQpIGJ0blRleHQudGV4dENvbnRlbnQgPSAnQWRkIEVudHJ5JzsKICAgIAogICAgY29uc3QgY2xlYXJCdG4gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpOwogICAgaWYgKGNsZWFyQnRuKSBjbGVhckJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQoKCmZ1bmN0aW9uIGhhbmRsZUludGVncmF0aW9uRWRpdENsaWNrKHJvdykgewogICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGlvbnMtZm9ybScpOwogICAgaWYgKCFmb3JtKSByZXR1cm47CgogICAgLy8gRXh0cmFjdCBkYXRhIGZyb20gdGhlIHJvdwogICAgY29uc3QgaW50ZWdyYXRpb25UeXBlID0gcm93LmNlbGxzWzBdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUxID0gcm93LmNlbGxzWzJdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUyID0gcm93LmNlbGxzWzRdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUzID0gcm93LmNlbGxzWzZdLnRleHRDb250ZW50OwoKICAgIC8vIE1hcCBkaXNwbGF5IG5hbWUgdG8gc2VsZWN0IHZhbHVlCiAgICBjb25zdCBzZWxlY3RWYWx1ZSA9IGludGVncmF0aW9uVHlwZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoJyB3YWxsZXQnLCAnJyk7CiAgICAKICAgIC8vIFNldCB0aGUgZHJvcGRvd24gYW5kIHRyaWdnZXIgY2hhbmdlIHRvIHNob3cgZmllbGRzCiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50ZWdyYXRpb24tc2VsZWN0Jyk7CiAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3RWYWx1ZTsKICAgIHNlbGVjdC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwoKICAgIC8vIFBvcHVsYXRlIHRoZSBjb3JyZWN0IGZpZWxkcwogICAgaWYgKHNlbGVjdFZhbHVlID09PSAnc25hcHNjYW4nKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NuYXBzY2FuLWNvZGUnKS52YWx1ZSA9IHZhbHVlMTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tZW1haWwnKS52YWx1ZSA9IHZhbHVlMjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tc2l0ZS1uYW1lJykudmFsdWUgPSB2YWx1ZTM7CiAgICB9IGVsc2UgaWYgKHNlbGVjdFZhbHVlID09PSAnemFwcGVyJykgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItbWVyY2hhbnQtaWQnKS52YWx1ZSA9IHZhbHVlMTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemFwcGVyLXNpdGUtaWQnKS52YWx1ZSA9IHZhbHVlMjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemFwcGVyLXBvcy1rZXknKS52YWx1ZSA9IHZhbHVlMzsKICAgIH0KCiAgICAvLyBTZXQgZm9ybSB0byBlZGl0IG1vZGUKICAgIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXggPSByb3cucm93SW5kZXg7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpLnRleHRDb250ZW50ID0gJ1VwZGF0ZSBFbnRyeSc7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgZm9ybS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTsKfQoKCmZ1bmN0aW9uIHJlc2V0Rm9ybShmb3JtKSB7CiAgICBjb25zdCBmb3JtSWQgPSBmb3JtLmlkOwogICAgZm9ybS5yZXNldCgpOwogICAgZGVsZXRlIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXg7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpLnRleHRDb250ZW50ID0gJ0FkZCBFbnRyeSc7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgaWYgKGZvcm1JZCA9PT0gJ3NpdGVEZXRhaWxzLWZvcm0nKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKLy8gLS0tIFVUSUxJVFkgJiBFWFBPUlQgLS0tCmZ1bmN0aW9uIGNsZWFyQWxsRGF0YShzaG93U3VjY2Vzc01vZGFsID0gdHJ1ZSkgewogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaChzaGVldCA9PiB7CiAgICAgICAgY29uc3QgdGFibGVJZCA9IGAke3NoZWV0LmlkfS10YWJsZWA7CiAgICAgICAgcmVuZGVyVGFibGUodGFibGVJZCwgc2hlZXQuaGVhZGVycywgW10pOwogICAgICAgIHNhdmVUYWJsZVRvU3RvcmFnZSh0YWJsZUlkKTsKICAgIH0pOwogICAgCiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnc3VnZ2VzdGlvbnNfUm9sZS1saXN0Jyk7CiAgICAKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd3ZWxjb21lU2NyZWVuU2hvd24nKTsKICAgIAogICAgY29uc3QgaW50ZWdyYXRpb25TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50ZWdyYXRpb24tc2VsZWN0Jyk7CiAgICBpZiAoaW50ZWdyYXRpb25TZWxlY3QpIHsKICAgICAgICBpbnRlZ3JhdGlvblNlbGVjdC52YWx1ZSA9ICcnOwogICAgICAgIGludGVncmF0aW9uU2VsZWN0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdjaGFuZ2UnKSk7CiAgICB9CgogICAgbG9hZEFsbFN1Z2dlc3Rpb25zKCk7CiAgICBpZiAoc2hvd1N1Y2Nlc3NNb2RhbCkgewogICAgICAgIHNob3dNb2RhbCgnQWxsIGRhdGEgYW5kIHNldHRpbmdzIGhhdmUgYmVlbiBjbGVhcmVkLicsICdzdWNjZXNzJyk7CiAgICB9Cn0KCmZ1bmN0aW9uIGV4cG9ydEFsbFRvRXhjZWwoKSB7CiAgICBjb25zdCBkb1RoZUV4cG9ydEFuZENsZWFyID0gKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOwogICAgICAgICAgICBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5mb3JFYWNoKHNoZWV0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHRhYmxlSWQgPSBgJHtzaGVldC5pZH0tdGFibGVgOwogICAgICAgICAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgICAgICAgICAgICAgIGlmICghdGFibGUpIHJldHVybjsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBzaGVldC5oZWFkZXJzOwogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IEFycmF5LmZyb20odGFibGUucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKSkubWFwKHJvdyA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93RGF0YSA9IHt9OwogICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20ocm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJykpLnNsaWNlKDAsIC0xKS5mb3JFYWNoKCh0ZCwgaSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhW2hlYWRlcnNbaV1dID0gdGQudGV4dENvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvd0RhdGE7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5qc29uX3RvX3NoZWV0KGRhdGEsIHsgaGVhZGVyOiBoZWFkZXJzIH0pOwogICAgICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgc2hlZXQubmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHNpdGVOYW1lID0gJ0RlZmF1bHRfU2l0ZSc7CiAgICAgICAgICAgIGNvbnN0IHNpdGVEZXRhaWxzVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZURldGFpbHMtdGFibGUnKTsKICAgICAgICAgICAgaWYgKHNpdGVEZXRhaWxzVGFibGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0Um93ID0gc2l0ZURldGFpbHNUYWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keSB0cicpOwogICAgICAgICAgICAgICAgaWYgKGZpcnN0Um93KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlyc3RDZWxsID0gZmlyc3RSb3cucXVlcnlTZWxlY3RvcigndGQnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDZWxsICYmIGZpcnN0Q2VsbC50ZXh0Q29udGVudC50cmltKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2l0ZU5hbWUgPSBmaXJzdENlbGwudGV4dENvbnRlbnQudHJpbSgpLnJlcGxhY2UoL1teYS16QS1aMC05XyAtXS9nLCAnJykucmVwbGFjZSgvXHMrL2csICdfJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7c2l0ZU5hbWV9X3NpdGVfSW5mb3JtYXRpb24ueGxzeGA7CiAgICAgICAgICAgIAogICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgZmlsZU5hbWUpOwogICAgICAgICAgICAKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBjbGVhckFsbERhdGEoZmFsc2UpOwogICAgICAgICAgICAgICAgc2hvd01vZGFsKCdEYXRhIHN1Y2Nlc3NmdWxseSBleHBvcnRlZCBhbmQgYWxsIGZpZWxkcyBoYXZlIGJlZW4gY2xlYXJlZCEnLCAnc3VjY2VzcycsICgpID0+IHt9LCBmYWxzZSwgeyBhdXRvQ2xvc2U6IGZhbHNlIH0pOwogICAgICAgICAgICB9LCAxMDApOwoKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFeHBvcnQgZmFpbGVkOiIsIGVycm9yKTsKICAgICAgICAgICAgc2hvd01vZGFsKCdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgZXhwb3J0LicsICdlcnJvcicpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3Qgc2hvd0ZpbmFsQ29uZmlybWF0aW9uID0gKCkgPT4gewogICAgICAgIHNob3dNb2RhbCgKICAgICAgICAgICAgJ1dhcm5pbmcuIFBsZWFzZSBlbnN1cmUgYWxsIGluZm9ybWF0aW9uIHByb3ZpZGVkIGlzIGNvcnJlY3QsIGFzIHRoaXMgYWN0aW9uIHdpbGwgY2xlYXIgYWxsIGRhdGEgZnJvbSB0aGUgdGFibGVzLiBEbyB5b3Ugd2FudCB0byBwcm9jZWVkPycsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgZG9UaGVFeHBvcnRBbmRDbGVhciwKICAgICAgICAgICAgdHJ1ZQogICAgICAgICk7CiAgICB9OwoKICAgIGNvbnN0IHNpdGVEZXRhaWxzQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaXRlRGV0YWlscy10YWJsZScpPy5xdWVyeVNlbGVjdG9yKCd0Ym9keScpOwogICAgY29uc3QgZW1wbG95ZWVzQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbXBsb3llZXMtdGFibGUnKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIAogICAgY29uc3QgaGFzU2l0ZURldGFpbHMgPSBzaXRlRGV0YWlsc0JvZHkgJiYgc2l0ZURldGFpbHNCb2R5LnJvd3MubGVuZ3RoID4gMDsKICAgIGNvbnN0IGhhc0VtcGxveWVlcyA9IGVtcGxveWVlc0JvZHkgJiYgZW1wbG95ZWVzQm9keS5yb3dzLmxlbmd0aCA+IDA7CiAgICAKICAgIGlmICghaGFzU2l0ZURldGFpbHMgfHwgIWhhc0VtcGxveWVlcykgewogICAgICAgIGxldCBtaXNzaW5nID0gW107CiAgICAgICAgaWYgKCFoYXNTaXRlRGV0YWlscykgbWlzc2luZy5wdXNoKCJTaXRlIERldGFpbHMiKTsKICAgICAgICBpZiAoIWhhc0VtcGxveWVlcykgbWlzc2luZy5wdXNoKCJFbXBsb3llZXMiKTsKICAgICAgICBzaG93TW9kYWwoYEV4cG9ydCBmYWlsZWQuIFRoZSBmb2xsb3dpbmcgcmVxdWlyZWQgc2VjdGlvbnMgYXJlIGVtcHR5OiAke21pc3Npbmcuam9pbignLCAnKX0uIFBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIGVudHJ5IHRvIGVhY2guYCwgJ2Vycm9yJyk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBlbXB0eU9wdGlvbmFsVGFicyA9IFtdOwogICAgWydzdXBwbGllcnMnLCAnc2l0ZG93bkFyZWFzJywgJ2ludGVncmF0aW9ucyddLmZvckVhY2goaWQgPT4gewogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtpZH0tdGFibGVgKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgICAgICBjb25zdCBzaGVldCA9IGluaXRpYWxEYXRhW2lkXTsKICAgICAgICBpZiAoc2hlZXQgJiYgKCFib2R5IHx8IGJvZHkucm93cy5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgIGVtcHR5T3B0aW9uYWxUYWJzLnB1c2goc2hlZXQubmFtZSk7CiAgICAgICAgfQogICAgfSk7CiAgICAKICAgIGlmIChlbXB0eU9wdGlvbmFsVGFicy5sZW5ndGggPiAwKSB7CiAgICAgICAgc2hvd01vZGFsKAogICAgICAgICAgICBgV2FybmluZzogVGhlIGZvbGxvd2luZyB0YWJzIGhhdmUgbm8gZGF0YTogJHtlbXB0eU9wdGlvbmFsVGFicy5qb2luKCcsICcpfS4gRG8geW91IHdhbnQgdG8gY29udGludWUgZXhwb3J0aW5nIHRoZSByZW1haW5pbmcgZGF0YT9gLAogICAgICAgICAgICAnd2FybmluZycsCiAgICAgICAgICAgIHNob3dGaW5hbENvbmZpcm1hdGlvbiwKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgeyBjaGFpbjogdHJ1ZSB9CiAgICAgICAgKTsKICAgIH0gZWxzZSB7CiAgICAgICAgc2hvd0ZpbmFsQ29uZmlybWF0aW9uKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHNob3dNb2RhbChtZXNzYWdlLCB0eXBlID0gJ3N1Y2Nlc3MnLCBvbkNvbmZpcm0gPSAoKSA9PiB7fSwgc2hvd0NhbmNlbCA9IGZhbHNlLCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsJyk7CiAgICBjb25zdCBtb2RhbE1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtbWVzc2FnZScpOwogICAgY29uc3QgbW9kYWxJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLWljb24nKTsKICAgIGNvbnN0IG1vZGFsU3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLXN2ZycpOwogICAgY29uc3QgY29uZmlybUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbC1jb25maXJtJyk7CiAgICBjb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtY2FuY2VsJyk7CiAgICBjb25zdCBtb2RhbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtYnV0dG9ucycpOwoKICAgIG1vZGFsTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7CiAgICBtb2RhbEljb24uY2xhc3NOYW1lID0gYG1vZGFsLWljb24gJHt0eXBlfWA7CiAgICBsZXQgaWNvblBhdGggPSAnJzsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgJ3N1Y2Nlc3MnOiBpY29uUGF0aCA9ICc8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iMjIgNCAxMiAxNC4wMSA5IDExLjAxIj48L3BvbHlsaW5lPic7IGJyZWFrOwogICAgICAgIGNhc2UgJ2Vycm9yJzogaWNvblBhdGggPSAnPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiPjwvY2lyY2xlPjxsaW5lIHgxPSIxNSIgeTE9IjkiIHgyPSI5IiB5Mj0iMTUiPjwvbGluZT48bGluZSB4MT0iOSIgeTE9IjkiIHgyPSIxNSIgeTI9IjE1Ij48L2xpbmU+JzsgYnJlYWs7CiAgICAgICAgY2FzZSAnd2FybmluZyc6IGljb25QYXRoID0gJzxwYXRoIGQ9Ik0xMC4yOSAzLjg2TDEuODIgMThhMiAyIDAgMCAwIDEuNzEgM2gxNi45NGEyIDIgMCAwIDAgMS43MS0zTDEzLjcxIDMuODZhMiAyIDAgMCAwLTMuNDIgMHoiPjwvcGF0aD48bGluZSB4MT0iMTIiIHkxPSI5IiB4Mj0iMTIiIHkyPSIxMyI+PC9saW5lPjxsaW5lIHgxPSIxMiIgeTE9IjE3IiB4Mj0iMTIuMDEiIHkyPSIxNyI+PC9saW5lPic7IGJyZWFrOwogICAgfQogICAgbW9kYWxTdmcuaW5uZXJIVE1MID0gaWNvblBhdGg7CgogICAgbW9kYWxCdXR0b25zLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICBjb25maXJtQnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgY2FuY2VsQnRuLnN0eWxlLmRpc3BsYXkgPSBzaG93Q2FuY2VsID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgIAogICAgaWYgKCFzaG93Q2FuY2VsKSB7CiAgICAgICAgY29uZmlybUJ0bi50ZXh0Q29udGVudCA9ICdPSyc7CiAgICAgICAgY29uZmlybUJ0bi5vbmNsaWNrID0gaGlkZU1vZGFsOwogICAgICAgIGlmICh0eXBlID09PSAnc3VjY2VzcycgJiYgb3B0aW9ucy5hdXRvQ2xvc2UgIT09IGZhbHNlKSB7CiAgICAgICAgICAgICBzZXRUaW1lb3V0KGhpZGVNb2RhbCwgMjUwMCk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBjb25maXJtQnRuLnRleHRDb250ZW50ID0gJ0NvbmZpcm0nOwogICAgICAgIGNvbmZpcm1CdG4ub25jbGljayA9ICgpID0+IHsgCiAgICAgICAgICAgIG9uQ29uZmlybSgpOwogICAgICAgICAgICBpZiAoIW9wdGlvbnMuY2hhaW4pIHsKICAgICAgICAgICAgICAgIGhpZGVNb2RhbCgpOyAKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICB9CiAgICAKICAgIGNhbmNlbEJ0bi5vbmNsaWNrID0gaGlkZU1vZGFsOwogICAgbW9kYWwub25jbGljayA9IChlKSA9PiB7IGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIGhpZGVNb2RhbCgpOyB9OwogICAgCiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7Cn0KCmZ1bmN0aW9uIGhpZGVNb2RhbCgpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKfQoKZnVuY3Rpb24gZ2V0VG9vbHRpcFRleHQoaGVhZGVyKSB7CiAgICBjb25zdCB0b29sdGlwcyA9IHsgIlNpdGUgTmFtZSI6ICJUaGUgY29tbW9uIG5hbWUgZm9yIHRoZSBidXNpbmVzcyBsb2NhdGlvbi4iLCAiUmVnaXN0ZXJlZCBDb21wYW55IE5hbWUiOiAiVGhlIG9mZmljaWFsLCBsZWdhbGx5IHJlZ2lzdGVyZWQgbmFtZSBvZiB0aGUgY29tcGFueS4iLCAiVHJhZGluZyBOYW1lIjogIlRoZSBuYW1lIHRoZSBidXNpbmVzcyB1c2VzIGZvciBtYXJrZXRpbmcgb3Igc2FsZXMuIiwgIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciI6ICJUaGUgdW5pcXVlIG51bWJlciBhc3NpZ25lZCBieSB0aGUgY29tcGFueSByZWdpc3RyYXIuIiwgIkNvbXBhbnkgVkFUIE51bWJlciI6ICJUaGUgdW5pcXVlIG51bWJlciBhc3NpZ25lZCBmb3IgVmFsdWUtQWRkZWQgVGF4IHB1cnBvc2VzLiIsICJPd25lciBOYW1lIjogIkZpcnN0IG5hbWUgb2YgdGhlIHByaW1hcnkgYnVzaW5lc3Mgb3duZXIuIiwgIk93bmVyIFN1cm5hbWUiOiAiTGFzdCBuYW1lIG9mIHRoZSBwcmltYXJ5IGJ1c2luZXNzIG93bmVyLiIsICJPd25lciBGdWxsIE5hbWUiOiAiRnVsbCBuYW1lIG9mIHRoZSBwcmltYXJ5IGJ1c2luZXNzIG93bmVyLiIsICJPd25lciBUZWxlcGhvbmUgTnVtYmVyIjogIkNvbnRhY3QgbnVtYmVyIGZvciB0aGUgYnVzaW5lc3Mgb3duZXIuIE11c3QgYmUgMTAgZGlnaXRzLiIsICJPd25lciBFbWFpbCBBZGRyZXNzIjogIlRoZSBwcmltYXJ5IGVtYWlsIGZvciB0aGUgYnVzaW5lc3Mgb3duZXIuIE11c3QgYmUgYSB2YWxpZCBlbWFpbCBmb3JtYXQuIiwgIlNpdGUgQWRkcmVzcyI6ICJUaGUgcGh5c2ljYWwgYWRkcmVzcyBvZiB0aGUgYnVzaW5lc3MgbG9jYXRpb24uIiwgIkVtcGxveWVlIE5hbWUiOiAiRmlyc3QgbmFtZSBvZiB0aGUgZW1wbG95ZWUuIiwgIlN1cm5hbWUiOiAiTGFzdCBuYW1lIG9mIHRoZSBlbXBsb3llZS4iLCAiRW1wbG95ZWUgRnVsbCBOYW1lIjogIkZ1bGwgbmFtZSBvZiB0aGUgZW1wbG95ZWUuIiwgIkVtYWlsIEFkZHJlc3MgKElmIEFkbWluL01hbmFnZXIpIjogIlJlcXVpcmVkIGZvciBzdGFmZiB3aXRoIEFkbWluIG9yIE1hbmFnZXIgcGVybWlzc2lvbnMuIE11c3QgYmUgYSB2YWxpZCBlbWFpbCBmb3JtYXQuIiwgIkNvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKSI6ICJPcHRpb25hbCBjb250YWN0IG51bWJlciBmb3Igc2VuaW9yIHN0YWZmLiBNdXN0IGJlIDEwIGRpZ2l0cyBpZiBwcm92aWRlZC4iLCAiUm9sZSI6ICJBIHNlY29uZGFyeSByb2xlIG9yIHRpdGxlIGZvciB0aGUgZW1wbG95ZWUgKGUuZy4sIE1hbmFnZXIsIFdhaXRlciwgU3RhZmYsIE93bmVyKS4iLCAiTG9naW4gQ29kZSI6ICJBIHVuaXF1ZSBudW1lcmljIGNvZGUgZm9yIHRoZSBlbXBsb3llZSB0byBsb2cgaW50byB0aGUgc3lzdGVtLiBNdXN0IGJlIDQgZGlnaXRzIGlmIHByb3ZpZGVkLiIsICJOYW1lIjogIlRoZSBuYW1lIG9mIHRoZSBzdXBwbGllciBjb21wYW55LiIsICJBZGRyZXNzIExpbmUgMSI6ICJUaGUgZmlyc3QgbGluZSBvZiB0aGUgc3VwcGxpZXIncyBhZGRyZXNzLiIsICJUb3duIjogIlRoZSB0b3duIG9yIGNpdHkgd2hlcmUgdGhlIHN1cHBsaWVyIGlzIGxvY2F0ZWQuIiwgIkNvbnRhY3QgRmlyc3QgTmFtZSI6ICJUaGUgZmlyc3QgbmFtZSBvZiB5b3VyIGNvbnRhY3QgcGVyc29uIGF0IHRoZSBzdXBwbGllci4iLCAiQ29udGFjdCBFbWFpbCI6ICJUaGUgZW1haWwgYWRkcmVzcyBmb3IgeW91ciBzdXBwbGllciBjb250YWN0LiBNdXN0IGJlIGEgdmFsaWQgZW1haWwgZm9ybWF0LiIsICJDb250YWN0IFBob25lIE51bWJlciI6ICJUaGUgcGhvbmUgbnVtYmVyIGZvciB5b3VyIHN1cHBsaWVyIGNvbnRhY3QuIE11c3QgYmUgMTAgZGlnaXRzLiIsICJBcmVhIExvY2F0aW9uIjogIkEgbmFtZSBmb3IgdGhlIHBoeXNpY2FsIGFyZWEgd2hlcmUgdGhlIHRhYmxlIGlzLCBlLmcuLCAnUGF0aW8nIG9yICdVcHN0YWlycycuIiwgIlRhYmxlICMiOiAiVGhlIG51bWJlciBvciBuYW1lIG9mIHRoZSB0YWJsZS4ifTsKICAgIHJldHVybiB0b29sdGlwc1toZWFkZXJdIHx8IGBFbnRlciB0aGUgJHtoZWFkZXJ9LmA7Cn0KCi8vIC0tLSBUVVRPUklBTCBMT0dJQyAtLS0KY29uc3QgdHV0b3JpYWxTdGVwcyA9IFsKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWhvdy10by1ndWlkZScsCiAgICAgICAgY29udGVudDogJzxiPldlbGNvbWUhPC9iPiBGb3IgYSBkZXRhaWxlZCBndWlkZSwgeW91IGNhbiBhbHdheXMgY2xpY2sgdGhpcyBkb2N1bWVudCBpY29uIHRvIG9wZW4gdGhlICJIb3cgVG8iIGd1aWRlIGluIGEgbmV3IHRhYi4nLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtdGFicycsCiAgICAgICAgY29udGVudDogJ0ZpcnN0LCB1c2UgdGhlc2UgdGFicyB0byBzd2l0Y2ggYmV0d2VlbiB0aGUgZGlmZmVyZW50IHNlY3Rpb25zIHlvdSBuZWVkIHRvIGZpbGwgaW4sIGxpa2UgIlNpdGUgRGV0YWlscyIgYW5kICJFbXBsb3llZXMiLicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjc2l0ZURldGFpbHMtZm9ybScsCiAgICAgICAgY29udGVudDogJ0luIGVhY2ggc2VjdGlvbiwgZmlsbCBvdXQgdGhlIGZvcm0gd2l0aCB5b3VyIGluZm9ybWF0aW9uLiBGaWVsZHMgd2l0aCBhIGJsdWUgc3RhciAoKikgYXJlIHJlcXVpcmVkLicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjc2l0ZURldGFpbHMtZm9ybSBidXR0b25bdHlwZT0ic3VibWl0Il0nLAogICAgICAgIGNvbnRlbnQ6ICdPbmNlIHlvdVwndmUgZmlsbGVkIG91dCB0aGUgZm9ybSwgY2xpY2sgdGhpcyBidXR0b24gdG8gYWRkIHlvdXIgZW50cnkgdG8gdGhlIHRhYmxlIGJlbG93LicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtdGFibGUtc2l0ZURldGFpbHMnLAogICAgICAgIGNvbnRlbnQ6ICdZb3VyIGVudHJpZXMgd2lsbCBhcHBlYXIgaGVyZS4gWW91IGNhbiBjbGljayBhbnkgY2VsbCB0byBtYWtlIHF1aWNrIGVkaXRzIGRpcmVjdGx5IGluIHRoZSB0YWJsZS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWxvYWRlcnMnLAogICAgICAgIGNvbnRlbnQ6ICdUaGVzZSA8Yj5Mb2FkZXIgYnV0dG9uczwvYj4gb3BlbiBzZXBhcmF0ZSB0b29scyBpbiBhIG5ldyBicm93c2VyIHRhYi4gVXNlIHRoZW0gdG8gYnVsay11cGxvYWQgeW91ciBwcm9kdWN0IGFuZCByZWNpcGUgbGlzdHMuJywKICAgICAgICBwb3NpdGlvbjogJ2xlZnQnCiAgICB9LAogICAgIHsKICAgICAgICBlbGVtZW50OiAnI2V4cG9ydEJ0bicsCiAgICAgICAgY29udGVudDogJ1RoZSA8Yj5FeHBvcnQ8L2I+IGJ1dHRvbiBzYXZlcyBhbGwgdGhlIHNpdGUgZGF0YSB5b3VcJ3ZlIGVudGVyZWQgb24gdGhpcyBwYWdlIGludG8gYSBzaW5nbGUgRXhjZWwgZmlsZS4gTm90ZTogVGhpcyBkb2VzIG5vdCBpbmNsdWRlIGRhdGEgZnJvbSB0aGUgUHJvZHVjdC9SZWNpcGUgbG9hZGVycy4nLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJyNjbGVhckJ0bicsCiAgICAgICAgY29udGVudDogJ1VzZSB0aGUgPGI+Q2xlYXIgQWxsIERhdGE8L2I+IGJ1dHRvbiB0byByZXNldCB0aGUgZW50aXJlIGFwcGxpY2F0aW9uIGFuZCBzdGFydCBmcmVzaC4nLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0KXTsKCmxldCBjdXJyZW50VHV0b3JpYWxTdGVwID0gMDsKY29uc3QgdHV0b3JpYWxPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXknKTsKY29uc3QgdHV0b3JpYWxQb3BvdmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXInKTsKY29uc3QgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3Zlci1jb250ZW50Jyk7CmNvbnN0IHN0ZXBDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXN0ZXAtY291bnRlcicpOwpjb25zdCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByZXYtYnRuJyk7CmNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtbmV4dC1idG4nKTsKbGV0IGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CgpmdW5jdGlvbiBzdGFydFR1dG9yaWFsKCkgewogICAgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICB0dXRvcmlhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3R1dG9yaWFsLWFjdGl2ZScpOwogICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKfQoKZnVuY3Rpb24gZW5kVHV0b3JpYWwoKSB7CiAgICB0dXRvcmlhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIGNvbnN0IG92ZXJsYXlQYXJ0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50dXRvcmlhbC1vdmVybGF5LXBhcnQnKTsKICAgIG92ZXJsYXlQYXJ0cy5mb3JFYWNoKHBhcnQgPT4gewogICAgICAgIHBhcnQuc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgcGFydC5zdHlsZS5oZWlnaHQgPSAnMCc7CiAgICB9KTsKCiAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgndHV0b3JpYWwtYWN0aXZlJyk7CiAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gbnVsbDsKICAgIH0KfQoKZnVuY3Rpb24gc2hvd1R1dG9yaWFsU3RlcChpbmRleCkgewogICAgaWYgKGhpZ2hsaWdodGVkRWxlbWVudCkgewogICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgfQoKICAgIGNvbnN0IHN0ZXAgPSB0dXRvcmlhbFN0ZXBzW2luZGV4XTsKICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0ZXAuZWxlbWVudCk7CgogICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUdXRvcmlhbCBlbGVtZW50IG5vdCBmb3VuZDonLCBzdGVwLmVsZW1lbnQpOwogICAgICAgIGlmIChpbmRleCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGluZGV4ICsgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZW5kVHV0b3JpYWwoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBNYWtlIHBvcG92ZXIgdmlzaWJsZSBmb3IgcG9zaXRpb25pbmcgY2FsY3VsYXRpb25zCiAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAKICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IHRhcmdldEVsZW1lbnQ7CiAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgIAogICAgdGFyZ2V0RWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdjZW50ZXInLCBpbmxpbmU6ICdjZW50ZXInIH0pOwoKICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHN0ZXAuY29udGVudDsKICAgIHN0ZXBDb3VudGVyLnRleHRDb250ZW50ID0gYFN0ZXAgJHtpbmRleCArIDF9IG9mICR7dHV0b3JpYWxTdGVwcy5sZW5ndGh9YDsKICAgIAogICAgLy8gUG9zaXRpb24gUG9wb3ZlciBhbmQgU3BvdGxpZ2h0CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBwb3NpdGlvblBvcG92ZXIodGFyZ2V0RWxlbWVudCwgc3RlcC5wb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0RWxlbWVudCk7CiAgICB9LCAzMDApOyAvLyBBIHNtYWxsIGRlbGF5IHRvIGFsbG93IGZvciBzY3JvbGxpbmcKCiAgICBwcmV2QnRuLmRpc2FibGVkID0gaW5kZXggPT09IDA7CiAgICBuZXh0QnRuLnRleHRDb250ZW50ID0gaW5kZXggPT09IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSA/ICdGaW5pc2gnIDogJ05leHQnOwp9CgpmdW5jdGlvbiBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXQpIHsKICAgIGNvbnN0IHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBjb25zdCBvdmVybGF5VG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJyk7CiAgICBjb25zdCBvdmVybGF5Qm90dG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJyk7CiAgICBjb25zdCBvdmVybGF5TGVmdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKTsKICAgIGNvbnN0IG92ZXJsYXlSaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jyk7CgogICAgb3ZlcmxheVRvcC5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICBvdmVybGF5VG9wLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKICAgIAogICAgb3ZlcmxheUJvdHRvbS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LmJvdHRvbX1weGA7CiAgICBvdmVybGF5Qm90dG9tLnN0eWxlLmhlaWdodCA9IGBjYWxjKDEwMHZoIC0gJHt0YXJnZXRSZWN0LmJvdHRvbX1weClgOwogICAgb3ZlcmxheUJvdHRvbS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CgogICAgb3ZlcmxheUxlZnQuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgb3ZlcmxheUxlZnQuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgb3ZlcmxheUxlZnQuc3R5bGUud2lkdGggPSBgJHt0YXJnZXRSZWN0LmxlZnR9cHhgOwoKICAgIG92ZXJsYXlSaWdodC5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICBvdmVybGF5UmlnaHQuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgb3ZlcmxheVJpZ2h0LnN0eWxlLmxlZnQgPSBgJHt0YXJnZXRSZWN0LnJpZ2h0fXB4YDsKICAgIG92ZXJsYXlSaWdodC5zdHlsZS53aWR0aCA9IGBjYWxjKDEwMHZ3IC0gJHt0YXJnZXRSZWN0LnJpZ2h0fXB4KWA7Cn0KCmZ1bmN0aW9uIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXQsIHBvc2l0aW9uKSB7CiAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgY29uc3QgcG9wb3Zlck5vZGUgPSB0dXRvcmlhbFBvcG92ZXI7CiAgICAKICAgIC8vIFRlbXBvcmFyaWx5IGRpc3BsYXkgdGhlIHBvcG92ZXIgdG8gZ2V0IGl0cyBkaW1lbnNpb25zCiAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7CiAgICBjb25zdCBwb3BvdmVyUmVjdCA9IHBvcG92ZXJOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgcG9wb3Zlck5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICcnOwoKICAgIGNvbnN0IGFycm93Q2xhc3MgPSBgYXJyb3ctJHtwb3NpdGlvbn1gOwogICAgY29uc3Qgc3BhY2luZyA9IDE1OwoKICAgIC8vIFJlc2V0IGNsYXNzZXMKICAgIHBvcG92ZXJOb2RlLmNsYXNzTmFtZSA9ICd0dXRvcmlhbC1wb3BvdmVyJzsKCiAgICBsZXQgdG9wLCBsZWZ0OwoKICAgIHN3aXRjaCAocG9zaXRpb24pIHsKICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CiAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyAodGFyZ2V0UmVjdC53aWR0aCAvIDIpIC0gKHBvcG92ZXJSZWN0LndpZHRoIC8gMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QuYm90dG9tICsgc3BhY2luZzsKICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QucmlnaHQgKyBzcGFjaW5nOwogICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCArICh0YXJnZXRSZWN0LmhlaWdodCAvIDIpIC0gKHBvcG92ZXJSZWN0LmhlaWdodCAvIDIpOwogICAgICAgICAgICBicmVhazsKICAgIH0KICAgIAogICAgLy8gQm91bmRhcnkgY2hlY2tzCiAgICBpZiAobGVmdCA8IHNwYWNpbmcpIGxlZnQgPSBzcGFjaW5nOwogICAgaWYgKChsZWZ0ICsgcG9wb3ZlclJlY3Qud2lkdGgpID4gd2luZG93LmlubmVyV2lkdGggLSBzcGFjaW5nKSBsZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICBpZiAodG9wIDwgc3BhY2luZykgdG9wID0gc3BhY2luZzsKICAgIGlmICgodG9wICsgcG9wb3ZlclJlY3QuaGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCAtIHNwYWNpbmcpIHRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CgogICAgcG9wb3Zlck5vZGUuc3R5bGUudG9wID0gYCR7dG9wfXB4YDsKICAgIHBvcG92ZXJOb2RlLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKICAgIHBvcG92ZXJOb2RlLmNsYXNzTGlzdC5hZGQoYXJyb3dDbGFzcyk7Cn0KCgpwcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPiAwKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcC0tOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9Cn0pOwoKbmV4dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwIDwgdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCsrOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9IGVsc2UgewogICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICB9Cn0pOwo8L3NjcmlwdD4KCgoKPC9ib2R5Pgo8L2h0bWw+Cgo=</script>
  <script type="application/json" id="b64-product">PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtU2VjdXJpdHktUG9saWN5IiBjb250ZW50PSIKICAgIGRlZmF1bHQtc3JjICdzZWxmJzsKICAgIHNjcmlwdC1zcmMgJ3NlbGYnICd1bnNhZmUtaW5saW5lJyBodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tOwogICAgc3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZScgaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbTsKICAgIGZvbnQtc3JjICdzZWxmJyBodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tOwogICAgaW1nLXNyYyAnc2VsZicgZGF0YTo7CiAgICBtZWRpYS1zcmMgJ3NlbGYnOwogICAgY29ubmVjdC1zcmMgJ3NlbGYnIHdzOjsKICAiPgogIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4KICA8dGl0bGU+VGFibGUgQnkgWW9jbyBQcm9kdWN0IExvYWRlcjwvdGl0bGU+CiAgPGxpbmsgcmVsPSJpY29uIiBocmVmPSJkYXRhOmltYWdlL3N2Zyt4bWwsJTNDc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgdmlld0JveD0nMCAwIDEwMCAxMDAnJTNFJTNDY2lyY2xlIGN4PSc1MCcgY3k9JzUwJyByPSc1MCcgZmlsbD0nJTIzMDBBM0ZGJy8lM0UlM0N0ZXh0IHg9JzUwJyB5PSc3MCcgZm9udC1zaXplPSc1MCcgZm9udC1mYW1pbHk9J1BvcHBpbnMsIHNhbnMtc2VyaWYnIGZvbnQtd2VpZ2h0PSdib2xkJyBmaWxsPSd3aGl0ZScgdGV4dC1hbmNob3I9J21pZGRsZSclM0VZJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIj4KICAKICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcyI+PC9zY3JpcHQ+CiAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3BkZi5qcy8yLjE2LjEwNS9wZGYubWluLmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvU29ydGFibGUvMS4xNS4wL1NvcnRhYmxlLm1pbi5qcyI+PC9zY3JpcHQ+CiAgCiAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIj4KICA8bGluayByZWw9InByZWNvbm5lY3QiIGhyZWY9Imh0dHBzOi8vZm9udHMuZ3N0YXRpYy5jb20iIGNyb3Nzb3JpZ2luPgogIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9UG9wcGluczp3Z2h0QDQwMDs1MDA7NjAwOzcwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CiAgCiAgPHN0eWxlPgogICAgOnJvb3QgewogICAgICAtLXlvY28tYmc6ICMxMjEyMTI7IC0teW9jby1zdXJmYWNlOiAjMWUxZTFlOyAtLXlvY28tcHJpbWFyeTogIzAwQTNGRjsKICAgICAgLS15b2NvLXByaW1hcnktaG92ZXI6ICMwMDhiZGY7IC0teW9jby10ZXh0LXByaW1hcnk6ICNGRkZGRkY7IC0teW9jby10ZXh0LXNlY29uZGFyeTogI2IzYjNiMzsKICAgICAgLS15b2NvLWJvcmRlcjogIzMzMzMzMzsgLS15b2NvLXJlZDogI2ViNTc1NzsgLS15b2NvLXllbGxvdzogI2ZmYzEwNzsKICAgICAgLS15b2NvLWdyZWVuOiAjMjdhZTYwOyAtLXNoYWRvdzogMCA4cHggMjRweCByZ2JhKDAsIDAsIDAsIDAuMyk7CiAgICB9CiAgICAqIHsgYm94LXNpemluZzogYm9yZGVyLWJveDsgfQogICAgYm9keSB7CiAgICAgICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsgbWFyZ2luOiAwOyBwYWRkaW5nOiAxNjBweCAyMHB4OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyBwb3NpdGlvbjogcmVsYXRpdmU7Cn0KICAgIC5jb250YWluZXIgeyBtYXgtd2lkdGg6IDE2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IH0KCiAgICBoZWFkZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiA0MHB4OyBwb3NpdGlvbjogcmVsYXRpdmU7IGZsZXgtd3JhcDogd3JhcDsgZ2FwOiAyMHB4OwogICAgfQogICAgLnRpdGxlLWNvbnRhaW5lciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIGdhcDogMTVweDsKICAgIH0KICAgIGhlYWRlciBoMiB7CiAgICAgICAgZm9udC1zaXplOiAyLjVyZW07IGZvbnQtd2VpZ2h0OiA3MDA7IG1hcmdpbjogMDsKICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoNDVkZWcsIHZhcigtLXlvY28tcHJpbWFyeSksICNmZmYpOwogICAgICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0OyAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAuaG93LXRvLWd1aWRlIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2UtaW4tb3V0OwogICAgfQogICAgLmhvdy10by1ndWlkZTpob3ZlciB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAuaG93LXRvLWd1aWRlIC50b29sdGlwdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsgd2lkdGg6IDEyMHB4OwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgIHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNnB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgei1pbmRleDogMTsgYm90dG9tOiAxNDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgCiAgICAgIG9wYWNpdHk6IDA7IHRyYW5zaXRpb246IG9wYWNpdHkgMC4zczsKICAgIH0KICAgIC5ob3ctdG8tZ3VpZGU6aG92ZXIgLnRvb2x0aXB0ZXh0IHsKICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAgICAgb3BhY2l0eTogMTsKICAgIH0KICAgICNzZWNyZXRUcmlnZ2VyIHsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICB9CiAgICAjc2F2ZVN0YXR1cyB7CiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDVweDsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1ncmVlbik7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgcGFkZGluZzogNXB4IDE1cHg7IGJvcmRlci1yYWRpdXM6IDIwcHg7IGZvbnQtc2l6ZTogMTRweDsKICAgICAgICBmb250LXdlaWdodDogNTAwOyBvcGFjaXR5OiAwOyB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXMgZWFzZS1pbi1vdXQ7CiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB9CiAgICAuc2Vzc2lvbi1zZXR0aW5ncywgLnByb2R1Y3QtZGVmYXVsdHMsIC5saWJyYXJ5LW1hbmFnZW1lbnQgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3JkZXItcmFkaXVzOiAxNnB4OyBwYWRkaW5nOiAzMHB4OyBtYXJnaW4tYm90dG9tOiA0MHB4OwogICAgICAgIGRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMjUwcHgsIDFmcikpOwogICAgICAgIGdhcDogMjVweDsgYWxpZ24taXRlbXM6IGVuZDsKICAgIH0KICAgICAubGlicmFyeS1tYW5hZ2VtZW50IHsKICAgICAgICBwYWRkaW5nOiAyMHB4IDMwcHg7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IAogICAgfQogICAgLmxpYnJhcnktbWFuYWdlbWVudC1oZWFkZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgZ2FwOiAxMHB4OwogICAgfQogICAgLmxpYnJhcnktbWFuYWdlbWVudC1oZWFkZXIgaDMgewogICAgICAgICBtYXJnaW46IDA7IGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgLmxpYnJhcnktY29udHJvbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZ2FwOiAxNXB4OwogICAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgIH0KICAgIC5zZXNzaW9uLXNldHRpbmdzIGgzLCAucHJvZHVjdC1kZWZhdWx0cyBoMyB7IAogICAgICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7IG1hcmdpbjogMCAwIDEwcHggMDsgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IAogICAgfQogICAgLnByb2R1Y3QtZGVmYXVsdHMgewogICAgICAgIC8qIG1hcmdpbi10b3A6IC0yMHB4OyAqLyAvKiBSRU1PVkVEIC0gTm8gbG9uZ2VyIG5lZWRlZCBhZnRlciByZW1vdmluZyBzZXNzaW9uIGRlZmF1bHRzICovCiAgICB9CiAgICBmb3JtIHsKICAgICAgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maXQsIG1pbm1heCgyODBweCwgMWZyKSk7CiAgICAgIGdhcDogMjVweDsgcGFkZGluZzogMzBweDsgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyBib3JkZXItcmFkaXVzOiAxNnB4OyBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgICBtYXJnaW4tYm90dG9tOiA0MHB4OwogICAgfQogICAgLmZvcm0tZ3JvdXAgeyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB9CiAgICAuZHluYW1pYy1zZWN0aW9uIHsKICAgICAgICBncmlkLWNvbHVtbjogMSAvIC0xOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgIGdhcDogMTVweDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgcGFkZGluZy10b3A6IDIwcHg7CiAgICB9CiAgICAudmFyaWFudHMtYW5kLXByaWNpbmctd3JhcHBlciB7CiAgICAgICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjsKICAgICAgICBnYXA6IDI1cHg7CiAgICAgICAgYWxpZ24taXRlbXM6IHN0YXJ0OwogICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgcGFkZGluZy10b3A6IDIwcHg7CiAgICB9CiAgICAjdmFyaWFudHMtY29sdW1uID4gZGl2IHsgbWFyZ2luLWJvdHRvbTogMjBweDsgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93LCAubW9kaWZpZXItZ3JvdXAtcm93IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBwYWRkaW5nOiAxNXB4OyBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDEwcHg7CiAgICAgICAgY3Vyc29yOiBncmFiOwogICAgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93OmdyYWJiaW5nIHsgY3Vyc29yOiBncmFiYmluZzsgfQogICAgLnZhcmlhbnQtb3B0aW9ucy1jb250YWluZXIgLnZhcmlhbnQtb3B0aW9uLXJvdyB7IGN1cnNvcjogZ3JhYjsgfQogICAgLnZhcmlhbnQtb3B0aW9ucy1jb250YWluZXIgLnZhcmlhbnQtb3B0aW9uLXJvdzpncmFiYmluZyB7IGN1cnNvcjogZ3JhYmJpbmc7IH0KCiAgICAudmFyaWFudC1ncm91cC1oZWFkZXIsIC5tb2RpZmllci1ncm91cC1oZWFkZXIgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IH0KICAgIC52YXJpYW50LWdyb3VwLWhlYWRlciBpbnB1dCwgLm1vZGlmaWVyLWdyb3VwLWhlYWRlciBpbnB1dCB7IGZsZXgtZ3JvdzogMTsgfQogICAgLnZhcmlhbnQtb3B0aW9uLXJvdyB7IGRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIGF1dG87IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZy1sZWZ0OiAyMHB4O30KICAgIC5tb2RpZmllci1vcHRpb24tcm93IHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyIGF1dG87IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZy1sZWZ0OiAyMHB4O30KICAgIC52YXJpYW50LXByaWNpbmctcm93IHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAyZnIgMWZyIDFmciBhdXRvOyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IHBhZGRpbmctbGVmdDogMjBweDt9CiAgICAudmFyaWFudC1wcmljaW5nLXJvdyAuY29tYm8tbmFtZSB7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyB9CgogICAgLmJ0bi1hZGQtZHluYW1pYyB7IGFsaWduLXNlbGY6IGZsZXgtc3RhcnQ7IHBhZGRpbmc6IDhweCAxNnB4OyBmb250LXNpemU6IDE0cHg7IH0KICAgIC5keW5hbWljLWNvbnRyb2xzLXdyYXBwZXIgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGZsZXgtd3JhcDogd3JhcDsgfQogICAgI3NpbmdsZS1wcm9kdWN0LW1vZGlmaWVyLWNvbnRyb2xzIHsgZGlzcGxheTogZmxleDsgZ2FwOiAxMHB4OyBhbGlnbi1pdGVtczogY2VudGVyOyB9CiAgICAuZm9ybS1hY3Rpb25zLWZvb3RlciB7CiAgICAgICAgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tdG9wOiAxMHB4OyBncmlkLWNvbHVtbjogMSAvIC0xOyBnYXA6IDIwcHg7CiAgICB9CiAgICAucmVtZW1iZXItbWUtY29udGFpbmVyIHsKICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4OwogICAgfQogICAgLnJlbWVtYmVyLW1lLWNvbnRhaW5lciBsYWJlbCB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsgY3Vyc29yOiBwb2ludGVyOyB1c2VyLXNlbGVjdDogbm9uZTsKICAgIH0KICAgIC5pbnB1dC13cmFwcGVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgcGFkZGluZzogMCAxNHB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4ycywgYm94LXNoYWRvdyAwLjJzOwogICAgfQogICAgLmlucHV0LXdyYXBwZXI6Zm9jdXMtd2l0aGluIHsKICAgICAgICBvdXRsaW5lOiBub25lOwogICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAxNjMsIDI1NSwgMC4zKTsKICAgIH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0IHsKICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICBwYWRkaW5nOiAxNHB4IDA7CiAgICAgICAgZmxleC1ncm93OiAxOwogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICB9CiAgICAuZ2hvc3QtdGV4dCB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG9wYWNpdHk6IDAuNzsKICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICBwYWRkaW5nLWxlZnQ6IDAuNWNoOwogICAgfQogICAgbGFiZWwgeyBmb250LXdlaWdodDogNTAwOyBtYXJnaW4tYm90dG9tOiAxMHB4OyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgfQogICAgbGFiZWwgLnJlcXVpcmVkLXN0YXIgeyBjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgZm9udC13ZWlnaHQ6IGJvbGQ7IG1hcmdpbi1sZWZ0OiAycHg7IH0KICAgIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhIHsKICAgICAgcGFkZGluZzogMTRweDsgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgIGZvbnQtc2l6ZTogMTZweDsgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsKICAgICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMsIGJveC1zaGFkb3cgMC4ycywgYmFja2dyb3VuZC1jb2xvciAwLjJzOyByZXNpemU6IHZlcnRpY2FsOwogICAgfQogICAgc2VsZWN0IHsKICAgICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgLW1vei1hcHBlYXJhbmNlOiBub25lOwogICAgICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWwsJTNDc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgd2lkdGg9JzE2JyBoZWlnaHQ9JzE2JyBmaWxsPSclMjNiM2IzYjMnIHZpZXdCb3g9JzAgMCAxNiAxNiclM0UlM0NwYXRoIGZpbGwtcnVsZT0nZXZlbm9kZCcgZD0nTTEuNjQ2IDQuNjQ2YS41LjUgMCAwIDEgLjcwOCAwTDggMTAuMjkzbDUuNjQ2LTUuNjQ3YS41LjUgMCAwIDEgLjcwOCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4IDBsLTYtNmEuNS41IDAgMCAxIDAtLjcwOHonLyUzRSUzQy9zdmclM0UiKTsKICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IHJpZ2h0IDE0cHggY2VudGVyOwogICAgICAgIGJhY2tncm91bmQtc2l6ZTogMTZweCAxNnB4OwogICAgfQogICAgaW5wdXQ6ZGlzYWJsZWQsIHNlbGVjdDpkaXNhYmxlZCwgdGV4dGFyZWE6ZGlzYWJsZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMzMzOyBjdXJzb3I6IG5vdC1hbGxvd2VkOyB9CiAgICBzZWxlY3Q6aW52YWxpZCB7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgfQogICAgaW5wdXQ6Zm9jdXMsIHNlbGVjdDpmb2N1cywgdGV4dGFyZWE6Zm9jdXMgewogICAgICAgIG91dGxpbmU6IG5vbmU7IGJvcmRlci1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAxNjMsIDI1NSwgMC4zKTsKICAgIH0KICAgIGlucHV0LmlucHV0LWludmFsaWQsIHNlbGVjdC5pbnB1dC1pbnZhbGlkLCB0ZXh0YXJlYS5pbnB1dC1pbnZhbGlkIHsKICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLXlvY28tcmVkKSAhaW1wb3J0YW50OwogICAgfQogICAgLmVycm9yLW1lc3NhZ2UgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXJlZCk7CiAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgICAgIG1hcmdpbi10b3A6IDZweDsKICAgIH0KICAgIGlucHV0OjpwbGFjZWhvbGRlciwgdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyBvcGFjaXR5OiAwLjc7IH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0W3R5cGU9Im51bWJlciJdIHsgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7IH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0W3R5cGU9Im51bWJlciJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uLAogICAgLmlucHV0LXdyYXBwZXIgaW5wdXRbdHlwZT0ibnVtYmVyIl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24gewogICAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgICAgICBtYXJnaW46IDA7CiAgICB9CiAgICAudGFibGUtY29udGFpbmVyIHsKICAgICAgICBvdmVyZmxvdy14OiBhdXRvOyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgYm9yZGVyLXJhZGl1czogMTZweDsgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93KTsKICAgIH0KICAgIHRhYmxlIHsgd2lkdGg6IDEwMCU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7IH0KICAgIHRoLCB0ZCB7IHBhZGRpbmc6IDE2cHggMjBweDsgdGV4dC1hbGlnbjogbGVmdDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgZm9udC1zaXplOiAxNHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyB9CiAgICB0cjpsYXN0LWNoaWxkIHRkIHsgYm9yZGVyLWJvdHRvbTogbm9uZTsgfQogICAgdGggewogICAgICBiYWNrZ3JvdW5kOiAjMmEyYTJhOyBmb250LXdlaWdodDogNjAwOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOyBmb250LXNpemU6IDEycHg7IGxldHRlci1zcGFjaW5nOiAwLjhweDsKICAgIH0KICAgIHRib2R5IHRyIHsgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2UtaW4tb3V0OyB9CiAgICB0Ym9keSB0cjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICMyYzJjMmMgIWltcG9ydGFudDsgfQogICAgdGJvZHkgdHIubmV3LXJvdyB7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMTYzLCAyNTUsIDAuMik7IHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC41cyBlYXNlLWluLW91dDsgfQogICAgdGJvZHkgdHIuZWRpdGluZy1yb3cgeyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMTkzLCA3LCAwLjIpOyB9CiAgICB0Ym9keSB0ci5ncm91cC1hIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4wNSk7IH0KICAgIHRib2R5IHRyLmdyb3VwLWIgeyBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfQogICAgYnV0dG9uIHsKICAgICAgcGFkZGluZzogMTRweCAyOHB4OyBib3JkZXI6IG5vbmU7IGJvcmRlci1yYWRpdXM6IDhweDsgY3Vyc29yOiBwb2ludGVyOwogICAgICBmb250LXNpemU6IDE2cHg7IGZvbnQtd2VpZ2h0OiA2MDA7IGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgfQogICAgYnV0dG9uOmhvdmVyIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0zcHgpOyBib3gtc2hhZG93OiAwIDhweCAxNnB4IHJnYmEoMCwwLDAsMC4zKTsgfQogICAgYnV0dG9uOmRpc2FibGVkIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzMzICFpbXBvcnRhbnQ7CiAgICAgICAgY29sb3I6ICM3NzcgIWltcG9ydGFudDsKICAgICAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOwogICAgICAgIHRyYW5zZm9ybTogbm9uZTsKICAgICAgICBib3gtc2hhZG93OiBub25lOwogICAgICAgIGJvcmRlci1jb2xvcjogIzMzMyAhaW1wb3J0YW50OwogICAgfQogICAgLmJ0bi1hZGQsIC5idG4tdXBkYXRlIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1wcmltYXJ5KTsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsgfQogICAgLmJ0bi1hZGQ6aG92ZXIsIC5idG4tdXBkYXRlOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1wcmltYXJ5LWhvdmVyKTsgfQogICAgLmJ0bi1leHBvcnQsIC5idG4taW1wb3J0IHsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7IGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAuYnRuLWV4cG9ydDpob3ZlciwgLmJ0bi1pbXBvcnQ6aG92ZXIgeyBiYWNrZ3JvdW5kOiB2YXIoLS15b2NvLXByaW1hcnkpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB9CiAgICAuYnRuLWNsZWFyIHsKICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgY29sb3I6IHZhcigtLXlvY28tcmVkKTsgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1yZWQpOyBwYWRkaW5nOiAxMnB4IDE0cHg7CiAgICB9CiAgICAuYnRuLWNsZWFyOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1yZWQpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB9CiAgICAuYnRuLWNsZWFyIHN2ZywgLmJ0bi1lZGl0IHN2ZywgLmJ0bi1yZW1vdmUgc3ZnIHsgdHJhbnNpdGlvbjogZmlsbCAwLjJzOyB9CiAgICAuYnRuLWNsZWFyIHN2ZyB7IGZpbGw6IHZhcigtLXlvY28tcmVkKTsgfQogICAgLmJ0bi1jbGVhcjpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7IH0KICAgIC5idG4tZWRpdCwgLmJ0bi1yZW1vdmUgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgcGFkZGluZzogNXB4OyBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgIHdpZHRoOiAzMnB4OyBoZWlnaHQ6IDMycHg7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgfQogICAgLmJ0bi1lZGl0IHN2ZywgLmJ0bi1yZW1vdmUgc3ZnIHsgZmlsbDogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7IH0KICAgIC5idG4tZWRpdDpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAuYnRuLXJlbW92ZTpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXJlZCk7IH0KICAgIC5idG4tZWRpdDpob3ZlciB7IAogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDE2MywgMjU1LCAwLjEpOyAKICAgICAgdHJhbnNmb3JtOiBub25lOyAKICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgIH0KICAgIC52YXJpYW50LWdyb3VwLXJvdyAuYnRuLXJlbW92ZTpob3ZlciBzdmcsIC52YXJpYW50LW9wdGlvbi1yb3cgLmJ0bi1yZW1vdmU6aG92ZXIgc3ZnIHsKICAgICAgZmlsbDogdmFyKC0teW9jby1yZWQpOwogICAgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93IC5idG4tcmVtb3ZlOmhvdmVyLCAudmFyaWFudC1vcHRpb24tcm93IC5idG4tcmVtb3ZlOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzUsIDg3LCA4NywgMC4xKTsKICAgIH0KICAgIC5idG4tcmVtb3ZlOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzUsIDg3LCA4NywgMC4xKTsgdHJhbnNmb3JtOiBub25lOyBib3gtc2hhZG93OiBub25lOyB9CiAgICAuYnRuLW1hbmFnZW1lbnQgewogICAgICAgIHBhZGRpbmc6IDEwcHggMjBweDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICB9CiAgICAuYWN0aW9ucy1jZWxsIHsgZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IH0KICAgIC5idXR0b24tY29udGFpbmVyIHsgbWFyZ2luLXRvcDogMjBweDsgZGlzcGxheTogZmxleDsgZ2FwOiAxNXB4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmbGV4LXdyYXA6IHdyYXA7IH0KICAgIC50b29sdGlwIHsgcG9zaXRpb246IHJlbGF0aXZlOyBjdXJzb3I6IGhlbHA7IH0KICAgIC50b29sdGlwIC50b29sdGlwdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsgd2lkdGg6IDI4MHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LWFsaWduOiBsZWZ0OyBwYWRkaW5nOiAxMnB4OyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgcG9zaXRpb246IGFic29sdXRlOyB6LWluZGV4OiAxMDsgYm90dG9tOiAxMjUlOyBsZWZ0OiA1MCU7IG1hcmdpbi1sZWZ0OiAtMTQwcHg7IG9wYWNpdHk6IDA7CiAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zczsgZm9udC13ZWlnaHQ6IDQwMDsgZm9udC1zaXplOiAxM3B4OyBsaW5lLWhlaWdodDogMS42OwogICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC40KTsKICAgIH0KICAgIC50b29sdGlwIC50b29sdGlwdGV4dDo6YWZ0ZXIgewogICAgICBjb250ZW50OiAiIjsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDEwMCU7IGxlZnQ6IDUwJTsgbWFyZ2luLWxlZnQ6IC01cHg7CiAgICAgIGJvcmRlci13aWR0aDogNXB4OyBib3JkZXItc3R5bGU6IHNvbGlkOyBib3JkZXItY29sb3I6ICMyYTJhMmEgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAudG9vbHRpcDpob3ZlciAudG9vbHRpcHRleHQgeyB2aXNpYmlsaXR5OiB2aXNpYmxlOyBvcGFjaXR5OiAxOyB9CiAgICAudGFibGUtZm9vdGVyIHsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsgZ2FwOiAxNXB4OyBtYXJnaW4tdG9wOiAyMHB4OyB9CgogICAgLmxpc3QtY29udGFpbmVyIHsKICAgICAgICBtYXJnaW4tdG9wOiA0MHB4OwogICAgfQogICAgLnRhYnMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBtYXJnaW4tYm90dG9tOiAtMXB4OyAvKiBPdmVybGFwIGJvcmRlciAqLwogICAgfQogICAgLnRhYi1saW5rIHsKICAgICAgICBwYWRkaW5nOiAxMnB4IDI0cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogM3B4IHNvbGlkIHRyYW5zcGFyZW50OwogICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgICAgIHRyYW5zZm9ybTogbm9uZTsgLyogT3ZlcnJpZGUgZ2VuZXJhbCBidXR0b24gaG92ZXIgKi8KICAgICAgICBib3gtc2hhZG93OiBub25lOyAvKiBPdmVycmlkZSBnZW5lcmFsIGJ1dHRvbiBob3ZlciAqLwogICAgfQogICAgLnRhYi1saW5rOmhvdmVyIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQogICAgLnRhYi1saW5rLmFjdGl2ZSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogM3B4IHNvbGlkIHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudGFiLWNvbnRlbnQgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAudGFiLWNvbnRlbnQuYWN0aXZlIHsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgIH0KCiAgICAuc2VhcmNoLWNvbnRhaW5lciB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsKICAgIH0KCiAgICAuc2VhcmNoLWNvbnRhaW5lciBpbnB1dFt0eXBlPSJzZWFyY2giXSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgbWF4LXdpZHRoOiA0MDBweDsKICAgICAgICBwYWRkaW5nOiAxMnB4IDE0cHg7IC8qIFNsaWdodGx5IHNtYWxsZXIgcGFkZGluZyAqLwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICB9CgogICAgLnNlYXJjaC1jb250YWluZXIgaW5wdXRbdHlwZT0ic2VhcmNoIl06Zm9jdXMgewogICAgICAgIG91dGxpbmU6IG5vbmU7CiAgICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDNweCByZ2JhKDAsIDE2MywgMjU1LCAwLjMpOwogICAgfQoKCiAgICAubW9kYWwtb3ZlcmxheSB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxOCwgMTgsIDE4LCAwLjg1KTsKICAgICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKICAgICAgICAtd2Via2l0LWJhY2tkcm9wLWZpbHRlcjogYmx1cig4cHgpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIHotaW5kZXg6IDEwMDA7IG9wYWNpdHk6IDA7IHBvaW50ZXItZXZlbnRzOiBub25lOyB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuM3MgZWFzZTsKICAgIH0KICAgIC5tb2RhbC1vdmVybGF5LnNob3cgeyBvcGFjaXR5OiAxOyBwb2ludGVyLWV2ZW50czogYXV0bzsgfQogICAgLm1vZGFsLWNvbnRlbnQgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgcGFkZGluZzogMzBweDsgYm9yZGVyLXJhZGl1czogMTZweDsgbWluLXdpZHRoOiAzMjBweDsgbWF4LXdpZHRoOiA1MDBweDsgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45KTsgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3MgZWFzZTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICB9CiAgICAubW9kYWwtb3ZlcmxheS5zaG93IC5tb2RhbC1jb250ZW50IHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfQogICAgLm1vZGFsLWNvbnRlbnQgcCB7IG1hcmdpbjogMCAwIDIwcHggMDsgZm9udC1zaXplOiAxNnB4OyBsaW5lLWhlaWdodDogMS42OyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IH0KICAgIC5tb2RhbC1hY3Rpb25zIHsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGdhcDogMTVweDsgfQogICAgLm1vZGFsLWNvbnRlbnQuZXJyb3IgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjNDQxYzI0OyBjb2xvcjogI2Y4ZDdkYTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1yZWQpOyB9CiAgICAubW9kYWwtY29udGVudC53YXJuaW5nIHsgYmFja2dyb3VuZC1jb2xvcjogIzRkNDIxYTsgY29sb3I6ICNmZmYzY2Q7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28teWVsbG93KTsgfQogICAgCiAgICAvKiAqLwogICAgLmxpYnJhcnktbW9kYWwtbWVudSB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgIGdhcDogMTVweDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgfQogICAgLmxpYnJhcnktbW9kYWwtbWVudSBidXR0b24gewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsKICAgICAgICBwYWRkaW5nOiAxOHB4IDI0cHg7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB9CiAgICAubGlicmFyeS1tb2RhbC1tZW51IGJ1dHRvbjpob3ZlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzMzMzsKICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CgoKICAgICNtb2RpZmllck1vZGFsIC5tb2RhbC1jb250ZW50LCAjbGlua01vZGlmaWVyTW9kYWwgLm1vZGFsLWNvbnRlbnQsIAogICAgLnByZXNldC1tb2RhbCAubW9kYWwtY29udGVudCB7IAogICAgICAgIG1heC13aWR0aDogODAwcHg7IHRleHQtYWxpZ246IGxlZnQ7IAogICAgfQogICAgI2VkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciwgI2xpbmtNb2RpZmllckxpc3RDb250YWluZXIsIAogICAgLnByZXNldC1saXN0LWNvbnRhaW5lciwgLnByZXNldC1lZGl0LWNvbnRhaW5lciB7IAogICAgICAgIG1heC1oZWlnaHQ6IDQwdmg7IG92ZXJmbG93LXk6IGF1dG87IHBhZGRpbmctcmlnaHQ6IDEwcHg7CiAgICB9CiAgICAubW9kYWwtc2VjdGlvbi1kaXZpZGVyIHsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIHBhZGRpbmctYm90dG9tOiAxNXB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICB9CiAgICAjbGlua01vZGlmaWVyTGlzdENvbnRhaW5lciAubW9kaWZpZXItbGluay1pdGVtIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDE1cHg7IHBhZGRpbmc6IDhweDsKICAgIH0KICAgICNsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyIC5tb2RpZmllci1saW5rLWl0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBib3JkZXItcmFkaXVzOiA0cHg7IH0KICAgICNsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyIC5tb2RpZmllci1saW5rLWl0ZW0gaW5wdXRbdHlwZT0iY2hlY2tib3giXSB7IHdpZHRoOiAxOHB4OyBoZWlnaHQ6IDE4cHg7IH0KCiAgICAubW9kaWZpZXItaW5kaWNhdG9yIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtZmxleDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgd2lkdGg6IDIycHg7IGhlaWdodDogMjJweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWdyZWVuKTsgY29sb3I6IHdoaXRlOyBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogNjAwOwogICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgfQogICAgLm1vZGlmaWVyLWluZGljYXRvci13cmFwcGVyLnRvb2x0aXAgeyBib3JkZXItYm90dG9tOiBub25lOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0KICAgIC5tb2RpZmllci1pbmRpY2F0b3Itd3JhcHBlciAudG9vbHRpcHRleHQgeyBtaW4td2lkdGg6IDIwMHB4OyBtYXJnaW4tbGVmdDogLTEwMHB4OyB9CgogICAgLnByaWNpbmctY29udHJvbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OyBwYWRkaW5nOiAxMHB4OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IGJvcmRlci1yYWRpdXM6IDhweDsKICAgIH0KICAgIC5wcmljaW5nLWNvbnRyb2xzIHNlbGVjdCB7CiAgICAgICAgZmxleC1ncm93OiAxOwogICAgfQogICAgLnByaWNpbmctY29udHJvbHMgaW5wdXQgeyAKICAgICAgICBmbGV4LWdyb3c6IDE7IAogICAgfQoKICAgICNidWxrTW9kaWZpZXJMaW5rZXIgewogICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICB9CgogICAgI2J1bGtNb2RpZmllckNoZWNrYm94Q29udGFpbmVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAxMHB4OwogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4OwogICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJnKTsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgIH0KCiAgICAudG9vbHRpcCAudG9vbHRpcHRleHQud2l0aC1naWYgewogICAgICAgIHdpZHRoOiA4NTBweDsKICAgICAgICBtYXJnaW4tbGVmdDogLTIyNXB4OwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDE1cHg7CiAgICB9CiAgICAudG9vbHRpcC10ZXh0LWNvbnRlbnQgewogICAgICAgIGZsZXg6IDE7CiAgICB9CiAgICAudG9vbHRpcC1naWYgewogICAgICAgIHdpZHRoOiAxMDAwcHg7CiAgICAgICAgaGVpZ2h0OiA1MDA7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgfQoKICAgIC5oaWRkZW4gewogICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLmJ0bi1saW5rIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBwYWRkaW5nOiA1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgIHdpZHRoOiAzMnB4OwogICAgICAgIGhlaWdodDogMzJweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuYnRuLWxpbmsgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICB0cmFuc2l0aW9uOiBmaWxsIDAuMnM7CiAgICB9CiAgICAuYnRuLWxpbms6aG92ZXIgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLWdyZWVuKTsKICAgIH0KICAgIC5idG4tbGluazpob3ZlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzOSwgMTc0LCA5NiwgMC4xKTsKICAgICAgICB0cmFuc2Zvcm06IG5vbmU7CiAgICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgIH0KICAgIC5oaWdobGlnaHQtcm93IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDEwMCwgMjU1LCAwLjMpICFpbXBvcnRhbnQ7CiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjVzIGVhc2UtaW4tb3V0OwogICAgfQoKICAgIC5yYXctaXRlbS1pbmRpY2F0b3IgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ncmVlbik7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tZ3JlZW4pOwogICAgICAgIHBhZGRpbmc6IDNweCA4cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgIGN1cnNvcjogZGVmYXVsdDsKICAgIH0KCgogICAgLyogLS0tIEhPVkVSIEJPQVJEIFNUWUxFUyAtLS0gKi8KICAgICNob3Zlci1ib2FyZCB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIGJvdHRvbTogMjBweDsKICAgICAgICByaWdodDogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4OwogICAgICAgIHBhZGRpbmc6IDRweDsKICAgICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgICAgIHotaW5kZXg6IDk1MDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGdhcDogNHB4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZS1pbi1vdXQ7CiAgICAgICAgb3BhY2l0eTogMC42OwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMHB4KTsKICAgIH0KCiAgICAjaG92ZXItYm9hcmQ6aG92ZXIgewogICAgICAgIG9wYWNpdHk6IDE7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOwogICAgfQoKICAgIC5ob3Zlci1ib2FyZC1saW5rIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIHBhZGRpbmc6IDZweCAxMHB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMsIGNvbG9yIDAuMnM7CiAgICB9CgogICAgLmhvdmVyLWJvYXJkLWxpbms6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IC8qIEZhbGxiYWNrIGZvciB3aGVuIHZhciBpcyBub3QgYXZhaWxhYmxlICovCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1iZy1hbHQsICMyYTJhMmEpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgogICAgI3Njcm9sbFRvVG9wQnRuLmhvdmVyLWJvYXJkLWxpbmssICNzY3JvbGxUb0JvdHRvbUJ0bi5ob3Zlci1ib2FyZC1saW5rIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcGFkZGluZzogNnB4OwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIH0KCiAgICAjc2Nyb2xsVG9Ub3BCdG4uaG92ZXItYm9hcmQtbGluayBzdmcsICNzY3JvbGxUb0JvdHRvbUJ0bi5ob3Zlci1ib2FyZC1saW5rIHN2ZyB7CiAgICAgICAgdHJhbnNpdGlvbjogZmlsbCAwLjJzOwogICAgICAgIGZpbGw6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgfQoKICAgICNzY3JvbGxUb1RvcEJ0bi5ob3Zlci1ib2FyZC1saW5rOmhvdmVyIHN2ZywgI3Njcm9sbFRvQm90dG9tQnRuLmhvdmVyLWJvYXJkLWxpbms6aG92ZXIgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiA5OTJweCkgewogICAgICAgIC52YXJpYW50cy1hbmQtcHJpY2luZy13cmFwcGVyIHsKICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7CiAgICAgICAgfQogICAgfQoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgewogICAgICAgIGJvZHkgeyBwYWRkaW5nOiAxMHB4OyB9CiAgICAgICAgLmNvbnRhaW5lciB7IHBhZGRpbmc6IDEwcHg7IH0KICAgICAgICBoZWFkZXIgeyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogZmxleC1zdGFydDsgZ2FwOiAyMHB4OyB9CiAgICAgICAgaGVhZGVyIGgyIHsgZm9udC1zaXplOiAycmVtOyB9CiAgICAgICAgLnNlc3Npb24tc2V0dGluZ3MsIC5wcm9kdWN0LWRlZmF1bHRzLCBmb3JtIHsgCiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7IAogICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgCiAgICAgICAgfQogICAgICAgIC5saWJyYXJ5LW1hbmFnZW1lbnQgeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgfQogICAgICAgIC5saWJyYXJ5LW1hbmFnZW1lbnQtaGVhZGVyIHsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IH0KICAgICAgICAubGlicmFyeS1jb250cm9scyB7IHdpZHRoOiAxMDAlOyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB9CiAgICAgICAgLmxpYnJhcnktY29udHJvbHMgYnV0dG9uIHsgd2lkdGg6IDEwMCU7IH0KICAgICAgICAudmFyaWFudC1ncm91cC1oZWFkZXIsIC52YXJpYW50LW9wdGlvbi1yb3csIC52YXJpYW50LXByaWNpbmctcm93LCAubW9kaWZpZXItZ3JvdXAtaGVhZGVyLCAubW9kaWZpZXItb3B0aW9uLXJvdyB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOyBnYXA6IDE1cHg7IH0KICAgICAgICB0aCwgdGQgeyBwYWRkaW5nOiAxMnB4IDEwcHg7IGZvbnQtc2l6ZTogMTNweDsgfQogICAgICAgIC5idXR0b24tY29udGFpbmVyIHsgd2lkdGg6IDEwMCU7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IH0KICAgICAgICAuYnV0dG9uLWNvbnRhaW5lciBidXR0b24geyB3aWR0aDogMTAwJTsgfQogICAgICAgIC5mb3JtLWFjdGlvbnMtZm9vdGVyIHsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IH0KICAgICAgICAuZm9ybS1hY3Rpb25zLWZvb3RlciBidXR0b24geyB3aWR0aDogMTAwJTsgfQogICAgfQogICAvKiAtLS0gTkVXIFNUWUxFUyBCTE9DSyBUTyBBREQgLS0tICovCgovKiAtLS0gVHV0b3JpYWwgU3R5bGVzIC0tLSAqLwoubW9kYWwtYmFja2Ryb3AgewogICAgcG9zaXRpb246IGZpeGVkOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjcpOwogICAgZGlzcGxheTogbm9uZTsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHotaW5kZXg6IDEwMDAwOwp9Ci5tb2RhbC1iYWNrZHJvcC5zaG93IHsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KLm1vZGFsLWJhY2tkcm9wIC5tb2RhbC1jb250ZW50IHsKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICBwYWRkaW5nOiAycmVtOwogICAgYm9yZGVyLXJhZGl1czogMC43NXJlbTsKICAgIHdpZHRoOiA5MCU7CiAgICBtYXgtd2lkdGg6IDUwMHB4OwogICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpOwogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9CiAubW9kYWwtYmFja2Ryb3AgLm1vZGFsLWNvbnRlbnQgaDMgewogICAgZm9udC1zaXplOiAxLjVyZW07CiAgICBtYXJnaW4tYm90dG9tOiAxcmVtOwogICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKIH0KIC5tb2RhbC1iYWNrZHJvcCAubW9kYWwtY29udGVudCBwIHsKICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgIG1hcmdpbi1ib3R0b206IDJyZW07CiB9CiAubW9kYWwtYnV0dG9ucyB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBnYXA6IDFyZW07CiB9CgoudHV0b3JpYWwtb3ZlcmxheSB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICB6LWluZGV4OiA5OTk4OwogICAgZGlzcGxheTogbm9uZTsKfQoudHV0b3JpYWwtb3ZlcmxheS1wYXJ0IHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44NSk7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC40cyBlYXNlLWluLW91dDsKfQouaGlnaGxpZ2h0LWVsZW1lbnQgewogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgei1pbmRleDogOTk5OTsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIHBhZGRpbmc6IDVweDsgLyogVGhpcyBuZXcgbGluZSBhZGRzIHNwYWNlIGFyb3VuZCB0aGUgaWNvbiAqLwogICAgdHJhbnNpdGlvbjogYm94LXNoYWRvdyAwLjNzIGVhc2UtaW4tb3V0OwogICAgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7CiAgICBhbmltYXRpb246IHB1bHNlLWdsb3cgMnMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7Cn0KLnR1dG9yaWFsLXBvcG92ZXIgewogICAgcG9zaXRpb246IGZpeGVkOyAKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICBjb2xvcjogI0ZGRkZGRjsKICAgIHBhZGRpbmc6IDA7CiAgICBib3JkZXItcmFkaXVzOiAwLjhyZW07CiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgei1pbmRleDogMTAwMDE7CiAgICB3aWR0aDogOTAlOwogICAgbWF4LXdpZHRoOiAzODBweDsKICAgIGJveC1zaGFkb3c6IDAgMTBweCA0MHB4IHJnYmEoMCwwLDAsMC43KSwgMCAwIDMwcHggcmdiYSgwLCAxNjMsIDI1NSwgMC41KTsKICAgIGFuaW1hdGlvbjogZmFkZUluUG9wb3ZlciAwLjRzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgZGlzcGxheTogbm9uZTsKfQoudHV0b3JpYWwtcG9wb3Zlci1oZWFkZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgIHBhZGRpbmc6IDFyZW0gMS41cmVtOwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIGZvbnQtc2l6ZTogMS4xcmVtOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGdhcDogMC43NXJlbTsKICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwp9Ci50dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQgewogICAgcGFkZGluZzogMS41cmVtOwogICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgbGluZS1oZWlnaHQ6IDEuNjsKfQoudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IGIgewogICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICBmb250LXdlaWdodDogNjAwOwp9Ci50dXRvcmlhbC1wb3BvdmVyLW5hdiB7CiAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC4yKTsKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoudHV0b3JpYWwtcG9wb3Zlcjo6YWZ0ZXIgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3JkZXItd2lkdGg6IDEwcHg7CiAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDsKfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy10b3A6OmFmdGVyIHsgYm90dG9tOiAxMDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgYm9yZGVyLWJvdHRvbS1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1ib3R0b206OmFmdGVyIHsgdG9wOiAxMDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgYm9yZGVyLXRvcC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1sZWZ0OjphZnRlciB7IHJpZ2h0OiAxMDAlOyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBib3JkZXItcmlnaHQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctcmlnaHQ6OmFmdGVyIHsgbGVmdDogMTAwJTsgdG9wOiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgYm9yZGVyLWxlZnQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KCkBrZXlmcmFtZXMgZmFkZUluUG9wb3ZlciB7IGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9IHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSB9CkBrZXlmcmFtZXMgcHVsc2UtZ2xvdyB7IDAlLCAxMDAlIHsgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7IH0gNTAlIHsgYm94LXNoYWRvdzogMCAwIDI1cHggMTBweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9IH0KICAKLyogU21hcnQgdG9vbHRpcCBwaW5uZWQvb3BlbiBzdGF0ZXMgKi8KLnRvb2x0aXAuaXMtb3BlbiAudG9vbHRpcHRleHQsCi50b29sdGlwOmZvY3VzLXdpdGhpbiAudG9vbHRpcHRleHQgeyB2aXNpYmlsaXR5OiB2aXNpYmxlOyBvcGFjaXR5OiAxOyB9CgovKiBUb29sdGlwIGJ1YmJsZSBlbmhhbmNlbWVudHMgKi8KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0IHsKICBtYXgtd2lkdGg6IG1pbig0NjBweCwgOTJ2dyk7CiAgbWF4LWhlaWdodDogbWluKDUwdmgsIDQyMHB4KTsKICBvdmVyZmxvdzogYXV0bzsKICBwYWRkaW5nOiAxMnB4IDE0cHg7CiAgbGluZS1oZWlnaHQ6IDEuMzU7CiAgd29yZC13cmFwOiBicmVhay13b3JkOwogIG92ZXJmbG93LXdyYXA6IGFueXdoZXJlOwogIHotaW5kZXg6IDEwMDEwOwp9Ci8qIFBvc2l0aW9uYWwgaGVscGVycyAqLwoudG9vbHRpcCAudG9vbHRpcHRleHQucG9zLXRvcCAgICB7IHRvcDogYXV0bzsgYm90dG9tOiAxMjUlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgcmlnaHQ6IGF1dG87IH0KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0LnBvcy1ib3R0b20geyBib3R0b206IGF1dG87IHRvcDogMTI1JTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7IHJpZ2h0OiBhdXRvOyB9Ci50b29sdGlwIC50b29sdGlwdGV4dC5wb3MtbGVmdCAgIHsgdG9wOiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgbGVmdDogYXV0bzsgcmlnaHQ6IGNhbGMoMTAwJSArIDEycHgpOyBib3R0b206IGF1dG87IH0KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0LnBvcy1yaWdodCAgeyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBsZWZ0OiBjYWxjKDEwMCUgKyAxMnB4KTsgcmlnaHQ6IGF1dG87IGJvdHRvbTogYXV0bzsgfQoKCi8qIFByb2R1Y3QgVHlwZTogdG9vbHRpcCBvbmx5IG9uIGxhYmVsIGhvdmVyOyBub3Qgb24gc2VsZWN0IGZvY3VzICovCmxhYmVsW2Zvcj0icHJvZHVjdFR5cGUiXS50b29sdGlwOjphZnRlciB7IC8qIHVzZXMgZGF0YS10b29sdGlwICovIH0KI3Byb2R1Y3RUeXBlW3RpdGxlXSwgI3Byb2R1Y3RUeXBlOmZvY3VzICsgLnRvb2x0aXB0ZXh0LCAjcHJvZHVjdFR5cGU6Zm9jdXM6OmFmdGVyIHsgdmlzaWJpbGl0eTogaGlkZGVuICFpbXBvcnRhbnQ7IG9wYWNpdHk6IDAgIWltcG9ydGFudDsgfQo8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgoKPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KICAgIDxoZWFkZXI+CiAgICAgICAgPGRpdiBjbGFzcz0idGl0bGUtY29udGFpbmVyIj4KICAgICAgICAgICAgPGEgaWQ9Imhvd1RvR3VpZGVMaW5rIiBocmVmPSIjIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9Imhvdy10by1ndWlkZSI+CiAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTE0IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY4eiI+PC9wYXRoPjxwb2x5bGluZSBwb2ludHM9IjE0IDIgMTQgOCAyMCA4Ij48L3BvbHlsaW5lPjxsaW5lIHgxPSIxNiIgeTE9IjEzIiB4Mj0iOCIgeTI9IjEzIj48L2xpbmU+PGxpbmUgeDE9IjE2IiB5MT0iMTciIHgyPSI4IiB5Mj0iMTciPjwvbGluZT48cG9seWxpbmUgcG9pbnRzPSIxMCA5IDkgOSA4IDkiPjwvcG9seWxpbmU+PC9zdmc+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkhvdy10byBHdWlkZTwvc3Bhbj4KICAgICAgICAgICAgPC9hPgogICAgICAgICAgICA8aDI+PHNwYW4gaWQ9InNlY3JldFRyaWdnZXIiIHRpdGxlPSJVbmxvY2sgYWR2YW5jZWQgZmVhdHVyZXMiPlQ8L3NwYW4+YWJsZSBCeSBZb2NvIFByb2R1Y3QgTG9hZGVyPC9oMj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8c3BhbiBpZD0ic2F2ZVN0YXR1cyI+U2F2ZWQhPC9zcGFuPgogICAgICAgIDxkaXYgY2xhc3M9ImJ1dHRvbi1jb250YWluZXIiPgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImVkaXRTZXNzaW9uQnRuIiBjbGFzcz0iYnRuLWltcG9ydCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij5FZGl0IFNlc3Npb248L2J1dHRvbj4KICAgICAgICAgICAgPGRpdiBpZD0ic2VjcmV0QWN0aW9uc0NvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IGdhcDogMTVweDsgZmxleC13cmFwOiB3cmFwOyI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgb25jbGljaz0iZXhwb3J0VG9FeGNlbCgpIiBjbGFzcz0iYnRuLWV4cG9ydCI+RXhwb3J0IHRvIEV4Y2VsPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJjb25maXJtQ2xlYXJBbGwoKSIgY2xhc3M9ImJ0bi1jbGVhciIgdGl0bGU9IkNsZWFyIEFsbCBEYXRhIj4KICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTMgNnYxOGgxOHYtMThoLTE4em01IDE0YzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNC0xOGgtMjB2LTJoNnYtMS41YzAtLjgyNy42NzMtMS41IDEuNS0xLjVoNWMuODI1IDAgMS41LjY3MSAxLjUgMS41djEuNWg2djJ6Ii8+PC9zdmc+CiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgPC9oZWFkZXI+CgogICAgPGRpdiBjbGFzcz0icHJvZHVjdC1kZWZhdWx0cyI+CiAgICAgICAgPGgzPlByb2R1Y3QgRGVmYXVsdHM8L2gzPgogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJ0YXhBcHBsaWNhYmxlIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlRheCBBcHBsaWNhYmxlPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+U2VsZWN0IFRSVUUgaWYgdGF4IHNob3VsZCBiZSBhZGRlZCB0byB0aGUgcHJpY2UsIG90aGVyd2lzZSBzZWxlY3QgRkFMU0UuPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9InRheEFwcGxpY2FibGUiIHJlcXVpcmVkPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIiBkaXNhYmxlZCBzZWxlY3RlZD4tLSBDaG9vc2UgLS08L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InRydWUiPlRSVUU8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImZhbHNlIj5GQUxTRTwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGZvcj0icHJvZHVjdFR5cGUiIGNsYXNzPSJ0b29sdGlwIiBkYXRhLXRvb2x0aXA9IlByb2R1Y3QgVHlwZSpXaGF0IGtpbmQgb2YgaXRlbSBpcyB0aGlzPyBZb3VyIGNob2ljZSBjaGFuZ2VzIHRoZSBmb3JtISDwn5OmZmluaXNoZWRHb29kOiBTb21ldGhpbmcgeW91IHNlbGwgZGlyZWN0bHkgKGUuZy4sIGEgYnVyZ2VyKS5yYXdNYXRlcmlhbDogQW4gaW5ncmVkaWVudCB5b3UgdXNlIGJ1dCBkb24ndCBzZWxsIChlLmcuLCBhIGJhZyBvZiBmbG91cikuZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWw6IEFuIGl0ZW0geW91IEJPVEggc2VsbCBhbmQgdXNlIGFzIGFuIGluZ3JlZGllbnQgKGUuZy4sIGEgYm90dGxlIG9mIHNhdWNlKS5NYW51ZmFjdHVyZWQ6IEFuIGl0ZW0geW91IGNyZWF0ZSBmcm9tIHJhdyBtYXRlcmlhbHMgKGUuZy4sIGEgYnVyZ2VyIHBhdHR5IHlvdSBtYWtlIHlvdXJzZWxmKS4iPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5Qcm9kdWN0IFR5cGU8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5XaGF0IGtpbmQgb2YgaXRlbSBpcyB0aGlzPyBZb3VyIGNob2ljZSBjaGFuZ2VzIHRoZSBmb3JtISDwn5OmPGJyPjxiPmZpbmlzaGVkR29vZDo8L2I+IFNvbWV0aGluZyB5b3Ugc2VsbCBkaXJlY3RseSAoZS5nLiwgYSBidXJnZXIpLjxicj48Yj5yYXdNYXRlcmlhbDo8L2I+IEFuIGluZ3JlZGllbnQgeW91IHVzZSBidXQgZG9uJ3Qgc2VsbCAoZS5nLiwgYSBiYWcgb2YgZmxvdXIpLjxicj48Yj5maW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbDo8L2I+IEFuIGl0ZW0geW91IEJPVEggc2VsbCBhbmQgdXNlIGFzIGFuIGluZ3JlZGllbnQgKGUuZy4sIGEgYm90dGxlIG9mIHNhdWNlKS48YnI+PGI+TWFudWZhY3R1cmVkOjwvYj4gQW4gaXRlbSB5b3UgY3JlYXRlIGZyb20gcmF3IG1hdGVyaWFscyAoZS5nLiwgYSBidXJnZXIgcGF0dHkgeW91IG1ha2UgeW91cnNlbGYpLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJwcm9kdWN0VHlwZSIgcmVxdWlyZWQ+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiIGRpc2FibGVkIHNlbGVjdGVkPi0tIFNlbGVjdCAtLTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZmluaXNoZWRHb29kIj5maW5pc2hlZEdvb2Q8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InJhd01hdGVyaWFsIj5yYXdNYXRlcmlhbDwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwiPmZpbmlzaGVkR29vZCAmIHJhd01hdGVyaWFsPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJNYW51ZmFjdHVyZWQiPk1hbnVmYWN0dXJlZDwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0icHVyY2hhc2VkRm9yUmVzYWxlR3JvdXAiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9InRvb2x0aXAiPkl0ZW0gVHlwZQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5JcyB0aGlzIGEgImJ1eS1hbmQtc2VsbCIgaXRlbT8g8J+lqzxicj5UaGluayBvZiBhIGNhbiBvZiBDb2tlLiBZb3UgYnV5IGl0IGFuZCBzZWxsIGl0IGluIHRoZSBleGFjdCBzYW1lIGZvcm0uIFRpY2tpbmcgdGhpcyB1c2VzIG9uZSBpdGVtIHJlY29yZCBmb3IgYm90aCB5b3VyIHN0b2NrIGFuZCB5b3VyIHNhbGVzIHNjcmVlbi4gU3VwZXIgc2ltcGxlITwvc3Bhbj4KICAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZW1lbWJlci1tZS1jb250YWluZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxMHB4OyBwYWRkaW5nOiAxNHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBib3JkZXItcmFkaXVzOiA4cHg7Ij4KICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJpc1B1cmNoYXNlZEZvclJlc2FsZSIgc3R5bGU9IndpZHRoOiAxOHB4OyBoZWlnaHQ6IDE4cHg7Ij4KICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJpc1B1cmNoYXNlZEZvclJlc2FsZSI+UHVyY2hhc2VkIGZvciBSZXNhbGU8L2xhYmVsPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgogICAgCiAgICA8ZGl2IGNsYXNzPSJsaWJyYXJ5LW1hbmFnZW1lbnQiPgogICAgICAgIDxkaXYgY2xhc3M9ImxpYnJhcnktbWFuYWdlbWVudC1oZWFkZXIiPgogICAgICAgICAgICA8aDM+TGlicmFyaWVzICYgUHJlc2V0czwvaDM+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxpYnJhcnktY29udHJvbHMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJvcGVuTGlicmFyeU1vZGFsQnRuIiBjbGFzcz0iYnRuLWFkZCBidG4tbWFuYWdlbWVudCI+TWFuYWdlIExpYnJhcmllcyAmIFByZXNldHM8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8Zm9ybSBpZD0icHJvZHVjdEZvcm0iIG5vdmFsaWRhdGU+CiAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgaWQ9ImVkaXRpbmdJbmRleCIgdmFsdWU9Ii0xIj4KICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGZvcj0icHJvZHVjdE5hbWUiIGNsYXNzPSJ0b29sdGlwIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+UHJvZHVjdCBOYW1lPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+V2hhdCdzIHRoZSBtYWluIG5hbWUgb2YgeW91ciBwcm9kdWN0PyDwn42UPGJyPktlZXAgaXQgc2ltcGxlLCBsaWtlICJDbGFzc2ljIEJlZWYgQnVyZ2VyIiBvciAiQ2hpY2tlbiBQaXp6YSIuIFlvdSdsbCBhZGQgdmFyaWF0aW9ucyBsaWtlIHNpemUgb3IgZmxhdm9yIGluIHRoZSBWYXJpYW50cyBzZWN0aW9uIGJlbG93ITwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InByb2R1Y3ROYW1lIiByZXF1aXJlZCBwbGFjZWhvbGRlcj0iZS5nLiwgQ2hpY2tlbiBQaXp6YSI+CiAgICAgICAgICAgIDxkaXYgaWQ9InNpbmdsZS1wcm9kdWN0LW1vZGlmaWVyLWNvbnRyb2xzIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMTBweDsiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJsaW5rU2luZ2xlTW9kaWZpZXJCdG4iIGNsYXNzPSJidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyI+TGluayBNb2RpZmllcjwvYnV0dG9uPgogICAgICAgICAgICAgICAgPHNwYW4gaWQ9InNpbmdsZU1vZGlmaWVySW5kaWNhdG9yIj48L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIAogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJzZWxsaW5nUHJpY2VHcm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBmb3I9InNlbGxpbmdQcmljZSIgaWQ9InNlbGxpbmdQcmljZUxhYmVsIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkRlZmF1bHQgU2VsbGluZyBQcmljZSAoaWYgbm8gdmFyaWFudCk8L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5XaGF0J3MgdGhlIHByaWNlIGlmIGl0J3MganVzdCBhIHNpbmdsZSwgc2ltcGxlIGl0ZW0/IPCfkrA8YnI+VGhpcyBwcmljZSBpcyB1c2VkIE9OTFkgd2hlbiB5b3UgZG9uJ3QgYWRkIGFueSB2YXJpYW50cyAobGlrZSBzaXplIG9yIGNvbG9yKS4gT25jZSB5b3UgYWRkIHZhcmlhbnRzLCB5b3UnbGwgc2V0IHRoZSBwcmljZSBmb3IgZWFjaCBjb21iaW5hdGlvbiBpbnN0ZWFkLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBzdGVwPSIwLjAxIiBpZD0ic2VsbGluZ1ByaWNlIiBwbGFjZWhvbGRlcj0iZS5nLiwgMzUuMDAiPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0icGx1RW50cnlHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICAgICAgPGxhYmVsIGZvcj0iY3VzdG9tUGx1IiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkN1c3RvbSBCYXNlIFBMVS9TS1U8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5Hb3QgeW91ciBvd24gcHJvZHVjdCBjb2Rlcz8g8J+Pt++4jzxicj5BIFBMVS9TS1UgaXMganVzdCBhIHVuaXF1ZSBJRCBmb3IgYSBwcm9kdWN0LiBJZiB5b3UgaGF2ZSB5b3VyIG93biBzeXN0ZW0sIGVudGVyIHRoZSBtYWluIGNvZGUgaGVyZS4gT3RoZXJ3aXNlLCB0aGUgdG9vbCBjYW4gZ2VuZXJhdGUgb25lIGZvciB5b3UgYXV0b21hZ2ljYWxseSEg4pyoPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iY3VzdG9tUGx1IiBwbGFjZWhvbGRlcj0iZS5nLiwgUElaWkEtQ0hFIj4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJ2YXJpYW50cy1hbmQtcHJpY2luZy13cmFwcGVyIj4KICAgICAgICAgICAgPGRpdiBpZD0idmFyaWFudHMtY29sdW1uIj4KICAgICAgICAgICAgICAgIDxkaXY+IAogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0idG9vbHRpcCI+VmFyaWFudCBHcm91cHMKICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5UaW1lIHRvIGFkZCBzb21lIHZhcmlldHkhIPCfjqg8YnI+VmFyaWFudHMgYXJlIGRpZmZlcmVudCBvcHRpb25zIGZvciBhIHByb2R1Y3QsIGxpa2UgPGI+U2l6ZTwvYj4gKFNtYWxsLCBNZWRpdW0sIExhcmdlKSBvciA8Yj5GbGF2b3I8L2I+IChWYW5pbGxhLCBDaG9jb2xhdGUpLiBZb3UgY2FuIGV2ZW4gY29tYmluZSB0aGVtISBFYWNoIHVuaXF1ZSBjb21ibyBjYW4gaGF2ZSBpdHMgb3duIHNwZWNpYWwgcHJpY2UuPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0idmFyaWFudEdyb3Vwc0NvbnRhaW5lciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZHluYW1pYy1jb250cm9scy13cmFwcGVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0iYWRkVmFyaWFudEdyb3VwQnRuIiBvbmNsaWNrPSJhZGRWYXJpYW50R3JvdXAoKSIgY2xhc3M9ImJ0bi1hZGQgYnRuLWFkZC1keW5hbWljIj5BZGQgTWFudWFsbHk8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0iYXBwbHlQcmVzZXRCdG4iIGNsYXNzPSJidG4taW1wb3J0IGJ0bi1hZGQtZHluYW1pYyI+QXBwbHkgUHJlc2V0PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9InNhdmVBc1ByZXNldEJ0biIgY2xhc3M9ImJ0bi1leHBvcnQgYnRuLWFkZC1keW5hbWljIj5TYXZlIGFzIFByZXNldDwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJwcmljaW5nLWNvbHVtbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9InZhcmlhbnRQcmljaW5nQ29udGFpbmVyIj48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJ1b20iIGNsYXNzPSJ0b29sdGlwIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+VU9NPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+VW5pdCBvZiBNZWFzdXJlLiBIb3cgdGhlIHByb2R1Y3QgaXMgc29sZCAoZS5nLiwgRWFjaCwgS2lsb2dyYW1zLCBMaXRyZXMpLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJ1b20iIHJlcXVpcmVkPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiIGRpc2FibGVkIHNlbGVjdGVkPi0tIFNlbGVjdCBVT00gLS08L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZWEiPkVhY2g8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ia2ciPktpbG9ncmFtczwvb3B0aW9uPjxvcHRpb24gdmFsdWU9ImciPkdyYW1zPC9vcHRpb24+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImwiPkxpdHJlczwvb3B0aW9uPjxvcHRpb24gdmFsdWU9Im1sIj5NaWxsaWxpdHJlczwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtIj5NZXRlcnM8L29wdGlvbj48b3B0aW9uIHZhbHVlPSJtbSI+TWlsbGltZXRlcnM8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY20iPkNlbnRpbWV0ZXJzPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0icHJlcExvY2F0aW9uR3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJwcmVwTG9jYXRpb24iIGNsYXNzPSJ0b29sdGlwIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+UHJlcCBMb2NhdGlvbjxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlRoZSBhcmVhIHdoZXJlIHRoZSBpdGVtIGlzIHByZXBhcmVkIChlLmcuLCAiS2l0Y2hlbiIsICJCYXIiKS48L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IGxpc3Q9InByZXBMaXN0IiBpZD0icHJlcExvY2F0aW9uIiByZXF1aXJlZCBwbGFjZWhvbGRlcj0iZS5nLiwgS2l0Y2hlbiI+CiAgICAgICAgICAgIDxkYXRhbGlzdCBpZD0icHJlcExpc3QiPjwvZGF0YWxpc3Q+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJtZW51Q2F0ZWdvcnlHcm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1lbnVDYXRlZ29yeSIgY2xhc3M9InRvb2x0aXAiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5NZW51IENhdGVnb3J5PHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+VGhlIGNhdGVnb3J5IHRoZSBwcm9kdWN0IHdpbGwgYXBwZWFyIHVuZGVyIG9uIHlvdXIgcG9pbnQgb2Ygc2FsZSAoZS5nLiwgIkJ1cmdlcnMiLCAiSG90IERyaW5rcyIpLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9Im1lbnVDYXRlZ29yeSIgbGlzdD0ibWVudUxpc3QiIHJlcXVpcmVkIHBsYWNlaG9sZGVyPSJlLmcuLCBCdXJnZXJzIj4KICAgICAgICAgICAgPGRhdGFsaXN0IGlkPSJtZW51TGlzdCI+PC9kYXRhbGlzdD4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGZvcj0iaW52ZW50b3J5Q2F0ZWdvcnkiIGlkPSJpbnZlbnRvcnlDYXRlZ29yeUxhYmVsIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkludmVudG9yeSBDYXRlZ29yeTwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkEgYnJvYWQgY2F0ZWdvcnkgZm9yIHN0b2NrIG1hbmFnZW1lbnQgKGUuZy4sICJGb29kIiwgIkJldmVyYWdlcyIpLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImludmVudG9yeUNhdGVnb3J5IiBsaXN0PSJpbnZlbnRvcnlDYXRlZ29yeUxpc3QiIHBsYWNlaG9sZGVyPSJlLmcuLCBGb29kIj4KICAgICAgICAgICAgPGRhdGFsaXN0IGlkPSJpbnZlbnRvcnlDYXRlZ29yeUxpc3QiPjwvZGF0YWxpc3Q+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJpbnZlbnRvcnlTdWJDYXRlZ29yeSIgaWQ9ImludmVudG9yeVN1YkNhdGVnb3J5TGFiZWwiIGNsYXNzPSJ0b29sdGlwIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+SW52ZW50b3J5IFN1Yi1DYXRlZ29yeTwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkEgbW9yZSBzcGVjaWZpYyBzdG9jayBjYXRlZ29yeSAoZS5nLiwgIk1lYXQiLCAiQ29mZmVlICYgVGVhIikuPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iaW52ZW50b3J5U3ViQ2F0ZWdvcnkiIGxpc3Q9ImludmVudG9yeVN1YkNhdGVnb3J5TGlzdCIgcGxhY2Vob2xkZXI9ImUuZy4sIE1lYXQiPgogICAgICAgICAgICA8ZGF0YWxpc3QgaWQ9ImludmVudG9yeVN1YkNhdGVnb3J5TGlzdCI+PC9kYXRhbGlzdD4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0ic3VwcGxpZWRRdWFudGl0eUdyb3VwIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJzdXBwbGllZFF1YW50aXR5IiBpZD0ic3VwcGxpZWRRdWFudGl0eUxhYmVsIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlN1cHBsaWVkIFF1YW50aXR5PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+Rm9yIHJhdyBtYXRlcmlhbCBwcm9kdWN0IHR5cGVzLCB0aGlzIGlzIHRoZSBxdWFudGl0eSB5b3UgcmVjZWl2ZSBmcm9tIHlvdXIgc3VwcGxpZXIgKGUuZy4sIDUgZm9yIGEgNWtnIGJhZykuPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImlucHV0LXdyYXBwZXIiPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9InN1cHBsaWVkUXVhbnRpdHkiIHBsYWNlaG9sZGVyPSJlLmcuLCAxMDAiPgogICAgICAgICAgICAgICAgPHNwYW4gaWQ9InF1YW50aXR5R2hvc3RUZXh0IiBjbGFzcz0iZ2hvc3QtdGV4dCI+PC9zcGFuPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0iY29zdFByaWNlR3JvdXAiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgIDxsYWJlbCBmb3I9ImNvc3RQcmljZSIgaWQ9ImNvc3RQcmljZUxhYmVsIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlRvdGFsIENvc3QgUHJpY2UgKGV4LiBWYXQpPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+VGhlIGNvc3Qgb2YgdGhlIHByb2R1Y3QuIEZvciByYXcgbWF0ZXJpYWxzLCB0aGlzIGlzIHRoZSBjb3N0IGZvciB0aGUgZW50aXJlIHN1cHBsaWVkIHF1YW50aXR5Ljwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBzdGVwPSIwLjAxIiBpZD0iY29zdFByaWNlIiBwbGFjZWhvbGRlcj0iZS5nLiwgMTUuNTAiPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0ieWllbGRRdWFudGl0eUdyb3VwIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJ5aWVsZFF1YW50aXR5IiBpZD0ieWllbGRRdWFudGl0eUxhYmVsIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPllpZWxkIFF1YW50aXR5PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+Rm9yIG1hbnVmYWN0dXJlZCBwcm9kdWN0IHR5cGVzLCB0aGlzIGlzIHRoZSBxdWFudGl0eSBwcm9kdWNlZCBmcm9tIHRoZSByYXcgbWF0ZXJpYWxzLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtd3JhcHBlciI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0ieWllbGRRdWFudGl0eSIgcGxhY2Vob2xkZXI9ImUuZy4sIDUwIj4KICAgICAgICAgICAgICAgIDxzcGFuIGlkPSJ5aWVsZEdob3N0VGV4dCIgY2xhc3M9Imdob3N0LXRleHQiPjwvc3Bhbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJoYXNCYXJjb2RlIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkhhcyBCYXJjb2RlPzwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlNlbGVjdCAiWWVzIiBpZiB5b3VyIHByb2R1Y3QgaGFzIGEgc2Nhbm5hYmxlIGJhcmNvZGUgdG8gcmV2ZWFsIHRoZSBlbnRyeSBmaWVsZC48L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgPHNlbGVjdCBpZD0iaGFzQmFyY29kZSI+IDxvcHRpb24gdmFsdWU9Im5vIj5Obzwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSJ5ZXMiPlllczwvb3B0aW9uPiA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCIgaWQ9ImJhcmNvZGVFbnRyeUdyb3VwIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJiYXJjb2RlIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkJhcmNvZGU8L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5FbnRlciB0aGUgbnVtZXJpY2FsIGJhcmNvZGUgZm9yIHRoaXMgcHJvZHVjdC48L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJiYXJjb2RlIiBwbGFjZWhvbGRlcj0iRW50ZXIgcHJvZHVjdCBiYXJjb2RlIj4KICAgICAgICA8L2Rpdj4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWFjdGlvbnMtZm9vdGVyIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icmVtZW1iZXItbWUtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9InJlbWVtYmVyQ2F0ZWdvcmllcyIgY2hlY2tlZD4KICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InJlbWVtYmVyQ2F0ZWdvcmllcyI+UmVtZW1iZXIgY2F0ZWdvcmllcyBmb3IgbmV4dCBwcm9kdWN0PC9sYWJlbD4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0ibWFpbkFjdGlvbkJ1dHRvbiIgY2xhc3M9ImJ0bi1hZGQiPkFkZCBQcm9kdWN0PC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICA8L2Zvcm0+CgogICAgPGRpdiBjbGFzcz0ibGlzdC1jb250YWluZXIiPgogICAgICAgIDxkaXYgY2xhc3M9InRhYnMiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ0YWItbGluayBhY3RpdmUiIGRhdGEtdGFiPSJwcm9kdWN0cyI+UHJvZHVjdHM8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idGFiLWxpbmsiIGRhdGEtdGFiPSJzdG9jayI+U3RvY2sgSXRlbXM8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0icHJvZHVjdHMiIGNsYXNzPSJ0YWItY29udGVudCBhY3RpdmUiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTogZmxleDsgZ2FwOiAxNXB4OyBmbGV4LXdyYXA6IHdyYXA7Ij4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJzZWFyY2giIGlkPSJwcm9kdWN0U2VhcmNoIiBwbGFjZWhvbGRlcj0iU2VhcmNoIGJ5IG5hbWUsIFBMVS4uLiIgc3R5bGU9ImZsZXgtZ3JvdzogMTsiPgogICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0icHJvZHVjdENhdGVnb3J5RmlsdGVyIiBzdHlsZT0ibWF4LXdpZHRoOiAyNTBweDsiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+RmlsdGVyIGJ5IE1lbnUgQ2F0ZWdvcnkuLi48L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0icHJvZHVjdFRhYmxlIj4KICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5QTFU8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlByb2R1Y3QgTmFtZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+VmFyaWFudDwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+TWVudSBDYXRlZ29yeTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+U2VsbGluZyBQcmljZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+TW9kaWZpZXJzPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5BY3Rpb25zPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPgogICAgICAgICAgICAgICAgICAgIDx0Ym9keT48L3Rib2R5PgogICAgICAgICAgICAgICAgPC90YWJsZT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgaWQ9InN0b2NrIiBjbGFzcz0idGFiLWNvbnRlbnQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJzZWFyY2giIGlkPSJzdG9ja1NlYXJjaCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBzdG9jayBieSBuYW1lLCBjYXRlZ29yeS4uLiI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPHRhYmxlIGlkPSJzdG9ja1RhYmxlIj4KICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5QTFU8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlByb2R1Y3QgTmFtZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+SW52LiBDYXRlZ29yeTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+VU9NPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5Db3N0IFByaWNlIChleC4gVmF0KTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+QWN0aW9uczwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgICAgICAgICAgPC90aGVhZD4KICAgICAgICAgICAgICAgICAgICA8dGJvZHk+PC90Ym9keT4KICAgICAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0ic3RvY2siIGNsYXNzPSJ0YWItY29udGVudCI+CiAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJzZWFyY2giIGlkPSJzdG9ja1NlYXJjaCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBzdG9jayBieSBuYW1lLCBjYXRlZ29yeS4uLiI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0ic3RvY2tUYWJsZSI+CiAgICAgICAgICAgICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICAgICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+UExVPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5Qcm9kdWN0IE5hbWU8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPkludi4gQ2F0ZWdvcnk8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlVPTTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+Q29zdCBQcmljZSAoZXguIFZhdCk8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPkFjdGlvbnM8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICA8L3RyPgogICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgPHRib2R5PjwvdGJvZHk+CiAgICAgICAgICAgICAgICA8L3RhYmxlPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtZm9vdGVyIj4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIG9uY2xpY2s9InVwZGF0ZVRhYmxlKCkiIGNsYXNzPSJidG4taW1wb3J0Ij5SZWZyZXNoIExpc3RzPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJleHBvcnRUb0V4Y2VsKCkiIGNsYXNzPSJidG4tZXhwb3J0Ij5FeHBvcnQgdG8gRXhjZWw8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCgo8ZGl2IGlkPSJzZXNzaW9uRGVmYXVsdHNNb2RhbCIgY2xhc3M9Im1vZGFsLW92ZXJsYXkiPgogICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCIgc3R5bGU9InRleHQtYWxpZ246IGxlZnQ7Ij4KICAgICAgICA8aDMgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBtYXJnaW4tdG9wOiAwOyI+U2Vzc2lvbiBTZXR1cDwvaDM+CiAgICAgICAgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgbWFyZ2luLWJvdHRvbTogMjVweDsiPkZpcnN0LCBsZXQncyBzZXQgdXAgc29tZSBkZWZhdWx0cyBmb3IgdGhpcyBzZXNzaW9uLiBZb3UgY2FuIGNoYW5nZSB0aGVzZSBsYXRlci48L3A+CiAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBmb3I9InNlc3Npb25TaXRlIiBjbGFzcz0idG9vbHRpcCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlNpdGU8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5FbnRlciB0aGUgbmFtZSBvZiB5b3VyIHN0b3JlIG9yIGJ1c2luZXNzIGxvY2F0aW9uIChlLmcuLCAiTWFpbiBTdHJlZXQgQ2FmZSIpLiBUaGlzIGlzIGEgcmVxdWlyZWQgZmllbGQuPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCBsaXN0PSJzaXRlTGlzdCIgaWQ9InNlc3Npb25TaXRlIiByZXF1aXJlZCBwbGFjZWhvbGRlcj0iZS5nLiwgTWFpbiBTdHJlZXQgQ2FmZSI+CiAgICAgICAgICAgIDxkYXRhbGlzdCBpZD0ic2l0ZUxpc3QiPjwvZGF0YWxpc3Q+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KICAgICAgICAgICAgPGxhYmVsIGZvcj0ic2Vzc2lvbkRlZmluZVBsdSIgY2xhc3M9InRvb2x0aXAiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5EZWZpbmUgUExVL1NLVT88c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5DaG9vc2UgJ1llcycgZm9yIG1hbnVhbCBlbnRyeSBpZiB5b3UgaGF2ZSBhIHByZS1leGlzdGluZyBTS1Ugc3lzdGVtLCBvciAnTm8nIHRvIGhhdmUgb25lIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkLjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJzZXNzaW9uRGVmaW5lUGx1Ij4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im5vIj5ObyAoQXV0by1nZW5lcmF0ZSk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InllcyI+WWVzIChNYW51YWwgRW50cnkpPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIHN0eWxlPSJtYXJnaW4tdG9wOiAzMHB4OyI+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0ic2V0RGVmYXVsdHNCdG4iIGNsYXNzPSJidG4tYWRkIiBzdHlsZT0id2lkdGg6IDEwMCU7Ij5TZXQgRGVmYXVsdHM8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCgo8ZGl2IGlkPSJsaWJyYXJ5TWFuYWdlbWVudE1vZGFsIiBjbGFzcz0ibW9kYWwtb3ZlcmxheSI+CiAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CiAgICA8aDMgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBtYXJnaW4tdG9wOiAwOyBtYXJnaW4tYm90dG9tOiAyNXB4OyI+TGlicmFyeSBNYW5hZ2VtZW50PC9oMz4KICAgIDxkaXYgY2xhc3M9ImxpYnJhcnktbW9kYWwtbWVudSI+CiAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJvcGVuTW9kaWZpZXJNb2RhbEJ0biI+RWRpdCBNb2RpZmllciBMaWJyYXJ5PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJtYW5hZ2VWYXJpYW50UHJlc2V0c0J0biI+TWFuYWdlIFZhcmlhbnQgUHJlc2V0czwvYnV0dG9uPgogICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0ibWFuYWdlTW9kaWZpZXJQcmVzZXRzQnRuIj5NYW5hZ2UgTW9kaWZpZXIgUHJlc2V0czwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJtb2RhbC1hY3Rpb25zIiBzdHlsZT0ibWFyZ2luLXRvcDogMzBweDsiPgogICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1leHBvcnQiIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWJyYXJ5TWFuYWdlbWVudE1vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIj5DbG9zZTwvYnV0dG9uPgogICAgPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPGRpdiBpZD0iY3VzdG9tTW9kYWwiIGNsYXNzPSJtb2RhbC1vdmVybGF5Ij4KICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgIDxwIGlkPSJtb2RhbE1lc3NhZ2UiPjwvcD4KICAgIDxkaXYgaWQ9Im1vZGFsQWN0aW9ucyIgY2xhc3M9Im1vZGFsLWFjdGlvbnMiPjwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9Im1vZGlmaWVyTW9kYWwiIGNsYXNzPSJtb2RhbC1vdmVybGF5Ij4KICAgIDxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgogICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDIwcHg7IGZsZXgtd3JhcDogd3JhcDsgZ2FwOiAxNXB4OyI+CiAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgbWFyZ2luOiAwOyI+TW9kaWZpZXIgTGlicmFyeTwvaDM+CiAgICAgICAgPGRpdiBjbGFzcz0iZHluYW1pYy1jb250cm9scy13cmFwcGVyIj4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJhcHBseU1vZGlmaWVyUHJlc2V0QnRuIiBjbGFzcz0iYnRuLWltcG9ydCBidG4tYWRkLWR5bmFtaWMiPkFwcGx5IFByZXNldDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9InNhdmVNb2RpZmllcnNBc1ByZXNldEJ0biIgY2xhc3M9ImJ0bi1leHBvcnQgYnRuLWFkZC1keW5hbWljIj5TYXZlIExpYnJhcnkgYXMgUHJlc2V0PC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgICAKICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtc2VjdGlvbi1kaXZpZGVyIj4KICAgICAgICA8aDQ+QWRkIE5ldyBNb2RpZmllciBHcm91cDwvaDQ+CiAgICAgICAgPGRpdiBpZD0ibmV3TW9kaWZpZXJHcm91cEZvcm0iIGNsYXNzPSJtb2RpZmllci1ncm91cC1yb3ciPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8aDQ+RWRpdCBFeGlzdGluZyBHcm91cHM8L2g0PgogICAgICA8ZGl2IGlkPSJlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIiPgogICAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0ic2F2ZU1vZGlmaWVyc0J0biIgY2xhc3M9ImJ0bi1hZGQiPlNhdmUgYW5kIENsb3NlPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNsb3NlTW9kaWZpZXJNb2RhbEJ0biIgY2xhc3M9ImJ0bi1leHBvcnQiPkNhbmNlbDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9ImxpbmtNb2RpZmllck1vZGFsIiBjbGFzcz0ibW9kYWwtb3ZlcmxheSI+CiAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CiAgICA8aDQgaWQ9ImxpbmtNb2RpZmllck1vZGFsVGl0bGUiIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgbWFyZ2luLXRvcDogMDsgbWFyZ2luLWJvdHRvbTogMjBweDsiPkxpbmsgTW9kaWZpZXJzPC9oND4KICAgIAogICAgPGRpdiBpZD0ibGlua01vZGlmaWVyTGlzdENvbnRhaW5lciI+CiAgICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KICAgICAgICA8ZGl2IGlkPSJkeW5hbWljTW9kYWxBY3Rpb25zIj48L2Rpdj4KICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNsb3NlTGlua01vZGlmaWVyTW9kYWxCdG4iIGNsYXNzPSJidG4tYWRkIj5Eb25lPC9idXR0b24+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+Cgo8ZGl2IGlkPSJhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCIgY2xhc3M9Im1vZGFsLW92ZXJsYXkgcHJlc2V0LW1vZGFsIj4KICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgIDxoNCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7Ij5BcHBseSBhIFZhcmlhbnQgUHJlc2V0PC9oND4KICAgIDxwIGlkPSJhcHBseVZhcmlhbnRQcmVzZXRXYXJuaW5nIiBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyBtYXJnaW4tYm90dG9tOiAyMHB4OyI+PC9wPgogICAgPGRpdiBpZD0iYXBwbHlWYXJpYW50UHJlc2V0TGlzdENvbnRhaW5lciIgY2xhc3M9InByZXNldC1saXN0LWNvbnRhaW5lciIgc3R5bGU9InRleHQtYWxpZ246IGxlZnQ7Ij48L2Rpdj4KICAgIDxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyI+CiAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuLWV4cG9ydCIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5VmFyaWFudFByZXNldE1vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIj5DYW5jZWw8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9Im1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwiIGNsYXNzPSJtb2RhbC1vdmVybGF5IHByZXNldC1tb2RhbCI+CiAgICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgICAgPGgzIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgbWFyZ2luLXRvcDogMDsiPk1hbmFnZSBWYXJpYW50IFByZXNldHM8L2gzPgogICAgICA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyBtYXJnaW4tYm90dG9tOiAyMHB4OyI+SGVyZSB5b3UgY2FuIHJlbmFtZSBvciBkZWxldGUgc2F2ZWQgdmFyaWFudCBwcmVzZXRzLjwvcD4KICAgICAgPGRpdiBpZD0iZWRpdFZhcmlhbnRQcmVzZXRzQ29udGFpbmVyIiBjbGFzcz0icHJlc2V0LWVkaXQtY29udGFpbmVyIj48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0ic2F2ZVZhcmlhbnRQcmVzZXRzQnRuIiBjbGFzcz0iYnRuLWFkZCI+U2F2ZSBhbmQgQ2xvc2U8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuLWV4cG9ydCIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JykiPkNhbmNlbDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9ImFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCIgY2xhc3M9Im1vZGFsLW92ZXJsYXkgcHJlc2V0LW1vZGFsIj4KICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgIDxoNCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7Ij5BcHBseSBhIE1vZGlmaWVyIFByZXNldCBMaWJyYXJ5PC9oND4KICAgIDxwIGlkPSJhcHBseU1vZGlmaWVyUHJlc2V0V2FybmluZyIgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPjwvcD4KICAgIDxkaXYgaWQ9ImFwcGx5TW9kaWZpZXJQcmVzZXRMaXN0Q29udGFpbmVyIiBjbGFzcz0icHJlc2V0LWxpc3QtY29udGFpbmVyIiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdDsiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tZXhwb3J0IiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlNb2RpZmllclByZXNldE1vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIj5DYW5jZWw8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9Im1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsIiBjbGFzcz0ibW9kYWwtb3ZlcmxheSBwcmVzZXQtbW9kYWwiPgogICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CiAgICAgIDxoMyBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7Ij5NYW5hZ2UgTW9kaWZpZXIgUHJlc2V0czwvaDM+CiAgICAgIDxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7IG1hcmdpbi1ib3R0b206IDIwcHg7Ij5IZXJlIHlvdSBjYW4gcmVuYW1lIG9yIGRlbGV0ZSBzYXZlZCBtb2RpZmllciBwcmVzZXQgbGlicmFyaWVzLjwvcD4KICAgICAgPGRpdiBpZD0iZWRpdE1vZGlmaWVyUHJlc2V0c0NvbnRhaW5lciIgY2xhc3M9InByZXNldC1lZGl0LWNvbnRhaW5lciI+PC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyI+CiAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9InNhdmVNb2RpZmllclByZXNldHNCdG4iIGNsYXNzPSJidG4tYWRkIj5TYXZlIGFuZCBDbG9zZTwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tZXhwb3J0IiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JykiPkNhbmNlbDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCgo8YXVkaW8gaWQ9ImV4cG9ydFNvdW5kIiBzcmM9InRhYmxlYXVkaW8ubXAzIiBwcmVsb2FkPSJhdXRvIj48L2F1ZGlvPgoKPGRpdiBpZD0idmlkZW9PdmVybGF5IiBzdHlsZT0iZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGZpeGVkOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IGJhY2tncm91bmQtY29sb3I6IGJsYWNrOyB6LWluZGV4OiAyMDAwOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgYWxpZ24taXRlbXM6IGNlbnRlcjsiPgogIDx2aWRlbyBpZD0iZXhwb3J0VmlkZW8iIHdpZHRoPSI2MDAiIHN0eWxlPSJtYXgtd2lkdGg6IDkwJTsgbWF4LWhlaWdodDogOTAlOyIgcGxheXNpbmxpbmU+CiAgICA8c291cmNlIHNyYz0iYW5pbWF0ZWQtbG9nby5tcDQiIHR5cGU9InZpZGVvL21wNCI+CiAgICBZb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgdmlkZW8gdGFnLgogIDwvdmlkZW8+CjwvZGl2PgoKPGRpdiBpZD0iaG92ZXItYm9hcmQiPgogICAgPGJ1dHRvbiBpZD0ic2Nyb2xsVG9Ub3BCdG4iIGNsYXNzPSJob3Zlci1ib2FyZC1saW5rIiB0aXRsZT0iU2Nyb2xsIHRvIFRvcCI+CiAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iY3VycmVudENvbG9yIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICAgICAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04IDE1YS41LjUgMCAwIDAgLjUtLjVWMi43MDdsMy4xNDYgMy4xNDdhLjUuNSAwIDAgMCAuNzA4LS43MDhsLTQtNGEuNS41IDAgMCAwLS43MDggMGwtNCA0YS41LjUgMCAxIDAgLjcwOC43MDhMNy41IDIuNzA3VjE0LjVhLjUuNSAwIDAgMCAuNS41eiIvPgogICAgICAgIDwvc3ZnPgogICAgPC9idXR0b24+CiAgICA8YnV0dG9uIGlkPSJzY3JvbGxUb0JvdHRvbUJ0biIgY2xhc3M9ImhvdmVyLWJvYXJkLWxpbmsiIHRpdGxlPSJTY3JvbGwgdG8gQm90dG9tIj4KICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJjdXJyZW50Q29sb3IiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgICAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTggMWEuNS41IDAgMCAxIC41LjV2MTEuNzkzbDMuMTQ2LTMuMTQ3YS41LjUgMCAwIDEgLjcwOCAuNzA4bC00IDRhLjUuNSAwIDAgMS0uNzA4IDBsLTQgNGEuNS41IDAgMCAxIC43MDgtLjcwOEw3LjUgMTMuMjkzVjEuNUEuNS41IDAgMCAxIDggMXoiLz4KICAgICAgICA8L3N2Zz4KICAgIDwvYnV0dG9uPgogICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cueW9jby5jb20vemEvbGVnYWwvcHJpdmFjeS1wb2xpY3kvIiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImhvdmVyLWJvYXJkLWxpbmsiPlByaXZhY3k8L2E+CiAgICA8YSBocmVmPSJodHRwczovL3d3dy55b2NvLmNvbS96YS9sZWdhbC90ZXJtcy1hbmQtY29uZGl0aW9ucy8iIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0iaG92ZXItYm9hcmQtbGluayI+VGVybXM8L2E+CjwvZGl2PgoKPHNjcmlwdD4KICAgIC8vIC0tLSBDT05GSUcgJiBHTE9CQUwgU1RBVEUgLS0tCiAgICBjb25zdCBIT1dfVE9fR1VJREVfVVJMID0gJ2h0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS9maWxlL2QvMXpyM0NEeWdCMjgwcDFHU2NGYWFkUmtNQmVMR1VNOGpwL3ZpZXc/dXNwPWRyaXZlX2xpbmsnOwoKICAgIGxldCBwcm9kdWN0cyA9IFtdOwogICAgbGV0IHBsdUNvdW50ZXIgPSAxMDAwOwogICAgbGV0IGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IFtdOwogICAgbGV0IGN1cnJlbnRNb2RpZmllckxpbmtzID0ge307CiAgICBsZXQgY3VycmVudFZhcmlhbnRHcm91cHMgPSBbXTsKICAgIGxldCBjdXJyZW50VmFyaWFudFByaWNpbmcgPSBbXTsKICAgIGxldCB2YXJpYW50UHJlc2V0cyA9IFtdOwogICAgbGV0IG1vZGlmaWVyUHJlc2V0cyA9IFtdOwogICAgbGV0IHNlc3Npb25TaXRlID0gJyc7CiAgICBsZXQgc2Vzc2lvbkRlZmluZVBsdSA9ICdubyc7CiAgICBsZXQgZGVmYXVsdHNTZXQgPSBmYWxzZTsKICAgIGxldCBsb2FkZXJJbnRlcnZhbCA9IG51bGw7CiAgICBsZXQgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCA9IHRydWU7CiAgICBsZXQgbGFzdFVzZWRDYXRlZ29yaWVzID0geyBwcmVwOiAnJywgbWVudTogJycsIGludjogJycsIHN1YkludjogJycsIHVvbTogJycgfTsKCiAgICBjb25zdCBjYXRlZ29yeU1hcCA9IHsKICAgICAgICAiRm9vZCI6IFsiTWVhdCIsICJEYWlyeSIsICJQcm9kdWNlIiwgIkJha2VyeSIsICJEcnkgR29vZHMiLCAiRnJvemVuIl0sCiAgICAgICAgIkJldmVyYWdlcyI6IFsiU29kYXMiLCAiSnVpY2VzIiwgIkFsY29ob2wiLCAiQ29mZmVlICYgVGVhIiwgIldhdGVyIl0sCiAgICAgICAgIlBhY2thZ2luZyI6IFsiQ29udGFpbmVycyIsICJCYWdzIiwgIkN1dGxlcnkiLCAiTmFwa2lucyJdLCAiU3VwcGxpZXMiOiBbIkNsZWFuaW5nIiwgIk9mZmljZSIsICJVbmlmb3JtcyJdCiAgICB9OwogICAgY29uc3QgdW9tTWFwID0gewogICAgICAgICdlYSc6ICdFYWNoJywgJ2tnJzogJ0tpbG9ncmFtcycsICdnJzogJ0dyYW1zJywgJ2wnOiAnTGl0cmVzJywKICAgICAgICAnbWwnOiAnTWlsbGlsaXRyZXMnLCAnbSc6ICdNZXRlcnMnLCAnbW0nOiAnTWlsbGltZXRlcnMnLCAnY20nOiAnQ2VudGltZXRlcnMnCiAgICB9OwoKICAgIC8vIC0tLSBET00gRWxlbWVudCB2YXJpYWJsZXMgd2lsbCBiZSBkZWZpbmVkIGluc2lkZSBET01Db250ZW50TG9hZGVkIC0tLQogICAgbGV0IGV4cG9ydFNvdW5kRWxlbWVudCwgc2Vzc2lvbkRlZmF1bHRzTW9kYWwsIHNlc3Npb25TaXRlSW5wdXQsIHNlc3Npb25EZWZpbmVQbHVTZWxlY3QsCiAgICAgICAgZWRpdFNlc3Npb25CdG4sIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwsIHBsdUVudHJ5R3JvdXAsIHByb2R1Y3RUeXBlU2VsZWN0LAogICAgICAgIGNvc3RQcmljZUdyb3VwLCBzZWxsaW5nUHJpY2VHcm91cCwgaW52ZW50b3J5Q2F0ZWdvcnlJbnB1dCwgaGFzQmFyY29kZVNlbGVjdCwKICAgICAgICBiYXJjb2RlRW50cnlHcm91cCwgc2F2ZVN0YXR1cywgdmFyaWFudEdyb3Vwc0NvbnRhaW5lciwgcHJpY2luZ0NvbHVtbiwKICAgICAgICB2YXJpYW50UHJpY2luZ0NvbnRhaW5lciwgYWRkVmFyaWFudEdyb3VwQnRuLCBjdXN0b21Nb2RhbCwgbW9kYWxNZXNzYWdlLAogICAgICAgIG1vZGFsQWN0aW9ucywgbWFpbkFjdGlvbkJ1dHRvbiwgZWRpdGluZ0luZGV4SW5wdXQsIG1vZGlmaWVyTW9kYWwsCiAgICAgICAgbmV3TW9kaWZpZXJHcm91cEZvcm0sIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciwgbGlua01vZGlmaWVyTW9kYWwsCiAgICAgICAgbGlua01vZGlmaWVyTW9kYWxUaXRsZSwgbGlua01vZGlmaWVyTGlzdENvbnRhaW5lciwgc2luZ2xlUHJvZHVjdE1vZGlmaWVyQ29udHJvbHMsCiAgICAgICAgdW9tU2VsZWN0LCBzdXBwbGllZFF1YW50aXR5SW5wdXQsIHlpZWxkUXVhbnRpdHlJbnB1dCwgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tib3gsCiAgICAgICAgYXBwbHlWYXJpYW50UHJlc2V0TW9kYWwsIG1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwsIGFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCwKICAgICAgICBtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbDsKCgogICAgLy8gLS0tIEVWRU5UIExJU1RFTkVSUyAmIElOSVRJQUxJWkFUSU9OIC0tLQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsKICAgICAgICAvLyAtLS0gRGVmaW5lIGFsbCBET00gZWxlbWVudCB2YXJpYWJsZXMgaGVyZSAtLS0KICAgICAgICBleHBvcnRTb3VuZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0U291bmQnKTsKICAgICAgICBzZXNzaW9uRGVmYXVsdHNNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXNzaW9uRGVmYXVsdHNNb2RhbCcpOwogICAgICAgIHNlc3Npb25TaXRlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vzc2lvblNpdGUnKTsKICAgICAgICBzZXNzaW9uRGVmaW5lUGx1U2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nlc3Npb25EZWZpbmVQbHUnKTsKICAgICAgICBlZGl0U2Vzc2lvbkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0U2Vzc2lvbkJ0bicpOwogICAgICAgIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlicmFyeU1hbmFnZW1lbnRNb2RhbCcpOwogICAgICAgIHBsdUVudHJ5R3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGx1RW50cnlHcm91cCcpOwogICAgICAgIHByb2R1Y3RUeXBlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RUeXBlJyk7CiAgICAgICAgY29zdFByaWNlR3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29zdFByaWNlR3JvdXAnKTsKICAgICAgICBzZWxsaW5nUHJpY2VHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxsaW5nUHJpY2VHcm91cCcpOwogICAgICAgIGludmVudG9yeUNhdGVnb3J5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW52ZW50b3J5Q2F0ZWdvcnknKTsKICAgICAgICBoYXNCYXJjb2RlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hhc0JhcmNvZGUnKTsKICAgICAgICBiYXJjb2RlRW50cnlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXJjb2RlRW50cnlHcm91cCcpOwogICAgICAgIHNhdmVTdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZVN0YXR1cycpOwogICAgICAgIHZhcmlhbnRHcm91cHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFyaWFudEdyb3Vwc0NvbnRhaW5lcicpOwogICAgICAgIHByaWNpbmdDb2x1bW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpY2luZy1jb2x1bW4nKTsKICAgICAgICB2YXJpYW50UHJpY2luZ0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YXJpYW50UHJpY2luZ0NvbnRhaW5lcicpOwogICAgICAgIGFkZFZhcmlhbnRHcm91cEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRWYXJpYW50R3JvdXBCdG4nKTsKICAgICAgICBjdXN0b21Nb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21Nb2RhbCcpOwogICAgICAgIG1vZGFsTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbE1lc3NhZ2UnKTsKICAgICAgICBtb2RhbEFjdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxBY3Rpb25zJyk7CiAgICAgICAgbWFpbkFjdGlvbkJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQWN0aW9uQnV0dG9uJyk7CiAgICAgICAgZWRpdGluZ0luZGV4SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdGluZ0luZGV4Jyk7CiAgICAgICAgbW9kaWZpZXJNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RpZmllck1vZGFsJyk7CiAgICAgICAgbmV3TW9kaWZpZXJHcm91cEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3TW9kaWZpZXJHcm91cEZvcm0nKTsKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyJyk7CiAgICAgICAgbGlua01vZGlmaWVyTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTW9kYWwnKTsKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbFRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtNb2RpZmllck1vZGFsVGl0bGUnKTsKICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtNb2RpZmllckxpc3RDb250YWluZXInKTsKICAgICAgICBzaW5nbGVQcm9kdWN0TW9kaWZpZXJDb250cm9scyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaW5nbGUtcHJvZHVjdC1tb2RpZmllci1jb250cm9scycpOwogICAgICAgIHVvbVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1b20nKTsKICAgICAgICBzdXBwbGllZFF1YW50aXR5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VwcGxpZWRRdWFudGl0eScpOwogICAgICAgIHlpZWxkUXVhbnRpdHlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZFF1YW50aXR5Jyk7CiAgICAgICAgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtZW1iZXJDYXRlZ29yaWVzJyk7CiAgICAgICAgYXBwbHlWYXJpYW50UHJlc2V0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlWYXJpYW50UHJlc2V0TW9kYWwnKTsKICAgICAgICBtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwnKTsKICAgICAgICBhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlNb2RpZmllclByZXNldE1vZGFsJyk7CiAgICAgICAgbWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwnKTsKCiAgICAgICAgLy8gLS0tIFRVVE9SSUFMIExPR0lDIChub3cgc2FmZWx5IGluc2lkZSBET01Db250ZW50TG9hZGVkKSAtLS0KICAgICAgICBjb25zdCB0dXRvcmlhbFByb21wdE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByb21wdC1tb2RhbCcpOwogICAgICAgIGNvbnN0IHN0YXJ0VHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQtdHV0b3JpYWwtYnRuJyk7CiAgICAgICAgY29uc3Qgc2tpcFR1dG9yaWFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NraXAtdHV0b3JpYWwtYnRuJyk7CiAgICAgICAgY29uc3QgdHV0b3JpYWxPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXknKTsKICAgICAgICBjb25zdCB0dXRvcmlhbFBvcG92ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3ZlcicpOwogICAgICAgIGNvbnN0IHBvcG92ZXJDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXItY29udGVudCcpOwogICAgICAgIGNvbnN0IHN0ZXBDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXN0ZXAtY291bnRlcicpOwogICAgICAgIGNvbnN0IHByZXZCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJldi1idG4nKTsKICAgICAgICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW5leHQtYnRuJyk7CiAgICAgICAgCiAgICAgICAgbGV0IGN1cnJlbnRUdXRvcmlhbFN0ZXAgPSAwOwogICAgICAgIGxldCBoaWdobGlnaHRlZEVsZW1lbnQgPSBudWxsOwoKICAgICAgICBjb25zdCB0dXRvcmlhbFN0ZXBzID0gWwogICAgewogICAgICAgIGVsZW1lbnQ6ICcjaG93VG9HdWlkZUxpbmsnLCAvLyBUaGlzIGxpbmUgdGFyZ2V0cyBPTkxZIHRoZSBpY29uCiAgICAgICAgY29udGVudDogJzxiPldlbGNvbWUhIPCfkYs8L2I+IExldFwncyB0YWtlIGEgcXVpY2ssIGludGVyYWN0aXZlIHRvdXIgb2YgdGhlIFByb2R1Y3QgTG9hZGVyLiBXZVwnbGwgaGlnaGxpZ2h0IGVhY2ggc2VjdGlvbiBhcyB3ZSBnby4nLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcucHJvZHVjdC1kZWZhdWx0cycsCiAgICAgICAgY29udGVudDogJzxiPlN0ZXAgMTogUHJvZHVjdCBEZWZhdWx0cyDimpnvuI88L2I+IFN0YXJ0IGhlcmUgYmVmb3JlIGFkZGluZyBhIHByb2R1Y3QuIFNldCB0aGUgXCdUYXhcJyBhbmQgXCdQcm9kdWN0IFR5cGVcJy4gWW91ciBjaG9pY2UgaGVyZSBjaGFuZ2VzIHdoaWNoIGZpZWxkcyBhcmUgcmVxdWlyZWQgaW4gdGhlIGZvcm0gYmVsb3cuJywKICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbScKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJy5saWJyYXJ5LW1hbmFnZW1lbnQnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDI6IExpYnJhcmllcyAmIFByZXNldHMg8J+TmjwvYj4gVGhpcyBpcyBhIGh1Z2UgdGltZS1zYXZlciEgTWFuYWdlIHlvdXIgcmV1c2FibGUgTW9kaWZpZXIgbGlzdHMgKGxpa2UgcGl6emEgdG9wcGluZ3MpIGFuZCBWYXJpYW50IFByZXNldHMgKGxpa2UgVC1zaGlydCBzaXplcykgaGVyZS4nLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3Byb2R1Y3RGb3JtJywKICAgICAgICBjb250ZW50OiAnPGI+U3RlcCAzOiBUaGUgTWFpbiBGb3JtIPCfk508L2I+IFRoaXMgaXMgd2hlcmUgdGhlIG1hZ2ljIGhhcHBlbnMuIEZpbGwgaW4gYWxsIHlvdXIgcHJvZHVjdCBkZXRhaWxzLiBOb3RpY2UgaG93IGl0IGNoYW5nZXMgYmFzZWQgb24gdGhlICJQcm9kdWN0IFR5cGUiIHlvdSBzZWxlY3RlZC4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnLnRhYnMnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDQ6IFlvdXIgUHJvZHVjdCBMaXN0cyDinIU8L2I+IEFzIHlvdSBhZGQgcHJvZHVjdHMsIHRoZXkgd2lsbCBhcHBlYXIgaGVyZS4gVGhlICJQcm9kdWN0cyIgdGFiIGlzIGZvciBzZWxsYWJsZSBpdGVtcyBhbmQgIlN0b2NrIEl0ZW1zIiBpcyBmb3IgaW52ZW50b3J5LiBZb3UgY2FuIGVkaXQgb3IgcmVtb3ZlIHRoZW0gYW55dGltZS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnaGVhZGVyIC5idXR0b24tY29udGFpbmVyJywKICAgICAgICBjb250ZW50OiAiPGI+WW91J3JlIGFsbCBzZXQhIPCfmoA8L2I+IFdoZW4geW91J3JlIGZpbmlzaGVkIGFkZGluZyBhbGwgeW91ciBwcm9kdWN0cywgY2xpY2sgdGhlIFwiRXhwb3J0IHRvIEV4Y2VsXCIgYnV0dG9uIHVwIGhlcmUgdG8gZ2V0IHlvdXIgZmluYWwgZmlsZS4gR29vZCBsdWNrISIsCiAgICAgICAgcG9zaXRpb246ICdsZWZ0JwogICAgfQpdOwoKICAgICAgICBmdW5jdGlvbiBzdGFydFR1dG9yaWFsKCkgewogICAgICAgICAgICBjdXJyZW50VHV0b3JpYWxTdGVwID0gMDsKICAgICAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZW5kVHV0b3JpYWwoKSB7CiAgICAgICAgICAgIHR1dG9yaWFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudHV0b3JpYWwtb3ZlcmxheS1wYXJ0JykuZm9yRWFjaChwYXJ0ID0+IHsKICAgICAgICAgICAgICAgIHBhcnQuc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgICAgICAgICBwYXJ0LnN0eWxlLmhlaWdodCA9ICcwJzsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHR1dG9yaWFsUG9wb3Zlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHNob3dUdXRvcmlhbFN0ZXAoaW5kZXgpIHsKICAgICAgICAgICAgaWYgKGhpZ2hsaWdodGVkRWxlbWVudCkgewogICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3Qgc3RlcCA9IHR1dG9yaWFsU3RlcHNbaW5kZXhdOwogICAgICAgICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdGVwLmVsZW1lbnQpOwoKICAgICAgICAgICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEpIHsgc2hvd1R1dG9yaWFsU3RlcChpbmRleCArIDEpOyB9IAogICAgICAgICAgICAgICAgZWxzZSB7IGVuZFR1dG9yaWFsKCk7IH0KICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgdHV0b3JpYWxQb3BvdmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50OwogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICAgICAgdGFyZ2V0RWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdjZW50ZXInLCBpbmxpbmU6ICdjZW50ZXInIH0pOwogICAgICAgICAgICBwb3BvdmVyQ29udGVudC5pbm5lckhUTUwgPSBzdGVwLmNvbnRlbnQ7CiAgICAgICAgICAgIHN0ZXBDb3VudGVyLnRleHRDb250ZW50ID0gYFN0ZXAgJHtpbmRleCArIDF9IG9mICR7dHV0b3JpYWxTdGVwcy5sZW5ndGh9YDsKICAgICAgICAgICAgCiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgcG9zaXRpb25Qb3BvdmVyKHRhcmdldEVsZW1lbnQsIHN0ZXAucG9zaXRpb24pOwogICAgICAgICAgICAgICAgcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0RWxlbWVudCk7CiAgICAgICAgICAgIH0sIDMwMCk7CgogICAgICAgICAgICBwcmV2QnRuLmRpc2FibGVkID0gaW5kZXggPT09IDA7CiAgICAgICAgICAgIG5leHRCdG4udGV4dENvbnRlbnQgPSBpbmRleCA9PT0gdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxID8gJ0ZpbmlzaCcgOiAnTmV4dCc7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXQpIHsKICAgICAgICAgICAgY29uc3QgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS10b3AnKS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QuYm90dG9tfXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUuaGVpZ2h0ID0gYGNhbGMoMTAwdmggLSAke3RhcmdldFJlY3QuYm90dG9tfXB4KWA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLmhlaWdodCA9IGAke3RhcmdldFJlY3QuaGVpZ2h0fXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLndpZHRoID0gYCR7dGFyZ2V0UmVjdC5sZWZ0fXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLmxlZnQgPSBgJHt0YXJnZXRSZWN0LnJpZ2h0fXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS53aWR0aCA9IGBjYWxjKDEwMHZ3IC0gJHt0YXJnZXRSZWN0LnJpZ2h0fXB4KWA7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwb3NpdGlvblBvcG92ZXIodGFyZ2V0LCBwb3NpdGlvbikgewogICAgICAgICAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICBjb25zdCBwb3BvdmVyTm9kZSA9IHR1dG9yaWFsUG9wb3ZlcjsKICAgICAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgICAgICAgICBjb25zdCBwb3BvdmVyUmVjdCA9IHBvcG92ZXJOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJyc7CiAgICAgICAgICAgIGNvbnN0IHNwYWNpbmcgPSAxNTsKICAgICAgICAgICAgcG9wb3Zlck5vZGUuY2xhc3NOYW1lID0gJ3R1dG9yaWFsLXBvcG92ZXInOwogICAgICAgICAgICBsZXQgdG9wLCBsZWZ0OwoKICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbikgewogICAgICAgICAgICAgICAgY2FzZSAndG9wJzoKICAgICAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC5ib3R0b20gKyBzcGFjaW5nOwogICAgICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyAodGFyZ2V0UmVjdC53aWR0aCAvIDIpIC0gKHBvcG92ZXJSZWN0LndpZHRoIC8gMik7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzoKICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0IC0gcG9wb3ZlclJlY3Qud2lkdGggLSBzcGFjaW5nOwogICAgICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdyaWdodCc6CiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QucmlnaHQgKyBzcGFjaW5nOwogICAgICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChsZWZ0IDwgc3BhY2luZykgbGVmdCA9IHNwYWNpbmc7CiAgICAgICAgICAgIGlmICgobGVmdCArIHBvcG92ZXJSZWN0LndpZHRoKSA+IHdpbmRvdy5pbm5lcldpZHRoIC0gc3BhY2luZykgbGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcG9wb3ZlclJlY3Qud2lkdGggLSBzcGFjaW5nOwogICAgICAgICAgICBpZiAodG9wIDwgc3BhY2luZykgdG9wID0gc3BhY2luZzsKICAgICAgICAgICAgaWYgKCh0b3AgKyBwb3BvdmVyUmVjdC5oZWlnaHQpID4gd2luZG93LmlubmVySGVpZ2h0IC0gc3BhY2luZykgdG9wID0gd2luZG93LmlubmVySGVpZ2h0IC0gcG9wb3ZlclJlY3QuaGVpZ2h0IC0gc3BhY2luZzsKCiAgICAgICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnRvcCA9IGAke3RvcH1weGA7CiAgICAgICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKICAgICAgICAgICAgcG9wb3Zlck5vZGUuY2xhc3NMaXN0LmFkZChgYXJyb3ctJHtwb3NpdGlvbn1gKTsKICAgICAgICB9CgogICAgICAgIHN0YXJ0VHV0b3JpYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvZHVjdExvYWRlclR1dG9yaWFsU2hvd24nLCAndHJ1ZScpOwogICAgICAgICAgICBzdGFydFR1dG9yaWFsKCk7CiAgICAgICAgfSk7CgogICAgICAgIHNraXBUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9kdWN0TG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICAgICAgfSk7CgogICAgICAgIHByZXZCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwID4gMCkgewogICAgICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcC0tOwogICAgICAgICAgICAgICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBpZiAoY3VycmVudFR1dG9yaWFsU3RlcCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCsrOwogICAgICAgICAgICAgICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAKICAgICAgICAvLyAtLS0gUkVHVUxBUiBBUFAgSU5JVElBTElaQVRJT04gLS0tCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hvd1RvR3VpZGVMaW5rJykuaHJlZiA9IEhPV19UT19HVUlERV9VUkw7CiAgICAgICAgbG9hZFN0YXRlKCk7CiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICBzZXR1cElubGluZVZhbGlkYXRpb24oKTsKCiAgICAgICAgaWYgKCFkZWZhdWx0c1NldCkgewogICAgICAgICAgICBzZXNzaW9uRGVmYXVsdHNNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWRpdFNlc3Npb25CdG4uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc2VjcmV0VHJpZ2dlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWNyZXRUcmlnZ2VyJyk7CiAgICAgICAgaWYgKHNlY3JldFRyaWdnZXIpIHsKICAgICAgICAgICAgc2VjcmV0VHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHNlY3JldENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWNyZXRBY3Rpb25zQ29udGFpbmVyJyk7CiAgICAgICAgICAgICAgICBpZiAoc2VjcmV0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgewogICAgICAgICAgICAgICAgICAgIHNlY3JldENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzZWNyZXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWxpbmsnKS5mb3JFYWNoKGJ1dHRvbiA9PiB7CiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHRhYklkID0gYnV0dG9uLmRhdGFzZXQudGFiOwogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1saW5rJykuZm9yRWFjaCh0YWIgPT4gdGFiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItY29udGVudCcpLmZvckVhY2goY29udGVudCA9PiBjb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhYklkKS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JvbGxUb1RvcEJ0bicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Nyb2xsVG9Cb3R0b21CdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjogJ3Ntb290aCcgfSkpOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdFNlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gZmlsdGVyVGFibGUoJ3Byb2R1Y3RTZWFyY2gnLCAncHJvZHVjdFRhYmxlJywgJ3Byb2R1Y3RDYXRlZ29yeUZpbHRlcicpKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdENhdGVnb3J5RmlsdGVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4gZmlsdGVyVGFibGUoJ3Byb2R1Y3RTZWFyY2gnLCAncHJvZHVjdFRhYmxlJywgJ3Byb2R1Y3RDYXRlZ29yeUZpbHRlcicpKTsKCiAgICAgICAgcHJvZHVjdFR5cGVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdXBkYXRlUmVxdWlyZWRGaWVsZHMpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXhBcHBsaWNhYmxlJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2F2ZVN0YXRlKTsKCiAgICAgICAgY29uc3QgZmllbGRzVG9DYXBpdGFsaXplID0gWydzZXNzaW9uU2l0ZScsICdwcm9kdWN0TmFtZScsICdwcmVwTG9jYXRpb24nLCAnbWVudUNhdGVnb3J5JywgJ2ludmVudG9yeUNhdGVnb3J5JywgJ2ludmVudG9yeVN1YkNhdGVnb3J5J107CiAgICAgICAgZmllbGRzVG9DYXBpdGFsaXplLmZvckVhY2goaWQgPT4gewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk/LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSBjYXBpdGFsaXplV29yZHMoZS50YXJnZXQudmFsdWUudHJpbSgpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlTGlua01vZGlmaWVyTW9kYWxCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgbGlua01vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsgCiAgICAgICAgfSk7CgogICAgfSk7CgogICAgZnVuY3Rpb24gZmlsdGVyVGFibGUoc2VhcmNoSW5wdXRJZCwgdGFibGVJZCwgY2F0ZWdvcnlGaWx0ZXJJZCkgewogICAgICAgIGNvbnN0IHF1ZXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VhcmNoSW5wdXRJZCkudmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCBjYXRlZ29yeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhdGVnb3J5RmlsdGVySWQpID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2F0ZWdvcnlGaWx0ZXJJZCkudmFsdWUgOiAnJzsKICAgICAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhYmxlSWQpOwogICAgICAgIGlmICghdGFibGUpIHJldHVybjsKICAgICAgICBjb25zdCByb3dzID0gdGFibGUucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKTsKCiAgICAgICAgcm93cy5mb3JFYWNoKHJvdyA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRleHRDb250ZW50ID0gcm93LnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5Q2VsbCA9IHJvdy5jZWxsc1szXSA/IHJvdy5jZWxsc1szXS50ZXh0Q29udGVudCA6ICcnOyAvLyBBc3N1bWVzIE1lbnUgQ2F0ZWdvcnkgaXMgdGhlIDR0aCBjZWxsCgogICAgICAgICAgICBjb25zdCBtYXRjaGVzUXVlcnkgPSB0ZXh0Q29udGVudC5pbmNsdWRlcyhxdWVyeSk7CiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXNDYXRlZ29yeSA9IGNhdGVnb3J5ID8gY2F0ZWdvcnlDZWxsID09PSBjYXRlZ29yeSA6IHRydWU7CgogICAgICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9IChtYXRjaGVzUXVlcnkgJiYgbWF0Y2hlc0NhdGVnb3J5KSA/ICcnIDogJ25vbmUnOwogICAgICAgIH0pOwogICAgfQoKICAgIC8vIC0tLSBFdmVudCBMaXN0ZW5lcnMgLS0tCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gewogICAgLy8gLS0tIERlZmluZSBhbGwgRE9NIGVsZW1lbnQgdmFyaWFibGVzIGhlcmUgLS0tCiAgICBleHBvcnRTb3VuZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0U291bmQnKTsKICAgIHNlc3Npb25EZWZhdWx0c01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nlc3Npb25EZWZhdWx0c01vZGFsJyk7CiAgICBzZXNzaW9uU2l0ZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nlc3Npb25TaXRlJyk7CiAgICBzZXNzaW9uRGVmaW5lUGx1U2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nlc3Npb25EZWZpbmVQbHUnKTsKICAgIGVkaXRTZXNzaW9uQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRTZXNzaW9uQnRuJyk7CiAgICBsaWJyYXJ5TWFuYWdlbWVudE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpYnJhcnlNYW5hZ2VtZW50TW9kYWwnKTsKICAgIHBsdUVudHJ5R3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGx1RW50cnlHcm91cCcpOwogICAgcHJvZHVjdFR5cGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdFR5cGUnKTsKICAgIGNvc3RQcmljZUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvc3RQcmljZUdyb3VwJyk7CiAgICBzZWxsaW5nUHJpY2VHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxsaW5nUHJpY2VHcm91cCcpOwogICAgaW52ZW50b3J5Q2F0ZWdvcnlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnZlbnRvcnlDYXRlZ29yeScpOwogICAgaGFzQmFyY29kZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoYXNCYXJjb2RlJyk7CiAgICBiYXJjb2RlRW50cnlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXJjb2RlRW50cnlHcm91cCcpOwogICAgc2F2ZVN0YXR1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlU3RhdHVzJyk7CiAgICB2YXJpYW50R3JvdXBzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZhcmlhbnRHcm91cHNDb250YWluZXInKTsKICAgIHByaWNpbmdDb2x1bW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpY2luZy1jb2x1bW4nKTsKICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZhcmlhbnRQcmljaW5nQ29udGFpbmVyJyk7CiAgICBhZGRWYXJpYW50R3JvdXBCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkVmFyaWFudEdyb3VwQnRuJyk7CiAgICBjdXN0b21Nb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21Nb2RhbCcpOwogICAgbW9kYWxNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsTWVzc2FnZScpOwogICAgbW9kYWxBY3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQWN0aW9ucycpOwogICAgbWFpbkFjdGlvbkJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQWN0aW9uQnV0dG9uJyk7CiAgICBlZGl0aW5nSW5kZXhJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0aW5nSW5kZXgnKTsKICAgIG1vZGlmaWVyTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kaWZpZXJNb2RhbCcpOwogICAgbmV3TW9kaWZpZXJHcm91cEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3TW9kaWZpZXJHcm91cEZvcm0nKTsKICAgIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXInKTsKICAgIGxpbmtNb2RpZmllck1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtNb2RpZmllck1vZGFsJyk7CiAgICBsaW5rTW9kaWZpZXJNb2RhbFRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtNb2RpZmllck1vZGFsVGl0bGUnKTsKICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTGlzdENvbnRhaW5lcicpOwogICAgc2luZ2xlUHJvZHVjdE1vZGlmaWVyQ29udHJvbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2luZ2xlLXByb2R1Y3QtbW9kaWZpZXItY29udHJvbHMnKTsKICAgIHVvbVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1b20nKTsKICAgIHN1cHBsaWVkUXVhbnRpdHlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdXBwbGllZFF1YW50aXR5Jyk7CiAgICB5aWVsZFF1YW50aXR5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRRdWFudGl0eScpOwogICAgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtZW1iZXJDYXRlZ29yaWVzJyk7CiAgICBhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCcpOwogICAgbWFuYWdlVmFyaWFudFByZXNldHNNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsJyk7CiAgICBhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlNb2RpZmllclByZXNldE1vZGFsJyk7CiAgICBtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCcpOwoKICAgIC8vIC0tLSBUVVRPUklBTCBMT0dJQyAobm93IHNhZmVseSBpbnNpZGUgRE9NQ29udGVudExvYWRlZCkgLS0tCiAgICBjb25zdCB0dXRvcmlhbFByb21wdE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByb21wdC1tb2RhbCcpOwogICAgY29uc3Qgc3RhcnRUdXRvcmlhbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydC10dXRvcmlhbC1idG4nKTsKICAgIGNvbnN0IHNraXBUdXRvcmlhbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdza2lwLXR1dG9yaWFsLWJ0bicpOwogICAgY29uc3QgdHV0b3JpYWxPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXknKTsKICAgIGNvbnN0IHR1dG9yaWFsUG9wb3ZlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wb3BvdmVyJyk7CiAgICBjb25zdCBwb3BvdmVyQ29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQnKTsKICAgIGNvbnN0IHN0ZXBDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXN0ZXAtY291bnRlcicpOwogICAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcmV2LWJ0bicpOwogICAgY29uc3QgbmV4dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1uZXh0LWJ0bicpOwogICAgCiAgICBsZXQgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICBsZXQgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gbnVsbDsKCiAgICBjb25zdCB0dXRvcmlhbFN0ZXBzID0gWwogICAgewogICAgICAgIGVsZW1lbnQ6ICcjaG93VG9HdWlkZUxpbmsnLCAvLyBUaGlzIGxpbmUgdGFyZ2V0cyBPTkxZIHRoZSBpY29uCiAgICAgICAgY29udGVudDogJzxiPldlbGNvbWUhIPCfkYs8L2I+IExldFwncyB0YWtlIGEgcXVpY2ssIGludGVyYWN0aXZlIHRvdXIgb2YgdGhlIFByb2R1Y3QgTG9hZGVyLiBXZVwnbGwgaGlnaGxpZ2h0IGVhY2ggc2VjdGlvbiBhcyB3ZSBnby4gVGhlIFBhZ2UgaWNvbiBvbiB0aGUgdG9wIGxlZnQgaXMgYSBidXR0b24gdGhhdCB3aWxsIHRha2UgeW91IHRvIHRoZSA8Yj5Ib3cgVG8gR3VpZGU8L2I+JywKICAgICAgICBwb3NpdGlvbjogJ3JpZ2h0JwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnLnByb2R1Y3QtZGVmYXVsdHMnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDE6IFByb2R1Y3QgRGVmYXVsdHMg4pqZ77iPPC9iPiBTdGFydCBoZXJlIGJlZm9yZSBhZGRpbmcgYSBwcm9kdWN0LiBTZXQgdGhlIFwnVGF4XCcgYW5kIFwnUHJvZHVjdCBUeXBlXCcuIFlvdXIgY2hvaWNlIGhlcmUgY2hhbmdlcyB3aGljaCBmaWVsZHMgYXJlIHJlcXVpcmVkIGluIHRoZSBmb3JtIGJlbG93LicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcubGlicmFyeS1tYW5hZ2VtZW50JywKICAgICAgICBjb250ZW50OiAnPGI+U3RlcCAyOiBMaWJyYXJpZXMgJiBQcmVzZXRzIPCfk5o8L2I+IFRoaXMgaXMgYSBodWdlIHRpbWUtc2F2ZXIhIE1hbmFnZSB5b3VyIHJldXNhYmxlIE1vZGlmaWVyIGxpc3RzIChsaWtlIHBpenphIHRvcHBpbmdzKSBhbmQgVmFyaWFudCBQcmVzZXRzIChsaWtlIFQtc2hpcnQgc2l6ZXMpIGhlcmUuJywKICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbScKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJyNwcm9kdWN0Rm9ybScsCiAgICAgICAgY29udGVudDogJzxiPlN0ZXAgMzogVGhlIE1haW4gRm9ybSDwn5OdPC9iPiBUaGlzIGlzIHdoZXJlIHRoZSBtYWdpYyBoYXBwZW5zLiBGaWxsIGluIGFsbCB5b3VyIHByb2R1Y3QgZGV0YWlscy4gTm90aWNlIGhvdyBpdCBjaGFuZ2VzIGJhc2VkIG9uIHRoZSAiUHJvZHVjdCBUeXBlIiB5b3Ugc2VsZWN0ZWQuJywKICAgICAgICBwb3NpdGlvbjogJ3RvcCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJy50YWJzJywKICAgICAgICBjb250ZW50OiAnPGI+U3RlcCA0OiBZb3VyIFByb2R1Y3QgTGlzdHMg4pyFPC9iPiBBcyB5b3UgYWRkIHByb2R1Y3RzLCB0aGV5IHdpbGwgYXBwZWFyIGhlcmUuIFRoZSAiUHJvZHVjdHMiIHRhYiBpcyBmb3Igc2VsbGFibGUgaXRlbXMgYW5kICJTdG9jayBJdGVtcyIgaXMgZm9yIGludmVudG9yeS4gWW91IGNhbiBlZGl0IG9yIHJlbW92ZSB0aGVtIGFueXRpbWUuJywKICAgICAgICBwb3NpdGlvbjogJ3RvcCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJ2hlYWRlciAuYnV0dG9uLWNvbnRhaW5lcicsCiAgICAgICAgY29udGVudDogIjxiPllvdSdyZSBhbGwgc2V0ISDwn5qAPC9iPiBXaGVuIHlvdSdyZSBmaW5pc2hlZCBhZGRpbmcgYWxsIHlvdXIgcHJvZHVjdHMsIGNsaWNrIHRoZSBcIkV4cG9ydCB0byBFeGNlbFwiIGJ1dHRvbiB1cCBoZXJlIHRvIGdldCB5b3VyIGZpbmFsIGZpbGUuIEdvb2QgbHVjayEiLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0KXTsKCiAgICBmdW5jdGlvbiBzdGFydFR1dG9yaWFsKCkgewogICAgICAgIGN1cnJlbnRUdXRvcmlhbFN0ZXAgPSAwOwogICAgICAgIHR1dG9yaWFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuZFR1dG9yaWFsKCkgewogICAgICAgIHR1dG9yaWFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50dXRvcmlhbC1vdmVybGF5LXBhcnQnKS5mb3JFYWNoKHBhcnQgPT4gewogICAgICAgICAgICBwYXJ0LnN0eWxlLndpZHRoID0gJzAnOwogICAgICAgICAgICBwYXJ0LnN0eWxlLmhlaWdodCA9ICcwJzsKICAgICAgICB9KTsKICAgICAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQgPSBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzaG93VHV0b3JpYWxTdGVwKGluZGV4KSB7CiAgICAgICAgaWYgKGhpZ2hsaWdodGVkRWxlbWVudCkgewogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc3RlcCA9IHR1dG9yaWFsU3RlcHNbaW5kZXhdOwogICAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0ZXAuZWxlbWVudCk7CgogICAgICAgIGlmICghdGFyZ2V0RWxlbWVudCkgewogICAgICAgICAgICBpZiAoaW5kZXggPCB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEpIHsgc2hvd1R1dG9yaWFsU3RlcChpbmRleCArIDEpOyB9IAogICAgICAgICAgICBlbHNlIHsgZW5kVHV0b3JpYWwoKTsgfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHR1dG9yaWFsUG9wb3Zlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50OwogICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgIHRhcmdldEVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnY2VudGVyJywgaW5saW5lOiAnY2VudGVyJyB9KTsKICAgICAgICBwb3BvdmVyQ29udGVudC5pbm5lckhUTUwgPSBzdGVwLmNvbnRlbnQ7CiAgICAgICAgc3RlcENvdW50ZXIudGV4dENvbnRlbnQgPSBgU3RlcCAke2luZGV4ICsgMX0gb2YgJHt0dXRvcmlhbFN0ZXBzLmxlbmd0aH1gOwogICAgICAgIAogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBwb3NpdGlvblBvcG92ZXIodGFyZ2V0RWxlbWVudCwgc3RlcC5wb3NpdGlvbik7CiAgICAgICAgICAgIHBvc2l0aW9uU3BvdGxpZ2h0KHRhcmdldEVsZW1lbnQpOwogICAgICAgIH0sIDMwMCk7CgogICAgICAgIHByZXZCdG4uZGlzYWJsZWQgPSBpbmRleCA9PT0gMDsKICAgICAgICBuZXh0QnRuLnRleHRDb250ZW50ID0gaW5kZXggPT09IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSA/ICdGaW5pc2gnIDogJ05leHQnOwogICAgfQoKICAgIGZ1bmN0aW9uIHBvc2l0aW9uU3BvdGxpZ2h0KHRhcmdldCkgewogICAgICAgIGNvbnN0IHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXRvcCcpLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LmJvdHRvbX1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUuaGVpZ2h0ID0gYGNhbGMoMTAwdmggLSAke3RhcmdldFJlY3QuYm90dG9tfXB4KWA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUud2lkdGggPSAnMTAwdncnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLmhlaWdodCA9IGAke3RhcmdldFJlY3QuaGVpZ2h0fXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUud2lkdGggPSBgJHt0YXJnZXRSZWN0LmxlZnR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUubGVmdCA9IGAke3RhcmdldFJlY3QucmlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUud2lkdGggPSBgY2FsYygxMDB2dyAtICR7dGFyZ2V0UmVjdC5yaWdodH1weClgOwogICAgfQoKICAgIGZ1bmN0aW9uIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXQsIHBvc2l0aW9uKSB7CiAgICAgICAgY29uc3QgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBjb25zdCBwb3BvdmVyTm9kZSA9IHR1dG9yaWFsUG9wb3ZlcjsKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7CiAgICAgICAgY29uc3QgcG9wb3ZlclJlY3QgPSBwb3BvdmVyTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJyc7CiAgICAgICAgY29uc3Qgc3BhY2luZyA9IDE1OwogICAgICAgIHBvcG92ZXJOb2RlLmNsYXNzTmFtZSA9ICd0dXRvcmlhbC1wb3BvdmVyJzsKICAgICAgICBsZXQgdG9wLCBsZWZ0OwoKICAgICAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgJ3RvcCc6CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgKHRhcmdldFJlY3Qud2lkdGggLyAyKSAtIChwb3BvdmVyUmVjdC53aWR0aCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LmJvdHRvbSArIHNwYWNpbmc7CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgKHRhcmdldFJlY3Qud2lkdGggLyAyKSAtIChwb3BvdmVyUmVjdC53aWR0aCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOgogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCAtIHBvcG92ZXJSZWN0LndpZHRoIC0gc3BhY2luZzsKICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QucmlnaHQgKyBzcGFjaW5nOwogICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyAodGFyZ2V0UmVjdC5oZWlnaHQgLyAyKSAtIChwb3BvdmVyUmVjdC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAobGVmdCA8IHNwYWNpbmcpIGxlZnQgPSBzcGFjaW5nOwogICAgICAgIGlmICgobGVmdCArIHBvcG92ZXJSZWN0LndpZHRoKSA+IHdpbmRvdy5pbm5lcldpZHRoIC0gc3BhY2luZykgbGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcG9wb3ZlclJlY3Qud2lkdGggLSBzcGFjaW5nOwogICAgICAgIGlmICh0b3AgPCBzcGFjaW5nKSB0b3AgPSBzcGFjaW5nOwogICAgICAgIGlmICgodG9wICsgcG9wb3ZlclJlY3QuaGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCAtIHNwYWNpbmcpIHRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CgogICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnRvcCA9IGAke3RvcH1weGA7CiAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgOwogICAgICAgIHBvcG92ZXJOb2RlLmNsYXNzTGlzdC5hZGQoYGFycm93LSR7cG9zaXRpb259YCk7CiAgICB9CgogICAgc3RhcnRUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvZHVjdExvYWRlclR1dG9yaWFsU2hvd24nLCAndHJ1ZScpOwogICAgICAgIHN0YXJ0VHV0b3JpYWwoKTsKICAgIH0pOwoKICAgIHNraXBUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvZHVjdExvYWRlclR1dG9yaWFsU2hvd24nLCAndHJ1ZScpOwogICAgfSk7CgogICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBpZiAoY3VycmVudFR1dG9yaWFsU3RlcCA+IDApIHsKICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcC0tOwogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgIH0KICAgIH0pOwoKICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPCB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCsrOwogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICAgICAgfQogICAgfSk7CiAgICAKICAgIC8vIC0tLSBSRUdVTEFSIEFQUCBJTklUSUFMSVpBVElPTiAtLS0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob3dUb0d1aWRlTGluaycpLmhyZWYgPSBIT1dfVE9fR1VJREVfVVJMOwogICAgbG9hZFN0YXRlKCk7CiAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgc2V0dXBJbmxpbmVWYWxpZGF0aW9uKCk7CgogICAgaWYgKCFkZWZhdWx0c1NldCkgewogICAgICAgIHNlc3Npb25EZWZhdWx0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0gZWxzZSB7CiAgICAgICAgZWRpdFNlc3Npb25CdG4uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOwogICAgfQoKICAgIGNvbnN0IHNlY3JldFRyaWdnZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VjcmV0VHJpZ2dlcicpOwogICAgaWYgKHNlY3JldFRyaWdnZXIpIHsKICAgICAgICBzZWNyZXRUcmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBjb25zdCBzZWNyZXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VjcmV0QWN0aW9uc0NvbnRhaW5lcicpOwogICAgICAgICAgICBpZiAoc2VjcmV0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgewogICAgICAgICAgICAgICAgc2VjcmV0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZWNyZXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItbGluaycpLmZvckVhY2goYnV0dG9uID0+IHsKICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRhYklkID0gYnV0dG9uLmRhdGFzZXQudGFiOwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWxpbmsnKS5mb3JFYWNoKHRhYiA9PiB0YWIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWNvbnRlbnQnKS5mb3JFYWNoKGNvbnRlbnQgPT4gY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgIH0pOwogICAgfSk7CgogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njcm9sbFRvVG9wQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gd2luZG93LnNjcm9sbFRvKHsgdG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCcgfSkpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njcm9sbFRvQm90dG9tQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gd2luZG93LnNjcm9sbFRvKHsgdG9wOiBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pKTsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdFNlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gZmlsdGVyVGFibGUoJ3Byb2R1Y3RTZWFyY2gnLCAncHJvZHVjdFRhYmxlJywgJ3Byb2R1Y3RDYXRlZ29yeUZpbHRlcicpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0Q2F0ZWdvcnlGaWx0ZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiBmaWx0ZXJUYWJsZSgncHJvZHVjdFNlYXJjaCcsICdwcm9kdWN0VGFibGUnLCAncHJvZHVjdENhdGVnb3J5RmlsdGVyJykpOwoKICAgIHByb2R1Y3RUeXBlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZVJlcXVpcmVkRmllbGRzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXhBcHBsaWNhYmxlJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2F2ZVN0YXRlKTsKCiAgICBjb25zdCBmaWVsZHNUb0NhcGl0YWxpemUgPSBbJ3Nlc3Npb25TaXRlJywgJ3Byb2R1Y3ROYW1lJywgJ3ByZXBMb2NhdGlvbicsICdtZW51Q2F0ZWdvcnknLCAnaW52ZW50b3J5Q2F0ZWdvcnknLCAnaW52ZW50b3J5U3ViQ2F0ZWdvcnknXTsKICAgIGZpZWxkc1RvQ2FwaXRhbGl6ZS5mb3JFYWNoKGlkID0+IHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk/LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZSkgPT4gewogICAgICAgICAgICBlLnRhcmdldC52YWx1ZSA9IGNhcGl0YWxpemVXb3JkcyhlLnRhcmdldC52YWx1ZS50cmltKCkpOwogICAgICAgIH0pOwogICAgfSk7CiAgICAKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZUxpbmtNb2RpZmllck1vZGFsQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgbGlua01vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIGdlbmVyYXRlQW5kUmVuZGVyUHJpY2luZygpOyAKICAgIH0pOwogICAgCiAgICAvLyAtLS0gUEFTVEUgVEhFIENVVCBFVkVOVCBMSVNURU5FUlMgSEVSRSAtLS0KICAgIG1haW5BY3Rpb25CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVNYWluQWN0aW9uKTsKICAgIHNlc3Npb25EZWZpbmVQbHVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4geyBpZiAoZGVmYXVsdHNTZXQpIHsgc2Vzc2lvbkRlZmluZVBsdSA9IHNlc3Npb25EZWZpbmVQbHVTZWxlY3QudmFsdWU7IGhhbmRsZVBsdVZpc2liaWxpdHkoKTsgfSB9KTsKICAgIGludmVudG9yeUNhdGVnb3J5SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVJbnZlbnRvcnlDYXRlZ29yeUNoYW5nZSk7CiAgICBoYXNCYXJjb2RlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUJhcmNvZGVWaXNpYmlsaXR5KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuTGlicmFyeU1vZGFsQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBsaWJyYXJ5TWFuYWdlbWVudE1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbk1vZGlmaWVyTW9kYWxCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBsaWJyYXJ5TWFuYWdlbWVudE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICByZW5kZXJNb2RpZmllck1vZGFsKCk7CiAgICAgICAgbW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VWYXJpYW50UHJlc2V0c0J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIG9wZW5NYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsKCk7CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VNb2RpZmllclByZXNldHNCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBsaWJyYXJ5TWFuYWdlbWVudE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBvcGVuTWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwoKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5UHJlc2V0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuQXBwbHlWYXJpYW50UHJlc2V0TW9kYWwpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVBc1ByZXNldEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUN1cnJlbnRWYXJpYW50c0FzUHJlc2V0KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5rU2luZ2xlTW9kaWZpZXJCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG9wZW5MaW5rTW9kaWZpZXJNb2RhbCgnJykpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldERlZmF1bHRzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZXREZWZhdWx0cyk7CiAgICBlZGl0U2Vzc2lvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNlc3Npb25EZWZhdWx0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2VNb2RpZmllck1vZGFsQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBtb2RpZmllck1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZU1vZGlmaWVyc0J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2F2ZU1vZGlmaWVyc0Zyb21Nb2RhbCh0cnVlKSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZVZhcmlhbnRQcmVzZXRzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlVmFyaWFudFByZXNldHNGcm9tTWFuYWdlcik7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZU1vZGlmaWVyUHJlc2V0c0J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZU1vZGlmaWVyUHJlc2V0c0Zyb21NYW5hZ2VyKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseU1vZGlmaWVyUHJlc2V0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuQXBwbHlNb2RpZmllclByZXNldE1vZGFsKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlTW9kaWZpZXJzQXNQcmVzZXRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVNb2RpZmllcnNBc1ByZXNldCk7CiAgICBzdXBwbGllZFF1YW50aXR5SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB1cGRhdGVHaG9zdFRleHQpOwogICAgc3VwcGxpZWRRdWFudGl0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdXBkYXRlR2hvc3RUZXh0KTsKICAgIHN1cHBsaWVkUXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdXBkYXRlR2hvc3RUZXh0KTsKICAgIHlpZWxkUXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVlpZWxkR2hvc3RUZXh0KTsKICAgIHlpZWxkUXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHVwZGF0ZVlpZWxkR2hvc3RUZXh0KTsKICAgIHlpZWxkUXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdXBkYXRlWWllbGRHaG9zdFRleHQpOwogICAgdW9tU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHsKICAgICAgICB1cGRhdGVHaG9zdFRleHQoKTsKICAgICAgICB1cGRhdGVZaWVsZEdob3N0VGV4dCgpOwogICAgfSk7CiAgICByZW1lbWJlckNhdGVnb3JpZXNDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4gewogICAgICAgIHJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrZWQgPSBlLnRhcmdldC5jaGVja2VkOwogICAgICAgIHNhdmVTdGF0ZSgpOwogICAgfSk7Cn0pOwoKICAgIC8vIC0tLSBIRUxQRVIgRlVOQ1RJT05TIC0tLQogICAgZnVuY3Rpb24gc2FuaXRpemVJbnB1dChzdHIpIHsKICAgICAgICBpZiAoIXN0cikgcmV0dXJuICcnOwogICAgICAgIGNvbnN0IGFsbG93ZWRDaGFyc1JlZ2V4ID0gL1teYS16QS1aMC05IFwtLiwmKClSXS9nOwogICAgICAgIHJldHVybiBzdHIudG9TdHJpbmcoKS5yZXBsYWNlKGFsbG93ZWRDaGFyc1JlZ2V4LCAnJyk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FwaXRhbGl6ZVdvcmRzKHN0cikgewogICAgICAgIGlmICghc3RyKSByZXR1cm4gJyc7CiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cYlx3L2csIGNoYXIgPT4gY2hhci50b1VwcGVyQ2FzZSgpKTsKICAgIH0KCiAgICAvLyAtLS0gTU9ESUZJRVIgTElCUkFSWSAmIFBSRVNFVCBMT0dJQyAtLS0KICAgIGZ1bmN0aW9uIGluaXRpYWxpemVEZWZhdWx0TW9kaWZpZXJQcmVzZXRzKCkgewogICAgICAgIG1vZGlmaWVyUHJlc2V0cyA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlN0ZWFrIFRlbXBlcmF0dXJlIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiU3RlYWsgVGVtcGVyYXR1cmUiLCBvcHRpb25zOiBbeyBuYW1lOiAiUmFyZSIsIHByaWNlOiAwIH0sIHsgbmFtZTogIk1lZGl1bSBSYXJlIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiTWVkaXVtIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiTWVkaXVtIFdlbGwiLCBwcmljZTogMCB9LCB7IG5hbWU6ICJXZWxsIERvbmUiLCBwcmljZTogMCB9XSB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiRWdnIFByZXBhcmF0aW9uIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiRWdnIFN0eWxlIiwgb3B0aW9uczogW3sgbmFtZTogIkZyaWVkIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiU2NyYW1ibGVkIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiUG9hY2hlZCIsIHByaWNlOiAwIH0sIHsgbmFtZTogIkJvaWxlZCBTb2Z0IiwgcHJpY2U6IDAgfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlBpenphIFRvcHBpbmdzIChFeHRyYXMpIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiRXh0cmEgVG9wcGluZ3MiLCBvcHRpb25zOiBbeyBuYW1lOiAiRXh0cmEgQ2hlZXNlIiwgcHJpY2U6IDE1IH0sIHsgbmFtZTogIkJhY29uIiwgcHJpY2U6IDIwIH0sIHsgbmFtZTogIk11c2hyb29tIiwgcHJpY2U6IDEyIH0sIHsgbmFtZTogIk9saXZlcyIsIHByaWNlOiAxMCB9LCB7IG5hbWU6ICJBdm8iLCBwcmljZTogMjUgfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIkJ1cmdlci9TYW5kd2ljaCBBZGQtb25zIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiQWRkLW9ucyIsIG9wdGlvbnM6IFt7IG5hbWU6ICJDaGVlc2UgU2xpY2UiLCBwcmljZTogMTAgfSwgeyBuYW1lOiAiQmFjb24iLCBwcmljZTogMjAgfSwgeyBuYW1lOiAiQXZvIiwgcHJpY2U6IDI1IH0sIHsgbmFtZTogIk11c2hyb29tIFNhdWNlIiwgcHJpY2U6IDE4IH1dIH1dCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJTYWxhZCBEcmVzc2luZ3MiLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJEcmVzc2luZyBDaG9pY2UiLCBvcHRpb25zOiBbeyBuYW1lOiAiVmluYWlncmV0dGUiLCBwcmljZTogMCB9LCB7IG5hbWU6ICJSYW5jaCIsIHByaWNlOiAwIH0sIHsgbmFtZTogIkl0YWxpYW4iLCBwcmljZTogMCB9LCB7IG5hbWU6ICJCbHVlIENoZWVzZSIsIHByaWNlOiAwIH1dIH1dCiAgICAgICAgICAgIH0sCiAgICAgICAgXTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2F2ZU1vZGlmaWVyc0FzUHJlc2V0KCkgewogICAgICAgIHNhdmVNb2RpZmllcnNGcm9tTW9kYWwoZmFsc2UpOyAvLyBGaXJzdCwgY2FwdHVyZSBhbnkgY2hhbmdlcyBtYWRlIGluIHRoZSBtb2RhbCBpbnB1dHMKICAgICAgICBpZiAoY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBzaG93TW9kYWwoIlRoZSBtb2RpZmllciBsaWJyYXJ5IGlzIGVtcHR5LiBBZGQgc29tZSBncm91cHMgYmVmb3JlIHNhdmluZyBhIHByZXNldC4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzaG93UHJvbXB0TW9kYWwoIkVudGVyIGEgbmFtZSBmb3IgdGhpcyBuZXcgbW9kaWZpZXIgcHJlc2V0IGxpYnJhcnk6IiwgKHByZXNldE5hbWUpID0+IHsKICAgICAgICAgICAgaWYgKG1vZGlmaWVyUHJlc2V0cy5zb21lKHAgPT4gcC5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHByZXNldE5hbWUudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChgQSBtb2RpZmllciBwcmVzZXQgbmFtZWQgIiR7cHJlc2V0TmFtZX0iIGFscmVhZHkgZXhpc3RzLmAsICJlcnJvciIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IG5ld1ByZXNldCA9IHsgbmFtZTogcHJlc2V0TmFtZSwgZ3JvdXBzOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGN1cnJlbnRNb2RpZmllckdyb3VwcykpIH07CiAgICAgICAgICAgIG1vZGlmaWVyUHJlc2V0cy5wdXNoKG5ld1ByZXNldCk7CiAgICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgICBzaG93TW9kYWwoYE1vZGlmaWVyIHByZXNldCAiJHtwcmVzZXROYW1lfSIgc2F2ZWQgc3VjY2Vzc2Z1bGx5LmAsICd3YXJuaW5nJyk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gb3BlbkFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCgpIHsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlNb2RpZmllclByZXNldExpc3RDb250YWluZXInKTsKICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYgKG1vZGlmaWVyUHJlc2V0cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyI+Tm8gbW9kaWZpZXIgcHJlc2V0cyBoYXZlIGJlZW4gc2F2ZWQgeWV0LjwvcD5gOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1vZGlmaWVyUHJlc2V0cy5mb3JFYWNoKHByZXNldCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBpdGVtLnN0eWxlID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZzogMTBweDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsnOwogICAgICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBgPHNwYW4+JHtwcmVzZXQubmFtZX08L3NwYW4+YDsKICAgICAgICAgICAgICAgIGNvbnN0IGFwcGx5QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi50ZXh0Q29udGVudCA9ICdBcHBseSc7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi5jbGFzc05hbWUgPSAnYnRuLWFkZCBidG4tYWRkLWR5bmFtaWMnOwogICAgICAgICAgICAgICAgYXBwbHlCdG4ub25jbGljayA9ICgpID0+IGFwcGx5TW9kaWZpZXJQcmVzZXQocHJlc2V0Lm5hbWUpOwogICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChhcHBseUJ0bik7CiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb25zdCB3YXJuaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5TW9kaWZpZXJQcmVzZXRXYXJuaW5nJyk7CiAgICAgICAgd2FybmluZy50ZXh0Q29udGVudCA9IGN1cnJlbnRNb2RpZmllckdyb3Vwcy5sZW5ndGggPiAwID8gCiAgICAgICAgICAgICdXYXJuaW5nOiBBcHBseWluZyBhIHByZXNldCB3aWxsIG92ZXJ3cml0ZSB5b3VyIGVudGlyZSBjdXJyZW50IG1vZGlmaWVyIGxpYnJhcnkuJyA6IAogICAgICAgICAgICAnU2VsZWN0IGEgcHJlc2V0IHRvIGxvYWQgaW50byB0aGUgbW9kaWZpZXIgbGlicmFyeS4nOwogICAgICAgIGFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlNb2RpZmllclByZXNldChwcmVzZXROYW1lKSB7CiAgICAgICAgY29uc3QgcHJlc2V0ID0gbW9kaWZpZXJQcmVzZXRzLmZpbmQocCA9PiBwLm5hbWUgPT09IHByZXNldE5hbWUpOwogICAgICAgIGlmICghcHJlc2V0KSByZXR1cm47CgogICAgICAgIGNvbnN0IGFwcGx5ID0gKCkgPT4gewogICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHByZXNldC5ncm91cHMpKTsKICAgICAgICAgICAgcmVuZGVyTW9kaWZpZXJNb2RhbCgpOyAvLyBSZS1yZW5kZXIgdGhlIG1haW4gbW9kaWZpZXIgbW9kYWwgd2l0aCBuZXcgZGF0YQogICAgICAgICAgICBhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICBzaG93TW9kYWwoYE1vZGlmaWVyIHByZXNldCAiJHtwcmVzZXROYW1lfSIgaGFzIGJlZW4gbG9hZGVkLmAsICd3YXJuaW5nJyk7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKGN1cnJlbnRNb2RpZmllckdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbChgQXJlIHlvdSBzdXJlPyBUaGlzIHdpbGwgcmVwbGFjZSB5b3VyIGN1cnJlbnQgbW9kaWZpZXIgbGlicmFyeSB3aXRoIHRoZSAiJHtwcmVzZXROYW1lfSIgcHJlc2V0LmAsICd3YXJuaW5nJywgYXBwbHksIHRydWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFwcGx5KCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jdGlvbiBvcGVuTWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwoKSB7CiAgICAgICAgcmVuZGVyTWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwoKTsKICAgICAgICBtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyTWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwoKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRNb2RpZmllclByZXNldHNDb250YWluZXInKTsKICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYgKG1vZGlmaWVyUHJlc2V0cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyI+Tm8gbW9kaWZpZXIgcHJlc2V0cyBzYXZlZCB5ZXQuPC9wPmA7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbW9kaWZpZXJQcmVzZXRzLmZvckVhY2gocHJlc2V0ID0+IHsKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHJvdy5zdHlsZSA9ICdkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDEwcHg7JzsKICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICBpbnB1dC50eXBlID0gJ3RleHQnOwogICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHByZXNldC5uYW1lOwogICAgICAgICAgICBpbnB1dC5kYXRhc2V0Lm9yaWdpbmFsTmFtZSA9IHByZXNldC5uYW1lOwogICAgICAgICAgICBpbnB1dC5zdHlsZS5mbGV4R3JvdyA9ICcxJzsKICAgICAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5jbGFzc05hbWUgPSAnYnRuLXJlbW92ZSc7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5pbm5lckhUTUwgPSBgJm5kYXNoO2A7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gZGVsZXRlTW9kaWZpZXJQcmVzZXQocHJlc2V0Lm5hbWUpOwogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoaW5wdXQpOwogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTsKICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHJvdyk7CiAgICAgICAgfSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHNhdmVNb2RpZmllclByZXNldHNGcm9tTWFuYWdlcigpIHsKICAgICAgICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZWRpdE1vZGlmaWVyUHJlc2V0c0NvbnRhaW5lciBpbnB1dCcpOwogICAgICAgIGNvbnN0IG5ld1ByZXNldHMgPSBbXTsKICAgICAgICBjb25zdCBuYW1lcyA9IG5ldyBTZXQoKTsKICAgICAgICBsZXQgaGFzRXJyb3IgPSBmYWxzZTsKCiAgICAgICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4gewogICAgICAgICAgICBjb25zdCBuZXdOYW1lID0gaW5wdXQudmFsdWUudHJpbSgpOwogICAgICAgICAgICBjb25zdCBvcmlnaW5hbE5hbWUgPSBpbnB1dC5kYXRhc2V0Lm9yaWdpbmFsTmFtZTsKICAgICAgICAgICAgaWYgKCFuZXdOYW1lIHx8IG5hbWVzLmhhcyhuZXdOYW1lLnRvTG93ZXJDYXNlKCkpKSB7CiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwobmV3TmFtZSA/IGBEdXBsaWNhdGUgcHJlc2V0IG5hbWU6ICIke25ld05hbWV9ImAgOiAiUHJlc2V0IG5hbWVzIGNhbm5vdCBiZSBlbXB0eS4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBuYW1lcy5hZGQobmV3TmFtZS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxQcmVzZXQgPSBtb2RpZmllclByZXNldHMuZmluZChwID0+IHAubmFtZSA9PT0gb3JpZ2luYWxOYW1lKTsKICAgICAgICAgICAgaWYob3JpZ2luYWxQcmVzZXQpIG5ld1ByZXNldHMucHVzaCh7IG5hbWU6IG5ld05hbWUsIGdyb3Vwczogb3JpZ2luYWxQcmVzZXQuZ3JvdXBzIH0pOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaGFzRXJyb3IpIHJldHVybjsKCiAgICAgICAgbW9kaWZpZXJQcmVzZXRzID0gbmV3UHJlc2V0czsKICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICBtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgc2hvd01vZGFsKCJNb2RpZmllciBwcmVzZXRzIHVwZGF0ZWQuIiwgIndhcm5pbmciKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGVNb2RpZmllclByZXNldChwcmVzZXROYW1lKSB7CiAgICAgICAgc2hvd01vZGFsKGBEZWxldGUgdGhlICIke3ByZXNldE5hbWV9IiBtb2RpZmllciBwcmVzZXQ/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS5gLCAnd2FybmluZycsICgpID0+IHsKICAgICAgICAgICAgbW9kaWZpZXJQcmVzZXRzID0gbW9kaWZpZXJQcmVzZXRzLmZpbHRlcihwID0+IHAubmFtZSAhPT0gcHJlc2V0TmFtZSk7CiAgICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgICByZW5kZXJNYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCgpOwogICAgICAgIH0sIHRydWUpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiByZW5kZXJNb2RpZmllck1vZGFsKCkgewogICAgICAgIHJlbmRlck5ld01vZGlmaWVyR3JvdXBGb3JtKCk7CiAgICAgICAgcmVuZGVyRXhpc3RpbmdNb2RpZmllckdyb3VwcygpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbmRlck5ld01vZGlmaWVyR3JvdXBGb3JtKCkgewogICAgICAgIG5ld01vZGlmaWVyR3JvdXBGb3JtLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kaWZpZXItZ3JvdXAtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iTmV3IEdyb3VwIE5hbWUgKGUuZy4sIEFkZC1vbnMpIiBpZD0ibmV3TW9kaWZpZXJHcm91cE5hbWUiPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBpZD0ibmV3LW1vZGlmaWVyLW9wdGlvbnMtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vZGlmaWVyLW9wdGlvbi1yb3ciPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iT3B0aW9uIE5hbWUiIGNsYXNzPSJuZXctbW9kaWZpZXItb3B0aW9uLW5hbWUiPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIHN0ZXA9IjAuMDEiIHBsYWNlaG9sZGVyPSJQcmljZSIgdmFsdWU9IjAiIGNsYXNzPSJuZXctbW9kaWZpZXItb3B0aW9uLXByaWNlIj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1yZW1vdmUiIGRpc2FibGVkPiZuZGFzaDs8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJhZGROZXdNb2RpZmllck9wdGlvbkJ0biIgY2xhc3M9ImJ0bi1hZGQtZHluYW1pYyI+QWRkIE9wdGlvbjwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNvbW1pdE5ld01vZGlmaWVyR3JvdXBCdG4iIGNsYXNzPSJidG4tYWRkIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4OyB3aWR0aDogMTAwJTsiPkFkZCBHcm91cCB0byBMaWJyYXJ5PC9idXR0b24+CiAgICAgICAgYDsKCiAgICAgICAgbmV3TW9kaWZpZXJHcm91cEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT0idGV4dCJdJykuZm9yRWFjaChpbnB1dCA9PiB7CiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBlID0+IGUudGFyZ2V0LnZhbHVlID0gY2FwaXRhbGl6ZVdvcmRzKGUudGFyZ2V0LnZhbHVlLnRyaW0oKSkpOwogICAgICAgIH0pOwoKICAgICAgICBuZXdNb2RpZmllckdyb3VwRm9ybS5xdWVyeVNlbGVjdG9yKCcjYWRkTmV3TW9kaWZpZXJPcHRpb25CdG4nKS5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBuZXdNb2RpZmllckdyb3VwRm9ybS5xdWVyeVNlbGVjdG9yKCcjbmV3LW1vZGlmaWVyLW9wdGlvbnMtY29udGFpbmVyJyk7CiAgICAgICAgICAgIGNvbnN0IG9wdGlvblJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBvcHRpb25Sb3cuY2xhc3NOYW1lID0gJ21vZGlmaWVyLW9wdGlvbi1yb3cnOwogICAgICAgICAgICBvcHRpb25Sb3cuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJPcHRpb24gTmFtZSIgY2xhc3M9Im5ldy1tb2RpZmllci1vcHRpb24tbmFtZSI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBzdGVwPSIwLjAxIiBwbGFjZWhvbGRlcj0iUHJpY2UiIHZhbHVlPSIwIiBjbGFzcz0ibmV3LW1vZGlmaWVyLW9wdGlvbi1wcmljZSI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1yZW1vdmUiPiZuZGFzaDs8L2J1dHRvbj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgb3B0aW9uUm93LnF1ZXJ5U2VsZWN0b3IoJy5idG4tcmVtb3ZlJykub25jbGljayA9ICgpID0+IG9wdGlvblJvdy5yZW1vdmUoKTsKICAgICAgICAgICAgb3B0aW9uUm93LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9InRleHQiXScpLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBlID0+IGUudGFyZ2V0LnZhbHVlID0gY2FwaXRhbGl6ZVdvcmRzKGUudGFyZ2V0LnZhbHVlLnRyaW0oKSkpOwogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQob3B0aW9uUm93KTsKICAgICAgICB9OwoKICAgICAgICBuZXdNb2RpZmllckdyb3VwRm9ybS5xdWVyeVNlbGVjdG9yKCcjY29tbWl0TmV3TW9kaWZpZXJHcm91cEJ0bicpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGdyb3VwTmFtZSA9IHNhbml0aXplSW5wdXQobmV3TW9kaWZpZXJHcm91cEZvcm0ucXVlcnlTZWxlY3RvcignI25ld01vZGlmaWVyR3JvdXBOYW1lJykudmFsdWUudHJpbSgpKTsKICAgICAgICAgICAgaWYgKCFncm91cE5hbWUgfHwgY3VycmVudE1vZGlmaWVyR3JvdXBzLnNvbWUoZyA9PiBnLmdyb3VwTmFtZS50b0xvd2VyQ2FzZSgpID09PSBncm91cE5hbWUudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChncm91cE5hbWUgPyBgQSBncm91cCBuYW1lZCAiJHtncm91cE5hbWV9IiBhbHJlYWR5IGV4aXN0cy5gIDogIlBsZWFzZSBlbnRlciBhIGdyb3VwIG5hbWUuIiwgImVycm9yIik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBBcnJheS5mcm9tKG5ld01vZGlmaWVyR3JvdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RpZmllci1vcHRpb24tcm93JykpCiAgICAgICAgICAgICAgICAubWFwKHJvdyA9PiAoewogICAgICAgICAgICAgICAgICAgIG5hbWU6IHNhbml0aXplSW5wdXQocm93LnF1ZXJ5U2VsZWN0b3IoJy5uZXctbW9kaWZpZXItb3B0aW9uLW5hbWUnKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICAgICAgICAgIHByaWNlOiBwYXJzZUZsb2F0KHJvdy5xdWVyeVNlbGVjdG9yKCcubmV3LW1vZGlmaWVyLW9wdGlvbi1wcmljZScpLnZhbHVlKSB8fCAwCiAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIC5maWx0ZXIob3B0ID0+IG9wdC5uYW1lKTsKCiAgICAgICAgICAgIGlmIChvcHRpb25zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgc2hvd01vZGFsKCJQbGVhc2UgYWRkIGF0IGxlYXN0IG9uZSB2YWxpZCBvcHRpb24uIiwgImVycm9yIik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzLnB1c2goeyBncm91cE5hbWUsIG9wdGlvbnMgfSk7CiAgICAgICAgICAgIHJlbmRlck1vZGlmaWVyTW9kYWwoKTsKICAgICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbmRlckV4aXN0aW5nTW9kaWZpZXJHcm91cHMoKSB7CiAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3Vwcy5mb3JFYWNoKChncm91cCwgZ3JvdXBJbmRleCkgPT4gewogICAgICAgICAgICBjb25zdCBncm91cEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGdyb3VwRWwuY2xhc3NOYW1lID0gJ21vZGlmaWVyLWdyb3VwLXJvdyc7CiAgICAgICAgICAgIGdyb3VwRWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kaWZpZXItZ3JvdXAtaGVhZGVyIj4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9IiR7Z3JvdXAuZ3JvdXBOYW1lfSIgZGF0YS1ncm91cC1pbmRleD0iJHtncm91cEluZGV4fSIgY2xhc3M9Im1vZGlmaWVyLWdyb3VwLW5hbWUtZWRpdCI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tcmVtb3ZlIHJlbW92ZS1tb2RpZmllci1ncm91cCIgZGF0YS1ncm91cC1pbmRleD0iJHtncm91cEluZGV4fSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTMgNnYxOGgxOHYtMThoLTE4em01IDE0YzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNC0xOGgtMjB2LTJoNnYtMS41YzAtLjgyNy42NzMtMS41IDEuNS0xLjVoNWMuODI1IDAgMS41LjY3MSAxLjUgMS41djEuNWg2djJ6Ii8+PC9zdmc+CiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgCiAgICAgICAgICAgIGdyb3VwLm9wdGlvbnMuZm9yRWFjaCgob3B0aW9uLCBvcHRpb25JbmRleCkgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uUm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBvcHRpb25Sb3cuY2xhc3NOYW1lID0gJ21vZGlmaWVyLW9wdGlvbi1yb3cnOwogICAgICAgICAgICAgICAgb3B0aW9uUm93LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9IiR7b3B0aW9uLm5hbWV9IiBkYXRhLWdyb3VwLWluZGV4PSIke2dyb3VwSW5kZXh9IiBkYXRhLW9wdGlvbi1pbmRleD0iJHtvcHRpb25JbmRleH0iIGNsYXNzPSJtb2RpZmllci1vcHRpb24tbmFtZS1lZGl0Ij4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBzdGVwPSIwLjAxIiB2YWx1ZT0iJHtvcHRpb24ucHJpY2V9IiBkYXRhLWdyb3VwLWluZGV4PSIke2dyb3VwSW5kZXh9IiBkYXRhLW9wdGlvbi1pbmRleD0iJHtvcHRpb25JbmRleH0iIGNsYXNzPSJtb2RpZmllci1vcHRpb24tcHJpY2UtZWRpdCI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4tcmVtb3ZlIHJlbW92ZS1tb2RpZmllci1vcHRpb24iIGRhdGEtZ3JvdXAtaW5kZXg9IiR7Z3JvdXBJbmRleH0iIGRhdGEtb3B0aW9uLWluZGV4PSIke29wdGlvbkluZGV4fSI+Jm5kYXNoOzwvYnV0dG9uPgogICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgICAgIGdyb3VwRWwuYXBwZW5kQ2hpbGQob3B0aW9uUm93KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb25zdCBhZGRPcHRpb25CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLnR5cGUgPSAnYnV0dG9uJzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLnRleHRDb250ZW50ID0gJ0FkZCBPcHRpb24nOwogICAgICAgICAgICBhZGRPcHRpb25CdG4uY2xhc3NOYW1lID0gJ2J0bi1hZGQtZHluYW1pYyBhZGQtbW9kaWZpZXItb3B0aW9uJzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLmRhdGFzZXQuZ3JvdXBJbmRleCA9IGdyb3VwSW5kZXg7CiAgICAgICAgICAgIGdyb3VwRWwuYXBwZW5kQ2hpbGQoYWRkT3B0aW9uQnRuKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lci5hcHBlbmRDaGlsZChncm91cEVsKTsKICAgICAgICB9KTsKCiAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9InRleHQiXScpLmZvckVhY2goaW5wdXQgPT4gewogICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZSA9PiBlLnRhcmdldC52YWx1ZSA9IGNhcGl0YWxpemVXb3JkcyhlLnRhcmdldC52YWx1ZS50cmltKCkpKTsKICAgICAgICB9KTsKCiAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5hZGQtbW9kaWZpZXItb3B0aW9uJykuZm9yRWFjaChidG4gPT4gYnRuLm9uY2xpY2sgPSAoZSkgPT4gewogICAgICAgICAgICBzYXZlTW9kaWZpZXJzRnJvbU1vZGFsKGZhbHNlKTsgCiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3Vwc1tlLnRhcmdldC5kYXRhc2V0Lmdyb3VwSW5kZXhdLm9wdGlvbnMucHVzaCh7IG5hbWU6ICcnLCBwcmljZTogMCB9KTsKICAgICAgICAgICAgcmVuZGVyRXhpc3RpbmdNb2RpZmllckdyb3VwcygpOwogICAgICAgIH0pOwogICAgICAgIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcucmVtb3ZlLW1vZGlmaWVyLWdyb3VwJykuZm9yRWFjaChidG4gPT4gYnRuLm9uY2xpY2sgPSAoZSkgPT4gewogICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMuc3BsaWNlKGUuY3VycmVudFRhcmdldC5kYXRhc2V0Lmdyb3VwSW5kZXgsIDEpOwogICAgICAgICAgICByZW5kZXJFeGlzdGluZ01vZGlmaWVyR3JvdXBzKCk7CiAgICAgICAgfSk7CiAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZW1vdmUtbW9kaWZpZXItb3B0aW9uJykuZm9yRWFjaChidG4gPT4gYnRuLm9uY2xpY2sgPSAoZSkgPT4gewogICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHNbZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZ3JvdXBJbmRleF0ub3B0aW9ucy5zcGxpY2UoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQub3B0aW9uSW5kZXgsIDEpOwogICAgICAgICAgICByZW5kZXJFeGlzdGluZ01vZGlmaWVyR3JvdXBzKCk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2F2ZU1vZGlmaWVyc0Zyb21Nb2RhbChjbG9zZU1vZGFsID0gdHJ1ZSkgewogICAgICAgIGNvbnN0IHRlbXBHcm91cHMgPSBbXTsKICAgICAgICBjb25zdCBncm91cE5hbWVzID0gbmV3IFNldCgpOwogICAgICAgIGxldCBoYXNFcnJvciA9IGZhbHNlOwoKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm1vZGlmaWVyLWdyb3VwLXJvdycpLmZvckVhY2goKGdyb3VwRWwpID0+IHsKICAgICAgICAgICAgY29uc3QgZ3JvdXBOYW1lID0gc2FuaXRpemVJbnB1dChncm91cEVsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RpZmllci1ncm91cC1uYW1lLWVkaXQnKS52YWx1ZS50cmltKCkpOwogICAgICAgICAgICBpZiAoZ3JvdXBOYW1lICYmIGdyb3VwTmFtZXMuaGFzKGdyb3VwTmFtZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICAgICAgICAgICAgc2hvd01vZGFsKGBEdXBsaWNhdGUgbW9kaWZpZXIgZ3JvdXAgbmFtZSBmb3VuZDogIiR7Z3JvdXBOYW1lfSIuIFBsZWFzZSB1c2UgdW5pcXVlIG5hbWVzLmAsICJlcnJvciIpOwogICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChncm91cE5hbWUpIGdyb3VwTmFtZXMuYWRkKGdyb3VwTmFtZS50b0xvd2VyQ2FzZSgpKTsKCiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBbXTsKICAgICAgICAgICAgZ3JvdXBFbC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kaWZpZXItb3B0aW9uLXJvdycpLmZvckVhY2gob3B0aW9uRWwgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uTmFtZSA9IHNhbml0aXplSW5wdXQob3B0aW9uRWwucXVlcnlTZWxlY3RvcignLm1vZGlmaWVyLW9wdGlvbi1uYW1lLWVkaXQnKS52YWx1ZS50cmltKCkpOwogICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uUHJpY2UgPSBvcHRpb25FbC5xdWVyeVNlbGVjdG9yKCcubW9kaWZpZXItb3B0aW9uLXByaWNlLWVkaXQnKS52YWx1ZTsKICAgICAgICAgICAgICAgIGlmIChvcHRpb25OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5wdXNoKHsgbmFtZTogb3B0aW9uTmFtZSwgcHJpY2U6IHBhcnNlRmxvYXQob3B0aW9uUHJpY2UpIHx8IDAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAoZ3JvdXBOYW1lICYmIG9wdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdGVtcEdyb3Vwcy5wdXNoKHsgZ3JvdXBOYW1lLCBvcHRpb25zIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmIChoYXNFcnJvcikgcmV0dXJuOwoKICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMgPSB0ZW1wR3JvdXBzOwogICAgICAgIGlmIChjbG9zZU1vZGFsKSB7CiAgICAgICAgICAgIG1vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICBzaG93TW9kYWwoJ01vZGlmaWVyIGxpYnJhcnkgdXBkYXRlZC4nLCAnd2FybmluZycpOwogICAgICAgIH0KICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuQnVsa0xpbmtNb2RhbCgpIHsKICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZUxpbmtNb2RpZmllck1vZGFsQnRuJyk7CiAgICAgICAgY29uc3QgZHluYW1pY0FjdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHluYW1pY01vZGFsQWN0aW9ucycpOwogICAgICAgIGR5bmFtaWNBY3Rpb25zLmlubmVySFRNTCA9ICcnOyAvLyBDbGVhciBwcmV2aW91cyBidXR0b25zCiAgICAgICAgY2xvc2VCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsgLy8gSGlkZSBkZWZhdWx0IERvbmUgYnV0dG9uCiAgICAgICAgCiAgICAgICAgbGlua01vZGlmaWVyTW9kYWxUaXRsZS50ZXh0Q29udGVudCA9ICdCdWxrIExpbmsgTW9kaWZpZXJzJzsKICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLmlubmVySFRNTCA9ICcnOwoKICAgICAgICBjb25zdCBhbGxNb2RpZmllckdyb3VwcyA9IGN1cnJlbnRNb2RpZmllckdyb3VwczsKCiAgICAgICAgaWYgKGFsbE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyI+Tm8gbW9kaWZpZXIgZ3JvdXBzIGFyZSBkZWZpbmVkIGluIHRoZSBsaWJyYXJ5LjwvcD5gOwogICAgICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgY2FuY2VsQnRuLnRleHRDb250ZW50ID0gJ0Nsb3NlJzsKICAgICAgICAgICAgY2FuY2VsQnRuLmNsYXNzTmFtZSA9ICdidG4tZXhwb3J0JzsKICAgICAgICAgICAgY2FuY2VsQnRuLm9uY2xpY2sgPSAoKSA9PiBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIGR5bmFtaWNBY3Rpb25zLmFwcGVuZENoaWxkKGNhbmNlbEJ0bik7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsbE1vZGlmaWVyR3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gewogICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnbW9kaWZpZXItbGluay1pdGVtJzsKICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gYGJ1bGstbW9kLXNlbC0ke2dyb3VwLmdyb3VwTmFtZS5yZXBsYWNlKC9ccysvZywgJy0nKX1gOwogICAgICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0iJHtpZH0iIHZhbHVlPSIke2dyb3VwLmdyb3VwTmFtZX0iIGNsYXNzPSJidWxrLW1vZGlmaWVyLWNoZWNrYm94Ij4KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSIke2lkfSI+JHtncm91cC5ncm91cE5hbWV9PC9sYWJlbD4KICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGFwcGx5QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGFwcGx5QnRuLnRleHRDb250ZW50ID0gJ0FwcGx5IHRvIGFsbCB2YXJpYW50cyc7CiAgICAgICAgICAgIGFwcGx5QnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkJzsKICAgICAgICAgICAgYXBwbHlCdG4ub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkR3JvdXBzID0gQXJyYXkuZnJvbShsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5idWxrLW1vZGlmaWVyLWNoZWNrYm94OmNoZWNrZWQnKSkubWFwKGNiID0+IGNiLnZhbHVlKTsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZy5mb3JFYWNoKHByaWNlSXRlbSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50TGlua3MgPSBjdXJyZW50TW9kaWZpZXJMaW5rc1twcmljZUl0ZW0uY29tYmluYXRpb25dIHx8IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEdyb3Vwcy5mb3JFYWNoKGdyb3VwTmFtZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRMaW5rcy5pbmNsdWRlcyhncm91cE5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudExpbmtzLnB1c2goZ3JvdXBOYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckxpbmtzW3ByaWNlSXRlbS5jb21iaW5hdGlvbl0gPSBjdXJyZW50TGlua3M7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgIHNob3dNb2RhbChgU2VsZWN0ZWQgZ3JvdXBzIHdlcmUgbGlua2VkIHRvIGFsbCB2YXJpYW50cy5gLCAnd2FybmluZycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGlua01vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGR5bmFtaWNBY3Rpb25zLmFwcGVuZENoaWxkKGFwcGx5QnRuKTsKCiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSAnQ2FuY2VsJzsKICAgICAgICAgICAgY2FuY2VsQnRuLmNsYXNzTmFtZSA9ICdidG4tZXhwb3J0JzsKICAgICAgICAgICAgY2FuY2VsQnRuLm9uY2xpY2sgPSAoKSA9PiBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIGR5bmFtaWNBY3Rpb25zLmFwcGVuZENoaWxkKGNhbmNlbEJ0bik7CiAgICAgICAgfQoKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CgogICAgZnVuY3Rpb24gb3BlbkxpbmtNb2RpZmllck1vZGFsKHZhcmlhbnRDb21iaW5hdGlvbikgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZUxpbmtNb2RpZmllck1vZGFsQnRuJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R5bmFtaWNNb2RhbEFjdGlvbnMnKS5pbm5lckhUTUwgPSAnJzsKCiAgICAgICAgbGlua01vZGlmaWVyTW9kYWxUaXRsZS50ZXh0Q29udGVudCA9IGBMaW5rIE1vZGlmaWVycyBmb3I6ICR7dmFyaWFudENvbWJpbmF0aW9uIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0TmFtZScpLnZhbHVlIHx8ICd0aGlzIHByb2R1Y3QnfWA7CiAgICAgICAgbGlua01vZGlmaWVyTW9kYWwuZGF0YXNldC5hY3RpdmVWYXJpYW50ID0gdmFyaWFudENvbWJpbmF0aW9uOwogICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgY29uc3QgbGlua2VkR3JvdXBzID0gY3VycmVudE1vZGlmaWVyTGlua3NbdmFyaWFudENvbWJpbmF0aW9uXSB8fCBbXTsKCiAgICAgICAgaWYgKGN1cnJlbnRNb2RpZmllckdyb3Vwcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgbGlua01vZGlmaWVyTGlzdENvbnRhaW5lci5pbm5lckhUTUwgPSBgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsiPk5vIG1vZGlmaWVyIGdyb3VwcyBkZWZpbmVkLiBVc2UgdGhlIExpYnJhcnkgTWFuYWdlbWVudCBzZWN0aW9uIHRvIGNyZWF0ZSBzb21lLjwvcD5gOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gewogICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGl0ZW0uY2xhc3NOYW1lID0gJ21vZGlmaWVyLWxpbmstaXRlbSc7CiAgICAgICAgICAgIGNvbnN0IGlzQ2hlY2tlZCA9IGxpbmtlZEdyb3Vwcy5pbmNsdWRlcyhncm91cC5ncm91cE5hbWUpOwogICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWRHcm91cE5hbWUgPSBncm91cC5ncm91cE5hbWUucmVwbGFjZSgvXHMrL2csICctJyk7CiAgICAgICAgICAgIGl0ZW0uaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0ibW9kLSR7c2FuaXRpemVkR3JvdXBOYW1lfSIgdmFsdWU9IiR7Z3JvdXAuZ3JvdXBOYW1lfSIgJHtpc0NoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJ30+CiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJtb2QtJHtzYW5pdGl6ZWRHcm91cE5hbWV9Ij4ke2dyb3VwLmdyb3VwTmFtZX08L2xhYmVsPgogICAgICAgICAgICBgOwogICAgICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICAKICAgICAgICAgICAgaXRlbS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLm9uY2hhbmdlID0gKGUpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwTmFtZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRMaW5rcyA9IGN1cnJlbnRNb2RpZmllckxpbmtzW3ZhcmlhbnRDb21iaW5hdGlvbl0gfHwgW107CiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudExpbmtzLmluY2x1ZGVzKGdyb3VwTmFtZSkpIGN1cnJlbnRMaW5rcy5wdXNoKGdyb3VwTmFtZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5rcyA9IGN1cnJlbnRMaW5rcy5maWx0ZXIobmFtZSA9PiBuYW1lICE9PSBncm91cE5hbWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyTGlua3NbdmFyaWFudENvbWJpbmF0aW9uXSA9IGN1cnJlbnRMaW5rczsKICAgICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAgICAgbGlua01vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgfQoKICAgIC8vIC0tLSBWQVJJQU5UIFBSRVNFVCBMT0dJQyAtLS0KICAgIGZ1bmN0aW9uIGluaXRpYWxpemVEZWZhdWx0VmFyaWFudFByZXNldHMoKSB7CiAgICAgICAgdmFyaWFudFByZXNldHMgPSBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJQaXp6YSBTaXplcyIsCiAgICAgICAgICAgICAgICBncm91cHM6IFt7IGdyb3VwTmFtZTogIlNpemUiLCBvcHRpb25zOiBbeyBuYW1lOiAiU21hbGwiIH0sIHsgbmFtZTogIk1lZGl1bSIgfSwgeyBuYW1lOiAiTGFyZ2UiIH1dIH1dCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJNZWF0IENob2ljZSAoQnVyZ2VyL1NhbmR3aWNoKSIsCiAgICAgICAgICAgICAgICBncm91cHM6IFt7IGdyb3VwTmFtZTogIlByb3RlaW4iLCBvcHRpb25zOiBbeyBuYW1lOiAiQmVlZiIgfSwgeyBuYW1lOiAiQ2hpY2tlbiBCcmVhc3QiIH0sIHsgbmFtZTogIlZlZ2dpZSBQYXR0eSIgfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIkNvZmZlZSBPcHRpb25zIiwKICAgICAgICAgICAgICAgIGdyb3VwczogWwogICAgICAgICAgICAgICAgICAgIHsgZ3JvdXBOYW1lOiAiVHlwZSIsIG9wdGlvbnM6IFt7IG5hbWU6ICJDYWZmZWluYXRlZCIgfSwgeyBuYW1lOiAiRGVjYWZmZWluYXRlZCIgfV0gfSwKICAgICAgICAgICAgICAgICAgICB7IGdyb3VwTmFtZTogIk1pbGsiLCBvcHRpb25zOiBbeyBuYW1lOiAiRnVsbCBDcmVhbSIgfSwgeyBuYW1lOiAiTG93IEZhdCIgfSwgeyBuYW1lOiAiQWxtb25kIE1pbGsiIH0sIHsgbmFtZTogIk9hdCBNaWxrIiB9XSB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJXaW5lIFNlcnZpbmciLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJTZXJ2aW5nIiwgb3B0aW9uczogW3sgbmFtZTogIkdsYXNzICgxNzVtbCkiIH0sIHsgbmFtZTogIkJvdHRsZSIgfV0gfV0KICAgICAgICAgICAgfQogICAgICAgIF07CiAgICB9CgogICAgZnVuY3Rpb24gc2F2ZUN1cnJlbnRWYXJpYW50c0FzUHJlc2V0KCkgewogICAgICAgIGlmIChjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgc2hvd01vZGFsKCJBZGQgYXQgbGVhc3Qgb25lIHZhcmlhbnQgZ3JvdXAgYmVmb3JlIHNhdmluZyBhIHByZXNldC4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgc2hvd1Byb21wdE1vZGFsKCJFbnRlciBhIG5hbWUgZm9yIHRoaXMgbmV3IHZhcmlhbnQgcHJlc2V0OiIsIChwcmVzZXROYW1lKSA9PiB7CiAgICAgICAgICAgIGlmICh2YXJpYW50UHJlc2V0cy5zb21lKHAgPT4gcC5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHByZXNldE5hbWUudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChgQSBwcmVzZXQgbmFtZWQgIiR7cHJlc2V0TmFtZX0iIGFscmVhZHkgZXhpc3RzLmAsICJlcnJvciIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IG5ld1ByZXNldCA9IHsKICAgICAgICAgICAgICAgIG5hbWU6IHByZXNldE5hbWUsCiAgICAgICAgICAgICAgICBncm91cHM6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudFZhcmlhbnRHcm91cHMpKQogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXJpYW50UHJlc2V0cy5wdXNoKG5ld1ByZXNldCk7CiAgICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgICBzaG93TW9kYWwoYFByZXNldCAiJHtwcmVzZXROYW1lfSIgc2F2ZWQgc3VjY2Vzc2Z1bGx5LmAsICd3YXJuaW5nJyk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gb3BlbkFwcGx5VmFyaWFudFByZXNldE1vZGFsKCkgewogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseVZhcmlhbnRQcmVzZXRMaXN0Q29udGFpbmVyJyk7CiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnOwoKICAgICAgICBpZiAodmFyaWFudFByZXNldHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsiPk5vIHByZXNldHMgaGF2ZSBiZWVuIHNhdmVkIHlldC48L3A+YDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXJpYW50UHJlc2V0cy5mb3JFYWNoKHByZXNldCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBpdGVtLnN0eWxlID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZzogMTBweDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsnOwogICAgICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBgPHNwYW4+JHtwcmVzZXQubmFtZX08L3NwYW4+YDsKICAgICAgICAgICAgICAgIGNvbnN0IGFwcGx5QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi50ZXh0Q29udGVudCA9ICdBcHBseSc7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi5jbGFzc05hbWUgPSAnYnRuLWFkZCBidG4tYWRkLWR5bmFtaWMnOwogICAgICAgICAgICAgICAgYXBwbHlCdG4ub25jbGljayA9ICgpID0+IGFwcGx5VmFyaWFudFByZXNldChwcmVzZXQubmFtZSk7CiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKGFwcGx5QnRuKTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IHdhcm5pbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlWYXJpYW50UHJlc2V0V2FybmluZycpOwogICAgICAgIHdhcm5pbmcudGV4dENvbnRlbnQgPSBjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPiAwID8KICAgICAgICAgICAgJ1dhcm5pbmc6IEFwcGx5aW5nIGEgcHJlc2V0IHdpbGwgb3ZlcndyaXRlIHRoZSBjdXJyZW50IHZhcmlhbnRzIGluIHRoZSBmb3JtLicgOgogICAgICAgICAgICAnU2VsZWN0IGEgcHJlc2V0IHRvIGFwcGx5IHRvIHRoaXMgcHJvZHVjdC4nOwoKICAgICAgICBhcHBseVZhcmlhbnRQcmVzZXRNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlWYXJpYW50UHJlc2V0KHByZXNldE5hbWUpIHsKICAgICAgICBjb25zdCBwcmVzZXQgPSB2YXJpYW50UHJlc2V0cy5maW5kKHAgPT4gcC5uYW1lID09PSBwcmVzZXROYW1lKTsKICAgICAgICBpZiAoIXByZXNldCkgcmV0dXJuOwoKICAgICAgICBjb25zdCBhcHBseSA9ICgpID0+IHsKICAgICAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHByZXNldC5ncm91cHMpKTsKICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyTGlua3MgPSB7fTsgLy8gQ2xlYXIgbW9kaWZpZXIgbGlua3MgYXMgdmFyaWFudHMgaGF2ZSBjaGFuZ2VkCiAgICAgICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgICAgICAgICAgYXBwbHlWYXJpYW50UHJlc2V0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIH07CgogICAgICAgIGlmIChjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbChgQXBwbHkgdGhlICIke3ByZXNldE5hbWV9IiBwcmVzZXQ/IFRoaXMgd2lsbCBvdmVyd3JpdGUgeW91ciBjdXJyZW50IHZhcmlhbnRzLmAsICd3YXJuaW5nJywgYXBwbHksIHRydWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFwcGx5KCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG9wZW5NYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsKCkgewogICAgICAgIHJlbmRlck1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwoKTsKICAgICAgICBtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJNYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsKCkgewogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0VmFyaWFudFByZXNldHNDb250YWluZXInKTsKICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYgKHZhcmlhbnRQcmVzZXRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7Ij5ObyB2YXJpYW50IHByZXNldHMgc2F2ZWQgeWV0LjwvcD5gOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhcmlhbnRQcmVzZXRzLmZvckVhY2gocHJlc2V0ID0+IHsKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHJvdy5zdHlsZSA9ICdkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDEwcHg7JzsKICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICBpbnB1dC50eXBlID0gJ3RleHQnOwogICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHByZXNldC5uYW1lOwogICAgICAgICAgICBpbnB1dC5kYXRhc2V0Lm9yaWdpbmFsTmFtZSA9IHByZXNldC5uYW1lOwogICAgICAgICAgICBpbnB1dC5zdHlsZS5mbGV4R3JvdyA9ICcxJzsKICAgICAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5jbGFzc05hbWUgPSAnYnRuLXJlbW92ZSc7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5pbm5lckhUTUwgPSBgJm5kYXNoO2A7CiAgICAgICAgICAgIGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gZGVsZXRlVmFyaWFudFByZXNldChwcmVzZXQubmFtZSk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChpbnB1dCk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChkZWxldGVCdG4pOwogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYXZlVmFyaWFudFByZXNldHNGcm9tTWFuYWdlcigpIHsKICAgICAgICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZWRpdFZhcmlhbnRQcmVzZXRzQ29udGFpbmVyIGlucHV0Jyk7CiAgICAgICAgY29uc3QgbmV3UHJlc2V0cyA9IFtdOwogICAgICAgIGNvbnN0IG5hbWVzID0gbmV3IFNldCgpOwogICAgICAgIGxldCBoYXNFcnJvciA9IGZhbHNlOwoKICAgICAgICBpbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7CiAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBpbnB1dC52YWx1ZS50cmltKCk7CiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGlucHV0LmRhdGFzZXQub3JpZ2luYWxOYW1lOwogICAgICAgICAgICBpZiAoIW5ld05hbWUgfHwgbmFtZXMuaGFzKG5ld05hbWUudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChuZXdOYW1lID8gYER1cGxpY2F0ZSBwcmVzZXQgbmFtZTogIiR7bmV3TmFtZX0iYCA6ICJQcmVzZXQgbmFtZXMgY2Fubm90IGJlIGVtcHR5LiIsICJlcnJvciIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzLmFkZChuZXdOYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgICBjb25zdCBvcmlnaW5hbFByZXNldCA9IHZhcmlhbnRQcmVzZXRzLmZpbmQocCA9PiBwLm5hbWUgPT09IG9yaWdpbmFsTmFtZSk7CiAgICAgICAgICAgIGlmKG9yaWdpbmFsUHJlc2V0KSBuZXdQcmVzZXRzLnB1c2goeyBuYW1lOiBuZXdOYW1lLCBncm91cHM6IG9yaWdpbmFsUHJlc2V0Lmdyb3VwcyB9KTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGhhc0Vycm9yKSByZXR1cm47CgogICAgICAgIHZhcmlhbnRQcmVzZXRzID0gbmV3UHJlc2V0czsKICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICBtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBzaG93TW9kYWwoIlZhcmlhbnQgcHJlc2V0cyB1cGRhdGVkLiIsICJ3YXJuaW5nIik7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlVmFyaWFudFByZXNldChwcmVzZXROYW1lKSB7CiAgICAgICAgc2hvd01vZGFsKGBEZWxldGUgdGhlICIke3ByZXNldE5hbWV9IiB2YXJpYW50IHByZXNldD8gVGhpcyBjYW5ub3QgYmUgdW5kb25lLmAsICd3YXJuaW5nJywgKCkgPT4gewogICAgICAgICAgICB2YXJpYW50UHJlc2V0cyA9IHZhcmlhbnRQcmVzZXRzLmZpbHRlcihwID0+IHAubmFtZSAhPT0gcHJlc2V0TmFtZSk7CiAgICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgICByZW5kZXJNYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsKCk7CiAgICAgICAgfSwgdHJ1ZSk7CiAgICB9CgoKICAgIC8vIC0tLSBEQVRBIFBFUlNJU1RFTkNFICYgU1RBVEUgTUFOQUdFTUVOVCAtLS0KICAgIGZ1bmN0aW9uIHNhdmVTdGF0ZSgpIHsKICAgICAgY29uc3Qgc3RhdGUgPSB7IAogICAgICAgICAgcHJvZHVjdHMsIHBsdUNvdW50ZXIsIHNlc3Npb25TaXRlLCBzZXNzaW9uRGVmaW5lUGx1LCBkZWZhdWx0c1NldCwKICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcywgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCwgbGFzdFVzZWRDYXRlZ29yaWVzLAogICAgICAgICAgdmFyaWFudFByZXNldHMsIG1vZGlmaWVyUHJlc2V0cywKICAgICAgICAgIHNlc3Npb25UYXg6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXhBcHBsaWNhYmxlJykudmFsdWUsCiAgICAgICAgICBzZXNzaW9uUHJvZFR5cGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpLnZhbHVlCiAgICAgIH07CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9kdWN0RGF0YScsIEpTT04uc3RyaW5naWZ5KHN0YXRlKSk7CiAgICAgIHNob3dTYXZlU3RhdHVzKCk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9hZFN0YXRlKCkgewogICAgICBjb25zdCBzYXZlZERhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvZHVjdERhdGEnKTsKICAgICAgaWYgKHNhdmVkRGF0YSkgewogICAgICAgIGNvbnN0IHN0YXRlID0gSlNPTi5wYXJzZShzYXZlZERhdGEpOwogICAgICAgIHByb2R1Y3RzID0gc3RhdGUucHJvZHVjdHMgfHwgW107CiAgICAgICAgcGx1Q291bnRlciA9IHN0YXRlLnBsdUNvdW50ZXIgfHwgMTAwMDsKICAgICAgICBzZXNzaW9uU2l0ZSA9IHN0YXRlLnNlc3Npb25TaXRlIHx8ICcnOwogICAgICAgIHNlc3Npb25EZWZpbmVQbHUgPSBzdGF0ZS5zZXNzaW9uRGVmaW5lUGx1IHx8ICdubyc7CiAgICAgICAgZGVmYXVsdHNTZXQgPSBzdGF0ZS5kZWZhdWx0c1NldCB8fCBmYWxzZTsKICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMgPSBzdGF0ZS5jdXJyZW50TW9kaWZpZXJHcm91cHMgfHwgW107CiAgICAgICAgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCA9IHN0YXRlLnJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrZWQgIT09IGZhbHNlOwogICAgICAgIGxhc3RVc2VkQ2F0ZWdvcmllcyA9IHN0YXRlLmxhc3RVc2VkQ2F0ZWdvcmllcyB8fCB7IHByZXA6ICcnLCBtZW51OiAnJywgaW52OiAnJywgc3ViSW52OiAnJywgdW9tOiAnJyB9OwogICAgICAgIHZhcmlhbnRQcmVzZXRzID0gc3RhdGUudmFyaWFudFByZXNldHMgfHwgW107CiAgICAgICAgbW9kaWZpZXJQcmVzZXRzID0gc3RhdGUubW9kaWZpZXJQcmVzZXRzIHx8IFtdOwoKICAgICAgICBpZiAodmFyaWFudFByZXNldHMubGVuZ3RoID09PSAwKSBpbml0aWFsaXplRGVmYXVsdFZhcmlhbnRQcmVzZXRzKCk7CiAgICAgICAgaWYgKG1vZGlmaWVyUHJlc2V0cy5sZW5ndGggPT09IDApIGluaXRpYWxpemVEZWZhdWx0TW9kaWZpZXJQcmVzZXRzKCk7CgogICAgICAgIC8vIElmIHRoZSBjdXJyZW50IGxpYnJhcnkgaXMgZW1wdHksIHBvcHVsYXRlIGl0IGZyb20gcHJlc2V0cy4KICAgICAgICBpZiAoY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA9PT0gMCAmJiBtb2RpZmllclByZXNldHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCBjb21iaW5lZEdyb3VwcyA9IFtdOwogICAgICAgICAgICBjb25zdCBncm91cE5hbWVzID0gbmV3IFNldCgpOwogICAgICAgICAgICBtb2RpZmllclByZXNldHMuZm9yRWFjaChwcmVzZXQgPT4gewogICAgICAgICAgICAgICAgcHJlc2V0Lmdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBncm91cE5hbWVMb3dlciA9IGdyb3VwLmdyb3VwTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgIGlmIChncm91cC5ncm91cE5hbWUgJiYgIWdyb3VwTmFtZXMuaGFzKGdyb3VwTmFtZUxvd2VyKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb21iaW5lZEdyb3Vwcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZ3JvdXApKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwTmFtZXMuYWRkKGdyb3VwTmFtZUxvd2VyKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IGNvbWJpbmVkR3JvdXBzOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRlLnNlc3Npb25UYXgpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXhBcHBsaWNhYmxlJykudmFsdWUgPSBzdGF0ZS5zZXNzaW9uVGF4OwogICAgICAgIGlmIChzdGF0ZS5zZXNzaW9uUHJvZFR5cGUpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpLnZhbHVlID0gc3RhdGUuc2Vzc2lvblByb2RUeXBlOwogICAgICAgIHJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrYm94LmNoZWNrZWQgPSByZW1lbWJlckNhdGVnb3JpZXNDaGVja2VkOwoKICAgICAgICBpZiAoZGVmYXVsdHNTZXQpIAogICAgICAgIHsKICAgICAgICAgICAgc2Vzc2lvblNpdGVJbnB1dC52YWx1ZSA9IHNlc3Npb25TaXRlOwogICAgICAgICAgICBzZXNzaW9uRGVmaW5lUGx1U2VsZWN0LnZhbHVlID0gc2Vzc2lvbkRlZmluZVBsdTsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc2l0ZXMgPSBuZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHAuU2l0ZSkpOwogICAgICAgIGNvbnN0IHByZXBzID0gbmV3IFNldChwcm9kdWN0cy5tYXAocCA9PiBwWyJQcmVwYXJhdGlvbiBMb2NhdGlvbiJdKSk7CiAgICAgICAgY29uc3QgbWVudUNhdGVnb3JpZXMgPSBuZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHBbIk1lbnUgQ2F0ZWdvcnkiXSkpOwogICAgICAgIGNvbnN0IGludkNhdGVnb3JpZXMgPSBuZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHBbIkludmVudG9yeSBDYXRlZ29yeSJdKSk7CiAgICAgICAgY29uc3QgaW52U3ViQ2F0ZWdvcmllcyA9IG5ldyBTZXQocHJvZHVjdHMubWFwKHAgPT4gcFsiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSJdKSk7CiAgICAgICAgCiAgICAgICAgc2l0ZXMuZm9yRWFjaChzaXRlID0+IGFkZFRvRGF0YWxpc3QoInNpdGVMaXN0Iiwgc2l0ZSkpOwogICAgICAgIHByZXBzLmZvckVhY2gocHJlcCA9PiBhZGRUb0RhdGFsaXN0KCJwcmVwTGlzdCIsIHByZXApKTsKICAgICAgICBtZW51Q2F0ZWdvcmllcy5mb3JFYWNoKG1lbnUgPT4gYWRkVG9EYXRhbGlzdCgibWVudUxpc3QiLCBtZW51KSk7CiAgICAgICAgaW52Q2F0ZWdvcmllcy5mb3JFYWNoKGNhdCA9PiBhZGRUb0RhdGFsaXN0KCJpbnZlbnRvcnlDYXRlZ29yeUxpc3QiLCBjYXQpKTsKICAgICAgICBpbnZTdWJDYXRlZ29yaWVzLmZvckVhY2goc3ViID0+IGFkZFRvRGF0YWxpc3QoImludmVudG9yeVN1YkNhdGVnb3J5TGlzdCIsIHN1YikpOwogICAgICAgIHVwZGF0ZVRhYmxlKCk7CiAgICAgIH0gCiAgICAgIGVsc2UgewogICAgICAgIGluaXRpYWxpemVEZWZhdWx0VmFyaWFudFByZXNldHMoKTsKICAgICAgICBpbml0aWFsaXplRGVmYXVsdE1vZGlmaWVyUHJlc2V0cygpOwogICAgICAgIC8vIFBvcHVsYXRlIHRoZSBsaWJyYXJ5IGZyb20gdGhlIGRlZmF1bHQgcHJlc2V0cyBvbiBmaXJzdCBydW4KICAgICAgICBjb25zdCBjb21iaW5lZEdyb3VwcyA9IFtdOwogICAgICAgIGNvbnN0IGdyb3VwTmFtZXMgPSBuZXcgU2V0KCk7CiAgICAgICAgbW9kaWZpZXJQcmVzZXRzLmZvckVhY2gocHJlc2V0ID0+IHsKICAgICAgICAgICAgcHJlc2V0Lmdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwTmFtZUxvd2VyID0gZ3JvdXAuZ3JvdXBOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICBpZiAoZ3JvdXAuZ3JvdXBOYW1lICYmICFncm91cE5hbWVzLmhhcyhncm91cE5hbWVMb3dlcikpIHsKICAgICAgICAgICAgICAgICAgICBjb21iaW5lZEdyb3Vwcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZ3JvdXApKSk7CiAgICAgICAgICAgICAgICAgICAgZ3JvdXBOYW1lcy5hZGQoZ3JvdXBOYW1lTG93ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMgPSBjb21iaW5lZEdyb3VwczsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFyQWxsRGF0YSgpIHsKICAgICAgICBwcm9kdWN0cyA9IFtdOyBwbHVDb3VudGVyID0gMTAwMDsgc2Vzc2lvblNpdGUgPSAnJzsgc2Vzc2lvbkRlZmluZVBsdSA9ICdubyc7IGRlZmF1bHRzU2V0ID0gZmFsc2U7IAogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IFtdOyB2YXJpYW50UHJlc2V0cyA9IFtdOyBtb2RpZmllclByZXNldHMgPSBbXTsKICAgICAgICBsYXN0VXNlZENhdGVnb3JpZXMgPSB7IHByZXA6ICcnLCBtZW51OiAnJywgaW52OiAnJywgc3ViSW52OiAnJywgdW9tOiAnJyB9OwogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwcm9kdWN0RGF0YScpOwogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwcm9kdWN0TG9hZGVyVHV0b3JpYWxTaG93bicpOwogICAgICAgIHNlc3Npb25TaXRlSW5wdXQudmFsdWUgPSAnJzsgc2Vzc2lvbkRlZmluZVBsdVNlbGVjdC52YWx1ZSA9ICdubyc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RheEFwcGxpY2FibGUnKS52YWx1ZSA9ICcnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpLnZhbHVlID0gJyc7CiAgICAgICAgZWRpdFNlc3Npb25CdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBzZXNzaW9uRGVmYXVsdHNNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICAgICAgaW5pdGlhbGl6ZURlZmF1bHRWYXJpYW50UHJlc2V0cygpOwogICAgICAgIGluaXRpYWxpemVEZWZhdWx0TW9kaWZpZXJQcmVzZXRzKCk7CiAgICAgICAgdXBkYXRlVGFibGUoKTsKICAgIH0KCgogICAgLy8gLS0tIFVJIExPR0lDICYgRk9STSBIQU5ETElORyAtLS0KICAgIGZ1bmN0aW9uIHNob3dTYXZlU3RhdHVzKCkgewogICAgICAgIHNhdmVTdGF0dXMuc3R5bGUub3BhY2l0eSA9ICcxJzsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgc2F2ZVN0YXR1cy5zdHlsZS5vcGFjaXR5ID0gJzAnOyB9LCAyMDAwKTsKICAgIH0KICAgIGZ1bmN0aW9uIHNob3dNb2RhbChtZXNzYWdlLCB0eXBlID0gJ2Vycm9yJywgb25Db25maXJtID0gbnVsbCwgc2hvd0NhbmNlbCA9IGZhbHNlKSB7CiAgICAgICAgbW9kYWxNZXNzYWdlLmlubmVySFRNTCA9IG1lc3NhZ2U7CiAgICAgICAgY3VzdG9tTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQnKS5jbGFzc05hbWUgPSAnbW9kYWwtY29udGVudCAnICsgdHlwZTsKICAgICAgICBtb2RhbEFjdGlvbnMuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYgKG9uQ29uZmlybSkgewogICAgICAgICAgICBjb25zdCBjb25maXJtQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGNvbmZpcm1CdG4udGV4dENvbnRlbnQgPSAnQ29udGludWUnOyBjb25maXJtQnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkJzsKICAgICAgICAgICAgY29uZmlybUJ0bi5vbmNsaWNrID0gKCkgPT4geyBvbkNvbmZpcm0oKTsgY3VzdG9tTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOyB9OwogICAgICAgICAgICBtb2RhbEFjdGlvbnMuYXBwZW5kQ2hpbGQoY29uZmlybUJ0bik7CiAgICAgICAgfQogICAgICAgIGlmIChzaG93Q2FuY2VsIHx8ICFvbkNvbmZpcm0pIHsKICAgICAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgY2xvc2VCdG4udGV4dENvbnRlbnQgPSBvbkNvbmZpcm0gPyAnQ2FuY2VsJyA6ICdDbG9zZSc7IGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4tZXhwb3J0JzsKICAgICAgICAgICAgY2xvc2VCdG4ub25jbGljayA9ICgpID0+IGN1c3RvbU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICAgICAgbW9kYWxBY3Rpb25zLmFwcGVuZENoaWxkKGNsb3NlQnRuKTsKICAgICAgICB9CiAgICAgICAgY3VzdG9tTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgfQogICAgZnVuY3Rpb24gc2hvd1Byb21wdE1vZGFsKG1lc3NhZ2UsIG9uQ29uZmlybSkgewogICAgICAgIG1vZGFsTWVzc2FnZS5pbm5lckhUTUwgPSBgJHttZXNzYWdlfTxicj48aW5wdXQgdHlwZT0idGV4dCIgaWQ9InByb21wdElucHV0IiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgd2lkdGg6IDEwMCU7IiBwbGFjZWhvbGRlcj0iRW50ZXIgcHJlc2V0IG5hbWUuLi4iPmA7CiAgICAgICAgY3VzdG9tTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQnKS5jbGFzc05hbWUgPSAnbW9kYWwtY29udGVudCc7IC8vIFJlc2V0IGNsYXNzCiAgICAgICAgbW9kYWxBY3Rpb25zLmlubmVySFRNTCA9ICcnOwogICAgICAgIGNvbnN0IGNvbmZpcm1CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBjb25maXJtQnRuLnRleHRDb250ZW50ID0gJ1NhdmUnOyBjb25maXJtQnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkJzsKICAgICAgICBjb25maXJtQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGlucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9tcHRJbnB1dCcpOwogICAgICAgICAgICBjb25zdCBpbnB1dFZhbHVlID0gaW5wdXRFbGVtZW50LnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgaWYgKGlucHV0VmFsdWUpIHsKICAgICAgICAgICAgICAgIG9uQ29uZmlybShpbnB1dFZhbHVlKTsKICAgICAgICAgICAgICAgIGN1c3RvbU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpbnB1dC1pbnZhbGlkJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIG1vZGFsQWN0aW9ucy5hcHBlbmRDaGlsZChjb25maXJtQnRuKTsKCiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDYW5jZWwnOyBjbG9zZUJ0bi5jbGFzc05hbWUgPSAnYnRuLWV4cG9ydCc7CiAgICAgICAgY2xvc2VCdG4ub25jbGljayA9ICgpID0+IGN1c3RvbU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBtb2RhbEFjdGlvbnMuYXBwZW5kQ2hpbGQoY2xvc2VCdG4pOwogICAgICAgIGN1c3RvbU1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9tcHRJbnB1dCcpLmZvY3VzKCksIDEwMCk7CiAgICB9CiAgICBmdW5jdGlvbiBjb25maXJtQ2xlYXJBbGwoKSB7CiAgICAgICAgc2hvd01vZGFsKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIHByb2R1Y3RzLCBwcmVzZXRzLCBhbmQgc2Vzc2lvbiBkZWZhdWx0cz8nLCAnd2FybmluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGNsZWFyQWxsRGF0YSgpOyBzaG93TW9kYWwoJ0FsbCBkYXRhIGhhcyBiZWVuIGNsZWFyZWQuJywgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgfSwgdHJ1ZQogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0RGVmYXVsdHMoKSB7CiAgICBjb25zdCBzaXRlVmFsdWUgPSBzZXNzaW9uU2l0ZUlucHV0LnZhbHVlLnRyaW0oKTsKICAgIGlmIChzaXRlVmFsdWUgPT09ICIiKSB7IAogICAgICAgIHNob3dNb2RhbCgiUGxlYXNlIGVudGVyIGEgU2l0ZSBmb3IgdGhpcyBzZXNzaW9uLiIsICJlcnJvciIpOyAKICAgICAgICByZXR1cm47IAogICAgfQogICAgc2Vzc2lvblNpdGUgPSBzaXRlVmFsdWU7IAogICAgc2Vzc2lvbkRlZmluZVBsdSA9IHNlc3Npb25EZWZpbmVQbHVTZWxlY3QudmFsdWU7CiAgICBkZWZhdWx0c1NldCA9IHRydWU7IAogICAgCiAgICBzZXNzaW9uRGVmYXVsdHNNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICBlZGl0U2Vzc2lvbkJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAKICAgIGhhbmRsZVBsdVZpc2liaWxpdHkoKTsgCiAgICBzYXZlU3RhdGUoKTsKICAgIAogICAgLy8gU2hvdyB0dXRvcmlhbCBwcm9tcHQgaWYgaXQgaGFzbid0IGJlZW4gc2VlbiBiZWZvcmUKICAgIAogICAgICAgIGNvbnN0IHR1dG9yaWFsUHJvbXB0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJyk7CiAgICAgICAgaWYgKHR1dG9yaWFsUHJvbXB0TW9kYWwpIHsKICAgICAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUdob3N0VGV4dCgpIHsKICAgICAgICBjb25zdCB1b21WYWx1ZSA9IHVvbVNlbGVjdC52YWx1ZTsKICAgICAgICBjb25zdCBxdWFudGl0eVZhbHVlID0gc3VwcGxpZWRRdWFudGl0eUlucHV0LnZhbHVlOwogICAgICAgIGNvbnN0IGdob3N0VGV4dFNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVhbnRpdHlHaG9zdFRleHQnKTsKCiAgICAgICAgaWYgKHVvbVZhbHVlICYmIHF1YW50aXR5VmFsdWUpIHsKICAgICAgICAgICAgZ2hvc3RUZXh0U3Bhbi50ZXh0Q29udGVudCA9IHVvbU1hcFt1b21WYWx1ZV0gfHwgJyc7CiAgICAgICAgICAgIGdob3N0VGV4dFNwYW4uc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBnaG9zdFRleHRTcGFuLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiB1cGRhdGVZaWVsZEdob3N0VGV4dCgpIHsKICAgICAgICBjb25zdCB1b21WYWx1ZSA9IHVvbVNlbGVjdC52YWx1ZTsKICAgICAgICBjb25zdCBxdWFudGl0eVZhbHVlID0geWllbGRRdWFudGl0eUlucHV0LnZhbHVlOwogICAgICAgIGNvbnN0IGdob3N0VGV4dFNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRHaG9zdFRleHQnKTsKCiAgICAgICAgaWYgKHVvbVZhbHVlICYmIHF1YW50aXR5VmFsdWUpIHsKICAgICAgICAgICAgZ2hvc3RUZXh0U3Bhbi50ZXh0Q29udGVudCA9IHVvbU1hcFt1b21WYWx1ZV0gfHwgJyc7CiAgICAgICAgICAgIGdob3N0VGV4dFNwYW4uc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBnaG9zdFRleHRTcGFuLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBoYW5kbGVQbHVWaXNpYmlsaXR5KCkgewogICAgICAgIHBsdUVudHJ5R3JvdXAuc3R5bGUuZGlzcGxheSA9IChzZXNzaW9uRGVmaW5lUGx1ID09PSAneWVzJykgPyAnZmxleCcgOiAnbm9uZSc7CiAgICAgICAgY29uc3QgcGx1TGFiZWwgPSBwbHVFbnRyeUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJ2xhYmVsIC5sYWJlbC10ZXh0Jyk7CiAgICAgICAgY29uc3QgaGFzVmFyaWFudHMgPSBjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPiAwOwogICAgICAgIHBsdUxhYmVsLnRleHRDb250ZW50ID0gJ0N1c3RvbSBCYXNlIFBMVS9TS1UnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21QbHUiKS5wbGFjZWhvbGRlciA9ICdlLmcuLCBQSVpaQS1DSEUnOwogICAgfQogICAgZnVuY3Rpb24gdXBkYXRlUmVxdWlyZWRGaWVsZHMoKSB7CiAgICAgICAgY29uc3Qgc2VsZWN0ZWRUeXBlID0gcHJvZHVjdFR5cGVTZWxlY3QudmFsdWU7CiAgICAgICAgY29uc3QgaW52ZW50b3J5Q2F0ZWdvcnlMYWJlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnZlbnRvcnlDYXRlZ29yeUxhYmVsJykucXVlcnlTZWxlY3RvcignLmxhYmVsLXRleHQnKTsKICAgICAgICBjb25zdCBpbnZlbnRvcnlTdWJDYXRlZ29yeUxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludmVudG9yeVN1YkNhdGVnb3J5TGFiZWwnKS5xdWVyeVNlbGVjdG9yKCcubGFiZWwtdGV4dCcpOwogICAgICAgIGNvbnN0IGNvc3RQcmljZUxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvc3RQcmljZUxhYmVsJykucXVlcnlTZWxlY3RvcignLmxhYmVsLXRleHQnKTsKICAgICAgICBjb25zdCBzdXBwbGllZFF1YW50aXR5R3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VwcGxpZWRRdWFudGl0eUdyb3VwJyk7CiAgICAgICAgY29uc3Qgc3VwcGxpZWRRdWFudGl0eUxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1cHBsaWVkUXVhbnRpdHlMYWJlbCcpLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbC10ZXh0Jyk7CiAgICAgICAgY29uc3QgeWllbGRRdWFudGl0eUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkUXVhbnRpdHlHcm91cCcpOwogICAgICAgIGNvbnN0IHlpZWxkUXVhbnRpdHlMYWJlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZFF1YW50aXR5TGFiZWwnKS5xdWVyeVNlbGVjdG9yKCcubGFiZWwtdGV4dCcpOwogICAgICAgIGNvbnN0IHByZXBMb2NhdGlvbkdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXBMb2NhdGlvbkdyb3VwJyk7CiAgICAgICAgY29uc3QgbWVudUNhdGVnb3J5R3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudUNhdGVnb3J5R3JvdXAnKTsKICAgICAgICBjb25zdCBwcmVwTG9jYXRpb25JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVwTG9jYXRpb24nKTsKICAgICAgICBjb25zdCBtZW51Q2F0ZWdvcnlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51Q2F0ZWdvcnknKTsKICAgICAgICBjb25zdCBwdXJjaGFzZWRGb3JSZXNhbGVHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwdXJjaGFzZWRGb3JSZXNhbGVHcm91cCcpOwogICAgICAgIGNvbnN0IHVvbVNlbGVjdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VvbScpOwoKICAgICAgICBjb3N0UHJpY2VHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIHNlbGxpbmdQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgcHJlcExvY2F0aW9uR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICBtZW51Q2F0ZWdvcnlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIGludmVudG9yeUNhdGVnb3J5TGFiZWwuaW5uZXJIVE1MID0gYEludmVudG9yeSBDYXRlZ29yeWA7CiAgICAgICAgaW52ZW50b3J5U3ViQ2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IFN1Yi1DYXRlZ29yeWA7CiAgICAgICAgY29zdFByaWNlTGFiZWwuaW5uZXJIVE1MID0gYERlZmF1bHQgQ29zdCBQcmljZSAoZXguIFZhdClgOwogICAgICAgIHN1cHBsaWVkUXVhbnRpdHlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIHlpZWxkUXVhbnRpdHlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIHNpbmdsZVByb2R1Y3RNb2RpZmllckNvbnRyb2xzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgcHVyY2hhc2VkRm9yUmVzYWxlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCiAgICAgICAgaWYoY3VycmVudFZhcmlhbnRHcm91cHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHNpbmdsZVByb2R1Y3RNb2RpZmllckNvbnRyb2xzLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHNlbGxpbmdQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChzZWxlY3RlZFR5cGUgPT09ICdmaW5pc2hlZEdvb2QnKSB7CiAgICAgICAgICAgIGludmVudG9yeUNhdGVnb3J5TGFiZWwuaW5uZXJIVE1MID0gYEludmVudG9yeSBDYXRlZ29yeSAoTm90IFJlcXVpcmVkKWA7CiAgICAgICAgICAgIGludmVudG9yeVN1YkNhdGVnb3J5TGFiZWwuaW5uZXJIVE1MID0gYEludmVudG9yeSBTdWItQ2F0ZWdvcnkgKE5vdCBSZXF1aXJlZClgOwogICAgICAgICAgICB1b21TZWxlY3RFbC52YWx1ZSA9ICdlYSc7CiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZFR5cGUgPT09ICdyYXdNYXRlcmlhbCcpIHsKICAgICAgICAgICAgdW9tU2VsZWN0RWwudmFsdWUgPSAnJzsKICAgICAgICAgICAgc2VsbGluZ1ByaWNlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgcHJlcExvY2F0aW9uR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgcHJlcExvY2F0aW9uSW5wdXQudmFsdWUgPSAnJzsKICAgICAgICAgICAgbWVudUNhdGVnb3J5R3JvdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgbWVudUNhdGVnb3J5SW5wdXQudmFsdWUgPSAnJzsKICAgICAgICAgICAgaW52ZW50b3J5Q2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IENhdGVnb3J5IDxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPmA7CiAgICAgICAgICAgIGNvc3RQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICAgIGNvc3RQcmljZUxhYmVsLmlubmVySFRNTCA9IGBUb3RhbCBDb3N0IFByaWNlIChleC4gVmF0KSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgICAgICBzdXBwbGllZFF1YW50aXR5R3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgc3VwcGxpZWRRdWFudGl0eUxhYmVsLmlubmVySFRNTCA9IGBTdXBwbGllZCBRdWFudGl0eSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRUeXBlID09PSAnZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwnKSB7CiAgICAgICAgICAgIHVvbVNlbGVjdEVsLnZhbHVlID0gJyc7CiAgICAgICAgICAgIGludmVudG9yeUNhdGVnb3J5TGFiZWwuaW5uZXJIVE1MID0gYEludmVudG9yeSBDYXRlZ29yeSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgICAgICBjb3N0UHJpY2VHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICBjb3N0UHJpY2VMYWJlbC5pbm5lckhUTUwgPSBgVG90YWwgQ29zdCBQcmljZSAoZXguIFZhdCkgPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+YDsKICAgICAgICAgICAgc3VwcGxpZWRRdWFudGl0eUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICAgIHN1cHBsaWVkUXVhbnRpdHlMYWJlbC5pbm5lckhUTUwgPSBgU3VwcGxpZWQgUXVhbnRpdHkgPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+YDsKICAgICAgICAgICAgcHVyY2hhc2VkRm9yUmVzYWxlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc2VsZWN0ZWRUeXBlID09PSAnTWFudWZhY3R1cmVkJykgewogICAgICAgICAgICB1b21TZWxlY3RFbC52YWx1ZSA9ICcnOwogICAgICAgICAgICBzZWxsaW5nUHJpY2VHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBwcmVwTG9jYXRpb25Hcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBwcmVwTG9jYXRpb25JbnB1dC52YWx1ZSA9ICcnOwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlJbnB1dC52YWx1ZSA9ICcnOwogICAgICAgICAgICBpbnZlbnRvcnlDYXRlZ29yeUxhYmVsLmlubmVySFRNTCA9IGBJbnZlbnRvcnkgQ2F0ZWdvcnkgPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+YDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgdW9tU2VsZWN0RWwudmFsdWUgPSAnJzsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSBzZWxlY3RlZFR5cGUgPT09ICdyYXdNYXRlcmlhbCcgfHwgc2VsZWN0ZWRUeXBlID09PSAnTWFudWZhY3R1cmVkJzsKICAgICAgICBhZGRWYXJpYW50R3JvdXBCdG4uZGlzYWJsZWQgPSBpc0Rpc2FibGVkOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseVByZXNldEJ0bicpLmRpc2FibGVkID0gaXNEaXNhYmxlZDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZUFzUHJlc2V0QnRuJykuZGlzYWJsZWQgPSBpc0Rpc2FibGVkOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5rU2luZ2xlTW9kaWZpZXJCdG4nKS5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7CgogICAgICAgIHVwZGF0ZVNpbmdsZVByb2R1Y3RNb2RpZmllckluZGljYXRvcigpOwogICAgICAgIHNhdmVTdGF0ZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVNpbmdsZVByb2R1Y3RNb2RpZmllckluZGljYXRvcigpIHsKICAgICAgICBjb25zdCBpbmRpY2F0b3JXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpbmdsZU1vZGlmaWVySW5kaWNhdG9yJyk7CiAgICAgICAgaW5kaWNhdG9yV3JhcHBlci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBjb25zdCBjb3VudCA9IGN1cnJlbnRNb2RpZmllckxpbmtzWycnXT8ubGVuZ3RoIHx8IDA7CiAgICAgICAgCiAgICAgICAgaWYgKGNvdW50ID4gMCkgewogICAgICAgICAgICBjb25zdCB0b29sdGlwRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHRvb2x0aXBEaXYuY2xhc3NOYW1lID0gJ3Rvb2x0aXAgbW9kaWZpZXItaW5kaWNhdG9yLXdyYXBwZXInOwogICAgICAgICAgICBjb25zdCBpbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIGluZGljYXRvci5jbGFzc05hbWUgPSAnbW9kaWZpZXItaW5kaWNhdG9yJzsKICAgICAgICAgICAgaW5kaWNhdG9yLnRleHRDb250ZW50ID0gY291bnQ7CiAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgICAgICB0b29sdGlwVGV4dC5jbGFzc05hbWUgPSAndG9vbHRpcHRleHQnOwogICAgICAgICAgICB0b29sdGlwVGV4dC5pbm5lckhUTUwgPSAoY3VycmVudE1vZGlmaWVyTGlua3NbJyddIHx8IFtdKS5qb2luKCc8YnI+Jyk7CiAgICAgICAgICAgIHRvb2x0aXBEaXYuYXBwZW5kQ2hpbGQoaW5kaWNhdG9yKTsKICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZCh0b29sdGlwVGV4dCk7CiAgICAgICAgICAgIGluZGljYXRvcldyYXBwZXIuYXBwZW5kQ2hpbGQodG9vbHRpcERpdik7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gaGFuZGxlSW52ZW50b3J5Q2F0ZWdvcnlDaGFuZ2UoZXZlbnQpIHsKICAgICAgICBjb25zdCBzdWJDYXRlZ29yaWVzID0gY2F0ZWdvcnlNYXBbZXZlbnQudGFyZ2V0LnZhbHVlXTsKICAgICAgICBpZiAoc3ViQ2F0ZWdvcmllcykgeyBzdWJDYXRlZ29yaWVzLmZvckVhY2goc3ViID0+IGFkZFRvRGF0YWxpc3QoImludmVudG9yeVN1YkNhdGVnb3J5TGlzdCIsIHN1YikpOyB9CiAgICB9CiAgICBmdW5jdGlvbiBoYW5kbGVCYXJjb2RlVmlzaWJpbGl0eSgpIHsKICAgICAgICBiYXJjb2RlRW50cnlHcm91cC5zdHlsZS5kaXNwbGF5ID0gKGhhc0JhcmNvZGVTZWxlY3QudmFsdWUgPT09ICd5ZXMnKSA/ICdmbGV4JyA6ICdub25lJzsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRWYXJpYW50R3JvdXAoKSB7CiAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHMucHVzaCh7IGdyb3VwTmFtZTogJycsIG9wdGlvbnM6IFt7IG5hbWU6ICcnIH1dIH0pOwogICAgICAgIHVwZGF0ZVJlcXVpcmVkRmllbGRzKCk7CiAgICAgICAgcmVuZGVyVmFyaWFudEdyb3VwcygpOwogICAgfQogICAgZnVuY3Rpb24gcmVtb3ZlVmFyaWFudEdyb3VwKGdyb3VwSW5kZXgpIHsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwcy5zcGxpY2UoZ3JvdXBJbmRleCwgMSk7CiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICB9CiAgICBmdW5jdGlvbiBhZGRWYXJpYW50T3B0aW9uKGdyb3VwSW5kZXgpIHsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwc1tncm91cEluZGV4XS5vcHRpb25zLnB1c2goeyBuYW1lOiAnJyB9KTsKICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICB9CiAgICBmdW5jdGlvbiByZW1vdmVWYXJpYW50T3B0aW9uKGdyb3VwSW5kZXgsIG9wdGlvbkluZGV4KSB7CiAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHNbZ3JvdXBJbmRleF0ub3B0aW9ucy5zcGxpY2Uob3B0aW9uSW5kZXgsIDEpOwogICAgICAgIGlmIChjdXJyZW50VmFyaWFudEdyb3Vwc1tncm91cEluZGV4XS5vcHRpb25zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZW1vdmVWYXJpYW50R3JvdXAoZ3JvdXBJbmRleCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVuZGVyVmFyaWFudEdyb3VwcygpOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHJlbmRlclZhcmlhbnRHcm91cHMoKSB7CiAgICAgICAgdmFyaWFudEdyb3Vwc0NvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwcy5mb3JFYWNoKChncm91cCwgZ3JvdXBJbmRleCkgPT4gewogICAgICAgICAgICBjb25zdCBncm91cEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGdyb3VwRWwuY2xhc3NOYW1lID0gJ3ZhcmlhbnQtZ3JvdXAtcm93JzsKCiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBoZWFkZXIuY2xhc3NOYW1lID0gJ3ZhcmlhbnQtZ3JvdXAtaGVhZGVyJzsKICAgICAgICAgICAgY29uc3QgZ3JvdXBOYW1lSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICBncm91cE5hbWVJbnB1dC50eXBlID0gJ3RleHQnOwogICAgICAgICAgICBncm91cE5hbWVJbnB1dC5wbGFjZWhvbGRlciA9ICdHcm91cCBOYW1lIChlLmcuLCBTaXplKSc7CiAgICAgICAgICAgIGdyb3VwTmFtZUlucHV0LnZhbHVlID0gZ3JvdXAuZ3JvdXBOYW1lOwogICAgICAgICAgICBncm91cE5hbWVJbnB1dC5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLmdyb3VwTmFtZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICAgICAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGdyb3VwTmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSBjYXBpdGFsaXplV29yZHMoZS50YXJnZXQudmFsdWUudHJpbSgpKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoZ3JvdXBOYW1lSW5wdXQpOwogICAgICAgICAgICBjb25zdCByZW1vdmVHcm91cEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICByZW1vdmVHcm91cEJ0bi50eXBlID0gJ2J1dHRvbic7CiAgICAgICAgICAgIHJlbW92ZUdyb3VwQnRuLmNsYXNzTmFtZSA9ICdidG4tcmVtb3ZlJzsKICAgICAgICAgICAgcmVtb3ZlR3JvdXBCdG4uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTMgNnYxOGgxOHYtMThoLTE4em01IDE0YzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNC0xOGgtMjB2LTJoNnYtMS41YzAtLjgyNy42NzMtMS41IDEuNS0xLjVoNWMuODI1IDAgMS41LjY3MSAxLjUgMS41djEuNWg2djJ6Ii8+PC9zdmc+YDsKICAgICAgICAgICAgcmVtb3ZlR3JvdXBCdG4ub25jbGljayA9ICgpID0+IHJlbW92ZVZhcmlhbnRHcm91cChncm91cEluZGV4KTsKICAgICAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHJlbW92ZUdyb3VwQnRuKTsKICAgICAgICAgICAgZ3JvdXBFbC5hcHBlbmRDaGlsZChoZWFkZXIpOwoKICAgICAgICAgICAgY29uc3Qgb3B0aW9uc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBvcHRpb25zQ29udGFpbmVyLmNsYXNzTmFtZSA9ICd2YXJpYW50LW9wdGlvbnMtY29udGFpbmVyJzsKICAgICAgICAgICAgb3B0aW9uc0NvbnRhaW5lci5kYXRhc2V0Lmdyb3VwSW5kZXggPSBncm91cEluZGV4OwogICAgICAgICAgICAKICAgICAgICAgICAgZ3JvdXAub3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIG9wdGlvbkluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25Sb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIG9wdGlvblJvdy5jbGFzc05hbWUgPSAndmFyaWFudC1vcHRpb24tcm93JzsKICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbk5hbWVJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgICAgICBvcHRpb25OYW1lSW5wdXQudHlwZSA9ICd0ZXh0JzsKICAgICAgICAgICAgICAgIG9wdGlvbk5hbWVJbnB1dC5wbGFjZWhvbGRlciA9IGBPcHRpb24gJHtvcHRpb25JbmRleCArIDF9IE5hbWUgKGUuZy4sIFNtYWxsKWA7CiAgICAgICAgICAgICAgICBvcHRpb25OYW1lSW5wdXQudmFsdWUgPSBvcHRpb24ubmFtZTsKICAgICAgICAgICAgICAgIG9wdGlvbk5hbWVJbnB1dC5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwc1tncm91cEluZGV4XS5vcHRpb25zW29wdGlvbkluZGV4XS5uYW1lID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgb3B0aW9uTmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gY2FwaXRhbGl6ZVdvcmRzKGUudGFyZ2V0LnZhbHVlLnRyaW0oKSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG9wdGlvblJvdy5hcHBlbmRDaGlsZChvcHRpb25OYW1lSW5wdXQpOwogICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlT3B0aW9uQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgICAgICByZW1vdmVPcHRpb25CdG4udHlwZSA9ICdidXR0b24nOwogICAgICAgICAgICAgICAgcmVtb3ZlT3B0aW9uQnRuLmNsYXNzTmFtZSA9ICdidG4tcmVtb3ZlJzsKICAgICAgICAgICAgICAgIHJlbW92ZU9wdGlvbkJ0bi5pbm5lckhUTUwgPSBgJm5kYXNoO2A7CiAgICAgICAgICAgICAgICByZW1vdmVPcHRpb25CdG4ub25jbGljayA9ICgpID0+IHJlbW92ZVZhcmlhbnRPcHRpb24oZ3JvdXBJbmRleCwgb3B0aW9uSW5kZXgpOwogICAgICAgICAgICAgICAgb3B0aW9uUm93LmFwcGVuZENoaWxkKHJlbW92ZU9wdGlvbkJ0bik7CiAgICAgICAgICAgICAgICBvcHRpb25zQ29udGFpbmVyLmFwcGVuZENoaWxkKG9wdGlvblJvdyk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZ3JvdXBFbC5hcHBlbmRDaGlsZChvcHRpb25zQ29udGFpbmVyKTsKCiAgICAgICAgICAgIGNvbnN0IGFkZE9wdGlvbkJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBhZGRPcHRpb25CdG4udHlwZSA9ICdidXR0b24nOwogICAgICAgICAgICBhZGRPcHRpb25CdG4udGV4dENvbnRlbnQgPSAnQWRkIE9wdGlvbic7CiAgICAgICAgICAgIGFkZE9wdGlvbkJ0bi5jbGFzc05hbWUgPSAnYnRuLWFkZC1keW5hbWljJzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLnN0eWxlLmFsaWduU2VsZiA9ICdmbGV4LXN0YXJ0JzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSAnMjBweCc7CiAgICAgICAgICAgIGFkZE9wdGlvbkJ0bi5vbmNsaWNrID0gKCkgPT4gYWRkVmFyaWFudE9wdGlvbihncm91cEluZGV4KTsKICAgICAgICAgICAgZ3JvdXBFbC5hcHBlbmRDaGlsZChhZGRPcHRpb25CdG4pOwoKICAgICAgICAgICAgdmFyaWFudEdyb3Vwc0NvbnRhaW5lci5hcHBlbmRDaGlsZChncm91cEVsKTsKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBuZXcgU29ydGFibGUodmFyaWFudEdyb3Vwc0NvbnRhaW5lciwgewogICAgICAgICAgICBhbmltYXRpb246IDE1MCwKICAgICAgICAgICAgaGFuZGxlOiAnLnZhcmlhbnQtZ3JvdXAtcm93JywKICAgICAgICAgICAgb25FbmQ6IChldnQpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IG1vdmVkSXRlbSA9IGN1cnJlbnRWYXJpYW50R3JvdXBzLnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgICAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHMuc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgbW92ZWRJdGVtKTsKICAgICAgICAgICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudmFyaWFudC1vcHRpb25zLWNvbnRhaW5lcicpLmZvckVhY2goY29udGFpbmVyID0+IHsKICAgICAgICAgICAgbmV3IFNvcnRhYmxlKGNvbnRhaW5lciwgewogICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAxNTAsCiAgICAgICAgICAgICAgICBvbkVuZDogKGV2dCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwSW5kZXggPSBldnQuZnJvbS5kYXRhc2V0Lmdyb3VwSW5kZXg7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW92ZWRPcHRpb24gPSBjdXJyZW50VmFyaWFudEdyb3Vwc1tncm91cEluZGV4XS5vcHRpb25zLnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLm9wdGlvbnMuc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgbW92ZWRPcHRpb24pOwogICAgICAgICAgICAgICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIGdlbmVyYXRlQW5kUmVuZGVyUHJpY2luZygpOwogICAgICAgIGhhbmRsZVBsdVZpc2liaWxpdHkoKTsKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgfQogICAgZnVuY3Rpb24gZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCkgewogICAgICAgIGNvbnN0IHZhbGlkR3JvdXBzID0gY3VycmVudFZhcmlhbnRHcm91cHMuZmlsdGVyKGcgPT4gZy5ncm91cE5hbWUudHJpbSgpICYmIGcub3B0aW9ucy5zb21lKG8gPT4gby5uYW1lLnRyaW0oKSkpOwogICAgICAgIHByaWNpbmdDb2x1bW4uc3R5bGUuZGlzcGxheSA9ICh2YWxpZEdyb3Vwcy5sZW5ndGggPiAwKSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgdmFyaWFudFByaWNpbmdDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CgogICAgICAgIGlmICh2YWxpZEdyb3Vwcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgY3VycmVudFZhcmlhbnRQcmljaW5nID0gW107CiAgICAgICAgICAgIHVwZGF0ZVJlcXVpcmVkRmllbGRzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGFycmF5c1RvQ29tYmluZSA9IHZhbGlkR3JvdXBzLm1hcChnID0+IGcub3B0aW9ucy5maWx0ZXIobyA9PiBvLm5hbWUudHJpbSgpKS5tYXAobyA9PiAoeyBncm91cE5hbWU6IGcuZ3JvdXBOYW1lLnRyaW0oKSwgb3B0aW9uTmFtZTogby5uYW1lLnRyaW0oKSB9KSkpOwogICAgICAgIGNvbnN0IGNhcnRlc2lhbiA9ICguLi5hKSA9PiBhLnJlZHVjZSgoQSwgQikgPT4gQS5mbGF0TWFwKHggPT4gQi5tYXAoeSA9PiBbLi4ueCwgeV0pKSwgW1tdXSk7CiAgICAgICAgY29uc3QgY29tYmluYXRpb25zID0gY2FydGVzaWFuKC4uLmFycmF5c1RvQ29tYmluZSk7CgogICAgICAgIGNvbnN0IG5ld1ByaWNpbmdEYXRhID0gY29tYmluYXRpb25zLm1hcChjb21ibyA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNvbWJpbmF0aW9uU3RyaW5nID0gY29tYm8ubWFwKGMgPT4gYCR7Yy5ncm91cE5hbWV9OiAke2Mub3B0aW9uTmFtZX1gKS5qb2luKCc7ICcpOwogICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGN1cnJlbnRWYXJpYW50UHJpY2luZy5maW5kKHAgPT4gcC5jb21iaW5hdGlvbiA9PT0gY29tYmluYXRpb25TdHJpbmcpOwogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgY29tYmluYXRpb246IGNvbWJpbmF0aW9uU3RyaW5nLAogICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBleGlzdGluZyA/IGV4aXN0aW5nLnNlbGxpbmdQcmljZSA6ICcnLAogICAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZyA9IG5ld1ByaWNpbmdEYXRhOwogICAgICAgIAogICAgICAgIGNvbnN0IHByaWNpbmdIZWFkZXJMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7CiAgICAgICAgcHJpY2luZ0hlYWRlckxhYmVsLmNsYXNzTmFtZSA9ICd0b29sdGlwJzsKICAgICAgICBwcmljaW5nSGVhZGVyTGFiZWwuaW5uZXJIVE1MID0gYENvbWJpbmF0aW9uIFByaWNpbmcgPHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5TZXQgdGhlIHNlbGxpbmcgcHJpY2UgZm9yIGVhY2ggdW5pcXVlIGNvbWJpbmF0aW9uIG9mIHZhcmlhbnRzLjwvc3Bhbj5gOwogICAgICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyLmFwcGVuZENoaWxkKHByaWNpbmdIZWFkZXJMYWJlbCk7CgogICAgICAgIGNvbnN0IGRlZmF1bHRQcmljZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxsaW5nUHJpY2UnKS52YWx1ZTsKICAgICAgICBjb25zdCBwcmljaW5nQ29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBwcmljaW5nQ29udHJvbHMuY2xhc3NOYW1lID0gJ3ByaWNpbmctY29udHJvbHMnOwogICAgICAgIHByaWNpbmdDb250cm9scy5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7CiAgICAgICAgcHJpY2luZ0NvbnRyb2xzLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9ImJ1bGtQcmljZUlucHV0IiBwbGFjZWhvbGRlcj0iU2V0IHByaWNlIGZvciBhbGwiIHN0ZXA9IjAuMDEiIHZhbHVlPSIke2RlZmF1bHRQcmljZSB8fCAnJ30iPgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImFwcGx5QnVsa1ByaWNlQnRuIiBjbGFzcz0iYnRuLWFkZCBidG4tYWRkLWR5bmFtaWMiPkFwcGx5IHRvIGFsbDwvYnV0dG9uPgogICAgICAgIGA7CiAgICAgICAgdmFyaWFudFByaWNpbmdDb250YWluZXIuYXBwZW5kQ2hpbGQocHJpY2luZ0NvbnRyb2xzKTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5QnVsa1ByaWNlQnRuJykub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgY29uc3QgcHJpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVsa1ByaWNlSW5wdXQnKS52YWx1ZTsKICAgICAgICAgICAgaWYgKHByaWNlICE9PSAnJyAmJiAhaXNOYU4ocHJpY2UpKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50VmFyaWFudFByaWNpbmcuZm9yRWFjaChwID0+IHAuc2VsbGluZ1ByaWNlID0gcGFyc2VGbG9hdChwcmljZSkpOwogICAgICAgICAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBjdXJyZW50VmFyaWFudFByaWNpbmcuZm9yRWFjaCgocHJpY2VJdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9ICd2YXJpYW50LXByaWNpbmctcm93JzsKICAgICAgICAgICAgcm93LnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAnMmZyIDFmciBhdXRvJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IG5hbWVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgbmFtZUVsLmNsYXNzTmFtZSA9ICdjb21iby1uYW1lJzsKICAgICAgICAgICAgbmFtZUVsLnRleHRDb250ZW50ID0gcHJpY2VJdGVtLmNvbWJpbmF0aW9uOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3Qgc3BJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgIHNwSW5wdXQudHlwZSA9ICdudW1iZXInOyBzcElucHV0LnN0ZXAgPSAnMC4wMSc7IHNwSW5wdXQucGxhY2Vob2xkZXIgPSAnU2VsbGluZyBQcmljZSonOwogICAgICAgICAgICBzcElucHV0LnZhbHVlID0gcHJpY2VJdGVtLnNlbGxpbmdQcmljZTsKICAgICAgICAgICAgc3BJbnB1dC5vbmlucHV0ID0gKGUpID0+IGN1cnJlbnRWYXJpYW50UHJpY2luZ1tpbmRleF0uc2VsbGluZ1ByaWNlID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBhY3Rpb25zV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBhY3Rpb25zV3JhcHBlci5zdHlsZSA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsnOwoKICAgICAgICAgICAgY29uc3QgbGlua0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBsaW5rQnRuLnR5cGUgPSAnYnV0dG9uJzsKICAgICAgICAgICAgbGlua0J0bi50ZXh0Q29udGVudCA9ICdMaW5rIE1vZGlmaWVyJzsKICAgICAgICAgICAgbGlua0J0bi50aXRsZSA9ICdMaW5rIE1vZGlmaWVycyc7CiAgICAgICAgICAgIGxpbmtCdG4uY2xhc3NOYW1lID0gJ2J0bi1hZGQgYnRuLWFkZC1keW5hbWljJzsKICAgICAgICAgICAgbGlua0J0bi5vbmNsaWNrID0gKCkgPT4gb3BlbkxpbmtNb2RpZmllck1vZGFsKHByaWNlSXRlbS5jb21iaW5hdGlvbik7CiAgICAgICAgICAgIAogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQobmFtZUVsKTsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKHNwSW5wdXQpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgbGlua2VkTW9kaWZpZXJzID0gY3VycmVudE1vZGlmaWVyTGlua3NbcHJpY2VJdGVtLmNvbWJpbmF0aW9uXSB8fCBbXTsKICAgICAgICAgICAgaWYgKGxpbmtlZE1vZGlmaWVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjb25zdCB0b29sdGlwRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmNsYXNzTmFtZSA9ICd0b29sdGlwIG1vZGlmaWVyLWluZGljYXRvci13cmFwcGVyJzsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgICAgIGluZGljYXRvci5jbGFzc05hbWUgPSAnbW9kaWZpZXItaW5kaWNhdG9yJzsKICAgICAgICAgICAgICAgIGluZGljYXRvci50ZXh0Q29udGVudCA9IGxpbmtlZE1vZGlmaWVycy5sZW5ndGg7CiAgICAgICAgICAgICAgICBjb25zdCB0b29sdGlwVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgICAgIHRvb2x0aXBUZXh0LmNsYXNzTmFtZSA9ICd0b29sdGlwdGV4dCc7CiAgICAgICAgICAgICAgICB0b29sdGlwVGV4dC5pbm5lckhUTUwgPSBsaW5rZWRNb2RpZmllcnMuam9pbignPGJyPicpOwogICAgICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZChpbmRpY2F0b3IpOwogICAgICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZCh0b29sdGlwVGV4dCk7CiAgICAgICAgICAgICAgICBhY3Rpb25zV3JhcHBlci5hcHBlbmRDaGlsZCh0b29sdGlwRGl2KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgYWN0aW9uc1dyYXBwZXIuYXBwZW5kQ2hpbGQobGlua0J0bik7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChhY3Rpb25zV3JhcHBlcik7CiAgICAgICAgICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyLmFwcGVuZENoaWxkKHJvdyk7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChjdXJyZW50TW9kaWZpZXJHcm91cHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCBidWxrU2V0dGluZ1dyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgYnVsa1NldHRpbmdXcmFwcGVyLnN0eWxlID0gJ21hcmdpbi10b3A6IDIwcHg7IHBhZGRpbmctdG9wOiAyMHB4OyBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyc7CiAgICAgICAgICAgIGNvbnN0IGJ1bGtMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7CiAgICAgICAgICAgIGJ1bGtMYWJlbC5jbGFzc05hbWUgPSAndG9vbHRpcCc7CiAgICAgICAgICAgIGJ1bGtMYWJlbC5pbm5lckhUTUwgPSBgQnVsayBNb2RpZmllciBTZXR0aW5nIDxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+QXBwbHkgb25lIG9yIG1vcmUgbW9kaWZpZXIgZ3JvdXBzIHRvIGFsbCB2YXJpYW50cyBvZiB0aGlzIHByb2R1Y3QuPC9zcGFuPmA7CiAgICAgICAgICAgIGJ1bGtTZXR0aW5nV3JhcHBlci5hcHBlbmRDaGlsZChidWxrTGFiZWwpOwoKICAgICAgICAgICAgY29uc3QgYnVsa0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBidWxrQnRuLnRleHRDb250ZW50ID0gJ0FwcGx5IEJ1bGsgTW9kaWZpZXInOwogICAgICAgICAgICBidWxrQnRuLnR5cGUgPSAnYnV0dG9uJzsKICAgICAgICAgICAgYnVsa0J0bi5jbGFzc05hbWUgPSAnYnRuLWFkZCBidG4tYWRkLWR5bmFtaWMnOwogICAgICAgICAgICBidWxrQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsKICAgICAgICAgICAgYnVsa0J0bi5vbmNsaWNrID0gKCkgPT4gb3BlbkJ1bGtMaW5rTW9kYWwoKTsKICAgICAgICAgICAgYnVsa1NldHRpbmdXcmFwcGVyLmFwcGVuZENoaWxkKGJ1bGtCdG4pOwogICAgICAgICAgICB2YXJpYW50UHJpY2luZ0NvbnRhaW5lci5hcHBlbmRDaGlsZChidWxrU2V0dGluZ1dyYXBwZXIpOwogICAgICAgIH0KCiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgIH0KCgogICAgLy8gLS0tIE1BSU4gRk9STSBBQ1RJT05TLCBQUk9EVUNUIEhBTkRMSU5HIC0tLQogICAgZnVuY3Rpb24gaGFuZGxlTWFpbkFjdGlvbigpIHsKICAgICAgICBjbGVhckFsbFZhbGlkYXRpb25FcnJvcnMoKTsKICAgICAgICBjb25zdCBlcnJvcnMgPSB2YWxpZGF0ZUZvcm0odHJ1ZSk7CiAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7IAogICAgICAgICAgICBzaG93TW9kYWwoIlBsZWFzZSBmaXggdGhlIGVycm9ycyBoaWdobGlnaHRlZCBvbiB0aGUgZm9ybS4iLCAiZXJyb3IiKTsgCiAgICAgICAgICAgIHJldHVybjsgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IGVkaXRpbmdJbmRleCA9IHBhcnNlSW50KGVkaXRpbmdJbmRleElucHV0LnZhbHVlLCAxMCk7CiAgICAgICAgaWYgKGVkaXRpbmdJbmRleCA+IC0xKSB7CiAgICAgICAgICAgIHVwZGF0ZVByb2R1Y3QoZWRpdGluZ0luZGV4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhZGRQcm9kdWN0KCk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gdmFsaWRhdGVGb3JtKHNob3dJbmxpbmVFcnJvcnMgPSBmYWxzZSkgewogICAgICAgIGNvbnN0IGdldEVsID0gKGlkKSA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSB7CiAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBnZXRFbCgicHJvZHVjdE5hbWUiKSwgdW9tOiBnZXRFbCgidW9tIiksIHByZXBMb2NhdGlvbjogZ2V0RWwoInByZXBMb2NhdGlvbiIpLAogICAgICAgICAgICBtZW51Q2F0ZWdvcnk6IGdldEVsKCJtZW51Q2F0ZWdvcnkiKSwgcHJvZHVjdFR5cGU6IGdldEVsKCJwcm9kdWN0VHlwZSIpLCBpbnZDYXRlZ29yeTogZ2V0RWwoImludmVudG9yeUNhdGVnb3J5IiksCiAgICAgICAgICAgIHN1cHBsaWVkUXVhbnRpdHk6IGdldEVsKCJzdXBwbGllZFF1YW50aXR5IiksIHlpZWxkUXVhbnRpdHk6IGdldEVsKCJ5aWVsZFF1YW50aXR5IiksIGNvc3RQcmljZTogZ2V0RWwoImNvc3RQcmljZSIpLAogICAgICAgICAgICBzZWxsaW5nUHJpY2U6IGdldEVsKCJzZWxsaW5nUHJpY2UiKSwgdGF4QXBwbGljYWJsZTogZ2V0RWwoInRheEFwcGxpY2FibGUiKSwgYmFyY29kZTogZ2V0RWwoImJhcmNvZGUiKSwKICAgICAgICAgICAgY3VzdG9tUGx1OiBnZXRFbCgiY3VzdG9tUGx1IiksCiAgICAgICAgfTsKICAgICAgICAKICAgICAgICBjb25zdCB2YWx1ZXMgPSB7CiAgICAgICAgICAgIGJhc2VQcm9kdWN0TmFtZTogZWxlbWVudHMucHJvZHVjdE5hbWUudmFsdWUudHJpbSgpLCB1b206IGVsZW1lbnRzLnVvbS52YWx1ZSwgcHJlcDogZWxlbWVudHMucHJlcExvY2F0aW9uLnZhbHVlLnRyaW0oKSwKICAgICAgICAgICAgbWVudTogZWxlbWVudHMubWVudUNhdGVnb3J5LnZhbHVlLnRyaW0oKSwgcHJvZHVjdFR5cGU6IGVsZW1lbnRzLnByb2R1Y3RUeXBlLnZhbHVlLCBpbnZDYXQ6IGVsZW1lbnRzLmludkNhdGVnb3J5LnZhbHVlLnRyaW0oKSwKICAgICAgICAgICAgc3VwcGxpZWRRdWFudGl0eTogZWxlbWVudHMuc3VwcGxpZWRRdWFudGl0eS52YWx1ZS50cmltKCksIHlpZWxkUXVhbnRpdHk6IGVsZW1lbnRzLnlpZWxkUXVhbnRpdHkudmFsdWUudHJpbSgpLAogICAgICAgICAgICBkZWZhdWx0Q29zdDogcGFyc2VGbG9hdChlbGVtZW50cy5jb3N0UHJpY2UudmFsdWUpLCBkZWZhdWx0UHJpY2U6IHBhcnNlRmxvYXQoZWxlbWVudHMuc2VsbGluZ1ByaWNlLnZhbHVlKSwKICAgICAgICAgICAgdGF4QXBwbGljYWJsZTogZWxlbWVudHMudGF4QXBwbGljYWJsZS52YWx1ZSwgaGFzQmFyY29kZTogaGFzQmFyY29kZVNlbGVjdC52YWx1ZSwgYmFyY29kZTogZWxlbWVudHMuYmFyY29kZS52YWx1ZS50cmltKCksCiAgICAgICAgICAgIGN1c3RvbVBsdTogZWxlbWVudHMuY3VzdG9tUGx1LnZhbHVlLnRyaW0oKSwKICAgICAgICB9OwoKICAgICAgICBjb25zdCBlZGl0aW5nSW5kZXggPSBwYXJzZUludChlZGl0aW5nSW5kZXhJbnB1dC52YWx1ZSwgMTApOwogICAgICAgIGxldCBlcnJvcnMgPSBbXTsKICAgICAgICBjb25zdCBjaGVjayA9IChjb25kaXRpb24sIGVsZW1lbnQsIG1lc3NhZ2UpID0+IHsKICAgICAgICAgICAgaWYgKGNvbmRpdGlvbikgewogICAgICAgICAgICAgICAgZXJyb3JzLnB1c2gobWVzc2FnZSk7CiAgICAgICAgICAgICAgICBpZiAoc2hvd0lubGluZUVycm9ycykgc2hvd1ZhbGlkYXRpb25FcnJvcihlbGVtZW50LCBtZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGNoZWNrKHZhbHVlcy5iYXNlUHJvZHVjdE5hbWUgPT09ICIiLCBlbGVtZW50cy5wcm9kdWN0TmFtZSwgIlByb2R1Y3QgTmFtZSBpcyByZXF1aXJlZC4iKTsKICAgICAgICBjaGVjayghdmFsdWVzLnVvbSwgZWxlbWVudHMudW9tLCAiU2VsbGluZyBVT00gaXMgcmVxdWlyZWQuIik7CiAgICAgICAgY2hlY2soIXZhbHVlcy5wcm9kdWN0VHlwZSwgZWxlbWVudHMucHJvZHVjdFR5cGUsICJQcm9kdWN0IFR5cGUgaXMgcmVxdWlyZWQuIik7CiAgICAgICAgY2hlY2soIXZhbHVlcy50YXhBcHBsaWNhYmxlLCBlbGVtZW50cy50YXhBcHBsaWNhYmxlLCAiVGF4IEFwcGxpY2FibGUgaXMgcmVxdWlyZWQuIik7CiAgICAgICAgCiAgICAgICAgaWYgKHZhbHVlcy5wcm9kdWN0VHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCcgfHwgdmFsdWVzLnByb2R1Y3RUeXBlID09PSAnZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwnKSB7CiAgICAgICAgICAgIGNoZWNrKHZhbHVlcy5wcmVwID09PSAiIiwgZWxlbWVudHMucHJlcExvY2F0aW9uLCAiUHJlcGFyYXRpb24gTG9jYXRpb24gaXMgcmVxdWlyZWQuIik7CiAgICAgICAgICAgIGNoZWNrKHZhbHVlcy5tZW51ID09PSAiIiwgZWxlbWVudHMubWVudUNhdGVnb3J5LCAiTWVudSBDYXRlZ29yeSBpcyByZXF1aXJlZC4iKTsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlcy5wcm9kdWN0VHlwZSA9PT0gJ3Jhd01hdGVyaWFsJyB8fCB2YWx1ZXMucHJvZHVjdFR5cGUgPT09ICdmaW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbCcpIHsKICAgICAgICAgICAgY2hlY2sodmFsdWVzLmludkNhdCA9PT0gIiIsIGVsZW1lbnRzLmludkNhdGVnb3J5LCAiSW52ZW50b3J5IENhdGVnb3J5IGlzIHJlcXVpcmVkLiIpOwogICAgICAgICAgICBjaGVjayh2YWx1ZXMuc3VwcGxpZWRRdWFudGl0eSA9PT0gIiIsIGVsZW1lbnRzLnN1cHBsaWVkUXVhbnRpdHksICJTdXBwbGllZCBRdWFudGl0eSBpcyByZXF1aXJlZC4iKTsKICAgICAgICAgICAgY2hlY2soaXNOYU4odmFsdWVzLmRlZmF1bHRDb3N0KSwgZWxlbWVudHMuY29zdFByaWNlLCAiVG90YWwgQ29zdCBQcmljZSBpcyByZXF1aXJlZC4iKTsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlcy5wcm9kdWN0VHlwZSA9PT0gJ01hbnVmYWN0dXJlZCcpIHsKICAgICAgICAgICAgIGNoZWNrKHZhbHVlcy5pbnZDYXQgPT09ICIiLCBlbGVtZW50cy5pbnZDYXRlZ29yeSwgIkludmVudG9yeSBDYXRlZ29yeSBpcyByZXF1aXJlZC4iKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA9PT0gMCAmJiAodmFsdWVzLnByb2R1Y3RUeXBlID09PSAnZmluaXNoZWRHb29kJyB8fCB2YWx1ZXMucHJvZHVjdFR5cGUgPT09ICdmaW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbCcpKSB7CiAgICAgICAgICAgIGNoZWNrKGlzTmFOKHZhbHVlcy5kZWZhdWx0UHJpY2UpLCBlbGVtZW50cy5zZWxsaW5nUHJpY2UsICJBIERlZmF1bHQgU2VsbGluZyBQcmljZSBpcyByZXF1aXJlZCBpZiBubyB2YXJpYW50cyBhcmUgYWRkZWQuIik7CiAgICAgICAgfQoKICAgICAgICBjaGVjayh2YWx1ZXMuaGFzQmFyY29kZSA9PT0gJ3llcycgJiYgdmFsdWVzLmJhcmNvZGUgPT09ICIiLCBlbGVtZW50cy5iYXJjb2RlLCAiQmFyY29kZSBpcyByZXF1aXJlZC4iKTsKICAgICAgICBjaGVjayhzZXNzaW9uRGVmaW5lUGx1ID09PSAneWVzJyAmJiB2YWx1ZXMuY3VzdG9tUGx1ID09PSAiIiwgZWxlbWVudHMuY3VzdG9tUGx1LCAiQ3VzdG9tIEJhc2UgUExVL1NLVSBpcyByZXF1aXJlZC4iKTsKICAgICAgICAKICAgICAgICBjb25zdCBlZGl0aW5nR3JvdXBJZCA9IGVkaXRpbmdJbmRleCA+IC0xID8gcHJvZHVjdHNbZWRpdGluZ0luZGV4XS5wcm9kdWN0R3JvdXBJZCA6IG51bGw7CiAgICAgICAgY29uc3QgcGx1RXhpc3RzID0gcHJvZHVjdHMuc29tZShwID0+IHAucHJvZHVjdEdyb3VwSWQgPT09IHZhbHVlcy5jdXN0b21QbHUgJiYgcC5wcm9kdWN0R3JvdXBJZCAhPT0gZWRpdGluZ0dyb3VwSWQpOwogICAgICAgIGNoZWNrKHNlc3Npb25EZWZpbmVQbHUgPT09ICd5ZXMnICYmIHBsdUV4aXN0cywgZWxlbWVudHMuY3VzdG9tUGx1LCBgQmFzZSBQTFUvU0tVICIke3ZhbHVlcy5jdXN0b21QbHV9IiBhbHJlYWR5IGV4aXN0cy5gKTsKCiAgICAgICAgY29uc3QgaXNEdXBsaWNhdGUgPSBwcm9kdWN0cy5zb21lKHAgPT4gcC5fc291cmNlICYmIHAucHJvZHVjdEdyb3VwSWQgIT09IGVkaXRpbmdHcm91cElkICYmCiAgICAgICAgICAgIHAuX3NvdXJjZS5wcm9kdWN0TmFtZS50b0xvd2VyQ2FzZSgpID09PSB2YWx1ZXMuYmFzZVByb2R1Y3ROYW1lLnRvTG93ZXJDYXNlKCkgJiYKICAgICAgICAgICAgcC5fc291cmNlLnByb2R1Y3RUeXBlID09PSB2YWx1ZXMucHJvZHVjdFR5cGUpOwogICAgICAgIGNoZWNrKGlzRHVwbGljYXRlLCBlbGVtZW50cy5wcm9kdWN0TmFtZSwgYEEgcHJvZHVjdCBuYW1lZCAiJHt2YWx1ZXMuYmFzZVByb2R1Y3ROYW1lfSIgd2l0aCB0eXBlICIke3ZhbHVlcy5wcm9kdWN0VHlwZX0iIGFscmVhZHkgZXhpc3RzLmApOwogICAgICAgICAgICAKICAgICAgICByZXR1cm4gZXJyb3JzOwogICAgfQoKICAgIGZ1bmN0aW9uIGdhdGhlclByb2R1Y3REYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0TmFtZSIpLnZhbHVlLnRyaW0oKSksCiAgICAgICAgICAgIHRheEFwcGxpY2FibGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0YXhBcHBsaWNhYmxlIikudmFsdWUsCiAgICAgICAgICAgIHByb2R1Y3RUeXBlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZHVjdFR5cGUiKS52YWx1ZSwKICAgICAgICAgICAgdW9tOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidW9tIikudmFsdWUsCiAgICAgICAgICAgIHByZXBMb2NhdGlvbjogc2FuaXRpemVJbnB1dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJlcExvY2F0aW9uIikudmFsdWUudHJpbSgpKSwKICAgICAgICAgICAgbWVudUNhdGVnb3J5OiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZW51Q2F0ZWdvcnkiKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICBpbnZDYXRlZ29yeTogc2FuaXRpemVJbnB1dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW52ZW50b3J5Q2F0ZWdvcnkiKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICBpbnZTdWJDYXRlZ29yeTogc2FuaXRpemVJbnB1dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW52ZW50b3J5U3ViQ2F0ZWdvcnkiKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICBzdXBwbGllZFF1YW50aXR5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3VwcGxpZWRRdWFudGl0eSIpLnZhbHVlLnRyaW0oKSwKICAgICAgICAgICAgeWllbGRRdWFudGl0eTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInlpZWxkUXVhbnRpdHkiKS52YWx1ZS50cmltKCksCiAgICAgICAgICAgIGRlZmF1bHRDb3N0OiBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb3N0UHJpY2UiKS52YWx1ZSkgfHwgMCwKICAgICAgICAgICAgZGVmYXVsdFByaWNlOiBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWxsaW5nUHJpY2UiKS52YWx1ZSkgfHwgMCwKICAgICAgICAgICAgaGFzQmFyY29kZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhhc0JhcmNvZGUiKS52YWx1ZSwKICAgICAgICAgICAgYmFyY29kZTogc2FuaXRpemVJbnB1dCgoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhhc0JhcmNvZGUiKS52YWx1ZSA9PT0gJ3llcycpID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhcmNvZGUiKS52YWx1ZS50cmltKCkgOiAiIiksCiAgICAgICAgICAgIGN1c3RvbVBsdTogc2FuaXRpemVJbnB1dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY3VzdG9tUGx1IikudmFsdWUudHJpbSgpKSwKICAgICAgICAgICAgaXNQdXJjaGFzZWRGb3JSZXNhbGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpc1B1cmNoYXNlZEZvclJlc2FsZSIpLmNoZWNrZWQsCiAgICAgICAgICAgIHZhcmlhbnRHcm91cHM6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudFZhcmlhbnRHcm91cHMpKSwKICAgICAgICAgICAgdmFyaWFudFByaWNpbmc6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudFZhcmlhbnRQcmljaW5nKSksCiAgICAgICAgICAgIG1vZGlmaWVyR3JvdXBzOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGN1cnJlbnRNb2RpZmllckdyb3VwcykpLAogICAgICAgICAgICBtb2RpZmllckxpbmtzOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGN1cnJlbnRNb2RpZmllckxpbmtzKSkKICAgICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFByb2R1Y3QoKSB7CiAgICAgICAgaWYgKCFkZWZhdWx0c1NldCkgeyBzaG93TW9kYWwoIlBsZWFzZSBzZXQgU2Vzc2lvbiBEZWZhdWx0cyBmaXJzdC4iLCAiZXJyb3IiKTsgcmV0dXJuOyB9CiAgICAgICAgCiAgICAgICAgY29uc3QgZGF0YSA9IGdhdGhlclByb2R1Y3REYXRhKCk7CiAgICAgICAgY29uc3QgaGFzWmVyb1ByaWNlVmFyaWFudCA9IGRhdGEudmFyaWFudFByaWNpbmcubGVuZ3RoID4gMCAmJiBkYXRhLnZhcmlhbnRQcmljaW5nLnNvbWUodiA9PiAocGFyc2VGbG9hdCh2LnNlbGxpbmdQcmljZSkgfHwgMCkgPT09IDApOwogICAgICAgIGlmIChoYXNaZXJvUHJpY2VWYXJpYW50KSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnU29tZSB2YXJpYW50cyBoYXZlIFIwLjAwIHByaWNlLiBDb250aW51ZT8nLCAnd2FybmluZycsICgpID0+IGNyZWF0ZUFuZEFkZFByb2R1Y3RzKGRhdGEpLCB0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjcmVhdGVBbmRBZGRQcm9kdWN0cyhkYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlQW5kQWRkUHJvZHVjdHMoZGF0YSwgZXhpc3RpbmdHcm91cElkID0gbnVsbCwgaXNCYXRjaCA9IGZhbHNlKSB7CiAgICAgICAgaWYgKHJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrZWQgJiYgIWlzQmF0Y2gpIHsKICAgICAgICAgICAgbGFzdFVzZWRDYXRlZ29yaWVzLnByZXAgPSBkYXRhLnByZXBMb2NhdGlvbjsKICAgICAgICAgICAgbGFzdFVzZWRDYXRlZ29yaWVzLm1lbnUgPSBkYXRhLm1lbnVDYXRlZ29yeTsKICAgICAgICAgICAgbGFzdFVzZWRDYXRlZ29yaWVzLmludiA9IGRhdGEuaW52Q2F0ZWdvcnk7CiAgICAgICAgICAgIGxhc3RVc2VkQ2F0ZWdvcmllcy5zdWJJbnYgPSBkYXRhLmludlN1YkNhdGVnb3J5OwogICAgICAgICAgICBsYXN0VXNlZENhdGVnb3JpZXMudW9tID0gZGF0YS51b207CiAgICAgICAgfQoKICAgICAgICBjb25zdCBpc0ZpbmlzaGVkQW5kUmF3ID0gZGF0YS5wcm9kdWN0VHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCAmIHJhd01hdGVyaWFsJzsKICAgICAgICBjb25zdCBuZXdQcm9kdWN0U3RhcnRJbmRleCA9IHByb2R1Y3RzLmxlbmd0aDsKCiAgICAgICAgaWYgKGlzRmluaXNoZWRBbmRSYXcpIHsKICAgICAgICAgICAgY29uc3QgZ3JvdXBJZCA9IGV4aXN0aW5nR3JvdXBJZCB8fCAoc2Vzc2lvbkRlZmluZVBsdSA9PT0gJ3llcycgJiYgZGF0YS5jdXN0b21QbHUgPyBkYXRhLmN1c3RvbVBsdSA6ICsrcGx1Q291bnRlcik7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoZGF0YS5pc1B1cmNoYXNlZEZvclJlc2FsZSkgewogICAgICAgICAgICAgICAgY29uc3QgdW5pdENvc3QgPSAoZGF0YS5kZWZhdWx0Q29zdCAmJiBkYXRhLnN1cHBsaWVkUXVhbnRpdHkgPiAwKSA/IGRhdGEuZGVmYXVsdENvc3QgLyBkYXRhLnN1cHBsaWVkUXVhbnRpdHkgOiAwOwogICAgICAgICAgICAgICAgY29uc3QgY29tYmluYXRpb25zVG9Qcm9jZXNzID0gZGF0YS52YXJpYW50UHJpY2luZy5sZW5ndGggPiAwID8gZGF0YS52YXJpYW50UHJpY2luZyA6IFt7IGNvbWJpbmF0aW9uOiAnJywgc2VsbGluZ1ByaWNlOiBkYXRhLmRlZmF1bHRQcmljZSB9XTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29tYmluYXRpb25zVG9Qcm9jZXNzLmZvckVhY2goKGNvbWJvLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsTmFtZSA9IGNvbWJvLmNvbWJpbmF0aW9uID8gYCR7ZGF0YS5wcm9kdWN0TmFtZX0gLSAke2NvbWJvLmNvbWJpbmF0aW9ufWAgOiBkYXRhLnByb2R1Y3ROYW1lOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSBwYXJzZUZsb2F0KGNvbWJvLnNlbGxpbmdQcmljZSkgfHwgMDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBncCA9IChmaW5hbFByaWNlID4gMCAmJiB1bml0Q29zdCA+IDApID8gKChmaW5hbFByaWNlIC0gdW5pdENvc3QpIC8gZmluYWxQcmljZSkgKiAxMDAgOiAwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RQbHUgPSAoY29tYmluYXRpb25zVG9Qcm9jZXNzLmxlbmd0aCA+IDEpID8gYFBMVS0ke2dyb3VwSWR9LSR7aW5kZXggKyAxfWAgOiBgUExVLSR7Z3JvdXBJZH1gOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtlZE1vZGlmaWVyR3JvdXBOYW1lcyA9IGRhdGEubW9kaWZpZXJMaW5rc1tjb21iby5jb21iaW5hdGlvbiB8fCAnJ10gfHwgW107CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kaWZpZXJTdHJpbmcgPSBjdXJyZW50TW9kaWZpZXJHcm91cHMKICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihncm91cCA9PiBsaW5rZWRNb2RpZmllckdyb3VwTmFtZXMuaW5jbHVkZXMoZ3JvdXAuZ3JvdXBOYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZsYXRNYXAoZ3JvdXAgPT4gZ3JvdXAub3B0aW9ucy5tYXAob3B0ID0+IGAke2dyb3VwLmdyb3VwTmFtZX06ICR7b3B0Lm5hbWV9ICgkeyhvcHQucHJpY2UgfHwgMCkudG9GaXhlZCgyKX0pYCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCcsICcpOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBoeWJyaWRQcm9kdWN0ID0gewogICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0R3JvdXBJZDogZ3JvdXBJZCwgcGx1QmFzZTogYFBMVS0ke2dyb3VwSWR9YCwgX3NvdXJjZTogZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcHJvZHVjdFBsdSwgIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiOiBmaW5hbE5hbWUsICJCYXNlIE5hbWUiOiBkYXRhLnByb2R1Y3ROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFudCBOYW1lIjogY29tYm8uY29tYmluYXRpb24gfHwgJycsICJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiOiAiZmluaXNoZWRHb29kIiwgIlNpdGUiOiBzZXNzaW9uU2l0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkdQIjogZ3AsICJTZWxsaW5nIFVPTSI6IGRhdGEudW9tLCAiUHJlcGFyYXRpb24gTG9jYXRpb24iOiBkYXRhLnByZXBMb2NhdGlvbiwgIk1lbnUgQ2F0ZWdvcnkiOiBkYXRhLm1lbnVDYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICAgICAgIkludmVudG9yeSBDYXRlZ29yeSI6IGRhdGEuaW52Q2F0ZWdvcnksICJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5IjogZGF0YS5pbnZTdWJDYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgVHlwZSI6ICdzaW5nbGUnLCAiU3VwcGxpZWQgUXVhbnRpdHkiOiBkYXRhLnN1cHBsaWVkUXVhbnRpdHksICJNYW51ZmFjdHVyZWQgWWllbGQiOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgIkVuYWJsZWQiOiB0cnVlLCAiQ29zdCBQcmljZSI6IHVuaXRDb3N0LCAiU2VsbGluZyBQcmljZSI6IGZpbmFsUHJpY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUYXggQXBwbGljYWJsZSI6IGRhdGEudGF4QXBwbGljYWJsZSA9PT0gJ3RydWUnLCAiTW9kaWZpZXIiOiBtb2RpZmllclN0cmluZywgIkJhcmNvZGUiOiBkYXRhLmJhcmNvZGUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2goaHlicmlkUHJvZHVjdCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zdCByYXdQbHVCYXNlID0gYFJBVy0ke2dyb3VwSWR9YDsKICAgICAgICAgICAgICAgIGNvbnN0IHJhd05hbWUgPSBgKFJBVykgJHtkYXRhLnByb2R1Y3ROYW1lfWA7CiAgICAgICAgICAgICAgICBjb25zdCByYXdQcm9kdWN0ID0gewogICAgICAgICAgICAgICAgICAgIHByb2R1Y3RHcm91cElkOiBncm91cElkLCBwbHVCYXNlOiByYXdQbHVCYXNlLCBfc291cmNlOiBkYXRhLAogICAgICAgICAgICAgICAgICAgICJQcm9kdWN0IFBMVSI6IHJhd1BsdUJhc2UsICJQcm9kdWN0IE5hbWUgJiBWYXJpYW50IjogcmF3TmFtZSwgIkJhc2UgTmFtZSI6IHJhd05hbWUsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhbnQgTmFtZSI6ICcnLCAiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIjogJ3Jhd01hdGVyaWFsJywgIlNpdGUiOiBzZXNzaW9uU2l0ZSwgIkdQIjogMCwgCiAgICAgICAgICAgICAgICAgICAgIlNlbGxpbmcgVU9NIjogZGF0YS51b20sICJQcmVwYXJhdGlvbiBMb2NhdGlvbiI6ICcnLCAiTWVudSBDYXRlZ29yeSI6ICcnLAogICAgICAgICAgICAgICAgICAgICJJbnZlbnRvcnkgQ2F0ZWdvcnkiOiBkYXRhLmludkNhdGVnb3J5LCAiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSI6IGRhdGEuaW52U3ViQ2F0ZWdvcnksCiAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgVHlwZSI6ICdzaW5nbGUnLCAiU3VwcGxpZWQgUXVhbnRpdHkiOiBkYXRhLnN1cHBsaWVkUXVhbnRpdHksICJNYW51ZmFjdHVyZWQgWWllbGQiOiAnJywKICAgICAgICAgICAgICAgICAgICAiRW5hYmxlZCI6IHRydWUsICJDb3N0IFByaWNlIjogZGF0YS5kZWZhdWx0Q29zdCwgIlNlbGxpbmcgUHJpY2UiOiAwLCAiVGF4IEFwcGxpY2FibGUiOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAiTW9kaWZpZXIiOiAnJywgIkJhcmNvZGUiOiAnJwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2gocmF3UHJvZHVjdCk7CgogICAgICAgICAgICAgICAgY29uc3QgZmluaXNoZWRQbHVCYXNlID0gYFBMVS0ke2dyb3VwSWR9YDsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbWJpbmF0aW9uc1RvUHJvY2VzcyA9IGRhdGEudmFyaWFudFByaWNpbmcubGVuZ3RoID4gMCA/IGRhdGEudmFyaWFudFByaWNpbmcgOiBbeyBjb21iaW5hdGlvbjogJycsIHNlbGxpbmdQcmljZTogZGF0YS5kZWZhdWx0UHJpY2UgfV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbWJpbmF0aW9uc1RvUHJvY2Vzcy5mb3JFYWNoKChjb21ibywgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5hbE5hbWUgPSBjb21iby5jb21iaW5hdGlvbiA/IGAke2RhdGEucHJvZHVjdE5hbWV9IC0gJHtjb21iby5jb21iaW5hdGlvbn1gIDogZGF0YS5wcm9kdWN0TmFtZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5hbFByaWNlID0gcGFyc2VGbG9hdChjb21iby5zZWxsaW5nUHJpY2UpIHx8IDA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdFBsdSA9IChjb21iaW5hdGlvbnNUb1Byb2Nlc3MubGVuZ3RoID4gMSkgPyBgJHtmaW5pc2hlZFBsdUJhc2V9LSR7aW5kZXggKyAxfWAgOiBmaW5pc2hlZFBsdUJhc2U7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua2VkTW9kaWZpZXJHcm91cE5hbWVzID0gZGF0YS5tb2RpZmllckxpbmtzW2NvbWJvLmNvbWJpbmF0aW9uIHx8ICcnXSB8fCBbXTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RpZmllclN0cmluZyA9IGN1cnJlbnRNb2RpZmllckdyb3VwcwogICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGdyb3VwID0+IGxpbmtlZE1vZGlmaWVyR3JvdXBOYW1lcy5pbmNsdWRlcyhncm91cC5ncm91cE5hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICAuZmxhdE1hcChncm91cCA9PiBncm91cC5vcHRpb25zLm1hcChvcHQgPT4gYCR7Z3JvdXAuZ3JvdXBOYW1lfTogJHtvcHQubmFtZX0gKCR7KG9wdC5wcmljZSB8fCAwKS50b0ZpeGVkKDIpfSlgKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJywgJyk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmlzaGVkUHJvZHVjdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEdyb3VwSWQ6IGdyb3VwSWQsIHBsdUJhc2U6IGZpbmlzaGVkUGx1QmFzZSwgX3NvdXJjZTogZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcHJvZHVjdFBsdSwgIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiOiBmaW5hbE5hbWUsICJCYXNlIE5hbWUiOiBkYXRhLnByb2R1Y3ROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFudCBOYW1lIjogY29tYm8uY29tYmluYXRpb24gfHwgJycsICJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiOiAnZmluaXNoZWRHb29kJywgIlNpdGUiOiBzZXNzaW9uU2l0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkdQIjogMTAwLCAiU2VsbGluZyBVT00iOiAiZWEiLCAiUHJlcGFyYXRpb24gTG9jYXRpb24iOiBkYXRhLnByZXBMb2NhdGlvbiwgIk1lbnUgQ2F0ZWdvcnkiOiBkYXRhLm1lbnVDYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICAgICAgIkludmVudG9yeSBDYXRlZ29yeSI6ICcnLCAiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSI6ICcnLCAiUHJvZHVjdCBUeXBlIjogJ3NpbmdsZScsICJTdXBwbGllZCBRdWFudGl0eSI6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAiTWFudWZhY3R1cmVkIFlpZWxkIjogJycsICJFbmFibGVkIjogdHJ1ZSwgIkNvc3QgUHJpY2UiOiAwLCAiU2VsbGluZyBQcmljZSI6IGZpbmFsUHJpY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUYXggQXBwbGljYWJsZSI6IGRhdGEudGF4QXBwbGljYWJsZSA9PT0gJ3RydWUnLCAiTW9kaWZpZXIiOiBtb2RpZmllclN0cmluZywgIkJhcmNvZGUiOiBkYXRhLmJhcmNvZGUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2goZmluaXNoZWRQcm9kdWN0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGdyb3VwSWQgPSBleGlzdGluZ0dyb3VwSWQgfHwgKHNlc3Npb25EZWZpbmVQbHUgPT09ICd5ZXMnICYmIGRhdGEuY3VzdG9tUGx1ID8gZGF0YS5jdXN0b21QbHUgOiArK3BsdUNvdW50ZXIpOwogICAgICAgICAgICBjb25zdCBwbHVCYXNlID0gYFBMVS0ke2dyb3VwSWR9YDsKICAgICAgICAgICAgY29uc3QgY29tYmluYXRpb25zVG9Qcm9jZXNzID0gZGF0YS52YXJpYW50UHJpY2luZy5sZW5ndGggPiAwIAogICAgICAgICAgICAgICAgPyBkYXRhLnZhcmlhbnRQcmljaW5nIAogICAgICAgICAgICAgICAgOiBbeyBjb21iaW5hdGlvbjogJycsIHNlbGxpbmdQcmljZTogZGF0YS5kZWZhdWx0UHJpY2UsIGNvc3RQcmljZTogZGF0YS5kZWZhdWx0Q29zdCB9XTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbWJpbmF0aW9uc1RvUHJvY2Vzcy5mb3JFYWNoKChjb21ibywgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBwcmVmaXhlZEJhc2VOYW1lID0gZGF0YS5wcm9kdWN0TmFtZTsKICAgICAgICAgICAgICAgIGlmIChkYXRhLnByb2R1Y3RUeXBlID09PSAicmF3TWF0ZXJpYWwiKSBwcmVmaXhlZEJhc2VOYW1lID0gIihSQVcpICIgKyBkYXRhLnByb2R1Y3ROYW1lOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5wcm9kdWN0VHlwZSA9PT0gIk1hbnVmYWN0dXJlZCIpIHByZWZpeGVkQmFzZU5hbWUgPSAiKE1BTikgIiArIGRhdGEucHJvZHVjdE5hbWU7CgogICAgICAgICAgICAgICAgY29uc3QgZmluYWxOYW1lID0gKGNvbWJvLmNvbWJpbmF0aW9uKSA/IGAke3ByZWZpeGVkQmFzZU5hbWV9IC0gJHtjb21iby5jb21iaW5hdGlvbn1gIDogcHJlZml4ZWRCYXNlTmFtZTsKICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSBwYXJzZUZsb2F0KGNvbWJvLnNlbGxpbmdQcmljZSkgfHwgMDsKICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsQ29zdCA9IHBhcnNlRmxvYXQoY29tYm8uY29zdFByaWNlKSB8fCAwOwogICAgICAgICAgICAgICAgY29uc3QgZ3AgPSAoZmluYWxQcmljZSA+IDAgJiYgZmluYWxDb3N0ID4gMCkgPyAoKGZpbmFsUHJpY2UgLSBmaW5hbENvc3QpIC8gZmluYWxQcmljZSkgKiAxMDAgOiAwOwogICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdFBsdSA9IChjb21iaW5hdGlvbnNUb1Byb2Nlc3MubGVuZ3RoID4gMSkgPyBgJHtwbHVCYXNlfS0ke2luZGV4ICsgMX1gIDogcGx1QmFzZTsKCiAgICAgICAgICAgICAgICBjb25zdCBsaW5rZWRNb2RpZmllckdyb3VwTmFtZXMgPSBkYXRhLm1vZGlmaWVyTGlua3NbY29tYm8uY29tYmluYXRpb24gfHwgJyddIHx8IFtdOwogICAgICAgICAgICAgICAgY29uc3QgbW9kaWZpZXJTdHJpbmcgPSBjdXJyZW50TW9kaWZpZXJHcm91cHMKICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGdyb3VwID0+IGxpbmtlZE1vZGlmaWVyR3JvdXBOYW1lcy5pbmNsdWRlcyhncm91cC5ncm91cE5hbWUpKQogICAgICAgICAgICAgICAgICAgIC5mbGF0TWFwKGdyb3VwID0+IGdyb3VwLm9wdGlvbnMubWFwKG9wdCA9PiBgJHtncm91cC5ncm91cE5hbWV9OiAke29wdC5uYW1lfSAoJHsob3B0LnByaWNlIHx8IDApLnRvRml4ZWQoMil9KWApKQogICAgICAgICAgICAgICAgICAgIC5qb2luKCcsICcpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHByb2R1Y3QgPSB7CiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEdyb3VwSWQ6IGdyb3VwSWQsIHBsdUJhc2U6IHBsdUJhc2UsIF9zb3VyY2U6IGRhdGEsCiAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcHJvZHVjdFBsdSwgIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiOiBmaW5hbE5hbWUsICJCYXNlIE5hbWUiOiBwcmVmaXhlZEJhc2VOYW1lLAogICAgICAgICAgICAgICAgICAgICJWYXJpYW50IE5hbWUiOiBjb21iby5jb21iaW5hdGlvbiB8fCAnJywgIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSI6IGRhdGEucHJvZHVjdFR5cGUsICJTaXRlIjogc2Vzc2lvblNpdGUsCiAgICAgICAgICAgICAgICAgICAgIkdQIjogZ3AsICJTZWxsaW5nIFVPTSI6IGRhdGEudW9tLCAiUHJlcGFyYXRpb24gTG9jYXRpb24iOiBkYXRhLnByZXBMb2NhdGlvbiwgIk1lbnUgQ2F0ZWdvcnkiOiBkYXRhLm1lbnVDYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICAiSW52ZW50b3J5IENhdGVnb3J5IjogZGF0YS5pbnZDYXRlZ29yeSwgIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiOiBkYXRhLmludlN1YkNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICJQcm9kdWN0IFR5cGUiOiBkYXRhLnByb2R1Y3RUeXBlID09PSAnTWFudWZhY3R1cmVkJyA/ICdwcmVwYXJhdGlvbicgOiAnc2luZ2xlJywKICAgICAgICAgICAgICAgICAgICAiU3VwcGxpZWQgUXVhbnRpdHkiOiAoZGF0YS5wcm9kdWN0VHlwZSA9PT0gJ3Jhd01hdGVyaWFsJykgPyBkYXRhLnN1cHBsaWVkUXVhbnRpdHkgOiAnJywKICAgICAgICAgICAgICAgICAgICAiTWFudWZhY3R1cmVkIFlpZWxkIjogKGRhdGEucHJvZHVjdFR5cGUgPT09ICdNYW51ZmFjdHVyZWQnKSA/IGRhdGEueWllbGRRdWFudGl0eSA6ICcnLAogICAgICAgICAgICAgICAgICAgICJFbmFibGVkIjogdHJ1ZSwgIkNvc3QgUHJpY2UiOiBmaW5hbENvc3QsICJTZWxsaW5nIFByaWNlIjogZmluYWxQcmljZSwKICAgICAgICAgICAgICAgICAgICAiVGF4IEFwcGxpY2FibGUiOiBkYXRhLnRheEFwcGxpY2FibGUgPT09ICd0cnVlJywKICAgICAgICAgICAgICAgICAgICAiTW9kaWZpZXIiOiBtb2RpZmllclN0cmluZywgIkJhcmNvZGUiOiBkYXRhLmJhcmNvZGUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBwcm9kdWN0cy5wdXNoKHByb2R1Y3QpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGlmICghaXNCYXRjaCkgewogICAgICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICAgICAgdXBkYXRlVGFibGUobmV3UHJvZHVjdFN0YXJ0SW5kZXgpOwogICAgICAgICAgICBhZGRUb0RhdGFsaXN0KCJwcmVwTGlzdCIsIGRhdGEucHJlcExvY2F0aW9uKTsgCiAgICAgICAgICAgIGFkZFRvRGF0YWxpc3QoIm1lbnVMaXN0IiwgZGF0YS5tZW51Q2F0ZWdvcnkpOwogICAgICAgICAgICBhZGRUb0RhdGFsaXN0KCJpbnZlbnRvcnlDYXRlZ29yeUxpc3QiLCBkYXRhLmludkNhdGVnb3J5KTsgCiAgICAgICAgICAgIGFkZFRvRGF0YWxpc3QoImludmVudG9yeVN1YkNhdGVnb3J5TGlzdCIsIGRhdGEuaW52U3ViQ2F0ZWdvcnkpOwogICAgICAgICAgICByZXNldEZvcm0oKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInByb2R1Y3ROYW1lIikuZm9jdXMoKTsKICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKHsgdG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCcgfSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3QoaW5kZXgpIHsKICAgICAgICBjb25zdCBkYXRhID0gZ2F0aGVyUHJvZHVjdERhdGEoKTsKICAgICAgICBjb25zdCBvcmlnaW5hbFByb2R1Y3QgPSBwcm9kdWN0c1tpbmRleF07CiAgICAgICAgY29uc3QgZ3JvdXBJZFRvVXBkYXRlID0gb3JpZ2luYWxQcm9kdWN0LnByb2R1Y3RHcm91cElkOwoKICAgICAgICBpZiAoIWdyb3VwSWRUb1VwZGF0ZSkgewogICAgICAgICAgICBzaG93TW9kYWwoJ0Nhbm5vdCBlZGl0IHRoaXMgbGVnYWN5IHByb2R1Y3QuIFBsZWFzZSByZW1vdmUgYW5kIHJlLWFkZCBpdC4nLCAnZXJyb3InKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcHJvZHVjdHMgPSBwcm9kdWN0cy5maWx0ZXIocCA9PiBwLnByb2R1Y3RHcm91cElkICE9PSBncm91cElkVG9VcGRhdGUpOwogICAgICAgIGNyZWF0ZUFuZEFkZFByb2R1Y3RzKGRhdGEsIGdyb3VwSWRUb1VwZGF0ZSk7CiAgICAgICAgcmVzZXRGb3JtKCk7CiAgICAgICAgc2hvd01vZGFsKCdQcm9kdWN0IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IScsICd3YXJuaW5nJyk7CiAgICB9CgogICAgZnVuY3Rpb24gZWRpdFByb2R1Y3QoaW5kZXgpIHsKICAgICAgICBjb25zdCBwcm9kdWN0ID0gcHJvZHVjdHNbaW5kZXhdOwogICAgICAgIGlmICghcHJvZHVjdCB8fCAhcHJvZHVjdC5fc291cmNlIHx8ICFwcm9kdWN0LnByb2R1Y3RHcm91cElkKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnVGhpcyBwcm9kdWN0IHdhcyBjcmVhdGVkIHdpdGggYW4gb2xkZXIgdmVyc2lvbiBhbmQgY2Fubm90IGJlIHNhZmVseSBlZGl0ZWQuIFBsZWFzZSByZW1vdmUgYW5kIHJlLWFkZCBpdC4nLCAnZXJyb3InKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb25zdCByZWxhdGVkUHJvZHVjdHMgPSBwcm9kdWN0cy5maWx0ZXIocCA9PiBwLnByb2R1Y3RHcm91cElkID09PSBwcm9kdWN0LnByb2R1Y3RHcm91cElkKTsKICAgICAgICBpZiAocmVsYXRlZFByb2R1Y3RzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgY29uc3Qgb3RoZXJWYXJpYW50cyA9IHJlbGF0ZWRQcm9kdWN0cy5sZW5ndGggLSAxOwogICAgICAgICAgICBsZXQgbWVzc2FnZSA9IGBUaGlzIHByb2R1Y3QgaGFzICR7b3RoZXJWYXJpYW50c30gb3RoZXIgcmVsYXRlZCBjb21wb25lbnQocykvdmFyaWFudChzKS4gRWRpdGluZyBpdCB3aWxsIGFmZmVjdCBhbGwgb2YgdGhlbS4gQ29udGludWU/YDsKICAgICAgICAgICAgc2hvd01vZGFsKG1lc3NhZ2UsICd3YXJuaW5nJywgKCkgPT4gcHJvY2VlZFdpdGhFZGl0KHByb2R1Y3QsIGluZGV4KSwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJvY2VlZFdpdGhFZGl0KHByb2R1Y3QsIGluZGV4KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcHJvY2VlZFdpdGhFZGl0KHByb2R1Y3QsIGluZGV4KSB7CiAgICAgICAgY29uc3Qgc291cmNlID0gcHJvZHVjdC5fc291cmNlOwogICAgICAgIGVkaXRpbmdJbmRleElucHV0LnZhbHVlID0gaW5kZXg7CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0YXhBcHBsaWNhYmxlIikudmFsdWUgPSBzb3VyY2UudGF4QXBwbGljYWJsZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZHVjdFR5cGUiKS52YWx1ZSA9IHNvdXJjZS5wcm9kdWN0VHlwZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZHVjdE5hbWUiKS52YWx1ZSA9IHNvdXJjZS5wcm9kdWN0TmFtZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidW9tIikudmFsdWUgPSBzb3VyY2UudW9tOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcmVwTG9jYXRpb24iKS52YWx1ZSA9IHNvdXJjZS5wcmVwTG9jYXRpb247CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1lbnVDYXRlZ29yeSIpLnZhbHVlID0gc291cmNlLm1lbnVDYXRlZ29yeTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW52ZW50b3J5Q2F0ZWdvcnkiKS52YWx1ZSA9IHNvdXJjZS5pbnZDYXRlZ29yeTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW52ZW50b3J5U3ViQ2F0ZWdvcnkiKS52YWx1ZSA9IHNvdXJjZS5pbnZTdWJDYXRlZ29yeTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3VwcGxpZWRRdWFudGl0eSIpLnZhbHVlID0gc291cmNlLnN1cHBsaWVkUXVhbnRpdHk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInlpZWxkUXVhbnRpdHkiKS52YWx1ZSA9IHNvdXJjZS55aWVsZFF1YW50aXR5OwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb3N0UHJpY2UiKS52YWx1ZSA9IGlzTmFOKHNvdXJjZS5kZWZhdWx0Q29zdCkgPyAnJyA6IHNvdXJjZS5kZWZhdWx0Q29zdDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VsbGluZ1ByaWNlIikudmFsdWUgPSBpc05hTihzb3VyY2UuZGVmYXVsdFByaWNlKSA/ICcnIDogc291cmNlLmRlZmF1bHRQcmljZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGFzQmFyY29kZSIpLnZhbHVlID0gc291cmNlLmhhc0JhcmNvZGU7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhcmNvZGUiKS52YWx1ZSA9IHNvdXJjZS5iYXJjb2RlOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpc1B1cmNoYXNlZEZvclJlc2FsZSIpLmNoZWNrZWQgPSBzb3VyY2UuaXNQdXJjaGFzZWRGb3JSZXNhbGU7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbVBsdSIpLnZhbHVlID0gcHJvZHVjdC5wcm9kdWN0R3JvdXBJZDsKICAgICAgICAKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc291cmNlLnZhcmlhbnRHcm91cHMgfHwgW10pKTsKICAgICAgICBjdXJyZW50VmFyaWFudFByaWNpbmcgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZS52YXJpYW50UHJpY2luZyB8fCBbXSkpOwogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc291cmNlLm1vZGlmaWVyR3JvdXBzIHx8IFtdKSk7CiAgICAgICAgY3VycmVudE1vZGlmaWVyTGlua3MgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZS5tb2RpZmllckxpbmtzIHx8IHt9KSk7CiAgICAgICAgCiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICAgICAgaGFuZGxlQmFyY29kZVZpc2liaWxpdHkoKTsKICAgICAgICBoYW5kbGVQbHVWaXNpYmlsaXR5KCk7CgogICAgICAgIG1haW5BY3Rpb25CdXR0b24udGV4dENvbnRlbnQgPSAnVXBkYXRlIFByb2R1Y3QnOwogICAgICAgIG1haW5BY3Rpb25CdXR0b24uY2xhc3NMaXN0LnJlcGxhY2UoJ2J0bi1hZGQnLCAnYnRuLXVwZGF0ZScpOwoKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcHJvZHVjdFRhYmxlIHRib2R5IHRyLCAjc3RvY2tUYWJsZSB0Ym9keSB0cicpLmZvckVhY2gocm93ID0+IHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdlZGl0aW5nLXJvdycpKTsKICAgICAgICBjb25zdCByb3dzVG9IaWdobGlnaHQgPSBwcm9kdWN0cy5maWx0ZXIocCA9PiBwLnByb2R1Y3RHcm91cElkID09PSBwcm9kdWN0LnByb2R1Y3RHcm91cElkKS5tYXAocCA9PiBwWydQcm9kdWN0IFBMVSddKTsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcHJvZHVjdFRhYmxlIHRib2R5IHRyLCAjc3RvY2tUYWJsZSB0Ym9keSB0cicpLmZvckVhY2gocm93ID0+IHsKICAgICAgICAgICAgaWYgKHJvd3NUb0hpZ2hsaWdodC5pbmNsdWRlcyhyb3cuY2VsbHNbMF0udGV4dENvbnRlbnQpKSB7CiAgICAgICAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnZWRpdGluZy1yb3cnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0Rm9ybScpLm9mZnNldFRvcCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHsKICAgICAgICBjbGVhckFsbFZhbGlkYXRpb25FcnJvcnMoKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdEZvcm0nKS5yZXNldCgpOwogICAgICAgIAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1b20nKS52YWx1ZSA9ICcnOyAvLyBFbnN1cmUgc2VsZWN0IHdpdGggZGlzYWJsZWQgb3B0aW9uIGlzIGNsZWFyZWQKICAgICAgICBlZGl0aW5nSW5kZXhJbnB1dC52YWx1ZSA9ICctMSc7CiAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHMgPSBbXTsKICAgICAgICBjdXJyZW50VmFyaWFudFByaWNpbmcgPSBbXTsKICAgICAgICBjdXJyZW50TW9kaWZpZXJMaW5rcyA9IHt9OwogICAgICAgIAogICAgICAgIG1haW5BY3Rpb25CdXR0b24udGV4dENvbnRlbnQgPSAnQWRkIFByb2R1Y3QnOwogICAgICAgIG1haW5BY3Rpb25CdXR0b24uY2xhc3NMaXN0LnJlcGxhY2UoJ2J0bi11cGRhdGUnLCAnYnRuLWFkZCcpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW5nLXJvdycpLmZvckVhY2gocm93ID0+IHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdlZGl0aW5nLXJvdycpKTsKICAgICAgICAKICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICBoYW5kbGVCYXJjb2RlVmlzaWJpbGl0eSgpOwoKICAgICAgICBpZiAocmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tib3guY2hlY2tlZCkgewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcExvY2F0aW9uJykudmFsdWUgPSBsYXN0VXNlZENhdGVnb3JpZXMucHJlcCB8fCAnJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnVDYXRlZ29yeScpLnZhbHVlID0gbGFzdFVzZWRDYXRlZ29yaWVzLm1lbnUgfHwgJyc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnZlbnRvcnlDYXRlZ29yeScpLnZhbHVlID0gbGFzdFVzZWRDYXRlZ29yaWVzLmludiB8fCAnJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludmVudG9yeVN1YkNhdGVnb3J5JykudmFsdWUgPSBsYXN0VXNlZENhdGVnb3JpZXMuc3ViSW52IHx8ICcnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW9tJykudmFsdWUgPSBsYXN0VXNlZENhdGVnb3JpZXMudW9tIHx8ICcnOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBuYXZpZ2F0ZVRvUmF3KGdyb3VwSWQpIHsKICAgICAgICBjb25zdCByYXdQcm9kdWN0ID0gcHJvZHVjdHMuZmluZChwID0+IHAucHJvZHVjdEdyb3VwSWQgPT09IGdyb3VwSWQgJiYgcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICdyYXdNYXRlcmlhbCcpOwogICAgICAgIGlmICghcmF3UHJvZHVjdCkgcmV0dXJuOwoKICAgICAgICBjb25zdCByYXdQbHUgPSByYXdQcm9kdWN0WyJQcm9kdWN0IFBMVSJdOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWItbGlua1tkYXRhLXRhYj0icHJvZHVjdHMiXScpLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWItY29udGVudCNwcm9kdWN0cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWItbGlua1tkYXRhLXRhYj0ic3RvY2siXScpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWItY29udGVudCNzdG9jaycpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwoKICAgICAgICBjb25zdCByb3dUb0hpZ2hsaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNzdG9ja1RhYmxlIHRyW2RhdGEtcGx1PSIke3Jhd1BsdX0iXWApOwogICAgICAgIGlmIChyb3dUb0hpZ2hsaWdodCkgewogICAgICAgICAgICByb3dUb0hpZ2hsaWdodC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdjZW50ZXInIH0pOwogICAgICAgICAgICByb3dUb0hpZ2hsaWdodC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtcm93Jyk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcm93VG9IaWdobGlnaHQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LXJvdycpLCAzMDAwKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlVGFibGUobmV3UHJvZHVjdFN0YXJ0SW5kZXggPSAtMSkgewogICAgICAgIGNvbnN0IHByb2R1Y3RUYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNwcm9kdWN0VGFibGUgdGJvZHkiKTsKICAgICAgICBjb25zdCBzdG9ja1Rib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3N0b2NrVGFibGUgdGJvZHkiKTsKICAgICAgICBwcm9kdWN0VGJvZHkuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgc3RvY2tUYm9keS5pbm5lckhUTUwgPSAiIjsKCiAgICAgICAgbGV0IGxhc3RHcm91cElkID0gbnVsbDsKICAgICAgICBsZXQgZ3JvdXBDbGFzc1RvZ2dsZSA9IGZhbHNlOwoKICAgICAgICBjb25zdCBjcmVhdGVBY3Rpb25zQ2VsbCA9IChwLCBpbmRleCkgPT4gewogICAgICAgICAgICBjb25zdCBhY3Rpb25zQ2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7CiAgICAgICAgICAgIGFjdGlvbnNDZWxsLmNsYXNzTmFtZSA9ICJhY3Rpb25zLWNlbGwiOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgICAgICBlZGl0QnRuLmNsYXNzTmFtZSA9ICJidG4tZWRpdCI7CiAgICAgICAgICAgIGVkaXRCdG4udGl0bGUgPSAiRWRpdCBQcm9kdWN0IjsKICAgICAgICAgICAgZWRpdEJ0bi5pbm5lckhUTUwgPSBgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkuNzY5IDkuOTIzbC0xMi42NDIgMTIuNjM5LTcuMTI3IDEuNDM4IDEuNDM4LTcuMTI3IDEyLjY0MS0xMi42NCA1LjY5IDUuNjkxem0xLjQxNC0xLjQxNGwyLjgxNy0yLjgxNy01LjY5MS01LjY5LTIuODE2IDIuODE3IDUuNjkgNS42OXoiLz48L3N2Zz5gOwogICAgICAgICAgICBlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiBlZGl0UHJvZHVjdChpbmRleCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCByZW1vdmVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgICAgcmVtb3ZlQnRuLmNsYXNzTmFtZSA9ICJidG4tcmVtb3ZlIjsKICAgICAgICAgICAgcmVtb3ZlQnRuLnRpdGxlID0gIlJlbW92ZSBQcm9kdWN0IjsKICAgICAgICAgICAgcmVtb3ZlQnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0zIDZ2MThoMTh2LTE4aC0xOHptNSAxNGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNSAwYzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTQtMThoLTIwdi0yaDZ2LTEuNWMwLS44MjcuNjczLTEuNSAxLjUtMS41aDVjLjgyNSAwIDEuNS42NzEgMS41IDEuNXYxLjVoNnYyeiIvPjwvc3ZnPmA7CiAgICAgICAgICAgIHJlbW92ZUJ0bi5vbmNsaWNrID0gKCkgPT4geyAKICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwSWRUb1JlbW92ZSA9IHAucHJvZHVjdEdyb3VwSWQ7CiAgICAgICAgICAgICAgICBpZiAoIWdyb3VwSWRUb1JlbW92ZSkgewogICAgICAgICAgICAgICAgICAgIHNob3dNb2RhbCgiQ2Fubm90IHJlbW92ZSBsZWdhY3kgcHJvZHVjdC4gUGxlYXNlIGNsZWFyIGFsbCBkYXRhIGlmIHlvdSB3aXNoIHRvIHJlbW92ZSBpdC4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBwcm9kdWN0c0luR3JvdXAgPSBwcm9kdWN0cy5maWx0ZXIocHJvZCA9PiBwcm9kLnByb2R1Y3RHcm91cElkID09PSBncm91cElkVG9SZW1vdmUpOwogICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGBSZW1vdmUgIiR7cC5fc291cmNlLnByb2R1Y3ROYW1lfSIgYW5kIGFsbCBpdHMgJHtwcm9kdWN0c0luR3JvdXAubGVuZ3RoIC0gMX0gcmVsYXRlZCBjb21wb25lbnRzL3ZhcmlhbnRzP2A7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwobWVzc2FnZSwgJ3dhcm5pbmcnLCAoKSA9PiB7IAogICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzID0gcHJvZHVjdHMuZmlsdGVyKHByb2QgPT4gcHJvZC5wcm9kdWN0R3JvdXBJZCAhPT0gZ3JvdXBJZFRvUmVtb3ZlKTsKICAgICAgICAgICAgICAgICAgICBzYXZlU3RhdGUoKTsgCiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGFibGUoKTsgCiAgICAgICAgICAgICAgICB9LCB0cnVlKTsgCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIAogICAgICAgICAgICBhY3Rpb25zQ2VsbC5hcHBlbmRDaGlsZChlZGl0QnRuKTsKICAgICAgICAgICAgYWN0aW9uc0NlbGwuYXBwZW5kQ2hpbGQocmVtb3ZlQnRuKTsKCiAgICAgICAgICAgIGNvbnN0IGlzTWFudWZhY3R1cmVkID0gcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICdmaW5pc2hlZEdvb2QnICYmIHAuX3NvdXJjZS5wcm9kdWN0VHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCAmIHJhd01hdGVyaWFsJyAmJiAhcC5fc291cmNlLmlzUHVyY2hhc2VkRm9yUmVzYWxlOwogICAgICAgICAgICBpZiAoaXNNYW51ZmFjdHVyZWQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJhd1Byb2R1Y3QgPSBwcm9kdWN0cy5maW5kKHJhd1AgPT4gcmF3UC5wcm9kdWN0R3JvdXBJZCA9PT0gcC5wcm9kdWN0R3JvdXBJZCAmJiByYXdQWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSA9PT0gJ3Jhd01hdGVyaWFsJyk7CiAgICAgICAgICAgICAgICBpZiAocmF3UHJvZHVjdCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmNsYXNzTmFtZSA9ICd0b29sdGlwIG1vZGlmaWVyLWluZGljYXRvci13cmFwcGVyJzsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LnRpdGxlID0gYE1hcHMgdG86ICR7cmF3UHJvZHVjdFsiQmFzZSBOYW1lIl19YDsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2Lm9uY2xpY2sgPSAoKSA9PiBuYXZpZ2F0ZVRvUmF3KHAucHJvZHVjdEdyb3VwSWQpOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLmNsYXNzTmFtZSA9ICdtb2RpZmllci1pbmRpY2F0b3InOwogICAgICAgICAgICAgICAgICAgIGluZGljYXRvci50ZXh0Q29udGVudCA9ICdSJzsKCiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZChpbmRpY2F0b3IpOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbnNDZWxsLmFwcGVuZENoaWxkKHRvb2x0aXBEaXYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBhY3Rpb25zQ2VsbDsKICAgICAgICB9OwoKICAgICAgICBwcm9kdWN0cy5mb3JFYWNoKChwLCBpbmRleCkgPT4gewogICAgICAgICAgICBjb25zdCBjdXJyZW50R3JvdXBJZCA9IHAucHJvZHVjdEdyb3VwSWQ7CiAgICAgICAgICAgIGlmIChjdXJyZW50R3JvdXBJZCAmJiBjdXJyZW50R3JvdXBJZCAhPT0gbGFzdEdyb3VwSWQpIHsKICAgICAgICAgICAgICAgIGdyb3VwQ2xhc3NUb2dnbGUgPSAhZ3JvdXBDbGFzc1RvZ2dsZTsKICAgICAgICAgICAgICAgIGxhc3RHcm91cElkID0gY3VycmVudEdyb3VwSWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGFibGUgPSBbJ2ZpbmlzaGVkR29vZCddLmluY2x1ZGVzKHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdKTsKICAgICAgICAgICAgY29uc3QgaXNTdG9jayA9IFsncmF3TWF0ZXJpYWwnLCAnTWFudWZhY3R1cmVkJ10uaW5jbHVkZXMocFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0pOwoKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKTsKICAgICAgICAgICAgcm93LmRhdGFzZXQucGx1ID0gcFsiUHJvZHVjdCBQTFUiXTsKICAgICAgICAgICAgaWYgKGN1cnJlbnRHcm91cElkKSByb3cuY2xhc3NMaXN0LmFkZChncm91cENsYXNzVG9nZ2xlID8gJ2dyb3VwLWEnIDogJ2dyb3VwLWInKTsKICAgICAgICAgICAgaWYgKGluZGV4ID49IG5ld1Byb2R1Y3RTdGFydEluZGV4KSByb3cuY2xhc3NMaXN0LmFkZCgnbmV3LXJvdycpOwoKICAgICAgICAgICAgaWYgKGlzU2VsbGFibGUpIHsKICAgICAgICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgPHRkPiR7cFsiUHJvZHVjdCBQTFUiXX08L3RkPjx0ZD4ke3BbIkJhc2UgTmFtZSJdfTwvdGQ+PHRkPiR7cFsiVmFyaWFudCBOYW1lIl19PC90ZD48dGQ+JHtwWyJNZW51IENhdGVnb3J5Il19PC90ZD48dGQ+JHsocGFyc2VGbG9hdChwWyJTZWxsaW5nIFByaWNlIl0pIHx8IDApLnRvRml4ZWQoMil9PC90ZD48dGQ+PC90ZD5gOwogICAgICAgICAgICAgICAgY29uc3QgbW9kaWZpZXJDZWxsID0gcm93LmNlbGxzWzVdOwogICAgICAgICAgICAgICAgY29uc3QgbGlua2VkR3JvdXBzID0gcC5fc291cmNlPy5tb2RpZmllckxpbmtzPy5bcFsiVmFyaWFudCBOYW1lIl0gfHwgJyddIHx8IFtdOwogICAgICAgICAgICAgICAgaWYgKGxpbmtlZEdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJDZWxsLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmNsYXNzTmFtZSA9ICd0b29sdGlwIG1vZGlmaWVyLWluZGljYXRvci13cmFwcGVyJzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLmNsYXNzTmFtZSA9ICdtb2RpZmllci1pbmRpY2F0b3InOwogICAgICAgICAgICAgICAgICAgIGluZGljYXRvci50ZXh0Q29udGVudCA9IGxpbmtlZEdyb3Vwcy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbHRpcFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcFRleHQuY2xhc3NOYW1lID0gJ3Rvb2x0aXB0ZXh0JzsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwVGV4dC5zdHlsZS50ZXh0QWxpZ24gPSAnbGVmdCc7CiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcFRleHQuaW5uZXJIVE1MID0gYDxzdHJvbmc+TGlua2VkOjwvc3Ryb25nPjxicj4ke2xpbmtlZEdyb3Vwcy5qb2luKCc8YnI+Jyl9YDsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKGluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZCh0b29sdGlwVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJDZWxsLmFwcGVuZENoaWxkKHRvb2x0aXBEaXYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNyZWF0ZUFjdGlvbnNDZWxsKHAsIGluZGV4KSk7CiAgICAgICAgICAgICAgICBwcm9kdWN0VGJvZHkuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaXNTdG9jaykgewogICAgICAgICAgICAgICAgY29uc3Qgc3RvY2tSb3cgPSByb3cuY2xvbmVOb2RlKHRydWUpOwogICAgICAgICAgICAgICAgc3RvY2tSb3cuaW5uZXJIVE1MID0gYDx0ZD4ke3BbIlByb2R1Y3QgUExVIl19PC90ZD48dGQ+JHtwWyJCYXNlIE5hbWUiXX08L3RkPjx0ZD4ke3BbIkludmVudG9yeSBDYXRlZ29yeSJdfTwvdGQ+PHRkPiR7cFsiU2VsbGluZyBVT00iXX08L3RkPjx0ZD4keyhwYXJzZUZsb2F0KHBbIkNvc3QgUHJpY2UiXSkgfHwgMCkudG9GaXhlZCgyKX08L3RkPmA7CiAgICAgICAgICAgICAgICBzdG9ja1Jvdy5hcHBlbmRDaGlsZChjcmVhdGVBY3Rpb25zQ2VsbChwLCBpbmRleCkpOwogICAgICAgICAgICAgICAgc3RvY2tUYm9keS5hcHBlbmRDaGlsZChzdG9ja1Jvdyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgIGlmIChuZXdQcm9kdWN0U3RhcnRJbmRleCAhPT0gLTEpIHsgCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmV3LXJvdycpLmZvckVhY2gociA9PiByLmNsYXNzTGlzdC5yZW1vdmUoJ25ldy1yb3cnKSksIDI1MDApOyAKICAgICAgfQogICAgICBjb25zdCBtZW51Q2F0ZWdvcmllcyA9IG5ldyBTZXQocHJvZHVjdHMuZmlsdGVyKHAgPT4gcFsiTWVudSBDYXRlZ29yeSJdKS5tYXAocCA9PiBwWyJNZW51IENhdGVnb3J5Il0pKTsKICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdENhdGVnb3J5RmlsdGVyJyk7CiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWwgPSBjYXRlZ29yeUZpbHRlci52YWx1ZTsKICAgICAgICAgICAgY2F0ZWdvcnlGaWx0ZXIuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9IiI+RmlsdGVyIGJ5IE1lbnUgQ2F0ZWdvcnkuLi48L29wdGlvbj4nOwogICAgICAgICAgICBtZW51Q2F0ZWdvcmllcy5mb3JFYWNoKGNhdCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IGNhdDsKICAgICAgICAgICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGNhdDsKICAgICAgICAgICAgICAgIGNhdGVnb3J5RmlsdGVyLmFwcGVuZENoaWxkKG9wdGlvbik7CiAgICAgICAgICAgIH0pOwogICAgICBjYXRlZ29yeUZpbHRlci52YWx1ZSA9IGN1cnJlbnRWYWw7IC8vIFByZXNlcnZlIHRoZSBzZWxlY3RlZCBmaWx0ZXIKICAgICAgCiAgICAgIC8vIENvcnJlY3RlZCBmaWx0ZXIgY2FsbHMgYXJlIGhlcmUKICAgICAgZmlsdGVyVGFibGUoJ3Byb2R1Y3RTZWFyY2gnLCAncHJvZHVjdFRhYmxlJywgJ3Byb2R1Y3RDYXRlZ29yeUZpbHRlcicpOwogICAgICBmaWx0ZXJUYWJsZSgnc3RvY2tTZWFyY2gnLCAnc3RvY2tUYWJsZScpOwogICAgfQoKICAgIC8vIC0tLSBJTkxJTkUgVkFMSURBVElPTiAtLS0KICAgIGZ1bmN0aW9uIHNob3dWYWxpZGF0aW9uRXJyb3IoZWxlbWVudCwgbWVzc2FnZSkgewogICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaW5wdXQtaW52YWxpZCcpOwogICAgICAgIGNvbnN0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZm9ybS1ncm91cCwgLnJlbWVtYmVyLW1lLWNvbnRhaW5lcicpOwogICAgICAgIGxldCBlcnJvclNwYW4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcignLmVycm9yLW1lc3NhZ2UnKTsKICAgICAgICBpZiAoIWVycm9yU3BhbikgewogICAgICAgICAgICBlcnJvclNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZXJyb3JTcGFuLmNsYXNzTmFtZSA9ICdlcnJvci1tZXNzYWdlJzsKICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGVycm9yU3Bhbik7CiAgICAgICAgfQogICAgICAgIGVycm9yU3Bhbi50ZXh0Q29udGVudCA9IG1lc3NhZ2U7CiAgICB9CiAgICBmdW5jdGlvbiBjbGVhclZhbGlkYXRpb25FcnJvcihlbGVtZW50KSB7CiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpbnB1dC1pbnZhbGlkJyk7CiAgICAgICAgY29uc3QgcGFyZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwLCAucmVtZW1iZXItbWUtY29udGFpbmVyJyk7CiAgICAgICAgcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvci1tZXNzYWdlJyk/LnJlbW92ZSgpOwogICAgfQogICAgZnVuY3Rpb24gY2xlYXJBbGxWYWxpZGF0aW9uRXJyb3JzKCkgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbnB1dC1pbnZhbGlkJykuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKCdpbnB1dC1pbnZhbGlkJykpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lcnJvci1tZXNzYWdlJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7CiAgICB9CiAgICBmdW5jdGlvbiBzZXR1cElubGluZVZhbGlkYXRpb24oKSB7CiAgICAgICAgY29uc3QgZmllbGRzVG9WYWxpZGF0ZSA9IFsncHJvZHVjdE5hbWUnLCAndGF4QXBwbGljYWJsZScsICdwcm9kdWN0VHlwZScsICd1b20nLCAncHJlcExvY2F0aW9uJywgJ21lbnVDYXRlZ29yeScsICdpbnZlbnRvcnlDYXRlZ29yeScsICdzdXBwbGllZFF1YW50aXR5JywgJ3lpZWxkUXVhbnRpdHknXTsKICAgICAgICBmaWVsZHNUb1ZhbGlkYXRlLmZvckVhY2goaWQgPT4gewogICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICAgICAgICAgICAgaWYgKGVsKSB7CiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZihlLnRhcmdldC5oYXNBdHRyaWJ1dGUoJ3JlcXVpcmVkJykgJiYgZS50YXJnZXQudmFsdWUudHJpbSgpID09PSAnJykgewogICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1ZhbGlkYXRpb25FcnJvcihlLnRhcmdldCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQuJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiBjbGVhclZhbGlkYXRpb25FcnJvcihlLnRhcmdldCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGV4cG9ydFRvRXhjZWwoKSB7CiAgICAgICAgaWYgKHByb2R1Y3RzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBzaG93TW9kYWwoIk5vIHByb2R1Y3RzIHRvIGV4cG9ydCEiLCAid2FybmluZyIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmICghc2Vzc2lvblNpdGUgfHwgc2Vzc2lvblNpdGUudHJpbSgpID09PSAnJykgewogICAgICAgICAgICBzaG93TW9kYWwoIlBsZWFzZSBzZXQgdGhlICdTaXRlJyBpbiBTZXNzaW9uIERlZmF1bHRzIGJlZm9yZSBleHBvcnRpbmcuIiwgImVycm9yIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHZpZGVvT3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlb092ZXJsYXknKTsKICAgICAgICBjb25zdCBleHBvcnRWaWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRWaWRlbycpOwoKICAgICAgICBjb25zdCBleHBvcnREYXRhID0gcHJvZHVjdHMubWFwKHAgPT4gewogICAgICAgICAgICBsZXQgaW52ZW50b3J5Q2F0ZWdvcnkgPSBwWyJJbnZlbnRvcnkgQ2F0ZWdvcnkiXTsKICAgICAgICAgICAgaWYgKGludmVudG9yeUNhdGVnb3J5KSB7IAogICAgICAgICAgICAgICAgc3dpdGNoIChwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgImZpbmlzaGVkR29vZCI6IAogICAgICAgICAgICAgICAgICAgICAgICBpbnZlbnRvcnlDYXRlZ29yeSArPSBwLl9zb3VyY2UuaXNQdXJjaGFzZWRGb3JSZXNhbGUgPyAiIC0gUkFXIE1BVEVSSUFMUyIgOiAiIC0gRklOSVNIRUQgR09PRCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgInJhd01hdGVyaWFsIjogY2FzZSAiZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwiOiBjYXNlICJNYW51ZmFjdHVyZWQiOgogICAgICAgICAgICAgICAgICAgICAgICBpbnZlbnRvcnlDYXRlZ29yeSArPSAiIC0gUkFXIE1BVEVSSUFMUyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBmaW5hbENvc3RQcmljZSA9IHBbIkNvc3QgUHJpY2UiXTsKICAgICAgICAgICAgaWYgKHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdID09PSAncmF3TWF0ZXJpYWwnICYmIHBbIlN1cHBsaWVkIFF1YW50aXR5Il0gJiYgTnVtYmVyKHBbIlN1cHBsaWVkIFF1YW50aXR5Il0pID4gMCkgewogICAgICAgICAgICAgICAgZmluYWxDb3N0UHJpY2UgPSBwWyJDb3N0IFByaWNlIl0gLyBOdW1iZXIocFsiU3VwcGxpZWQgUXVhbnRpdHkiXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcFsiUHJvZHVjdCBQTFUiXSwgIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiOiBwWyJQcm9kdWN0IE5hbWUgJiBWYXJpYW50Il0sICJTaXRlIjogcC5TaXRlLAogICAgICAgICAgICAgICJHUCI6IHBbIkdQIl0sICJTZWxsaW5nIFVPTSI6IHBbIlNlbGxpbmcgVU9NIl0sICJQcmVwYXJhdGlvbiBMb2NhdGlvbiI6IHBbIlByZXBhcmF0aW9uIExvY2F0aW9uIl0sCiAgICAgICAgICAgICAgIk1lbnUgQ2F0ZWdvcnkiOiBwWyJNZW51IENhdGVnb3J5Il0sICJJbnZlbnRvcnkgQ2F0ZWdvcnkiOiBpbnZlbnRvcnlDYXRlZ29yeSwgIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiOiBwWyJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5Il0sCiAgICAgICAgICAgICAgIlByb2R1Y3QgVHlwZSI6IHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdID09PSAiTWFudWZhY3R1cmVkIiA/ICJzaW5nbGUiIDogcFsiUHJvZHVjdCBUeXBlIl0sIAogICAgICAgICAgICAgICJFbmFibGVkIjogcC5FbmFibGVkLCAiQ29zdCBQcmljZSI6IGZpbmFsQ29zdFByaWNlLCAiU2VsbGluZyBQcmljZSI6IHBbIlNlbGxpbmcgUHJpY2UiXSwKICAgICAgICAgICAgICAiRHluYW1pYyBQcmljZSI6IGZhbHNlLCAiVmlzaWJsZSBvbiBBcHAiOiBmYWxzZSwgIkRlZmF1bHQgU2VsbGluZyBMb2NhdGlvbiI6ICJEZWZhdWx0IFNlbGxpbmcgTG9jYXRpb24iLCAiRGVmYXVsdCBTdG9yYWdlIExvY2F0aW9uIjogIkRlZmF1bHQgU3RvcmFnZSBMb2NhdGlvbiIsCiAgICAgICAgICAgICAgIlRheCBBcHBsaWNhYmxlIjogcFsiVGF4IEFwcGxpY2FibGUiXSwgIkJhcmNvZGUiOiBwLkJhcmNvZGUsIAogICAgICAgICAgICAgICJTdXBwbGllZCBRdWFudGl0eSI6IHBbIlN1cHBsaWVkIFF1YW50aXR5Il0gPyBgJHtwWyJTdXBwbGllZCBRdWFudGl0eSJdfSAke3BbIlNlbGxpbmcgVU9NIl19YCA6ICcnLAogICAgICAgICAgICAgICJTdXBwbGllZCBRdWFudGl0eSBDb3N0IFByaWNlIjogcFsiU3VwcGxpZWQgUXVhbnRpdHkiXSA/IHBbIkNvc3QgUHJpY2UiXSA6ICcnLCAKICAgICAgICAgICAgICAiTWFudWZhY3R1cmVkIFlpZWxkIjogcFsiTWFudWZhY3R1cmVkIFlpZWxkIl0sICJQcm9kdWN0IFBMVSAoRW5kKSI6IHBbIlByb2R1Y3QgUExVIl0sICJQcm9kdWN0IE5hbWUiOiBwWyJCYXNlIE5hbWUiXSwKICAgICAgICAgICAgICAiVmFyaWFudCI6IHBbIlZhcmlhbnQgTmFtZSJdIHx8ICIiLCAKICAgICAgICAgICAgICAiTGlzdGVkIFByb2R1Y3QgVHlwZSI6IHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdID09PSAiTWFudWZhY3R1cmVkIiA/ICJyYXdNYXRlcmlhbCIgOiBwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXQogICAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICBjb25zdCBjcmVhdGVQcm9kdWN0U3RydWN0dXJlRGF0YSA9IHByb2R1Y3RzLm1hcChwID0+IHsKICAgICAgICAgICAgY29uc3QgdmFyaWFudE5hbWUgPSBwWyJWYXJpYW50IE5hbWUiXSB8fCAnJzsKICAgICAgICAgICAgY29uc3QgbGlua2VkR3JvdXBzID0gcC5fc291cmNlPy5tb2RpZmllckxpbmtzPy5bdmFyaWFudE5hbWVdIHx8IFtdOwogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcFsiUHJvZHVjdCBQTFUiXSwgIk5hbWUiOiBwWyJCYXNlIE5hbWUiXSwgIlZhcmlhbnRzIjogcFsiVmFyaWFudCBOYW1lIl0gfHwgIiIsCiAgICAgICAgICAgICAgICAiTW9kaWZpZXJzIjogbGlua2VkR3JvdXBzLmpvaW4oJywgJyksICJNZW51IENhdGVnb3JpZXMiOiBwWyJNZW51IENhdGVnb3J5Il0sIAogICAgICAgICAgICAgICAgIkludmVudG9yeSBUeXBlIjogcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICJNYW51ZmFjdHVyZWQiID8gInJhd01hdGVyaWFsIiA6IHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdLCAKICAgICAgICAgICAgICAgICJUYWdzIjogIiIsICJTZWxsaW5nIFVPTSI6IHBbIlNlbGxpbmcgVU9NIl0sICJUYXggQXBwbGljYWJsZSI6IHBbIlRheCBBcHBsaWNhYmxlIl0sICJTaG93IG9uIFJveWFsdHkiOiBmYWxzZSwKICAgICAgICAgICAgICAgICJJbnZlbnRvcnkgQ2F0ZWdvcnkiOiBwWyJJbnZlbnRvcnkgQ2F0ZWdvcnkiXSwgIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiOiBwWyJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5Il0sCiAgICAgICAgICAgICAgICAiQmFyY29kZXMiOiBwLkJhcmNvZGUsICJQcm9kdWN0IFNLVSI6IHBbIlByb2R1Y3QgUExVIl0sICJEZXNjcmlwdGlvbiI6ICIiCiAgICAgICAgICAgIH07CiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IG1vZGlmaWVyU2hlZXREYXRhID0gW107CiAgICAgICAgaWYgKGN1cnJlbnRNb2RpZmllckdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtlZFByb2R1Y3RzID0gcHJvZHVjdHMuZmlsdGVyKHAgPT4gKHAuX3NvdXJjZT8ubW9kaWZpZXJMaW5rcz8uW3BbIlZhcmlhbnQgTmFtZSJdIHx8ICcnXSB8fCBbXSkuaW5jbHVkZXMoZ3JvdXAuZ3JvdXBOYW1lKSkubWFwKHAgPT4gcFsiUHJvZHVjdCBOYW1lICYgVmFyaWFudCJdKTsKICAgICAgICAgICAgICAgIG1vZGlmaWVyU2hlZXREYXRhLnB1c2goeyAiTGluZSBJdGVtIjogYE1PRElGSUVSIEdST1VQOiAke2dyb3VwLmdyb3VwTmFtZX1gLCAiRGV0YWlscyI6ICIiIH0pOwogICAgICAgICAgICAgICAgbW9kaWZpZXJTaGVldERhdGEucHVzaCh7ICJMaW5lIEl0ZW0iOiAiT3B0aW9ucyIsICJEZXRhaWxzIjogIlByaWNlIiB9KTsKICAgICAgICAgICAgICAgIGdyb3VwLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gbW9kaWZpZXJTaGVldERhdGEucHVzaCh7ICJMaW5lIEl0ZW0iOiBvcHRpb24ubmFtZSwgIkRldGFpbHMiOiAob3B0aW9uLnByaWNlIHx8IDApLnRvRml4ZWQoMikgfSkpOwogICAgICAgICAgICAgICAgbW9kaWZpZXJTaGVldERhdGEucHVzaCh7fSwgeyAiTGluZSBJdGVtIjogIkxpbmtlZCBTZWxsaW5nIFByb2R1Y3RzIiwgIkRldGFpbHMiOiBgKCR7bGlua2VkUHJvZHVjdHMubGVuZ3RofSBpdGVtL3MpYCB9KTsKICAgICAgICAgICAgICAgIGxpbmtlZFByb2R1Y3RzLmZvckVhY2gobmFtZSA9PiBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHsgIkxpbmUgSXRlbSI6IG5hbWUsICJEZXRhaWxzIjogIiIgfSkpOwogICAgICAgICAgICAgICAgbW9kaWZpZXJTaGVldERhdGEucHVzaCh7fSwge30pOwogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHsgIkxpbmUgSXRlbSI6ICJObyBtb2RpZmllciBncm91cHMgZGVmaW5lZCBpbiBsaWJyYXJ5LiIsICJEZXRhaWxzIjogIiIgfSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB3czEgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQoZXhwb3J0RGF0YSk7CiAgICAgICAgY29uc3Qgd3MyID0gWExTWC51dGlscy5qc29uX3RvX3NoZWV0KGNyZWF0ZVByb2R1Y3RTdHJ1Y3R1cmVEYXRhKTsKICAgICAgICBjb25zdCB3czMgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQobW9kaWZpZXJTaGVldERhdGEsIHtza2lwSGVhZGVyOiBmYWxzZX0pOwogICAgICAgIHdzM1snIWNvbHMnXSA9IFsge3djaDo2MH0sIHt3Y2g6MjB9IF07CiAgICAgICAgCiAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7CiAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MxLCAiU2l0ZSBQcm9kdWN0IFN0cnVjdHVyZSIpOwogICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzMiwgIkNyZWF0ZSBQcm9kdWN0IHN0cnVjdHVyZSIpOwogICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzMywgIk1vZGlmaWVyIEdyb3VwcyIpOwogICAgICAKICAgICAgICBjb25zdCBzYW5pdGl6ZWRTaXRlTmFtZSA9IHNlc3Npb25TaXRlLnRyaW0oKS5yZXBsYWNlKC9bXmEtekEtWjAtOVxzXy1dL2csICcnKS5yZXBsYWNlKC9ccysvZywgJ18nKTsKICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGAke3Nhbml0aXplZFNpdGVOYW1lfV9UYWJsZV9ieV9Zb2NvLnhsc3hgOwogICAgICAgIFhMU1gud3JpdGVGaWxlKHdiLCBmaWxlTmFtZSk7CgogICAgICAgIHZpZGVvT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIGV4cG9ydFZpZGVvLmN1cnJlbnRUaW1lID0gMDsKICAgICAgICBleHBvcnRTb3VuZEVsZW1lbnQuY3VycmVudFRpbWUgPSAwOwogICAgICAgIGV4cG9ydFZpZGVvLnBsYXkoKTsKICAgICAgICBleHBvcnRTb3VuZEVsZW1lbnQucGxheSgpOwoKICAgICAgICBleHBvcnRWaWRlby5vbmVuZGVkID0gKCkgPT4gewogICAgICAgICAgICB2aWRlb092ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgc2hvd01vZGFsKCdFeHBvcnQgc3VjY2Vzc2Z1bCEgQ2xlYXIgYWxsIGRhdGE/JywgJ3dhcm5pbmcnLCAoKSA9PiBjbGVhckFsbERhdGEoKSwgdHJ1ZSk7CiAgICAgICAgfTsKICAgIH0KICAgIGZ1bmN0aW9uIGFkZFRvRGF0YWxpc3QoaWQsIHZhbHVlKSB7CiAgICAgIGlmICghdmFsdWUpIHJldHVybjsgCiAgICAgIGNvbnN0IGRhdGFsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICBpZiAoZGF0YWxpc3QgJiYgIVsuLi5kYXRhbGlzdC5vcHRpb25zXS5zb21lKG8gPT4gby52YWx1ZSA9PT0gdmFsdWUpKSB7CiAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7IG9wdC52YWx1ZSA9IHZhbHVlOyBkYXRhbGlzdC5hcHBlbmRDaGlsZChvcHQpOwogICAgICB9CiAgICB9CgoKCgoKCjwvc2NyaXB0Pgo8ZGl2IGlkPSJ0dXRvcmlhbC1wcm9tcHQtbW9kYWwiIGNsYXNzPSJtb2RhbC1iYWNrZHJvcCI+CiAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CiAgICA8aDM+UXVpY2sgVHV0b3JpYWw8L2gzPgogICAgPHA+V291bGQgeW91IGxpa2UgYSBxdWljayB0b3VyIG9mIHRoZSBtYWluIGZlYXR1cmVzPzwvcD4KICAgIDxkaXYgY2xhc3M9Im1vZGFsLWJ1dHRvbnMiPgogICAgICA8YnV0dG9uIGlkPSJzdGFydC10dXRvcmlhbC1idG4iIGNsYXNzPSJidG4tYWRkIj5ZZXMsIHBsZWFzZTwvYnV0dG9uPgogICAgICA8YnV0dG9uIGlkPSJza2lwLXR1dG9yaWFsLWJ0biIgY2xhc3M9ImJ0bi1leHBvcnQiPk5vLCB0aGFua3M8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9InR1dG9yaWFsLW92ZXJsYXkiIGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5Ij4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktdG9wIj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktYm90dG9tIj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktbGVmdCI+PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Ij48L2Rpdj4KPC9kaXY+CjxkaXYgaWQ9InR1dG9yaWFsLXBvcG92ZXIiIGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyIj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItaGVhZGVyIj4KICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTEyIDIyczgtNCA4LTEwVjVsLTgtMy04IDN2N2MwIDYgOCAxMCA4IDEweiI+PC9wYXRoPjwvc3ZnPgogICAgICAgIDxzcGFuPlF1aWNrIEd1aWRlPC9zcGFuPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiIGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1uYXYiPgogICAgICAgIDxzcGFuIGlkPSJ0dXRvcmlhbC1zdGVwLWNvdW50ZXIiIGNsYXNzPSJ0ZXh0LXNtIj48L3NwYW4+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0idHV0b3JpYWwtcHJldi1idG4iIGNsYXNzPSJidG4tZXhwb3J0Ij5QcmV2PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gaWQ9InR1dG9yaWFsLW5leHQtYnRuIiBjbGFzcz0iYnRuLWFkZCI+TmV4dDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CjwvZGl2PgoKPHNjcmlwdD4KLy8gLS0tIFNtYXJ0IFRvb2x0aXAgQ29udHJvbGxlciAodjUpOiBjbGljay10by1vcGVuLCBsaW5nZXIgMXMgb24gYmx1ciAtLS0KKGZ1bmN0aW9uICgpIHsKICBpZiAod2luZG93Ll9fc21hcnRUb29sdGlwc1Y1KSByZXR1cm47IHdpbmRvdy5fX3NtYXJ0VG9vbHRpcHNWNSA9IHRydWU7CgogIGNvbnN0IExPTkdfUFJFU1NfTVMgPSAzNTA7CiAgY29uc3QgTElOR0VSX09OX0JMVVJfTVMgPSAxMDAwOyAvLyA8LS0gcGVyIHJlcXVpcmVtZW50CiAgY29uc3QgbGluZ2VyVGltZXJzID0gbmV3IFdlYWtNYXAoKTsKCiAgY29uc3QgZHluYW1pY0JvZGllcyA9IHsKICAgIHByb2R1Y3RUeXBlOiAoKSA9PiB7CiAgICAgIGNvbnN0IHR5cGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpOwogICAgICBjb25zdCB0eXBlID0gdHlwZUVsID8gKHR5cGVFbC52YWx1ZSB8fCAiIikgOiAiIjsKICAgICAgY29uc3QgYmFzZSA9IFsiPGI+V2hhdCBpcyB0aGlzIGl0ZW0/PC9iPiBZb3VyIGNob2ljZSBjaGFuZ2VzIHdoaWNoIGZpZWxkcyBhcmUgcmVxdWlyZWQuIl07CiAgICAgIGNvbnN0IG1hcCA9IHsKICAgICAgICBmaW5pc2hlZEdvb2Q6CiAgICAgICAgICAiPGI+RmluaXNoZWQgR29vZDo8L2I+IFlvdSBzZWxsIGl0IHRvIGN1c3RvbWVycyAoZS5nLiwgPGk+Q2xhc3NpYyBCdXJnZXI8L2k+KS4gWW914oCZbGwgc2V0IGNhdGVnb3J5LCBwcmVwIGFyZWEsIGFuZCBwcmljZS4iLAogICAgICAgIHJhd01hdGVyaWFsOgogICAgICAgICAgIjxiPlJhdyBNYXRlcmlhbDo8L2I+IFlvdSBkb27igJl0IHNlbGwgaXQ7IHlvdSA8aT51c2U8L2k+IGl0IChlLmcuLCA8aT41IGtnIGJhZyBvZiBmbG91cjwvaT4pLiBZb3XigJlsbCBzZXQgY29zdCBhbmQgc3VwcGxpZWQgcXVhbnRpdHkuIiwKICAgICAgICAiZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwiOgogICAgICAgICAgIjxiPkZpbmlzaGVkIEdvb2QgJiBSYXcgTWF0ZXJpYWw6PC9iPiBZb3Ugc2VsbCBpdCA8aT5hbmQ8L2k+IHVzZSBpdCAoZS5nLiwgPGk+Ym90dGxlZCBzYXVjZTwvaT4pLiBDb25zaWRlciDigJxQdXJjaGFzZWQgZm9yIFJlc2FsZeKAnS4iLAogICAgICAgIE1hbnVmYWN0dXJlZDoKICAgICAgICAgICI8Yj5NYW51ZmFjdHVyZWQ6PC9iPiBZb3UgbWFrZSBpdCBmcm9tIGluZ3JlZGllbnRzIChlLmcuLCA8aT5ob3VzZSBwYXR0eTwvaT4pLiBUcmFjayBpbnZlbnRvcnkgYXMgYSBwcmVwYXJhdGlvbi4iCiAgICAgIH07CiAgICAgIGlmIChtYXBbdHlwZV0pIGJhc2UucHVzaChtYXBbdHlwZV0pOwogICAgICByZXR1cm4gYmFzZS5qb2luKCI8YnI+Iik7CiAgICB9LAogICAgdW9tOiAoKSA9PiAiPGI+VW5pdCBvZiBNZWFzdXJlPC9iPjxicj5Ib3cgeW91IHNlbGwvc3RvY2sgdGhpcyBpdGVtLiBFeGFtcGxlczogZWEsIGtnLCBsLiIsCiAgICBzdXBwbGllZFF1YW50aXR5OiAoKSA9PiB7CiAgICAgIGNvbnN0IHUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW9tJyk7IGNvbnN0IHYgPSB1ID8gKHUudmFsdWUgfHwgInVuaXQiKSA6ICJ1bml0IjsKICAgICAgcmV0dXJuIGA8Yj5TdXBwbGllZCBRdWFudGl0eTwvYj48YnI+SG93IG11Y2ggeW91IHJlY2VpdmUgZnJvbSB0aGUgc3VwcGxpZXIgKGUuZy4sIDxpPjU8L2k+IGZvciBhIDUgJHt2fSBiYWcpLmA7CiAgICB9LAogICAgZGVmYXVsdFNlbGxpbmdQcmljZTogKCkgPT4gIjxiPkRlZmF1bHQgU2VsbGluZyBQcmljZTwvYj48YnI+VXNlZCBvbmx5IHdoZW4gdGhlcmUgYXJlIG5vIHZhcmlhbnRzLiIsCiAgICBjdXN0b21QbHU6ICgpID0+ICI8Yj5DdXN0b20gQmFzZSBQTFUvU0tVPC9iPjxicj5Vc2UgeW91ciBvd24gY29kZSBpZiB5b3UgYWxyZWFkeSBoYXZlIG9uZTsgb3RoZXJ3aXNlIHdl4oCZbGwgZ2VuZXJhdGUgaXQuIiwKICAgIGhhc0JhcmNvZGU6ICgpID0+ICI8Yj5IYXMgYSBiYXJjb2RlPzwvYj48YnI+Q2hvb3NlIOKAnFllc+KAnSB0byBlbnRlciB0aGUgc2Nhbm5hYmxlIGJhcmNvZGUgbnVtYmVyLiIsCiAgICB2YXJpYW50czogKCkgPT4gIjxiPlZhcmlhbnQgR3JvdXBzPC9iPjxicj5BZGQgb3B0aW9ucyBsaWtlIDxpPlNpemU8L2k+IChTLCBNLCBMKSBvciA8aT5NaWxrPC9pPiAoRnVsbCwgT2F0KS4iCiAgfTsKCiAgZnVuY3Rpb24gY2xlYXJMaW5nZXIobGFiZWwpewogICAgY29uc3QgdCA9IGxpbmdlclRpbWVycy5nZXQobGFiZWwpOwogICAgaWYgKHQpIHsgY2xlYXJUaW1lb3V0KHQpOyBsaW5nZXJUaW1lcnMuZGVsZXRlKGxhYmVsKTsgfQogICAgbGFiZWwuZGF0YXNldC5saW5nZXJBY3RpdmUgPSAiMCI7CiAgfQogIGZ1bmN0aW9uIHN0YXJ0TGluZ2VyKGxhYmVsLCBtcyl7CiAgICBjbGVhckxpbmdlcihsYWJlbCk7CiAgICBsYWJlbC5kYXRhc2V0LmxpbmdlckFjdGl2ZSA9ICIxIjsKICAgIGNvbnN0IHQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgbGFiZWwuZGF0YXNldC5saW5nZXJBY3RpdmUgPSAiMCI7CiAgICAgIGNvbnN0IGN0cmwgPSBmaW5kQ29udHJvbEZvckxhYmVsKGxhYmVsKTsKICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICAgIC8vIGlmIGZvY3VzIHJldHVybmVkIHRvIHRoaXMgbGFiZWwvY29udHJvbCwgZG9uJ3QgY2xvc2UKICAgICAgaWYgKGEgJiYgKGxhYmVsLmNvbnRhaW5zKGEpIHx8IChjdHJsICYmIChjdHJsPT09YSB8fCAoY3RybC5jb250YWlucyAmJiBjdHJsLmNvbnRhaW5zKGEpKSkpKSkgcmV0dXJuOwogICAgICBjbG9zZVRpcChsYWJlbCk7CiAgICB9LCBtcyk7CiAgICBsaW5nZXJUaW1lcnMuc2V0KGxhYmVsLCB0KTsKICB9CgogIGZ1bmN0aW9uIGdldFRpcENvbnRlbnQobGFiZWwpIHsKICAgIGNvbnN0IGR5bmFtaWNLZXkgPSBsYWJlbC5kYXRhc2V0LnRpcER5bmFtaWM7CiAgICBjb25zdCBzdGF0aWNUaXRsZSA9IGxhYmVsLmRhdGFzZXQudGlwVGl0bGUgfHwgIiI7CiAgICBjb25zdCBidWJibGUgPSBsYWJlbC5xdWVyeVNlbGVjdG9yKCcudG9vbHRpcHRleHQnKTsKICAgIGNvbnN0IHN0YXRpY0JvZHkgPSBidWJibGUgPyBidWJibGUuaW5uZXJIVE1MIDogIiI7CiAgICBjb25zdCBib2R5ID0gZHluYW1pY0tleSAmJiBkeW5hbWljQm9kaWVzW2R5bmFtaWNLZXldID8gZHluYW1pY0JvZGllc1tkeW5hbWljS2V5XSgpIDogc3RhdGljQm9keTsKICAgIHJldHVybiBgPGRpdiBjbGFzcz0idG9vbHRpcC10ZXh0LWNvbnRlbnQiPiR7c3RhdGljVGl0bGUgPyBgPGI+JHtzdGF0aWNUaXRsZX08L2I+PGJyPmAgOiAiIn0ke2JvZHl9PC9kaXY+YDsKICB9CgogIGZ1bmN0aW9uIHBvc2l0aW9uVGlwKGxhYmVsLCBidWJibGUpIHsKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtdG9wJywncG9zLWJvdHRvbScsJ3Bvcy1sZWZ0JywncG9zLXJpZ2h0Jyk7CiAgICBidWJibGUuc3R5bGUubGVmdCA9ICcnOyBidWJibGUuc3R5bGUucmlnaHQgPSAnJzsgYnViYmxlLnN0eWxlLnRvcCA9ICcnOyBidWJibGUuc3R5bGUuYm90dG9tID0gJyc7IGJ1YmJsZS5zdHlsZS50cmFuc2Zvcm0gPSAnJzsKICAgIGNvbnN0IHZ3ID0gd2luZG93LmlubmVyV2lkdGgsIHZoID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgY29uc3QgbHIgPSBsYWJlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IGN0cmwgPSBmaW5kQ29udHJvbEZvckxhYmVsKGxhYmVsKTsKICAgIGNvbnN0IGNyID0gY3RybCA/IGN0cmwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBudWxsOwogICAgY29uc3Qgc3BhY2VUb3AgPSBsci50b3A7CiAgICBjb25zdCBzcGFjZUJvdHRvbSA9IHZoIC0gbHIuYm90dG9tOwogICAgY29uc3Qgc3BhY2VMZWZ0ID0gbHIubGVmdDsKICAgIGNvbnN0IHNwYWNlUmlnaHQgPSB2dyAtIGxyLnJpZ2h0OwoKICAgIGZ1bmN0aW9uIG92ZXJsYXBzQ29udHJvbCgpIHsKICAgICAgaWYgKCFjcikgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3Qgbm9PdmVybGFwID0gYnIucmlnaHQgPCBjci5sZWZ0IHx8IGJyLmxlZnQgPiBjci5yaWdodCB8fCBici5ib3R0b20gPCBjci50b3AgfHwgYnIudG9wID4gY3IuYm90dG9tOwogICAgICByZXR1cm4gIW5vT3ZlcmxhcDsKICAgIH0KICAgIGZ1bmN0aW9uIGNsYW1wSG9yaXpvbnRhbCgpIHsKICAgICAgY29uc3QgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IG1hcmdpbiA9IDg7CiAgICAgIGlmIChici5yaWdodCA+IHZ3IC0gbWFyZ2luKSB7CiAgICAgICAgYnViYmxlLnN0eWxlLmxlZnQgPSBNYXRoLm1heChtYXJnaW4sIHZ3IC0gbWFyZ2luIC0gYnIud2lkdGgpICsgJ3B4JzsKICAgICAgICBidWJibGUuc3R5bGUudHJhbnNmb3JtID0gJ25vbmUnOwogICAgICB9IGVsc2UgaWYgKGJyLmxlZnQgPCBtYXJnaW4pIHsKICAgICAgICBidWJibGUuc3R5bGUubGVmdCA9IG1hcmdpbiArICdweCc7CiAgICAgICAgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgICAgfQoKICAgIC8vIFByZWZlciB0b3AgaWYgaW5wdXQgaXMgZGlyZWN0bHkgYmVsb3cgdGhlIGxhYmVsIHRvIGF2b2lkIGNvdmVyaW5nIHRoZSBmaWVsZAogICAgY29uc3QgcHJlZmVyVG9wID0gY3IgPyAoY3IudG9wID49IGxyLmJvdHRvbSAtIDIpIDogZmFsc2U7CgogICAgZnVuY3Rpb24gdHJ5Qm90dG9tKCl7CiAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7CiAgICAgIGxldCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKHNwYWNlQm90dG9tID49IGJyLmhlaWdodCArIDEyKSB7IGNsYW1wSG9yaXpvbnRhbCgpOyByZXR1cm4gIW92ZXJsYXBzQ29udHJvbCgpOyB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGZ1bmN0aW9uIHRyeVRvcCgpewogICAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLWJvdHRvbScpOyBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXRvcCcpOwogICAgICBsZXQgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGlmIChzcGFjZVRvcCA+PSBici5oZWlnaHQgKyAxMikgeyBjbGFtcEhvcml6b250YWwoKTsgcmV0dXJuICFvdmVybGFwc0NvbnRyb2woKTsgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBmdW5jdGlvbiB0cnlSaWdodCgpewogICAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLXRvcCcsJ3Bvcy1ib3R0b20nKTsgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy1yaWdodCcpOwogICAgICBsZXQgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHJldHVybiBzcGFjZVJpZ2h0ID49IGJyLndpZHRoICsgMTIgJiYgIW92ZXJsYXBzQ29udHJvbCgpOwogICAgfQogICAgZnVuY3Rpb24gdHJ5TGVmdCgpewogICAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLXJpZ2h0Jyk7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtbGVmdCcpOwogICAgICBsZXQgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHJldHVybiBzcGFjZUxlZnQgPj0gYnIud2lkdGggKyAxMiAmJiAhb3ZlcmxhcHNDb250cm9sKCk7CiAgICB9CgogICAgLy8gUHJpb3JpdHk6IGF2b2lkIG92ZXJsYXBwaW5nIHRoZSBjb250cm9sLiBJZiBwcmVmZXJUb3AsIHRyeSB0b3AgZmlyc3QuCiAgICBpZiAocHJlZmVyVG9wID8gKHRyeVRvcCgpIHx8IHRyeUJvdHRvbSgpIHx8IHRyeVJpZ2h0KCkgfHwgdHJ5TGVmdCgpKSA6ICh0cnlCb3R0b20oKSB8fCB0cnlUb3AoKSB8fCB0cnlSaWdodCgpIHx8IHRyeUxlZnQoKSkpIHJldHVybjsKCiAgICAvLyBGYWxsYmFjazogY2hvb3NlIHNpZGUgd2l0aCBtb3N0IHNwYWNlLCB0aGVuIGNsYW1wIHNpemUgYW5kIGVuc3VyZSBub3Qgb3ZlcmxhcHBpbmcKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtbGVmdCcsJ3Bvcy1yaWdodCcsJ3Bvcy10b3AnLCdwb3MtYm90dG9tJyk7CiAgICBpZiAoTWF0aC5tYXgoc3BhY2VCb3R0b20sIHNwYWNlVG9wKSA+PSBNYXRoLm1heChzcGFjZUxlZnQsIHNwYWNlUmlnaHQpKSB7CiAgICAgIGlmIChzcGFjZUJvdHRvbSA+PSBzcGFjZVRvcCkgeyBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLWJvdHRvbScpOyBidWJibGUuc3R5bGUubWF4SGVpZ2h0ID0gTWF0aC5tYXgoMTIwLCBzcGFjZUJvdHRvbSAtIDEyKSArICdweCc7IH0KICAgICAgZWxzZSB7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7IGJ1YmJsZS5zdHlsZS5tYXhIZWlnaHQgPSBNYXRoLm1heCgxMjAsIHNwYWNlVG9wIC0gMTIpICsgJ3B4JzsgfQogICAgICBjbGFtcEhvcml6b250YWwoKTsKICAgICAgaWYgKG92ZXJsYXBzQ29udHJvbCgpKSB7IGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtdG9wJywncG9zLWJvdHRvbScpOyBidWJibGUuY2xhc3NMaXN0LmFkZChzcGFjZVJpZ2h0ID49IHNwYWNlTGVmdCA/ICdwb3MtcmlnaHQnIDogJ3Bvcy1sZWZ0Jyk7IH0KICAgIH0gZWxzZSB7CiAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKHNwYWNlUmlnaHQgPj0gc3BhY2VMZWZ0ID8gJ3Bvcy1yaWdodCcgOiAncG9zLWxlZnQnKTsKICAgICAgY29uc3QgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGlmIChzcGFjZVJpZ2h0IDwgYnIud2lkdGggKyAxMiAmJiBzcGFjZUxlZnQgPCBici53aWR0aCArIDEyKSB7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heFdpZHRoID0gTWF0aC5tYXgoMTgwLCBNYXRoLm1heChzcGFjZVJpZ2h0LCBzcGFjZUxlZnQpIC0gMTIpICsgJ3B4JzsKICAgICAgfQogICAgfQogICAgfQoKICAgIC8vIFRyeSBib3R0b20KICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7CiAgICBsZXQgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBpZiAoc3BhY2VCb3R0b20gPj0gYnIuaGVpZ2h0ICsgMTIpIHsKICAgICAgY2xhbXBIb3Jpem9udGFsKCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIFRyeSB0b3AKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtYm90dG9tJyk7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZVRvcCA+PSBici5oZWlnaHQgKyAxMikgewogICAgICBjbGFtcEhvcml6b250YWwoKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gVHJ5IHJpZ2h0CiAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLXRvcCcpOyBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXJpZ2h0Jyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZVJpZ2h0ID49IGJyLndpZHRoICsgMTIpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gVHJ5IGxlZnQKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtcmlnaHQnKTsgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy1sZWZ0Jyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZUxlZnQgPj0gYnIud2lkdGggKyAxMikgewogICAgICByZXR1cm47CiAgICB9CiAgICAvLyBGYWxsYmFjazogcGljayB0aGUgc2lkZSB3aXRoIG1vc3Qgc3BhY2UgYW5kIGNvbnN0cmFpbiBzaXplCiAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLWxlZnQnLCdwb3MtcmlnaHQnLCdwb3MtdG9wJywncG9zLWJvdHRvbScpOwogICAgaWYgKE1hdGgubWF4KHNwYWNlQm90dG9tLCBzcGFjZVRvcCkgPj0gTWF0aC5tYXgoc3BhY2VMZWZ0LCBzcGFjZVJpZ2h0KSkgewogICAgICAvLyBVc2UgdmVydGljYWwgd2l0aCBtYXgtaGVpZ2h0IGNsYW1wCiAgICAgIGlmIChzcGFjZUJvdHRvbSA+PSBzcGFjZVRvcCkgewogICAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heEhlaWdodCA9IE1hdGgubWF4KDEyMCwgc3BhY2VCb3R0b20gLSAxMikgKyAncHgnOwogICAgICB9IGVsc2UgewogICAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heEhlaWdodCA9IE1hdGgubWF4KDEyMCwgc3BhY2VUb3AgLSAxMikgKyAncHgnOwogICAgICB9CiAgICAgIGNsYW1wSG9yaXpvbnRhbCgpOwogICAgfSBlbHNlIHsKICAgICAgLy8gVXNlIGhvcml6b250YWwgd2l0aCB3aWR0aCBjbGFtcAogICAgICBpZiAoc3BhY2VSaWdodCA+PSBzcGFjZUxlZnQpIHsKICAgICAgICBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXJpZ2h0Jyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heFdpZHRoID0gTWF0aC5tYXgoMTgwLCBzcGFjZVJpZ2h0IC0gMTIpICsgJ3B4JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLWxlZnQnKTsKICAgICAgICBidWJibGUuc3R5bGUubWF4V2lkdGggPSBNYXRoLm1heCgxODAsIHNwYWNlTGVmdCAtIDEyKSArICdweCc7CiAgICAgIH0KICAgIH0KICAgIC8vIENsYW1wIGhvcml6b250YWxseSB0byB2aWV3cG9ydCBtYXJnaW5zCiAgICBpZiAocmVjdC5yaWdodCA+IHZ3IC0gbWFyZ2luKSB7CiAgICAgIGJ1YmJsZS5zdHlsZS5sZWZ0ID0gTWF0aC5tYXgobWFyZ2luLCB2dyAtIG1hcmdpbiAtIHJlY3Qud2lkdGgpICsgJ3B4JzsKICAgICAgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgIH0gZWxzZSBpZiAocmVjdC5sZWZ0IDwgbWFyZ2luKSB7CiAgICAgIGJ1YmJsZS5zdHlsZS5sZWZ0ID0gbWFyZ2luICsgJ3B4JzsKICAgICAgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgIH0KICAgIGlmIChyZWN0LnRvcCA8IG1hcmdpbikgewogICAgICBidWJibGUuc3R5bGUuYm90dG9tID0gImF1dG8iOyBidWJibGUuc3R5bGUudG9wID0gIjEwMCUiOwogICAgfSBlbHNlIHsKICAgICAgYnViYmxlLnN0eWxlLnRvcCA9ICIiOyBidWJibGUuc3R5bGUuYm90dG9tID0gIjEyNSUiOwogICAgfQogIH0KCiAgZnVuY3Rpb24gb3BlblRpcChsYWJlbCkgewogICAgLy8gQ2xvc2UgYWxsIG90aGVyIG9wZW4gdG9vbHRpcHMgZmlyc3QKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29sdGlwLmlzLW9wZW4nKS5mb3JFYWNoKGwgPT4gewogICAgICBpZiAobCAhPT0gbGFiZWwpIHsKICAgICAgICBsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW9wZW4nKTsKICAgICAgICBpZiAod2luZG93Ll9fYWN0aXZlVG9vbHRpcExhYmVsID09PSBsKSB7IHRyeSB7IHdpbmRvdy5fX2FjdGl2ZVRvb2x0aXBMYWJlbCA9IG51bGw7IH0gY2F0Y2goZSl7fSB9CiAgICAgIH0KICAgIH0pOwogICAgY2xlYXJMaW5nZXIobGFiZWwpOwogICAgbGFiZWwuZGF0YXNldC50aXBTdGF0ZSA9ICdvcGVuJzsKICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2lzLW9wZW4nKTsKICAgIGNvbnN0IGJ1YmJsZSA9IGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy50b29sdGlwdGV4dCcpOwogICAgdHJ5IHsgd2luZG93Ll9fYWN0aXZlVG9vbHRpcExhYmVsID0gbGFiZWw7IH0gY2F0Y2goZSkge30KICAgIAogICAgaWYgKCFidWJibGUpIHJldHVybjsKICAgIGJ1YmJsZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndG9vbHRpcCcpOwogICAgYnViYmxlLmlubmVySFRNTCA9IGdldFRpcENvbnRlbnQobGFiZWwpOwogICAgcG9zaXRpb25UaXAobGFiZWwsIGJ1YmJsZSk7CiAgfQoKICBmdW5jdGlvbiBjbG9zZVRpcChsYWJlbCkgewogICAgbGFiZWwuZGF0YXNldC50aXBTdGF0ZSA9ICdjbG9zZWQnOwogICAgbGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtb3BlbicpOwogICAgaWYgKHdpbmRvdy5fX2FjdGl2ZVRvb2x0aXBMYWJlbCA9PT0gbGFiZWwpIHsgdHJ5IHsgd2luZG93Ll9fYWN0aXZlVG9vbHRpcExhYmVsID0gbnVsbDsgfSBjYXRjaChlKXt9IH0KICB9CgogIGZ1bmN0aW9uIGZpbmRDb250cm9sRm9yTGFiZWwobGFiZWwpIHsKICAgIGNvbnN0IGh0bWxGb3IgPSBsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpOwogICAgbGV0IGN0cmwgPSBudWxsOwogICAgaWYgKGh0bWxGb3IpIGN0cmwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChodG1sRm9yKTsKICAgIGlmICghY3RybCkgY3RybCA9IGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBidXR0b24nKTsKICAgIGlmICghY3RybCkgewogICAgICBsZXQgc2liID0gbGFiZWwubmV4dEVsZW1lbnRTaWJsaW5nLCBzdGVwcyA9IDA7CiAgICAgIHdoaWxlIChzaWIgJiYgc3RlcHMgPCA2ICYmICFjdHJsKSB7CiAgICAgICAgaWYgKHNpYi5tYXRjaGVzICYmIHNpYi5tYXRjaGVzKCdpbnB1dCxzZWxlY3QsdGV4dGFyZWEsYnV0dG9uJykpIHsgY3RybCA9IHNpYjsgYnJlYWs7IH0KCiAgLy8gUm9idXN0bHkgbG9jYXRlIGEgdG9vbHRpcCBsYWJlbCBmb3IgYSBnaXZlbiBjb250cm9sCiAgZnVuY3Rpb24gZmluZExhYmVsRm9yQ29udHJvbChjdHJsKSB7CiAgICBpZiAoIWN0cmwgfHwgIShjdHJsIGluc3RhbmNlb2YgRWxlbWVudCkpIHJldHVybiBudWxsOwogICAgLy8gMSkgRGlyZWN0IGJ5IGlkL2ZvcgogICAgaWYgKGN0cmwuaWQpIHsKICAgICAgbGV0IGxhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC50b29sdGlwW2Zvcj0iJHtjdHJsLmlkfSJdYCk7CiAgICAgIGlmIChsYWIpIHJldHVybiBsYWI7CiAgICAgIGxhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGxhYmVsW2Zvcj0iJHtjdHJsLmlkfSJdLnRvb2x0aXBgKTsKICAgICAgaWYgKGxhYikgcmV0dXJuIGxhYjsKICAgIH0KICAgIC8vIDIpIEFuY2VzdG9yIHRvb2x0aXAKICAgIGxldCBhbmMgPSBjdHJsLmNsb3Nlc3QoJy50b29sdGlwJyk7CiAgICBpZiAoYW5jKSByZXR1cm4gYW5jOwogICAgLy8gMykgTmVhcmJ5IHNpYmxpbmdzIChiZWZvcmUvYWZ0ZXIpCiAgICBsZXQgY3VyID0gY3RybC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLCBzdGVwcz0wOwogICAgd2hpbGUgKGN1ciAmJiBzdGVwcyA8IDgpIHsKICAgICAgaWYgKGN1ci5jbGFzc0xpc3QgJiYgY3VyLmNsYXNzTGlzdC5jb250YWlucygndG9vbHRpcCcpKSByZXR1cm4gY3VyOwogICAgICBpZiAoY3VyLm1hdGNoZXMgJiYgY3VyLm1hdGNoZXMoJ2xhYmVsLnRvb2x0aXAnKSkgcmV0dXJuIGN1cjsKICAgICAgY3VyID0gY3VyLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7IHN0ZXBzKys7CiAgICB9CiAgICBjdXIgPSBjdHJsLm5leHRFbGVtZW50U2libGluZzsgc3RlcHM9MDsKICAgIHdoaWxlIChjdXIgJiYgc3RlcHMgPCA4KSB7CiAgICAgIGlmIChjdXIuY2xhc3NMaXN0ICYmIGN1ci5jbGFzc0xpc3QuY29udGFpbnMoJ3Rvb2x0aXAnKSkgcmV0dXJuIGN1cjsKICAgICAgaWYgKGN1ci5tYXRjaGVzICYmIGN1ci5tYXRjaGVzKCdsYWJlbC50b29sdGlwJykpIHJldHVybiBjdXI7CiAgICAgIGN1ciA9IGN1ci5uZXh0RWxlbWVudFNpYmxpbmc7IHN0ZXBzKys7CiAgICB9CiAgICAvLyA0KSBDb250YWluZXItYXdhcmUgc2VhcmNoOiBzY2FuIHVwIGFuY2VzdG9ycywgcGljayBuZWFyZXN0IHRvb2x0aXAgbGFiZWwgYWJvdmUgdGhlIGNvbnRyb2wKICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBbXTsKICAgIGxldCBwID0gY3RybC5wYXJlbnRFbGVtZW50OyBsZXQgZGVwdGggPSAwOwogICAgY29uc3QgbWF4RGVwdGggPSA0OwogICAgd2hpbGUgKHAgJiYgZGVwdGggPCBtYXhEZXB0aCkgewogICAgICBwLnF1ZXJ5U2VsZWN0b3JBbGwgJiYgcC5xdWVyeVNlbGVjdG9yQWxsKCdsYWJlbC50b29sdGlwLCAudG9vbHRpcCcpLmZvckVhY2goZWwgPT4geyBpZiAoZWwgaW5zdGFuY2VvZiBFbGVtZW50KSBjYW5kaWRhdGVzLnB1c2goZWwpOyB9KTsKICAgICAgcCA9IHAucGFyZW50RWxlbWVudDsgZGVwdGgrKzsKICAgIH0KICAgIGlmIChjYW5kaWRhdGVzLmxlbmd0aCkgewogICAgICBjb25zdCBjUmVjdCA9IGN0cmwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGxldCBiZXN0ID0gbnVsbCwgYmVzdFNjb3JlID0gSW5maW5pdHk7CiAgICAgIGNhbmRpZGF0ZXMuZm9yRWFjaChsYWIgPT4gewogICAgICAgIGNvbnN0IHIgPSBsYWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgLy8gUHJlZmVyIGxhYmVscyB0aGF0IGFyZSBhYm92ZSB0aGUgY29udHJvbCBhbmQgaG9yaXpvbnRhbGx5IG92ZXJsYXBwaW5nCiAgICAgICAgY29uc3QgaG9yaXpPdmVybGFwID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oci5yaWdodCwgY1JlY3QucmlnaHQpIC0gTWF0aC5tYXgoci5sZWZ0LCBjUmVjdC5sZWZ0KSk7CiAgICAgICAgY29uc3QgdmVydGljYWxEZWx0YSA9IGNSZWN0LnRvcCAtIHIuYm90dG9tOyAvLyBwb3NpdGl2ZSBpZiBsYWJlbCBpcyBhYm92ZQogICAgICAgIGlmICh2ZXJ0aWNhbERlbHRhID49IC02ICYmIGhvcml6T3ZlcmxhcCA+IDApIHsKICAgICAgICAgIGNvbnN0IHNjb3JlID0gdmVydGljYWxEZWx0YSArIChNYXRoLmFicygoci5sZWZ0ICsgci5yaWdodCkvMiAtIChjUmVjdC5sZWZ0ICsgY1JlY3QucmlnaHQpLzIpICogMC4wMSk7CiAgICAgICAgICBpZiAoc2NvcmUgPCBiZXN0U2NvcmUpIHsgYmVzdFNjb3JlID0gc2NvcmU7IGJlc3QgPSBsYWI7IH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAoYmVzdCkgcmV0dXJuIGJlc3Q7CiAgICAgIC8vIGZhbGxiYWNrOiBuZWFyZXN0IGJ5IGRpc3RhbmNlCiAgICAgIGxldCBiZXN0QW55ID0gbnVsbCwgYmVzdERpc3QgPSBJbmZpbml0eTsKICAgICAgY2FuZGlkYXRlcy5mb3JFYWNoKGxhYiA9PiB7CiAgICAgICAgY29uc3QgciA9IGxhYi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBjb25zdCBkeCA9IChyLmxlZnQgKyByLnJpZ2h0KS8yIC0gKGNSZWN0LmxlZnQgKyBjUmVjdC5yaWdodCkvMjsKICAgICAgICBjb25zdCBkeSA9IChyLnRvcCArIHIuYm90dG9tKS8yIC0gKGNSZWN0LnRvcCArIGNSZWN0LmJvdHRvbSkvMjsKICAgICAgICBjb25zdCBkaXN0ID0gTWF0aC5oeXBvdChkeCwgZHkpOwogICAgICAgIGlmIChkaXN0IDwgYmVzdERpc3QpIHsgYmVzdERpc3QgPSBkaXN0OyBiZXN0QW55ID0gbGFiOyB9CiAgICAgIH0pOwogICAgICBpZiAoYmVzdEFueSkgcmV0dXJuIGJlc3RBbnk7CiAgICB9CiAgICByZXR1cm4gbnVsbDsKICB9CiAgICAgICAgaWYgKHNpYi5xdWVyeVNlbGVjdG9yKSB7IGNvbnN0IGZvdW5kID0gc2liLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0LHNlbGVjdCx0ZXh0YXJlYSxidXR0b24nKTsgaWYgKGZvdW5kKSB7IGN0cmwgPSBmb3VuZDsgYnJlYWs7IH0gfQogICAgICAgIHNpYiA9IHNpYi5uZXh0RWxlbWVudFNpYmxpbmc7IHN0ZXBzKys7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBjdHJsOwogIH0KCiAgZnVuY3Rpb24gd2lyZVBhaXIoY3RybCwgbGFiZWwpIHsKICAgIGlmIChsYWJlbC5kYXRhc2V0LnRvb2x0aXBXaXJlZCA9PT0gJzEnKSByZXR1cm47CiAgICBsYWJlbC5kYXRhc2V0LnRvb2x0aXBXaXJlZCA9ICcxJzsKCiAgICBsZXQgcHJlc3NUaW1lciA9IG51bGw7CgogICAgLy8gQ2xpY2tpbmcgdGhlIGxhYmVsIHRvZ2dsZXMgKGJ1dCBpZ25vcmUgaWYgY2xpY2tpbmcgdGhlIGNvbnRyb2wgaW5zaWRlIGl0KQogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICBpZiAoKGUudGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCkgJiYgKGUudGFyZ2V0Lm1hdGNoZXMoJ2lucHV0LHNlbGVjdCx0ZXh0YXJlYSxidXR0b24nKSB8fCBlLnRhcmdldC5jbG9zZXN0KCcudG9vbHRpcHRleHQnKSkpIHJldHVybjsKICAgICAgaWYgKGxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnaXMtb3BlbicpKSBjbG9zZVRpcChsYWJlbCk7CiAgICAgIGVsc2Ugb3BlblRpcChsYWJlbCk7CiAgICB9KTsKICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7IHByZXNzVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IG9wZW5UaXAobGFiZWwpLCBMT05HX1BSRVNTX01TKTsgfSwge3Bhc3NpdmU6dHJ1ZX0pOwogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiBjbGVhclRpbWVvdXQocHJlc3NUaW1lcikpOwoKICAgIC8vIENvbnRyb2wgaW50ZXJhY3Rpb25zOiBvcGVuIG9uIGZvY3VzL2NsaWNrL2lucHV0OyBETyBOT1QgYXV0by1jbG9zZSBoZXJlCiAgICBpZiAoY3RybCkgewogICAgICBbJ2ZvY3VzJywnY2xpY2snLCdpbnB1dCddLmZvckVhY2goZXZ0ID0+IGN0cmwuYWRkRXZlbnRMaXN0ZW5lcihldnQsICgpID0+IG9wZW5UaXAobGFiZWwpKSk7CiAgICAgIGN0cmwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCAoKSA9PiBvcGVuVGlwKGxhYmVsKSk7CiAgICAgIGN0cmwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4geyBvcGVuVGlwKGxhYmVsKTsgLyogbm8gbGluZ2VyIGhlcmU7IGJsdXIgd2lsbCBoYW5kbGUgaXQgKi8gfSk7CiAgICB9CgogICAgLy8gS2VlcCBvcGVuIHdoaWxlIGZvY3VzZWQKICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCAoKSA9PiBvcGVuVGlwKGxhYmVsKSk7CiAgICBpZiAoY3RybCkgY3RybC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgKCkgPT4gb3BlblRpcChsYWJlbCkpOwoKICAgIC8vIE9uIGJsdXIgb2YgbGFiZWwgb3IgY29udHJvbCwgbGluZ2VyIDFzIHRoZW4gY2xvc2UgKHVubGVzcyBmb2N1cyByZXR1cm5zKQogICAgZnVuY3Rpb24gb25CbHVyU2NoZWR1bGVMaW5nZXIoKXsKICAgICAgc3RhcnRMaW5nZXIobGFiZWwsIExJTkdFUl9PTl9CTFVSX01TKTsKICAgIH0KICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0Jywgb25CbHVyU2NoZWR1bGVMaW5nZXIsIHRydWUpOwogICAgaWYgKGN0cmwpIGN0cmwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBvbkJsdXJTY2hlZHVsZUxpbmdlciwgdHJ1ZSk7CgogICAgLy8gRXNjIGNsb3NlcyBpbW1lZGlhdGVseQogICAgZnVuY3Rpb24gZXNjSGFuZGxlcihlKXsgaWYgKGUua2V5PT09J0VzY2FwZScpeyBjbGVhckxpbmdlcihsYWJlbCk7IGNsb3NlVGlwKGxhYmVsKTsgfSB9CiAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXNjSGFuZGxlcik7CiAgICBpZiAoY3RybCkgY3RybC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXNjSGFuZGxlcik7CiAgCiAgICAvLyBQcmV2ZW50IGNsaWNrcyBpbnNpZGUgYnViYmxlIGZyb20gdG9nZ2xpbmcvY2xvc2luZyB0aGUgbGFiZWwKICAgIGNvbnN0IGJ1YmJsZUVsID0gbGFiZWwucXVlcnlTZWxlY3RvcignLnRvb2x0aXB0ZXh0Jyk7CiAgICBpZiAoYnViYmxlRWwpIHsKICAgICAgY29uc3Qgc3RvcCA9IChldikgPT4geyBldi5zdG9wUHJvcGFnYXRpb24oKTsgfTsKICAgICAgYnViYmxlRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wLCB0cnVlKTsKICAgICAgYnViYmxlRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3RvcCwgdHJ1ZSk7CiAgICAgIGJ1YmJsZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgc3RvcCwgdHJ1ZSk7CiAgICB9CgoKICAgIC8vIEhvdmVyIHN1cHBvcnQ6IHNob3cgb24gaG92ZXIgb2YgdGhlIHRpdGxlL2xhYmVsLCBjbG9zZSBhZnRlciBsaW5nZXIgb24gbGVhdmUKICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiBvcGVuVGlwKGxhYmVsKSk7CiAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gc3RhcnRMaW5nZXIobGFiZWwsIExJTkdFUl9PTl9CTFVSX01TKSk7Cn0gIGZ1bmN0aW9uIGJ1aWxkUGFpcnNBbmRXaXJlKCkgewogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2x0aXAnKS5mb3JFYWNoKGxhYmVsID0+IHsKICAgICAgY29uc3QgY3RybCA9IGZpbmRDb250cm9sRm9yTGFiZWwobGFiZWwpOwogICAgICB3aXJlUGFpcihjdHJsLCBsYWJlbCk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGluaXQoKSB7CiAgICBidWlsZFBhaXJzQW5kV2lyZSgpOwoKICAgIC8vIEFsbG93IGV4dGVybmFsICJzbWFydFRvb2x0aXA6b3BlbiIgcmVxdWVzdHMgKGUuZy4sIHR1dG9yaWFsKQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc21hcnRUb29sdGlwOm9wZW4nLCAoZSkgPT4gewogICAgICBjb25zdCBsYWJlbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50b29sdGlwJyk7CiAgICAgIGlmIChsYWJlbCkgb3BlblRpcChsYWJlbCk7CiAgICB9LCB0cnVlKTsKCiAgICAvLyBPcGVuIHRvb2x0aXAgd2hlbiBhIGNvbnRyb2wgaXMgbWFya2VkIGludmFsaWQgYnkgYWRkaW5nIGNsYXNzOyB0aHJvdHRsZWQgYnkgckFGCiAgICBsZXQgc2NoZWR1bGVkID0gZmFsc2U7CiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRzKSA9PiB7CiAgICAgIGlmIChzY2hlZHVsZWQpIHJldHVybjsKICAgICAgc2NoZWR1bGVkID0gdHJ1ZTsKICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgICBzY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgICBtdXRzLmZvckVhY2gobSA9PiB7CiAgICAgICAgICBjb25zdCBlbCA9IG0udGFyZ2V0OwogICAgICAgICAgaWYgKCEoZWwgaW5zdGFuY2VvZiBFbGVtZW50KSkgcmV0dXJuOwogICAgICAgICAgaWYgKCFlbC5tYXRjaGVzKCdpbnB1dCxzZWxlY3QsdGV4dGFyZWEnKSkgcmV0dXJuOwogICAgICAgICAgaWYgKGVsLmNsYXNzTGlzdC5jb250YWlucygnaW5wdXQtaW52YWxpZCcpKSB7CiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnRvb2x0aXBbZm9yPSIke2VsLmlkfSJdYCkgfHwgZWwuY2xvc2VzdCgnLnRvb2x0aXAnKTsKICAgICAgICAgICAgaWYgKGxhYmVsKSBvcGVuVGlwKGxhYmVsKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge3N1YnRyZWU6dHJ1ZSwgYXR0cmlidXRlczp0cnVlLCBhdHRyaWJ1dGVGaWx0ZXI6WydjbGFzcyddfSk7CiAgfQoKICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCwge29uY2U6dHJ1ZX0pOwogIH0gZWxzZSB7CiAgICBpbml0KCk7CiAgfQoKICAvLyBNaW5pbWFsIHB1YmxpYyBBUEkKICB3aW5kb3cuU21hcnRUb29sdGlwcyA9IHdpbmRvdy5TbWFydFRvb2x0aXBzIHx8IHsKICAgIG9wZW5Gb3IodGFyZ2V0KXsKICAgICAgY29uc3QgZWwgPSAodHlwZW9mIHRhcmdldD09PSdzdHJpbmcnKSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KSA6IHRhcmdldDsKICAgICAgaWYgKCFlbCkgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnRvb2x0aXBbZm9yPSIke2VsLmlkfSJdYCkgfHwgZWwuY2xvc2VzdCgnLnRvb2x0aXAnKTsKICAgICAgaWYgKGwpeyBvcGVuVGlwKGwpOyBlbC5mb2N1cyAmJiBlbC5mb2N1cygpOyByZXR1cm4gdHJ1ZTsgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgY2xvc2VBbGwoKXsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2x0aXAuaXMtb3BlbicpLmZvckVhY2gobCA9PiBsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW9wZW4nKSk7IH0KICB9Owp9KSgpOwo8L3NjcmlwdD4KCgo8c2NyaXB0PgovKiBQcm9kdWN0IFR5cGUgVVg6CiAgIC0gZGVmYXVsdCBvcHRpb24gIi0gU2VsZWN0IC0iCiAgIC0gc2hvdyBBTEwgZXhwbGFuYXRpb25zIG9uIGZvY3VzIHdoZW4gdW5zZWxlY3RlZAogICAtIHN3aXRjaCB0byBmb2N1c2VkIGV4YW1wbGUgYWZ0ZXIgc2VsZWN0aW9uICsgIlNob3cgYWxsIHR5cGVzIiB0b2dnbGUKKi8KKGZ1bmN0aW9uICgpIHsKICBjb25zdCBGSUVMRF9JRCA9ICJwcm9kdWN0VHlwZSI7CgogIGZ1bmN0aW9uIGVuc3VyZURlZmF1bHRPcHRpb24oKSB7CiAgICBjb25zdCBzZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChGSUVMRF9JRCk7CiAgICBpZiAoIXNlbCkgcmV0dXJuOwogICAgY29uc3QgaGFzQmxhbmsgPSBBcnJheS5mcm9tKHNlbC5vcHRpb25zKS5zb21lKG8gPT4gby52YWx1ZSA9PT0gIiIgJiYgL3NlbGVjdC9pLnRlc3Qoby50ZXh0Q29udGVudCB8fCAiIikpOwogICAgaWYgKCFoYXNCbGFuaykgewogICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsKICAgICAgb3B0LnZhbHVlID0gIiI7IG9wdC50ZXh0Q29udGVudCA9ICItIFNlbGVjdCAtIjsgb3B0LmRpc2FibGVkID0gdHJ1ZTsKICAgICAgc2VsLmluc2VydEJlZm9yZShvcHQsIHNlbC5maXJzdENoaWxkKTsKICAgIH0KICAgIGNvbnN0IG9rID0gQXJyYXkuZnJvbShzZWwub3B0aW9ucykuc29tZShvID0+IG8udmFsdWUgPT09IHNlbC52YWx1ZSAmJiAhby5kaXNhYmxlZCk7CiAgICBpZiAoIW9rKSB7IHNlbC52YWx1ZSA9ICIiOyBjb25zdCBibGFuayA9IEFycmF5LmZyb20oc2VsLm9wdGlvbnMpLmZpbmQobyA9PiBvLnZhbHVlID09PSAiIik7IGlmIChibGFuaykgYmxhbmsuc2VsZWN0ZWQgPSB0cnVlOyB9CiAgfQoKICBjb25zdCBodG1sQWxsID0gKCkgPT4gWwogICAgIjxiPldoYXQgaXMgdGhpcyBpdGVtPzwvYj4gWW91ciBjaG9pY2UgY2hhbmdlcyB3aGljaCBmaWVsZHMgYXJlIHJlcXVpcmVkLjxicj48YnI+IiwKICAgICI8dWwgc3R5bGU9J21hcmdpbjowIDAgMC41cmVtIDEuMnJlbTsgcGFkZGluZzowOyc+IiwKICAgICI8bGk+PGI+RmluaXNoZWQgR29vZDwvYj46IFlvdSBzZWxsIGl0IHRvIGN1c3RvbWVycyAoZS5nLiwgPGk+Q2xhc3NpYyBCdXJnZXI8L2k+KS4gWW914oCZbGwgc2V0IGNhdGVnb3J5LCBwcmVwIGFyZWEsIGFuZCBwcmljZS48L2xpPiIsCiAgICAiPGxpPjxiPlJhdyBNYXRlcmlhbDwvYj46IFlvdSBkb24ndCBzZWxsIGl0OyB5b3UgPGk+dXNlPC9pPiBpdCAoZS5nLiwgPGk+NSBrZyBiYWcgb2YgZmxvdXI8L2k+KS4gWW914oCZbGwgc2V0IGNvc3QgYW5kIHN1cHBsaWVkIHF1YW50aXR5LjwvbGk+IiwKICAgICI8bGk+PGI+RmluaXNoZWQgR29vZCAmIFJhdyBNYXRlcmlhbDwvYj46IFlvdSBzZWxsIGl0IDxpPmFuZDwvaT4gdXNlIGl0IChlLmcuLCA8aT5ib3R0bGVkIHNhdWNlPC9pPikuIENvbnNpZGVyIOKAnFB1cmNoYXNlZCBmb3IgUmVzYWxl4oCdLjwvbGk+IiwKICAgICI8bGk+PGI+TWFudWZhY3R1cmVkPC9iPjogWW91IG1ha2UgaXQgZnJvbSBpbmdyZWRpZW50cyAoZS5nLiwgPGk+aG91c2UgcGF0dHk8L2k+KS4gVHJhY2sgaW52ZW50b3J5IGFzIGEgcHJlcGFyYXRpb24uPC9saT4iLAogICAgIjwvdWw+IiwKICAgICI8ZGl2IHN0eWxlPSdmb250LXNpemU6MTJweDtjb2xvcjojNTU1Jz5UaXA6IFlvdSBjYW4gY2hhbmdlIHRoaXMgbGF0ZXLigJRkb3duc3RyZWFtIGZpZWxkcyB3aWxsIGFkanVzdC48L2Rpdj4iCiAgXS5qb2luKCIiKTsKCiAgY29uc3QgaHRtbEZvciA9ICh2YWwwKSA9PiB7CiAgICBjb25zdCB2ID0gU3RyaW5nKHZhbDAgfHwgIiIpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgdG9nZ2xlID0gJzxkaXYgc3R5bGU9Im1hcmdpbi10b3A6OHB4OyI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJwdC12aWV3LWFsbCIgc3R5bGU9ImZvbnQtc2l6ZToxMnB4O2JhY2tncm91bmQ6bm9uZTtib3JkZXI6bm9uZTtjb2xvcjojMGE2O2N1cnNvcjpwb2ludGVyO3BhZGRpbmc6MDsiPlNob3cgYWxsIHR5cGVzPC9idXR0b24+PC9kaXY+JzsKICAgIGlmICh2ID09PSAiZmluaXNoZWRnb29kIiB8fCB2ID09PSAiZmluaXNoZWQgZ29vZCIpIHsKICAgICAgcmV0dXJuICI8Yj5GaW5pc2hlZCBHb29kPC9iPjxicj5Zb3Ugc2VsbCB0aGlzIHRvIGN1c3RvbWVycyAoZS5nLiwgPGk+Q2xhc3NpYyBCdXJnZXI8L2k+KS4gU2V0IGNhdGVnb3J5LCBwcmVwIGFyZWEsIGFuZCBwcmljZS48YnI+PGI+RXhhbXBsZTo8L2I+IEEgYnVyZ2VyIHlvdSBzZWxsIG9uIHRoZSBtZW51LiIgKyB0b2dnbGU7CiAgICB9CiAgICBpZiAodiA9PT0gInJhd21hdGVyaWFsIiB8fCB2ID09PSAicmF3IG1hdGVyaWFsIikgewogICAgICByZXR1cm4gIjxiPlJhdyBNYXRlcmlhbDwvYj48YnI+WW91IGRvbuKAmXQgc2VsbCB0aGlzIGRpcmVjdGx5OyB5b3UgPGk+dXNlPC9pPiBpdCB0byBtYWtlIG90aGVyIGl0ZW1zLiBZb3XigJlsbCBzZXQgY29zdCBhbmQgc3VwcGxpZWQgcXVhbnRpdHkuPGJyPjxiPkV4YW1wbGU6PC9iPiBBIDxpPjUga2cgYmFnIG9mIGZsb3VyPC9pPiB1c2VkIGluIGJha2luZy4iICsgdG9nZ2xlOwogICAgfQogICAgaWYgKHYgPT09ICJmaW5pc2hlZGdvb2QgJiByYXdtYXRlcmlhbCIgfHwgdiA9PT0gImZpbmlzaGVkZ29vZCZyYXdtYXRlcmlhbCIgfHwgdiA9PT0gImZpbmlzaGVkIGdvb2QgJiByYXcgbWF0ZXJpYWwiKSB7CiAgICAgIHJldHVybiAiPGI+RmluaXNoZWQgR29vZCAmIFJhdyBNYXRlcmlhbDwvYj48YnI+WW91IGJvdGggc2VsbCB0aGlzIGFuZCB1c2UgaXQgZWxzZXdoZXJlLiBDb25zaWRlciDigJxQdXJjaGFzZWQgZm9yIFJlc2FsZeKAnS48YnI+PGI+RXhhbXBsZTo8L2I+IEEgPGk+Ym90dGxlZCBzYXVjZTwvaT4geW91IHNlbGwgYW5kIGFsc28gdXNlIGluIHJlY2lwZXMuIiArIHRvZ2dsZTsKICAgIH0KICAgIGlmICh2ID09PSAibWFudWZhY3R1cmVkIikgewogICAgICByZXR1cm4gIjxiPk1hbnVmYWN0dXJlZDwvYj48YnI+WW91IG1ha2UgdGhpcyBmcm9tIGluZ3JlZGllbnRzIGFuZCB0cmFjayBpdHMgcHJlcCAoYmF0Y2hpbmcsIHlpZWxkcykuPGJyPjxiPkV4YW1wbGU6PC9iPiBBbiA8aT5pbi1ob3VzZSBwYXR0eTwvaT4gcHJlcGFyZWQgZnJvbSBtaW5jZSBhbmQgc3BpY2VzLiIgKyB0b2dnbGU7CiAgICB9CiAgICByZXR1cm4gaHRtbEFsbCgpOwogIH07CgogIGZ1bmN0aW9uIGdldExhYmVsQW5kQnViYmxlKCkgewogICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9vbHRpcFtmb3I9IicgKyBGSUVMRF9JRCArICciXScpIHx8CiAgICAgIChmdW5jdGlvbigpeyBjb25zdCBjdHJsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEZJRUxEX0lEKTsgcmV0dXJuIGN0cmw/IGN0cmwuY2xvc2VzdCgnLnRvb2x0aXAnKTogbnVsbDsgfSkoKTsKICAgIGlmICghbGFiZWwpIHJldHVybiB7fTsKICAgIHJldHVybiB7IGxhYmVsLCBidWJibGU6IGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy50b29sdGlwdGV4dCcpIH07CiAgfQoKICBmdW5jdGlvbiByZWZyZXNoKHsga2VlcE9wZW5BZnRlcj1mYWxzZSwgb3Blbj1mYWxzZSB9ID0ge30pIHsKICAgIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEZJRUxEX0lEKTsKICAgIGNvbnN0IHsgbGFiZWwsIGJ1YmJsZSB9ID0gZ2V0TGFiZWxBbmRCdWJibGUoKTsKICAgIGlmICghc2VsIHx8ICFsYWJlbCB8fCAhYnViYmxlKSByZXR1cm47CiAgICBjb25zdCB2YWwgPSBzZWwudmFsdWUgfHwgIiI7CiAgICBidWJibGUuaW5uZXJIVE1MID0gdmFsID8gaHRtbEZvcih2YWwpIDogaHRtbEFsbCgpOwogICAgCiAgICBpZiAob3BlbikgeyBsYWJlbC5jbGFzc0xpc3QuYWRkKCdpcy1vcGVuJyk7IH0gZWxzZSB7IGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW9wZW4nKTsgfQoKICAgIGNvbnN0IGJ0biA9IGJ1YmJsZS5xdWVyeVNlbGVjdG9yKCcucHQtdmlldy1hbGwnKTsKICAgIGlmIChidG4pIHsKICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGJ1YmJsZS5pbm5lckhUTUwgPSBodG1sQWxsKCk7CiAgICAgICAgbGFiZWwuY2xhc3NMaXN0LmFkZCgnaXMtb3BlbicpOwogICAgICB9LCB7b25jZTp0cnVlfSk7CiAgICB9CgogICAgaWYgKGtlZXBPcGVuQWZ0ZXIpIHsKICAgICAgY2xlYXJUaW1lb3V0KHJlZnJlc2guX3QpOwogICAgICByZWZyZXNoLl90ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IHNlbCAmJiAhbGFiZWwuY29udGFpbnMoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkpIHsKICAgICAgICAgIGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW9wZW4nKTsKICAgICAgICB9CiAgICAgIH0sIDEwMDApOyAvLyBhbGlnbiB3aXRoIGJsdXIgbGluZ2VyCiAgICB9CiAgfQoKICBmdW5jdGlvbiB3aXJlKCkgewogICAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRklFTERfSUQpOwogICAgaWYgKCFzZWwgfHwgc2VsLmRhdGFzZXQucHRXaXJlZCA9PT0gJzEnKSByZXR1cm47CiAgICBzZWwuZGF0YXNldC5wdFdpcmVkID0gJzEnOwogICAgZW5zdXJlRGVmYXVsdE9wdGlvbigpOwogICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT4gcmVmcmVzaCh7b3Blbjp0cnVlfSksIHRydWUpOwogICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVmcmVzaCh7b3Blbjp0cnVlfSksIHRydWUpOwogICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHJlZnJlc2goe2tlZXBPcGVuQWZ0ZXI6dHJ1ZSwgb3Blbjp0cnVlfSksIHRydWUpOwoKICAgIGNvbnN0IHtsYWJlbH0gPSBnZXRMYWJlbEFuZEJ1YmJsZSgpOwogICAgaWYgKGxhYmVsKSBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdzbWFydFRvb2x0aXA6b3BlbicsICgpID0+IHJlZnJlc2goe29wZW46dHJ1ZX0pLCB0cnVlKTsKICAgIC8vIHJlbmRlciBvbmNlIGluaXRpYWxseSAobm8gYXV0by1vcGVuKQogICAgcmVmcmVzaCh7b3BlbjpmYWxzZX0pOwogIH0KCiAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHdpcmUpOwogIH0gZWxzZSB7CiAgICB3aXJlKCk7CiAgfQp9KSgpOwo8L3NjcmlwdD4KCjxzY3JpcHQ+KGZ1bmN0aW9uKCl7IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29sdGlwLmlzLW9wZW4nKS5mb3JFYWNoKGVsPT5lbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1vcGVuJykpOyB9KSgpOzwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4=</script>
  <script type="application/json" id="b64-recipe">PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4KICA8dGl0bGU+VGFibGUgQnkgWW9jbyBSZWNpcGUgTG9hZGVyPC90aXRsZT4KICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcyI+PC9zY3JpcHQ+CiAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIj4KICA8bGluayByZWw9InByZWNvbm5lY3QiIGhyZWY9Imh0dHBzOi8vZm9udHMuZ3N0YXRpYy5jb20iIGNyb3Nzb3JpZ2luPgogIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9UG9wcGluczp3Z2h0QDQwMDs1MDA7NjAwOzcwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CiAgPHN0eWxlPgogICAgOnJvb3QgewogICAgICAtLXlvY28tYmc6ICMxMjEyMTI7CiAgICAgIC0teW9jby1zdXJmYWNlOiAjMWUxZTFlOwogICAgICAtLXlvY28tc3VyZmFjZS1saWdodDogIzJhMmEyYTsKICAgICAgLS15b2NvLXByaW1hcnk6ICMwMEEzRkY7CiAgICAgIC0teW9jby1wcmltYXJ5LWhvdmVyOiAjMDA4YmRmOwogICAgICAtLXlvY28tdGV4dC1wcmltYXJ5OiAjRkZGRkZGOwogICAgICAtLXlvY28tdGV4dC1zZWNvbmRhcnk6ICNiM2IzYjM7CiAgICAgIC0teW9jby1ib3JkZXI6ICMzMzMzMzM7CiAgICAgIC0teW9jby1ncmVlbjogIzI3YWU2MDsKICAgICAgLS15b2NvLW9yYW5nZTogI2YzOWMxMjsKICAgICAgLS15b2NvLXJlZDogI2ViNTc1NzsKICAgICAgLS1zaGFkb3c6IDAgOHB4IDI0cHggcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgfQoKICAgICogewogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIHBhZGRpbmc6IDA7CiAgICB9CgogICAgYm9keSB7CiAgICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICBwYWRkaW5nOiAyMHB4OwogICAgfQogICAgCiAgICAubWFpbi1oZWFkZXIgewogICAgICAgIG1heC13aWR0aDogMTgwMHB4OwogICAgICAgIG1hcmdpbjogMCBhdXRvIDIwcHggYXV0bzsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQoKICAgIC5tYWluLWhlYWRlciBoMSB7CiAgICAgICAgZm9udC1zaXplOiAyLjVyZW07CiAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsKICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCAjM0I4MkY2LCAjRkZGRkZGKTsKICAgICAgICAtd2Via2l0LWJhY2tncm91bmQtY2xpcDogdGV4dDsKICAgICAgICAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICB9CgogICAgLmhlYWRlci1hY3Rpb25zIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGdhcDogMTVweDsKICAgIH0KCiAgICAuY29udGFpbmVyIHsKICAgICAgICBtYXgtd2lkdGg6IDE4MDBweDsKICAgICAgICBtYXJnaW46IDAgYXV0bzsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDJmcjsKICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgYWxpZ24taXRlbXM6IHN0YXJ0OwogICAgfQogICAgCiAgICAucGFuZWwgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDE2cHg7CiAgICAgICAgcGFkZGluZzogMjVweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICB9CgogICAgLnBhbmVsLWhlYWRlciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgfQoKICAgIC5wYW5lbC1oZWFkZXIgaDIgewogICAgICAgIGZvbnQtc2l6ZTogMS44cmVtOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CgogICAgLyogLS0tIExlZnQgUGFuZWw6IEltcG9ydCAmIEluZ3JlZGllbnRzIC0tLSAqLwogICAgLmxlZnQtcGFuZWwgewogICAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiBhdXRvIDFmcjsKICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMTAwcHgpOwogICAgICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICAgICAgdG9wOiAyMHB4OwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiB7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiAudG9vbHRpcC1jb250YWluZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDhweDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiBsYWJlbCB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsKICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgIH0KCiAgICBpbnB1dFt0eXBlPSJmaWxlIl0gewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CgogICAgLmZpbGUtdXBsb2FkLWJ0biB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIHBhZGRpbmc6IDEycHggMjRweDsKICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvcjogMC4yczsKICAgIH0KCiAgICAuZmlsZS11cGxvYWQtYnRuOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnktaG92ZXIpOwogICAgfQoKICAgICNmaWxlTmFtZSB7CiAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tZ3JlZW4pOwogICAgfQoKICAgIC5saWJyYXJ5LXNlY3Rpb24gewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBvdmVyZmxvdzogaGlkZGVuOyAvKiBSZXN0b3JlZCBmb3IgbmVhdCBjb250YWluZXIgbG9vayAqLwogICAgfQoKICAgIC50YWJzIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICBmbGV4LXNocmluazogMDsKICAgICAgICBvdmVyZmxvdy14OiBhdXRvOwogICAgfQoKICAgIC50YWItYnV0dG9uIHsKICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgdHJhbnNpdGlvbjogY29sb3IgMC4yczsKICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgfQoKICAgIC50YWItYnV0dG9uLmFjdGl2ZSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAKICAgIC50YWItYnV0dG9uLmFjdGl2ZTo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBib3R0b206IC0xcHg7CiAgICAgICAgbGVmdDogMDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDJweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAudGFiLWNvbnRlbnQtY29udGFpbmVyIHsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBmbGV4LWdyb3c6IDE7CiAgICB9CgogICAgI3RhYkNvbnRlbnRzIHsKICAgICAgICBmbGV4LWdyb3c6IDE7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIG1pbi1oZWlnaHQ6IDA7IC8qIFByZXZlbnRzIGZsZXhib3ggb3ZlcmZsb3cgaXNzdWVzICovCiAgICB9CgogICAgLnRhYi1jb250ZW50IHsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgcGFkZGluZy1yaWdodDogMTBweDsKICAgICAgICAvKiBGaWxsIHRoZSBwYXJlbnQgI3RhYkNvbnRlbnRzIGNvbnRhaW5lciAqLwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICByaWdodDogMDsKICAgICAgICBib3R0b206IDA7CiAgICB9CiAgICAKICAgIC50YWItY29udGVudC5hY3RpdmUgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIH0KCiAgICAuc2VhcmNoLWJhciB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1iZyk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgZmxleC1zaHJpbms6IDA7CiAgICB9CgogICAgLmluZ3JlZGllbnQtbGlzdCB7CiAgICAgICAgbGlzdC1zdHlsZTogbm9uZTsKICAgIH0KCiAgICAuaW5ncmVkaWVudC1pdGVtIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDhweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMsIHRyYW5zZm9ybSAwLjJzOwogICAgfQogICAgCiAgICAuaW5ncmVkaWVudC1pdGVtOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCg1cHgpOwogICAgfQoKICAgIC5pbmdyZWRpZW50LWl0ZW0gc3BhbiB7CiAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgfQogICAgLmluZ3JlZGllbnQtaXRlbSAubmFtZSB7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgIH0KICAgIC5pbmdyZWRpZW50LWl0ZW0gLnVvbSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG1hcmdpbi1sZWZ0OiAxMHB4OwogICAgfQogICAgLmluZ3JlZGllbnQtaXRlbSAuY29zdCB7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7CiAgICB9CgogICAgLyogLS0tIFJpZ2h0IFBhbmVscyAtLS0gKi8KICAgIC5yaWdodC1jb2x1bW4gewogICAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiBhdXRvIGF1dG87CiAgICAgICAgZ2FwOiAyMHB4OwogICAgfQoKICAgIC5yaWdodC1wYW5lbC1ncm91cCAucGFuZWwgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAucmlnaHQtcGFuZWwtZ3JvdXAgLnBhbmVsLmFjdGl2ZSB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgIH0KICAgIAogICAgLnJlY2lwZS1idWlsZGVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAyMHB4OwogICAgfQoKICAgIC5tYXN0ZXItcHJvZHVjdC1mb3JtIHsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDJmcjsKICAgICAgICBnYXA6IDE1cHg7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgYWxpZ24taXRlbXM6IGVuZDsKICAgIH0KCiAgICAuZm9ybS1ncm91cCB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgfQoKICAgIC5mb3JtLWdyb3VwIGxhYmVsIHsKICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgfQoKICAgIC5mb3JtLWdyb3VwIGlucHV0LCAuZm9ybS1ncm91cCBzZWxlY3QgewogICAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJnKTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIGZvbnQtc2l6ZTogMTZweDsKICAgICAgICBmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmOwogICAgfQogICAgCiAgICAuZm9ybS1ncm91cCBpbnB1dDpyZWFkLW9ubHkgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZS1saWdodCk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgcGFkZGluZy1sZWZ0OiAwOwogICAgICAgIGN1cnNvcjogZGVmYXVsdDsKICAgIH0KCgogICAgLyogU3R5bGVzIGZvciBjbGVhcmFibGUgaW5wdXQgKi8KICAgIC5pbnB1dC13aXRoLWNsZWFyIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmlucHV0LXdpdGgtY2xlYXIgaW5wdXQgewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIHBhZGRpbmctcmlnaHQ6IDMwcHg7IC8qIE1ha2Ugc3BhY2UgZm9yIHRoZSBYICovCiAgICB9CiAgICAuY2xlYXItYnRuLWlucHV0IHsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgcmlnaHQ6IDEwcHg7CiAgICAgICAgdG9wOiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIGRpc3BsYXk6IG5vbmU7IC8qIEhpZGUgYnkgZGVmYXVsdCAqLwogICAgICAgIGxpbmUtaGVpZ2h0OiAxOwogICAgICAgIHRyYW5zaXRpb246IGNvbG9yIDAuMnM7CiAgICB9CiAgICAuY2xlYXItYnRuLWlucHV0OmhvdmVyIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQoKCiAgICAucmVjaXBlLWRldGFpbHMgewogICAgICAgIGZsZXgtZ3JvdzogMTsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIH0KCiAgICAucmVjaXBlLXRhYmxlLWNvbnRhaW5lciB7CiAgICAgICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIH0KCiAgICB0YWJsZSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIH0KCiAgICB0aCwgdGQgewogICAgICAgIHBhZGRpbmc6IDE0cHg7CiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgfQoKICAgIHRoIHsKICAgICAgICBiYWNrZ3JvdW5kOiAjMmEyYTJhOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBsZXR0ZXItc3BhY2luZzogMC44cHg7CiAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgei1pbmRleDogMTsKICAgIH0KICAgIAogICAgdGQgaW5wdXRbdHlwZT0ibnVtYmVyIl0sIHRkIGlucHV0W3R5cGU9InRleHQiXSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgbWluLXdpZHRoOiA4MHB4OwogICAgICAgIHBhZGRpbmc6IDhweDsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9CiAgICB0ZCBpbnB1dFt0eXBlPSJ0ZXh0Il0gewogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB9CiAgICB0ZCBpbnB1dFt0eXBlPSJudW1iZXIiXSB7CiAgICAgIC1tb3otYXBwZWFyYW5jZTogdGV4dGZpZWxkOyAvKiBGaXJlZm94ICovCiAgICB9CiAgICAvKiBIaWRlIHNwaW4gYnV0dG9ucyBvbiBudW1iZXIgaW5wdXRzIGZvciBDaHJvbWUsIFNhZmFyaSwgRWRnZSwgT3BlcmEgKi8KICAgIHRkIGlucHV0W3R5cGU9Im51bWJlciJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uLAogICAgdGQgaW5wdXRbdHlwZT0ibnVtYmVyIl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24gewogICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgIG1hcmdpbjogMDsKICAgIH0KICAgIAogICAgLnJlbW92ZS1idG4gewogICAgICAgIGJhY2tncm91bmQ6IG5vbmU7CiAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1yZWQpOwogICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgIH0KCiAgICAucmVjaXBlLXN1bW1hcnkgewogICAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBmbGV4LXNocmluazogMDsKICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgZ2FwOiAxNXB4OwogICAgfQoKICAgIC5jb3N0LWRldGFpbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBnYXA6IDhweDsKICAgIH0KCiAgICAucmVjaXBlLXN1bW1hcnkgLnRvdGFsLWNvc3QsIC5yZWNpcGUtc3VtbWFyeSAuc2VsbGluZy1wcmljZSwgLnJlY2lwZS1zdW1tYXJ5IC5ncC1wZXJjZW50YWdlIHsKICAgICAgICBmb250LXNpemU6IDEuMnJlbTsKICAgICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQoKICAgIC5yZWNpcGUtc3VtbWFyeSAudG90YWwtY29zdCBzcGFuIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7CiAgICB9CgogICAgLnJlY2lwZS1zdW1tYXJ5IC5zZWxsaW5nLXByaWNlIHNwYW4gewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAucmVjaXBlLXN1bW1hcnkgLmdwLXBlcmNlbnRhZ2Ugc3BhbiB7CiAgICAgICAgdHJhbnNpdGlvbjogY29sb3IgMC4zczsKICAgIH0KICAgIAogICAgLmFjdGlvbi1idG4gewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgcGFkZGluZzogMTJweCAyNHB4OwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnM7CiAgICB9CiAgICAuYWN0aW9uLWJ0bjpkaXNhYmxlZCB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzU1NSAhaW1wb3J0YW50OwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50OwogICAgICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjNTU1ICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLnNhdmUtYnRuLCAudXBkYXRlLXlpZWxkLWJ0biB7IGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC5zYXZlLWJ0bjpob3Zlcjpub3QoOmRpc2FibGVkKSwgLnVwZGF0ZS15aWVsZC1idG46aG92ZXI6bm90KDpkaXNhYmxlZCkgeyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnktaG92ZXIpOyB9CiAgICAKICAgIC5leHBvcnQtYnRuIHsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIC5leHBvcnQtYnRuOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQoKICAgIC5jbGVhci1idG4gewogICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXJlZCk7CiAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1yZWQpOwogICAgICAgIHBhZGRpbmc6IDEwcHg7CiAgICAgICAgd2lkdGg6IDQ0cHg7CiAgICAgICAgaGVpZ2h0OiA0NHB4OwogICAgfQogICAgLmNsZWFyLWJ0bjpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0teW9jby1yZWQpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CiAgICAuY2xlYXItYnRuIHN2ZyB7CiAgICAgICAgZmlsbDogdmFyKC0teW9jby1yZWQpOwogICAgICAgIHRyYW5zaXRpb246IGZpbGwgMC4yczsKICAgIH0KICAgIC5jbGVhci1idG46aG92ZXI6bm90KDpkaXNhYmxlZCkgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgoKICAgIC8qIFNhdmVkIFJlY2lwZXMgUGFuZWwgKi8KICAgIC5zYXZlZC1yZWNpcGVzLXBhbmVsIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAxNXB4OwogICAgfQogICAgI3NhdmVkUmVjaXBlc0NvbnRhaW5lciB7CiAgICAgICAgb3ZlcmZsb3cteDogYXV0bzsKICAgIH0KICAgIC5zYXZlZC1yZWNpcGVzLXBhbmVsIC5hY3Rpb25zLWNvbCB7CiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9CiAgICAuc2F2ZWQtcmVjaXBlcy1wYW5lbCAuYWN0aW9ucy1jb2wgYnV0dG9uIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgcGFkZGluZzogNnB4IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBtYXJnaW4tbGVmdDogOHB4OwogICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOwogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICB9CiAgICAuc2F2ZWQtcmVjaXBlcy1wYW5lbCAuYWN0aW9ucy1jb2wgYnV0dG9uOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgIH0KICAgIC5zYXZlZC1yZWNpcGVzLWZvb3RlciB7CiAgICAgICAgbWFyZ2luLXRvcDogYXV0bzsKICAgICAgICBwYWRkaW5nLXRvcDogMTVweDsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAgIH0KICAgIC5ncC1sb3cgeyBjb2xvcjogdmFyKC0teW9jby1yZWQpOyBmb250LXdlaWdodDogNjAwOyB9CiAgICAuZ3AtbWVkaXVtIHsgY29sb3I6IHZhcigtLXlvY28tb3JhbmdlKTsgZm9udC13ZWlnaHQ6IDYwMDsgfQogICAgLmdwLWhpZ2ggeyBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7IGZvbnQtd2VpZ2h0OiA2MDA7IH0KCiAgICAvKiBUb29sdGlwIFN0eWxlcyAqLwogICAgLnRvb2x0aXAtY29udGFpbmVyIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDhweDsKICAgIH0KICAgIC50b29sdGlwLXRyaWdnZXIgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgY3Vyc29yOiBoZWxwOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgd2lkdGg6IDE4cHg7CiAgICAgICAgaGVpZ2h0OiAxOHB4OwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBsaW5lLWhlaWdodDogMTZweDsKICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgZmxleC1zaHJpbms6IDA7CiAgICB9CiAgICAudG9vbHRpcC1jb250YWluZXI6aG92ZXIgLnRvb2x0aXAtdHJpZ2dlciB7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgfQogICAgLnRvb2x0aXAtdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsKICAgICAgd2lkdGg6IDI4MHB4OwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgICBwYWRkaW5nOiAxMnB4OwogICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB6LWluZGV4OiAxMDAwOwogICAgICB0b3A6IDEyNSU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICBvcGFjaXR5OiAwOwogICAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuM3M7CiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuNCk7CiAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOwogICAgfQogICAgLnRvb2x0aXAtdGV4dDo6YWZ0ZXIgewogICAgICBjb250ZW50OiAiIjsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICBib3R0b206IDEwMCU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgbWFyZ2luLWxlZnQ6IC01cHg7CiAgICAgIGJvcmRlci13aWR0aDogNXB4OwogICAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50ICMyYTJhMmEgdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAudG9vbHRpcC10cmlnZ2VyOmhvdmVyICsgLnRvb2x0aXAtdGV4dCB7CiAgICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAgICAgICBvcGFjaXR5OiAxOwogICAgfQogICAgCiAgICAvKiBHZW5lcmFsIHB1cnBvc2UgdG9vbHRpcCB1c2luZyBkYXRhLXRvb2x0aXAgYXR0cmlidXRlICovCiAgICAudG9vbHRpcCB7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgfQogICAgLnRvb2x0aXA6OmFmdGVyIHsKICAgICAgY29udGVudDogYXR0cihkYXRhLXRvb2x0aXApOwogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHotaW5kZXg6IDEwMDA7CiAgICAgIAogICAgICAvKiBQb3NpdGlvbmluZyAqLwogICAgICBsZWZ0OiA1MCU7CiAgICAgIGJvdHRvbTogMTIwJTsgLyogR2l2ZSBpdCBzb21lIHNwYWNlICovCiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKCiAgICAgIC8qIEFwcGVhcmFuY2UgKi8KICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgcGFkZGluZzogOHB4IDEycHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICBmb250LXdlaWdodDogNDAwOwogICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjQpOwoKICAgICAgLyogVmlzaWJpbGl0eSAqLwogICAgICBvcGFjaXR5OiAwOwogICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlLWluLW91dCwgdmlzaWJpbGl0eSAwLjJzIGVhc2UtaW4tb3V0OwogICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIH0KICAgIC50b29sdGlwOmhvdmVyOjphZnRlciB7CiAgICAgIG9wYWNpdHk6IDE7CiAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7CiAgICB9CgoKICAgIC8qIFNjcm9sbGJhciBzdHlsZXMgKi8KICAgIDo6LXdlYmtpdC1zY3JvbGxiYXIgewogICAgICB3aWR0aDogOHB4OwogICAgfQogICAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICAgICAgYmFja2dyb3VuZDogdmFyKC0teW9jby1ib3JkZXIpOwogICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogIzU1NTsKICAgIH0KICAgIC5idG4taWNvbiB7CiAgICAgICAgcGFkZGluZzogMC43NXJlbTsKICAgIH0KICAgIC5idG4gewogICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogMC41cmVtOwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBnYXA6IDAuNXJlbTsKICAgICAgYm94LXNoYWRvdzogMCA0cHggNnB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKICAgIH0KICAgIC5idG4tcHJpbWFyeSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgIH0KICAgIC5idG4tcHJpbWFyeTpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeS1ob3Zlcik7CiAgICB9CiAgICAuYnRuLXNlY29uZGFyeSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgIH0KICAgIAogICAgI3lpZWxkRmllbGRzQ29udGFpbmVyIC5hY3Rpb24tYnRuIHsKICAgICAgICBwYWRkaW5nOiAxMHB4OwogICAgICAgIHdpZHRoOiA0NHB4OwogICAgICAgIGhlaWdodDogNDRweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgfQogICAgI3lpZWxkRmllbGRzQ29udGFpbmVyIC5hY3Rpb24tYnRuOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAvKiAtLS0gVHV0b3JpYWwgU3R5bGVzIC0tLSAqLwogICAgLm1vZGFsLWJhY2tkcm9wIHsKICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgdG9wOiAwOwogICAgICAgIGxlZnQ6IDA7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC43KTsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgei1pbmRleDogMTAwMDA7CiAgICB9CiAgICAubW9kYWwtYmFja2Ryb3Auc2hvdyB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgIH0KICAgIC5tb2RhbC1jb250ZW50IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIHBhZGRpbmc6IDJyZW07CiAgICAgICAgYm9yZGVyLXJhZGl1czogMC43NXJlbTsKICAgICAgICB3aWR0aDogOTAlOwogICAgICAgIG1heC13aWR0aDogNTAwcHg7CiAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICB9CiAgICAgLm1vZGFsLWNvbnRlbnQgaDMgewogICAgICAgIGZvbnQtc2l6ZTogMS41cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICB9CiAgICAgLm1vZGFsLWNvbnRlbnQgcCB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG1hcmdpbi1ib3R0b206IDJyZW07CiAgICAgfQogICAgIC5tb2RhbC1idXR0b25zIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIGdhcDogMXJlbTsKICAgICB9CgogICAgLnR1dG9yaWFsLW92ZXJsYXkgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgei1pbmRleDogOTk5ODsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgfQogICAgLnR1dG9yaWFsLW92ZXJsYXktcGFydCB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44NSk7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNHMgZWFzZS1pbi1vdXQ7CiAgICB9CiAgICAuaGlnaGxpZ2h0LWVsZW1lbnQgewogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICB6LWluZGV4OiA5OTk5OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICB0cmFuc2l0aW9uOiBib3gtc2hhZG93IDAuM3MgZWFzZS1pbi1vdXQ7CiAgICAgICAgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7CiAgICAgICAgYW5pbWF0aW9uOiBwdWxzZS1nbG93IDJzIGluZmluaXRlIGVhc2UtaW4tb3V0OwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgICBjb2xvcjogI0ZGRkZGRjsKICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuOHJlbTsKICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIHotaW5kZXg6IDEwMDAxOwogICAgICAgIHdpZHRoOiA5MCU7CiAgICAgICAgbWF4LXdpZHRoOiAzODBweDsKICAgICAgICBib3gtc2hhZG93OiAwIDEwcHggNDBweCByZ2JhKDAsMCwwLDAuNyksIDAgMCAzMHB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNSk7CiAgICAgICAgYW5pbWF0aW9uOiBmYWRlSW5Qb3BvdmVyIDAuNHMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgICAgZGlzcGxheTogbm9uZTsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLWhlYWRlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgICAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDAuNzVyZW07CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IHsKICAgICAgICBwYWRkaW5nOiAxLjVyZW07CiAgICAgICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IGIgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1uYXYgewogICAgICAgIHBhZGRpbmc6IDFyZW0gMS41cmVtOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC4yKTsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlcjo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBib3JkZXItd2lkdGg6IDEwcHg7CiAgICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKICAgICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50OwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctdG9wOjphZnRlciB7IGJvdHRvbTogMTAwJTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7IGJvcmRlci1ib3R0b20tY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LWJvdHRvbTo6YWZ0ZXIgeyB0b3A6IDEwMCU7IGxlZnQ6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOyBib3JkZXItdG9wLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1sZWZ0OjphZnRlciB7IHJpZ2h0OiAxMDAlOyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBib3JkZXItcmlnaHQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LXJpZ2h0OjphZnRlciB7IGxlZnQ6IDEwMCU7IHRvcDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7IGJvcmRlci1sZWZ0LWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAKICAgIEBrZXlmcmFtZXMgZmFkZUluUG9wb3ZlciB7IGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9IHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSB9CiAgICBAa2V5ZnJhbWVzIHB1bHNlLWdsb3cgeyAwJSwgMTAwJSB7IGJveC1zaGFkb3c6IDAgMCAxNXB4IDVweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9IDUwJSB7IGJveC1zaGFkb3c6IDAgMCAyNXB4IDEwcHggcmdiYSgwLCAxNjMsIDI1NSwgMC43KTsgfSB9CgogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+Cgo8aGVhZGVyIGlkPSJ0dXRvcmlhbC1oZWFkZXIiIGNsYXNzPSJtYWluLWhlYWRlciI+CiAgICA8ZGl2IGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyI+CiAgICAgICAgPGEgaWQ9InR1dG9yaWFsLWhvdy10by1ndWlkZSIgaHJlZj0iaHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xNW9DNEJDeXhwQ2ZsSEZPSjNtaWZRSXJ6WmdiemxQd3Evdmlldz91c3A9c2hhcmluZyIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSBidG4taWNvbiB0b29sdGlwIiBzdHlsZT0icGFkZGluZzogMC43NXJlbTsiIGRhdGEtdG9vbHRpcD0iVmlldyBIb3cgVG8gR3VpZGUiPgogICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTE0IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY4eiI+PC9wYXRoPjxwb2x5bGluZSBwb2ludHM9IjE0IDIgMTQgOCAyMCA4Ij48L3BvbHlsaW5lPjxsaW5lIHgxPSIxNiIgeTE9IjEzIiB4Mj0iOCIgeTI9IjEzIj48L2xpbmU+PGxpbmUgeDE9IjE2IiB5MT0iMTciIHgyPSI4IiB5Mj0iMTciPjwvbGluZT48cG9seWxpbmUgcG9pbnRzPSIxMCA5IDkgOSA4IDkiPjwvcG9seWxpbmU+PC9zdmc+CiAgICAgICAgPC9hPgogICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KICAgICAgICAgICAgPGgxPlRhYmxlIEJ5IFlvY28gUmVjaXBlIExvYWRlcjwvaDE+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b29sdGlwLXRyaWdnZXIiPj88L3NwYW4+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+QW4gYXBwbGljYXRpb24gdG8gYnVpbGQgYW5kIG1hbmFnZSBwcm9kdWN0IHJlY2lwZXMgZnJvbSBhbiBpbXBvcnRlZCBsaXN0LjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJoZWFkZXItYWN0aW9ucyIgaWQ9InR1dG9yaWFsLWFjdGlvbnMiPgogICAgICAgIDxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gZXhwb3J0LWJ0biIgaWQ9ImV4cG9ydEFsbEJ0bkhlYWRlciIgdGl0bGU9IkV4cG9ydCBhbGwgc2F2ZWQgcmVjaXBlcyB0byBhbiBFeGNlbCBmaWxlIGFuZCBjbGVhciBhbGwgZGF0YS4iPkV4cG9ydCBBbGwgUmVjaXBlczwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gY2xlYXItYnRuIiBpZD0iY2xlYXJBbGxCdG4iIHRpdGxlPSJDbGVhciBhbGwgaW1wb3J0ZWQgcHJvZHVjdHMgYW5kIHNhdmVkIHJlY2lwZXMgZnJvbSB0aGUgYXBwbGljYXRpb24uIj4KICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMyA2djE4aDE4di0xOGgtMTh6bTUgMTRjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNSAwYzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem00LTE4aC0yMHYtMmg2di0xLjVjMC0uODI3LjY3My0xLjUgMS41LTEuNWg1Yy44MjUgMCAxLjUuNjcxIDEuNSAxLjV2MS41aDZ2MnoiLz48L3N2Zz4KICAgICAgICA8L2J1dHRvbj4KICAgIDwvZGl2Pgo8L2hlYWRlcj4KCjxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CiAgICA8IS0tIExlZnQgUGFuZWw6IEltcG9ydCBhbmQgTGlicmFyeSAtLT4KICAgIDxkaXYgY2xhc3M9ImxlZnQtcGFuZWwiPgogICAgICAgIDxkaXYgaWQ9InR1dG9yaWFsLWltcG9ydCIgY2xhc3M9InBhbmVsIGltcG9ydC1zZWN0aW9uIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idG9vbHRpcC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iZXhjZWxGaWxlIj5JbXBvcnQgUHJvZHVjdCBTaGVldDwvbGFiZWw+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idG9vbHRpcC10ZXh0Ij5UaGUgcHJvZHVjdCBleGNlbCBzaGVldCBmcm9tIHRoZSBUYWJsZSBieSBZb2NvIFByb2R1Y3QgTG9hZGVyIG11c3QgYmUgbG9hZGVkLjwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGlkPSJleGNlbEZpbGUiIGFjY2VwdD0iLnhsc3gsIC54bHMsIC5jc3YiPgogICAgICAgICAgICA8bGFiZWwgZm9yPSJleGNlbEZpbGUiIGNsYXNzPSJmaWxlLXVwbG9hZC1idG4iIHRpdGxlPSJJbXBvcnQgYW4gRXhjZWwgZmlsZSAoLnhsc3gsIC54bHMsIC5jc3YpIHdpdGggeW91ciBwcm9kdWN0IGxpc3QuIj5DaG9vc2UgRmlsZTwvbGFiZWw+CiAgICAgICAgICAgIDxwIGlkPSJmaWxlTmFtZSI+PC9wPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgaWQ9InR1dG9yaWFsLWxpYnJhcnkiIGNsYXNzPSJwYW5lbCBsaWJyYXJ5LXNlY3Rpb24iPgogICAgICAgICAgICAgPGRpdiBjbGFzcz0icGFuZWwtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICA8aDI+SW5ncmVkaWVudCBMaWJyYXJ5PC9oMj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+QnJvd3NlIGFuZCBzZWxlY3QgaW5ncmVkaWVudHMgZnJvbSB5b3VyIGltcG9ydGVkIHByb2R1Y3QgbGlzdCwgc29ydGVkIGJ5IGNhdGVnb3J5LjwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJzIiBpZD0ibGlicmFyeVRhYnMiPgogICAgICAgICAgICAgICAgPCEtLSBUYWJzIHdpbGwgYmUgZ2VuZXJhdGVkIGhlcmUgLS0+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJ0YWJDb250ZW50cyIgY2xhc3M9InRhYi1jb250ZW50LWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICA8IS0tIFRhYiBjb250ZW50cyB3aWxsIGJlIGdlbmVyYXRlZCBoZXJlIC0tPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDwhLS0gUmlnaHQgQ29sdW1uIC0tPgogICAgPGRpdiBjbGFzcz0icmlnaHQtY29sdW1uIj4KICAgICAgICA8IS0tIFJpZ2h0LXNpZGUgVGFiIE5hdmlnYXRpb24gLS0+CiAgICAgICAgPGRpdiBjbGFzcz0idGFicyIgaWQ9InJpZ2h0UGFuZWxUYWJzIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idGFiLWJ1dHRvbiBhY3RpdmUiIGRhdGEtdGFiPSJyZWNpcGVCdWlsZGVyUGFuZWwiPlJlY2lwZSBCdWlsZGVyPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InRhYi1idXR0b24iIGRhdGEtdGFiPSJ5aWVsZEVkaXRvclBhbmVsIj5ZaWVsZCBFZGl0b3I8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPCEtLSBSaWdodC1zaWRlIFRhYiBDb250ZW50IC0tPgogICAgICAgIDxkaXYgY2xhc3M9InJpZ2h0LXBhbmVsLWdyb3VwIj4KICAgICAgICAgICAgPCEtLSBUb3AgUmlnaHQgUGFuZWw6IFJlY2lwZSBCdWlsZGVyIC0tPgogICAgICAgICAgICA8ZGl2IGlkPSJyZWNpcGVCdWlsZGVyUGFuZWwiIGNsYXNzPSJwYW5lbCByZWNpcGUtYnVpbGRlciBhY3RpdmUiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGFuZWwtaGVhZGVyIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b29sdGlwLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxoMj5SZWNpcGUgQnVpbGRlcjwvaDI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b29sdGlwLXRyaWdnZXIiPj88L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+Q29uc3RydWN0IGEgbmV3IHJlY2lwZSBmb3IgYSBzZWxlY3RlZCBtYXN0ZXIgcHJvZHVjdC48L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgaWQ9InR1dG9yaWFsLW1hc3Rlci1wcm9kdWN0IiBjbGFzcz0ibWFzdGVyLXByb2R1Y3QtZm9ybSI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1lbnVDYXRlZ29yeUZpbHRlciI+RmlsdGVyIGJ5IE1lbnUgQ2F0ZWdvcnk8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJtZW51Q2F0ZWdvcnlGaWx0ZXIiPjwvc2VsZWN0PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJtYXN0ZXJQcm9kdWN0SW5wdXQiPlNlYXJjaCBmb3IgTWFzdGVyIFByb2R1Y3Q8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnB1dC13aXRoLWNsZWFyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ibWFzdGVyUHJvZHVjdElucHV0IiBsaXN0PSJtYXN0ZXJQcm9kdWN0TGlzdCIgcGxhY2Vob2xkZXI9Ii0tIEltcG9ydCBwcm9kdWN0cyBmaXJzdCAtLSIgdGl0bGU9IlNlbGVjdCB0aGUgbWFpbiBwcm9kdWN0IHlvdSBhcmUgYnVpbGRpbmcgYSByZWNpcGUgZm9yLiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iY2xlYXItYnRuLWlucHV0IiBpZD0ibWFzdGVyUHJvZHVjdENsZWFyQnRuIj4mdGltZXM7PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRhdGFsaXN0IGlkPSJtYXN0ZXJQcm9kdWN0TGlzdCI+PC9kYXRhbGlzdD4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8IS0tIFlpZWxkIEZpZWxkcyBmb3IgTWFudWZhY3R1cmVkIFByb2R1Y3RzIC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InlpZWxkRmllbGRzQ29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgZ3JpZC1jb2x1bW46IDEgLyAtMTsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyIGF1dG87IGdhcDogMTVweDsgbWFyZ2luLXRvcDogMTBweDsgYWxpZ24taXRlbXM6IGVuZDsiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InlpZWxkUXR5SW5wdXQiPllpZWxkIFF1YW50aXR5PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIGlkPSJ5aWVsZFF0eUlucHV0IiBwbGFjZWhvbGRlcj0iZS5nLiwgMS41IiBtaW49IjAuMDAxIiBzdGVwPSIwLjAwMSIgdGl0bGU9IkhvdyBtdWNoIGRvZXMgdGhpcyByZWNpcGUgcHJvZHVjZT8iIHJlYWRvbmx5PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ5aWVsZFVvbUlucHV0Ij5ZaWVsZCBVT008L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ5aWVsZFVvbUlucHV0IiBwbGFjZWhvbGRlcj0iZS5nLiwga2csIEwsIGVhY2giIHRpdGxlPSJXaGF0IGlzIHRoZSB1bml0IGZvciB0aGUgeWllbGQgcXVhbnRpdHk/IiByZWFkb25seT4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJlZGl0WWllbGRCdG4iIGNsYXNzPSJhY3Rpb24tYnRuIGJ0bi1pY29uIiB0aXRsZT0iRWRpdCBZaWVsZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgY2xhc3M9ImVkaXQtaWNvbiI+PHBhdGggZD0iTTExIDRINGEyIDIgMCAwIDAtMiAydjE0YTIgMiAwIDAgMCAyIDJoMTRhMiAyIDAgMCAwIDItMnYtNyI+PC9wYXRoPjxwYXRoIGQ9Ik0xOC41IDIuNWEyLjEyMSAyLjEyMSAwIDAgMSAzIDNMMTIgMTVsLTQgMSAxLTQgOS41LTkuNXoiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ic2F2ZS1pY29uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPjxwb2x5bGluZSBwb2ludHM9IjIwIDYgOSAxNyA0IDEyIj48L3BvbHlsaW5lPjwvc3ZnPgogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJlY2lwZS1kZXRhaWxzIiBpZD0idHV0b3JpYWwtcmVjaXBlLXRhYmxlIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZWNpcGUtdGFibGUtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGlkPSJyZWNpcGVUYWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+UExVPC90aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPlByb2R1Y3QgTmFtZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5VT008L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+Q29zdC9VT008L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+UXVhbnRpdHk8L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+VG90YWwgQ29zdDwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5BY3Rpb248L3RoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gUmVjaXBlIGl0ZW1zIHdpbGwgYmUgYWRkZWQgaGVyZSAtLT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyZWNpcGUtc3VtbWFyeSI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29zdC1kZXRhaWxzIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idG90YWwtY29zdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3RhbCBSZWNpcGUgQ29zdDogPHNwYW4gaWQ9InRvdGFsQ29zdCI+UjAuMDA8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWxsaW5nLXByaWNlIiBpZD0ic2VsbGluZ1ByaWNlQ29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFzdGVyIFNlbGxpbmcgUHJpY2U6IDxzcGFuIGlkPSJtYXN0ZXJTZWxsaW5nUHJpY2UiPlIwLjAwPC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ3AtcGVyY2VudGFnZSIgaWQ9ImdwUGVyY2VudGFnZUNvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyb3NzIFByb2ZpdCAlOiA8c3BhbiBpZD0iZ3BQZXJjZW50YWdlIj4wLjAwJTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYWN0aW9uLWJ0biBzYXZlLWJ0biIgaWQ9InNhdmVSZWNpcGVCdG4iIHRpdGxlPSJTYXZlIHRoZSBjdXJyZW50IHJlY2lwZSBpbiB0aGUgYnVpbGRlciB0byB0aGUgJ1NhdmVkIFJlY2lwZXMnIGxpc3QgYmVsb3cuIj5TYXZlIFJlY2lwZTwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPCEtLSBZaWVsZCBFZGl0b3IgUGFuZWwgLS0+CiAgICAgICAgICAgIDxkaXYgaWQ9InlpZWxkRWRpdG9yUGFuZWwiIGNsYXNzPSJwYW5lbCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkZXIiPgogICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b29sdGlwLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxoMj5ZaWVsZCBFZGl0b3I8L2gyPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0b29sdGlwLXRleHQiPkVkaXQgdGhlIHlpZWxkIGZvciBzYXZlZCBtYW51ZmFjdHVyZWQgcHJvZHVjdHMuIFVwZGF0aW5nIHRoZSB5aWVsZCB3aWxsIGF1dG9tYXRpY2FsbHkgcmVjYWxjdWxhdGUgaXRzIGNvc3QgYW5kIHVwZGF0ZSBpdCBldmVyeXdoZXJlIGl0J3MgdXNlZCBhcyBhbiBpbmdyZWRpZW50LjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InlpZWxkRWRpdG9yU2VhcmNoIiBjbGFzcz0ic2VhcmNoLWJhciIgcGxhY2Vob2xkZXI9IlNlYXJjaCBtYW51ZmFjdHVyZWQgcHJvZHVjdHMuLi4iPgogICAgICAgICAgICAgICAgPGRpdiBpZD0ieWllbGRFZGl0b3JDb250YWluZXIiIGNsYXNzPSJyZWNpcGUtdGFibGUtY29udGFpbmVyIj4KICAgICAgICAgICAgICAgICAgICA8IS0tIFlpZWxkIGVkaXRvciB0YWJsZSB3aWxsIGJlIGdlbmVyYXRlZCBoZXJlIC0tPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8IS0tIEJvdHRvbSBSaWdodCBQYW5lbDogU2F2ZWQgUmVjaXBlcyAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJwYW5lbCBzYXZlZC1yZWNpcGVzLXBhbmVsIiBpZD0idHV0b3JpYWwtc2F2ZWQtcmVjaXBlcyI+CiAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkZXIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idG9vbHRpcC1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDxoMj5TYXZlZCBSZWNpcGVzPC9oMj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+VmlldywgZWRpdCwgY29weSwgb3IgZGVsZXRlIHlvdXIgc2F2ZWQgcmVjaXBlcy48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJzYXZlZFJlY2lwZVNlYXJjaCIgY2xhc3M9InNlYXJjaC1iYXIiIHBsYWNlaG9sZGVyPSJTZWFyY2ggc2F2ZWQgcmVjaXBlcy4uLiI+CiAgICAgICAgICAgIDxkaXYgaWQ9InNhdmVkUmVjaXBlc0NvbnRhaW5lciI+CiAgICAgICAgICAgICAgICA8IS0tIFNhdmVkIHJlY2lwZXMgdGFibGUgd2lsbCBiZSBnZW5lcmF0ZWQgaGVyZSAtLT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InNhdmVkLXJlY2lwZXMtZm9vdGVyIj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gZXhwb3J0LWJ0biIgaWQ9ImV4cG9ydEFsbEJ0bkZvb3RlciIgdGl0bGU9IkV4cG9ydCBhbGwgc2F2ZWQgcmVjaXBlcyB0byBhbiBFeGNlbCBmaWxlIGFuZCBjbGVhciBhbGwgZGF0YS4iPkV4cG9ydCBBbGwgUmVjaXBlczwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L2Rpdj4KCjwhLS0gVHV0b3JpYWwgRWxlbWVudHMgLS0+CjxkaXYgaWQ9InR1dG9yaWFsLXByb21wdC1tb2RhbCIgY2xhc3M9Im1vZGFsLWJhY2tkcm9wIj4KICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KICAgIDxoMz5XZWxjb21lIHRvIFlvdXIgWW9jbyBKb3VybmV5PC9oMz4KICAgIDxwPldl4oCZbGwgZ3VpZGUgeW91IHRocm91Z2ggdGhlIHN0ZXBzIG5lZWRlZCB0byBnZXQgc3RhcnRlZC4gRWFjaCBzZWN0aW9uIHdpbGwgaGlnaGxpZ2h0IHdoYXTigJlzIHJlcXVpcmVkIGZyb20geW91LjwvcD4KICAgIDxkaXYgY2xhc3M9Im1vZGFsLWJ1dHRvbnMiPgogICAgICA8YnV0dG9uIGlkPSJzdGFydC10dXRvcmlhbC1idG4iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPlllcywgcGxlYXNlPC9idXR0b24+CiAgICAgIDxidXR0b24gaWQ9InNraXAtdHV0b3JpYWwtYnRuIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiPk5vLCB0aGFua3M8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxkaXYgaWQ9InR1dG9yaWFsLW92ZXJsYXkiIGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5Ij4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktdG9wIj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktYm90dG9tIj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktbGVmdCI+PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Ij48L2Rpdj4KPC9kaXY+CjxkaXYgaWQ9InR1dG9yaWFsLXBvcG92ZXIiIGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyIj4KICAgIDxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItaGVhZGVyIj4KICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTEyIDIyczgtNCA4LTEwVjVsLTgtMy04IDN2N2MwIDYgOCAxMCA4IDEweiI+PC9wYXRoPjwvc3ZnPgogICAgICAgIDxzcGFuPlF1aWNrIEd1aWRlPC9zcGFuPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiIGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1uYXYiPgogICAgICAgIDxzcGFuIGlkPSJ0dXRvcmlhbC1zdGVwLWNvdW50ZXIiIGNsYXNzPSJ0ZXh0LXNtIj48L3NwYW4+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0idHV0b3JpYWwtcHJldi1idG4iIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSI+UHJldjwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGlkPSJ0dXRvcmlhbC1uZXh0LWJ0biIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+TmV4dDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CjwvZGl2PgoKCjxzY3JpcHQ+CiAgICAvLyAtLS0gU3RhdGUgTWFuYWdlbWVudCAtLS0KICAgIGxldCBpbXBvcnRlZFByb2R1Y3RzID0gW107CiAgICBsZXQgcmVjaXBlSXRlbXMgPSBbXTsKICAgIGxldCBzZWxlY3RlZE1hc3RlclByb2R1Y3QgPSBudWxsOwogICAgbGV0IHNhdmVkUmVjaXBlcyA9IFtdOwogICAgbGV0IGlzRWRpdGluZ1JlY2lwZSA9IGZhbHNlOwoKICAgIC8vIC0tLSBET00gRWxlbWVudHMgLS0tCiAgICBjb25zdCBleGNlbEZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleGNlbEZpbGUnKTsKICAgIGNvbnN0IGZpbGVOYW1lRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlTmFtZScpOwogICAgY29uc3QgbGlicmFyeVRhYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlicmFyeVRhYnMnKTsKICAgIGNvbnN0IHRhYkNvbnRlbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYkNvbnRlbnRzJyk7CiAgICBjb25zdCByZWNpcGVUYWJsZUJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmVjaXBlVGFibGUgdGJvZHknKTsKICAgIGNvbnN0IHRvdGFsQ29zdERpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90YWxDb3N0Jyk7CiAgICBjb25zdCBzYXZlUmVjaXBlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVSZWNpcGVCdG4nKTsKICAgIGNvbnN0IGV4cG9ydEFsbEJ0bkhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRBbGxCdG5IZWFkZXInKTsKICAgIGNvbnN0IGV4cG9ydEFsbEJ0bkZvb3RlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRBbGxCdG5Gb290ZXInKTsKICAgIGNvbnN0IGNsZWFyQWxsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyQWxsQnRuJyk7CiAgICBjb25zdCBtZW51Q2F0ZWdvcnlGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudUNhdGVnb3J5RmlsdGVyJyk7CiAgICBjb25zdCBtYXN0ZXJQcm9kdWN0SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFzdGVyUHJvZHVjdElucHV0Jyk7CiAgICBjb25zdCBtYXN0ZXJQcm9kdWN0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXN0ZXJQcm9kdWN0TGlzdCcpOwogICAgY29uc3QgbWFzdGVyUHJvZHVjdENsZWFyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc3RlclByb2R1Y3RDbGVhckJ0bicpOwogICAgY29uc3Qgc2F2ZWRSZWNpcGVzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVkUmVjaXBlc0NvbnRhaW5lcicpOwogICAgY29uc3Qgc2F2ZWRSZWNpcGVTZWFyY2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZWRSZWNpcGVTZWFyY2gnKTsKICAgIGNvbnN0IHNlbGxpbmdQcmljZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxsaW5nUHJpY2VDb250YWluZXInKTsKICAgIGNvbnN0IG1hc3RlclNlbGxpbmdQcmljZURpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFzdGVyU2VsbGluZ1ByaWNlJyk7CiAgICBjb25zdCBncFBlcmNlbnRhZ2VDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3BQZXJjZW50YWdlQ29udGFpbmVyJyk7CiAgICBjb25zdCBncFBlcmNlbnRhZ2VEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dwUGVyY2VudGFnZScpOwogICAgY29uc3QgeWllbGRGaWVsZHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRGaWVsZHNDb250YWluZXInKTsKICAgIGNvbnN0IHlpZWxkUXR5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRRdHlJbnB1dCcpOwogICAgY29uc3QgeWllbGRVb21JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZFVvbUlucHV0Jyk7CiAgICBjb25zdCByaWdodFBhbmVsVGFicyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaWdodFBhbmVsVGFicycpOwogICAgY29uc3QgeWllbGRFZGl0b3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRFZGl0b3JDb250YWluZXInKTsKICAgIGNvbnN0IHlpZWxkRWRpdG9yU2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkRWRpdG9yU2VhcmNoJyk7CiAgICBjb25zdCBlZGl0WWllbGRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdFlpZWxkQnRuJyk7CiAgICAKICAgIC8vIC0tLSBFdmVudCBMaXN0ZW5lcnMgLS0tCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsKICAgICAgICBsb2FkU3RhdGUoKTsKICAgICAgICBjb25zdCBoYXNEYXRhID0gKGltcG9ydGVkUHJvZHVjdHMgJiYgaW1wb3J0ZWRQcm9kdWN0cy5sZW5ndGggPiAwKSB8fCAoc2F2ZWRSZWNpcGVzICYmIHNhdmVkUmVjaXBlcy5sZW5ndGggPiAwKTsKICAgICAgICBpZiAoIWhhc0RhdGEpIHsKICAgICAgICAgICAgLy8gQWx3YXlzIHByb21wdCB0dXRvcmlhbCB3aGVuIHRoZXJlJ3Mgbm8gZGF0YSAoZmlyc3QgbG9hZCAvIGZyZXNoIHN0YXJ0KQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIH0KICAgIH0pOwogICAgZXhjZWxGaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVVwbG9hZCk7CiAgICBzYXZlUmVjaXBlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUN1cnJlbnRSZWNpcGUpOwogICAgZXhwb3J0QWxsQnRuSGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXhwb3J0QWxsUmVjaXBlcyk7CiAgICBleHBvcnRBbGxCdG5Gb290ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRBbGxSZWNpcGVzKTsKICAgIGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY2xlYXJBbGxEYXRhKHRydWUpKTsKICAgIG1lbnVDYXRlZ29yeUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7CiAgICAgICAgY2xlYXJNYXN0ZXJQcm9kdWN0SW5wdXQoKTsKICAgICAgICBwb3B1bGF0ZU1hc3RlclByb2R1Y3REYXRhbGlzdCgpOwogICAgfSk7CiAgICBtYXN0ZXJQcm9kdWN0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVNYXN0ZXJQcm9kdWN0SW5wdXQpOwogICAgbWFzdGVyUHJvZHVjdENsZWFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xlYXJNYXN0ZXJQcm9kdWN0SW5wdXQpOwogICAgc2F2ZWRSZWNpcGVTZWFyY2guYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBoYW5kbGVTYXZlZFJlY2lwZVNlYXJjaCk7CiAgICB5aWVsZEVkaXRvclNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICgpID0+IHJlbmRlcllpZWxkRWRpdG9yKCkpOwogICAgcmlnaHRQYW5lbFRhYnMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcudGFiLWJ1dHRvbicpKSB7CiAgICAgICAgICAgIHN3aXRjaFJpZ2h0VGFiKGUudGFyZ2V0LmNsb3Nlc3QoJy50YWItYnV0dG9uJykuZGF0YXNldC50YWIpOwogICAgICAgIH0KICAgIH0pOwogICAgZWRpdFlpZWxkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlWWllbGRFZGl0aW5nKTsKCgogICAgLy8gLS0tIERhdGEgUGVyc2lzdGVuY2UgLS0tCiAgICBmdW5jdGlvbiBzYXZlU3RhdGUoKSB7CiAgICAgICAgY29uc3QgYXBwU3RhdGUgPSB7CiAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHM6IGltcG9ydGVkUHJvZHVjdHMsCiAgICAgICAgICAgIHNhdmVkUmVjaXBlczogc2F2ZWRSZWNpcGVzCiAgICAgICAgfTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVjaXBlQnVpbGRlclN0YXRlJywgSlNPTi5zdHJpbmdpZnkoYXBwU3RhdGUpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsb2FkU3RhdGUoKSB7CiAgICAgICAgY29uc3Qgc2F2ZWRTdGF0ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWNpcGVCdWlsZGVyU3RhdGUnKTsKICAgICAgICBpZiAoc2F2ZWRTdGF0ZSkgewogICAgICAgICAgICBjb25zdCBhcHBTdGF0ZSA9IEpTT04ucGFyc2Uoc2F2ZWRTdGF0ZSk7CiAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHMgPSBhcHBTdGF0ZS5pbXBvcnRlZFByb2R1Y3RzIHx8IFtdOwogICAgICAgICAgICBzYXZlZFJlY2lwZXMgPSBhcHBTdGF0ZS5zYXZlZFJlY2lwZXMgfHwgW107CgogICAgICAgICAgICBpZiAoaW1wb3J0ZWRQcm9kdWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBmaWxlTmFtZURpc3BsYXkudGV4dENvbnRlbnQgPSAnTG9hZGVkIGZyb20gcHJldmlvdXMgc2Vzc2lvbi4nOwogICAgICAgICAgICAgICAgc2V0dXBMaWJyYXJ5VGFicygpOwogICAgICAgICAgICAgICAgcG9wdWxhdGVDYXRlZ29yeUZpbHRlcigpOwogICAgICAgICAgICAgICAgcG9wdWxhdGVNYXN0ZXJQcm9kdWN0RGF0YWxpc3QoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2F2ZWRSZWNpcGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcygpOwogICAgICAgICAgICAgICAgcmVuZGVyWWllbGRFZGl0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldHVwTGlicmFyeVRhYnMoKTsgLy8gU2V0dXAgdGFicyBldmVuIGlmIG5vIGRhdGEKICAgICAgICB9CiAgICB9CgogICAgLy8gLS0tIEZpbGUgSW1wb3J0IExvZ2ljIC0tLQogICAgZnVuY3Rpb24gaGFuZGxlRmlsZVVwbG9hZChldmVudCkgewogICAgICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07CiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm47CgogICAgICAgIGlmIChpbXBvcnRlZFByb2R1Y3RzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgaWYgKCFjb25maXJtKCJJbXBvcnRpbmcgYSBuZXcgZmlsZSB3aWxsIGNsZWFyIGFsbCBjdXJyZW50IGRhdGEsIGluY2x1ZGluZyBzYXZlZCByZWNpcGVzLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY29udGludWU/IikpIHsKICAgICAgICAgICAgICAgIGV4Y2VsRmlsZUlucHV0LnZhbHVlID0gIiI7IC8vIFJlc2V0IGZpbGUgaW5wdXQKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjbGVhckFsbERhdGEoZmFsc2UpOyAvLyBDbGVhciBleGlzdGluZyBkYXRhIHdpdGhvdXQgYXNraW5nIGFnYWluCgogICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoZS50YXJnZXQucmVzdWx0KTsKICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogJ2FycmF5JyB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0U2hlZXROYW1lID0gd29ya2Jvb2suU2hlZXROYW1lc1swXTsKICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtzaGVldCA9IHdvcmtib29rLlNoZWV0c1tmaXJzdFNoZWV0TmFtZV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIC0tLSBIRUFERVIgVkFMSURBVElPTiAtLS0KICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkSGVhZGVycyA9IFsnUHJvZHVjdCBQTFUnLCAnUHJvZHVjdCBOYW1lICYgVmFyaWFudCcsICdTZWxsaW5nIFVPTScsICdDb3N0IFByaWNlJywgJ1NlbGxpbmcgUHJpY2UnLCAnSW52ZW50b3J5IENhdGVnb3J5JywgJ01lbnUgQ2F0ZWdvcnknXTsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlclJvdyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3Jrc2hlZXQsIHsgaGVhZGVyOiAxIH0pWzBdOwogICAgICAgICAgICAgICAgY29uc3QgbWlzc2luZ0hlYWRlcnMgPSByZXF1aXJlZEhlYWRlcnMuZmlsdGVyKGhlYWRlciA9PiAhaGVhZGVyUm93LmluY2x1ZGVzKGhlYWRlcikpOwoKICAgICAgICAgICAgICAgIGlmIChtaXNzaW5nSGVhZGVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoYEltcG9ydCBmYWlsZWQuIFRoZSBFeGNlbCBmaWxlIGlzIG1pc3NpbmcgdGhlIGZvbGxvd2luZyByZXF1aXJlZCBjb2x1bW5zOlxuXG4tICR7bWlzc2luZ0hlYWRlcnMuam9pbignXG4tICcpfWApOwogICAgICAgICAgICAgICAgICAgIGV4Y2VsRmlsZUlucHV0LnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tIEVORCBWQUxJREFUSU9OIC0tLQoKICAgICAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdvcmtzaGVldCwgeyBkZWZ2YWw6ICIiIH0pOwogICAgICAgICAgICAgICAgZmlsZU5hbWVEaXNwbGF5LnRleHRDb250ZW50ID0gYExvYWRlZDogJHtmaWxlLm5hbWV9YDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaW1wb3J0ZWRQcm9kdWN0cyA9IGpzb25EYXRhLm1hcChyb3cgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHlpZWxkUXR5VmFsdWUgPSBwYXJzZUZsb2F0KHJvd1snTWFudWZhY3R1cmVkIFlpZWxkJ10gfHwgcm93WydZaWVsZCBRdWFudGl0eSddKSB8fCAxOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsdTogcm93WydQcm9kdWN0IFBMVSddLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiByb3dbJ1Byb2R1Y3QgTmFtZSAmIFZhcmlhbnQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgdW9tOiByb3dbJ1NlbGxpbmcgVU9NJ10sCiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsVW9tOiByb3dbJ1NlbGxpbmcgVU9NJ10sCiAgICAgICAgICAgICAgICAgICAgICAgIGNvc3Q6IHBhcnNlRmxvYXQocm93WydDb3N0IFByaWNlJ10pIHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogcGFyc2VGbG9hdChyb3dbJ1NlbGxpbmcgUHJpY2UnXSkgfHwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHJvd1snSW52ZW50b3J5IENhdGVnb3J5J10gfHwgJycsIC8vIERlZmF1bHQgdG8gZW1wdHkgc3RyaW5nLCBub3QgJ1VuY2F0ZWdvcml6ZWQnCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnVDYXRlZ29yeTogcm93WydNZW51IENhdGVnb3J5J10gfHwgJ1VuY2F0ZWdvcml6ZWQnLAogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZFF0eTogeWllbGRRdHlWYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxZaWVsZFF0eTogeWllbGRRdHlWYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGRVb206IHJvd1snWWllbGQgVU9NJ10gfHwgJ2VhY2gnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHNldHVwTGlicmFyeVRhYnMoKTsKICAgICAgICAgICAgICAgIHBvcHVsYXRlQ2F0ZWdvcnlGaWx0ZXIoKTsKICAgICAgICAgICAgICAgIHBvcHVsYXRlTWFzdGVyUHJvZHVjdERhdGFsaXN0KCk7CiAgICAgICAgICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIHByb2Nlc3NpbmcgZmlsZToiLCBlcnJvcik7CiAgICAgICAgICAgICAgICBhbGVydCgiVGhlcmUgd2FzIGFuIGVycm9yIHJlYWRpbmcgdGhlIEV4Y2VsIGZpbGUuIFBsZWFzZSBlbnN1cmUgaXQncyBhIHZhbGlkIGZvcm1hdC4iKTsKICAgICAgICAgICAgICAgIGV4Y2VsRmlsZUlucHV0LnZhbHVlID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihmaWxlKTsKICAgIH0KCiAgICAvLyAtLS0gVUkgUmVuZGVyaW5nIC0tLQogICAgZnVuY3Rpb24gc3dpdGNoUmlnaHRUYWIodGFiSWQpIHsKICAgICAgICByaWdodFBhbmVsVGFicy5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWJ1dHRvbicpLmZvckVhY2goYnRuID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJpZ2h0LXBhbmVsLWdyb3VwIC5wYW5lbCcpLmZvckVhY2gocGFuZWwgPT4gcGFuZWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgIAogICAgICAgIGNvbnN0IGFjdGl2ZUJ1dHRvbiA9IHJpZ2h0UGFuZWxUYWJzLnF1ZXJ5U2VsZWN0b3IoYC50YWItYnV0dG9uW2RhdGEtdGFiPScke3RhYklkfSddYCk7CiAgICAgICAgY29uc3QgYWN0aXZlUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCk7CgogICAgICAgIGlmKGFjdGl2ZUJ1dHRvbikgYWN0aXZlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgIGlmKGFjdGl2ZVBhbmVsKSBhY3RpdmVQYW5lbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwb3B1bGF0ZUNhdGVnb3J5RmlsdGVyKCkgewogICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBjb25zdCBzYXZlZE1hc3RlclByb2R1Y3RQTFVzID0gbmV3IFNldChzYXZlZFJlY2lwZXMubWFwKHIgPT4gci5tYXN0ZXIucGx1KSk7CiAgICAgICAgY29uc3QgZWxpZ2libGVQcm9kdWN0cyA9IGltcG9ydGVkUHJvZHVjdHMuZmlsdGVyKHByb2R1Y3QgPT4KICAgICAgICAgICAgIXByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhyYXcpJykgJiYKICAgICAgICAgICAgIXNhdmVkTWFzdGVyUHJvZHVjdFBMVXMuaGFzKHByb2R1Y3QucGx1KQogICAgICAgICk7CiAgICAgICAgCiAgICAgICAgY29uc3QgbWFuUHJvZHVjdHMgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+IHAubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpOwogICAgICAgIGNvbnN0IG90aGVyUHJvZHVjdHMgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+ICFwLm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcobWFuKScpKTsKCiAgICAgICAgLy8gQWRkIGRlZmF1bHQgIkFsbCIgb3B0aW9uCiAgICAgICAgY29uc3QgYWxsT3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgYWxsT3B0aW9uLnZhbHVlID0gJ2FsbCc7CiAgICAgICAgYWxsT3B0aW9uLnRleHRDb250ZW50ID0gJ0FsbCBDYXRlZ29yaWVzJzsKICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIuYXBwZW5kQ2hpbGQoYWxsT3B0aW9uKTsKICAgICAgICAKICAgICAgICAvLyBBZGQgIk1hbnVmYWN0dXJlZCIgb3B0aW9uIGlmIHRoZXJlIGFyZSBhbnkKICAgICAgICBpZiAobWFuUHJvZHVjdHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCBtYW5PcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICAgICAgbWFuT3B0aW9uLnZhbHVlID0gJ21hbnVmYWN0dXJlZCc7CiAgICAgICAgICAgIG1hbk9wdGlvbi50ZXh0Q29udGVudCA9ICdNYW51ZmFjdHVyZWQgUHJvZHVjdHMnOwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIuYXBwZW5kQ2hpbGQobWFuT3B0aW9uKTsKICAgICAgICB9CgogICAgICAgIC8vIEFkZCBvdGhlciBtZW51IGNhdGVnb3JpZXMKICAgICAgICBjb25zdCB1bmlxdWVNZW51Q2F0ZWdvcmllcyA9IFsuLi5uZXcgU2V0KG90aGVyUHJvZHVjdHMubWFwKHAgPT4gcC5tZW51Q2F0ZWdvcnkgfHwgJ1VuY2F0ZWdvcml6ZWQnKSldLnNvcnQoKTsKICAgICAgICB1bmlxdWVNZW51Q2F0ZWdvcmllcy5mb3JFYWNoKGNhdCA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhdE9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgICAgICBjYXRPcHRpb24udmFsdWUgPSBjYXQ7CiAgICAgICAgICAgIGNhdE9wdGlvbi50ZXh0Q29udGVudCA9IGNhdDsKICAgICAgICAgICAgbWVudUNhdGVnb3J5RmlsdGVyLmFwcGVuZENoaWxkKGNhdE9wdGlvbik7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gcG9wdWxhdGVNYXN0ZXJQcm9kdWN0RGF0YWxpc3QoKSB7CiAgICAgICAgbWFzdGVyUHJvZHVjdExpc3QuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgY29uc3Qgc2F2ZWRNYXN0ZXJQcm9kdWN0UExVcyA9IG5ldyBTZXQoc2F2ZWRSZWNpcGVzLm1hcChyID0+IHIubWFzdGVyLnBsdSkpOwogICAgICAgIAogICAgICAgIC8vIFdoZW4gZWRpdGluZywgdGhlIHNlbGVjdGVkIHByb2R1Y3QgaXNuJ3QgaW4gc2F2ZWRSZWNpcGVzLCBidXQgaXQgSVMgdGhlIGBzZWxlY3RlZE1hc3RlclByb2R1Y3RgCiAgICAgICAgY29uc3QgZWxpZ2libGVQcm9kdWN0cyA9IGltcG9ydGVkUHJvZHVjdHMuZmlsdGVyKHByb2R1Y3QgPT4KICAgICAgICAgICAgIXByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhyYXcpJykgJiYKICAgICAgICAgICAgKCFzYXZlZE1hc3RlclByb2R1Y3RQTFVzLmhhcyhwcm9kdWN0LnBsdSkgfHwgKGlzRWRpdGluZ1JlY2lwZSAmJiBzZWxlY3RlZE1hc3RlclByb2R1Y3QgJiYgcHJvZHVjdC5wbHUgPT09IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5wbHUpKQogICAgICAgICk7CgogICAgICAgIGNvbnN0IHNlbGVjdGVkQ2F0ZWdvcnkgPSBtZW51Q2F0ZWdvcnlGaWx0ZXIudmFsdWU7CiAgICAgICAgbGV0IHByb2R1Y3RzVG9MaXN0ID0gW107CgogICAgICAgIGlmIChzZWxlY3RlZENhdGVnb3J5ID09PSAnYWxsJykgewogICAgICAgICAgICBwcm9kdWN0c1RvTGlzdCA9IGVsaWdpYmxlUHJvZHVjdHM7CiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZENhdGVnb3J5ID09PSAnbWFudWZhY3R1cmVkJykgewogICAgICAgICAgICBwcm9kdWN0c1RvTGlzdCA9IGVsaWdpYmxlUHJvZHVjdHMuZmlsdGVyKHAgPT4gcC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJvZHVjdHNUb0xpc3QgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+IChwLm1lbnVDYXRlZ29yeSB8fCAnVW5jYXRlZ29yaXplZCcpID09PSBzZWxlY3RlZENhdGVnb3J5KTsKICAgICAgICB9CgogICAgICAgIGlmIChwcm9kdWN0c1RvTGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgbWFzdGVyUHJvZHVjdElucHV0LnBsYWNlaG9sZGVyID0gIi0tIE5vIHByb2R1Y3RzIGluIHRoaXMgY2F0ZWdvcnkgLS0iOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1hc3RlclByb2R1Y3RJbnB1dC5wbGFjZWhvbGRlciA9ICItLSBTdGFydCB0eXBpbmcgdG8gc2VhcmNoIC0tIjsKICAgICAgICB9CgogICAgICAgIHByb2R1Y3RzVG9MaXN0LnNvcnQoKGEsYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSkuZm9yRWFjaChwcm9kdWN0ID0+IHsKICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IGAke3Byb2R1Y3QubmFtZX0gKCR7cHJvZHVjdC5wbHV9KWA7CiAgICAgICAgICAgIG9wdGlvbi5kYXRhc2V0LnBsdSA9IHByb2R1Y3QucGx1OwogICAgICAgICAgICBtYXN0ZXJQcm9kdWN0TGlzdC5hcHBlbmRDaGlsZChvcHRpb24pOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldHVwTGlicmFyeVRhYnMoKSB7CiAgICAgICAgbGlicmFyeVRhYnMuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgdGFiQ29udGVudHMuaW5uZXJIVE1MID0gJyc7CgogICAgICAgIGNvbnN0IGF2YWlsYWJsZUluZ3JlZGllbnRzID0gaW1wb3J0ZWRQcm9kdWN0cy5maWx0ZXIocCA9PiB7CiAgICAgICAgICAgIC8vIFRyaW0gYW5kIGNvbnZlcnQgdG8gbG93ZXIgY2FzZSBmb3IgYSBjYXNlLWluc2Vuc2l0aXZlIGNoZWNrLgogICAgICAgICAgICBjb25zdCBjbGVhbkNhdGVnb3J5ID0gKHAuY2F0ZWdvcnkgfHwgJycpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQW4gaW5ncmVkaWVudCBpcyBhbnkgcHJvZHVjdCB0aGF0IGhhcyBhbiBpbnZlbnRvcnkgY2F0ZWdvcnkgY29udGFpbmluZyAicmF3IG1hdGVyaWFsIiBvciAibWFudWZhY3R1cmVkIi4KICAgICAgICAgICAgLy8gVXNpbmcgLmluY2x1ZGVzKCkgaXMgbW9yZSBmbGV4aWJsZSB0aGFuIC5lbmRzV2l0aCgpCiAgICAgICAgICAgIHJldHVybiBjbGVhbkNhdGVnb3J5LmluY2x1ZGVzKCdyYXcgbWF0ZXJpYWwnKSB8fCBjbGVhbkNhdGVnb3J5LmluY2x1ZGVzKCdtYW51ZmFjdHVyZWQnKTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGF2YWlsYWJsZUluZ3JlZGllbnRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBpZiAoaW1wb3J0ZWRQcm9kdWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBsaWJyYXJ5VGFicy5pbm5lckhUTUwgPSAnPHAgc3R5bGU9InBhZGRpbmc6IDEwcHg7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsiPk5vIHZhbGlkIGluZ3JlZGllbnRzIGZvdW5kLjwvcD4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsgLy8gRXhpdCBpZiBubyBpbmdyZWRpZW50cyB0byBzaG93CiAgICAgICAgfQoKICAgICAgICAvLyAtLS0gQ3JlYXRlICJBbGwiIFRhYiAtLS0KICAgICAgICBjb25zdCBhbGxUYWJJZCA9ICd0YWItYWxsJzsKICAgICAgICBjb25zdCBhbGxUYWJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBhbGxUYWJCdXR0b24uY2xhc3NOYW1lID0gJ3RhYi1idXR0b24nOwogICAgICAgIGFsbFRhYkJ1dHRvbi5kYXRhc2V0LnRhYiA9IGFsbFRhYklkOwogICAgICAgIGFsbFRhYkJ1dHRvbi50ZXh0Q29udGVudCA9ICdBbGwnOwogICAgICAgIGxpYnJhcnlUYWJzLmFwcGVuZENoaWxkKGFsbFRhYkJ1dHRvbik7CgogICAgICAgIGNvbnN0IGFsbFRhYkNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBhbGxUYWJDb250ZW50LmlkID0gYWxsVGFiSWQ7CiAgICAgICAgYWxsVGFiQ29udGVudC5jbGFzc05hbWUgPSAndGFiLWNvbnRlbnQnOwoKICAgICAgICBjb25zdCBhbGxTZWFyY2hJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgYWxsU2VhcmNoSW5wdXQudHlwZSA9ICd0ZXh0JzsKICAgICAgICBhbGxTZWFyY2hJbnB1dC5jbGFzc05hbWUgPSAnc2VhcmNoLWJhcic7CiAgICAgICAgYWxsU2VhcmNoSW5wdXQucGxhY2Vob2xkZXIgPSAnU2VhcmNoIGFsbCBpbmdyZWRpZW50cy4uLic7CiAgICAgICAgYWxsU2VhcmNoSW5wdXQub25rZXl1cCA9IChlKSA9PiBmaWx0ZXJJbmdyZWRpZW50cyhlLnRhcmdldC52YWx1ZSwgYWxsVGFiSWQpOwoKICAgICAgICBjb25zdCBhbGxMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTsKICAgICAgICBhbGxMaXN0LmNsYXNzTmFtZSA9ICdpbmdyZWRpZW50LWxpc3QnOwogICAgICAgIAogICAgICAgIC8vIFNvcnQgYWxsIGluZ3JlZGllbnRzIGFscGhhYmV0aWNhbGx5IGJ5IG5hbWUgZm9yIHRoZSAiQWxsIiB0YWIKICAgICAgICBhdmFpbGFibGVJbmdyZWRpZW50cy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKS5mb3JFYWNoKHByb2R1Y3QgPT4gewogICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsKICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnaW5ncmVkaWVudC1pdGVtJzsKICAgICAgICAgICAgaXRlbS50aXRsZSA9ICJDbGljayB0byBhZGQgdGhpcyBpdGVtIHRvIHRoZSBjdXJyZW50IHJlY2lwZS4iOwogICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im5hbWUiPiR7cHJvZHVjdC5uYW1lfTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idW9tIj4oJHtwcm9kdWN0LnVvbX0pPC9zcGFuPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iY29zdCI+UiR7cHJvZHVjdC5jb3N0LnRvRml4ZWQoMil9PC9zcGFuPgogICAgICAgICAgICBgOwogICAgICAgICAgICBpdGVtLm9uY2xpY2sgPSAoKSA9PiBhZGRQcm9kdWN0VG9SZWNpcGUocHJvZHVjdCk7CiAgICAgICAgICAgIGFsbExpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7CiAgICAgICAgfSk7CgogICAgICAgIGFsbFRhYkNvbnRlbnQuYXBwZW5kQ2hpbGQoYWxsU2VhcmNoSW5wdXQpOwogICAgICAgIGFsbFRhYkNvbnRlbnQuYXBwZW5kQ2hpbGQoYWxsTGlzdCk7CiAgICAgICAgdGFiQ29udGVudHMuYXBwZW5kQ2hpbGQoYWxsVGFiQ29udGVudCk7CgoKICAgICAgICAvLyAtLS0gQ3JlYXRlIENhdGVnb3J5IFRhYnMgLS0tCiAgICAgICAgY29uc3QgYWxsQ2F0ZWdvcmllcyA9IFsuLi5uZXcgU2V0KGF2YWlsYWJsZUluZ3JlZGllbnRzLm1hcChwID0+IHAuY2F0ZWdvcnkpKV07CiAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGFsbENhdGVnb3JpZXMuZmlsdGVyKGMgPT4gYyAmJiBjLnRyaW0oKSAhPT0gJycgJiYgYy50cmltKCkgIT09ICdVbmNhdGVnb3JpemVkJykuc29ydCgpOwoKICAgICAgICBjYXRlZ29yaWVzLmZvckVhY2goY2F0ZWdvcnkgPT4gewogICAgICAgICAgICBjb25zdCB0YWJJZCA9IGB0YWItJHtjYXRlZ29yeS5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywgJy0nKX1gOyAvLyBTYW5pdGl6ZSBJRCBmb3Igc2FmZXR5CiAgICAgICAgICAgIGNvbnN0IHRhYkJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICB0YWJCdXR0b24uY2xhc3NOYW1lID0gJ3RhYi1idXR0b24nOwogICAgICAgICAgICB0YWJCdXR0b24uZGF0YXNldC50YWIgPSB0YWJJZDsKICAgICAgICAgICAgdGFiQnV0dG9uLnRleHRDb250ZW50ID0gY2F0ZWdvcnk7CiAgICAgICAgICAgIGxpYnJhcnlUYWJzLmFwcGVuZENoaWxkKHRhYkJ1dHRvbik7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCB0YWJDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHRhYkNvbnRlbnQuaWQgPSB0YWJJZDsKICAgICAgICAgICAgdGFiQ29udGVudC5jbGFzc05hbWUgPSAndGFiLWNvbnRlbnQnOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgICAgICBzZWFyY2hJbnB1dC50eXBlID0gJ3RleHQnOwogICAgICAgICAgICBzZWFyY2hJbnB1dC5jbGFzc05hbWUgPSAnc2VhcmNoLWJhcic7CiAgICAgICAgICAgIHNlYXJjaElucHV0LnBsYWNlaG9sZGVyID0gYFNlYXJjaCBpbiAke2NhdGVnb3J5fS4uLmA7CiAgICAgICAgICAgIHNlYXJjaElucHV0Lm9ua2V5dXAgPSAoZSkgPT4gZmlsdGVySW5ncmVkaWVudHMoZS50YXJnZXQudmFsdWUsIHRhYklkKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpOwogICAgICAgICAgICBsaXN0LmNsYXNzTmFtZSA9ICdpbmdyZWRpZW50LWxpc3QnOwoKICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlQcm9kdWN0cyA9IGF2YWlsYWJsZUluZ3JlZGllbnRzLmZpbHRlcihwID0+IHAuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsKICAgICAgICAgICAgLy8gU29ydCBwcm9kdWN0cyB3aXRoaW4gZWFjaCBjYXRlZ29yeSBhcyB3ZWxsCiAgICAgICAgICAgIGNhdGVnb3J5UHJvZHVjdHMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSkuZm9yRWFjaChwcm9kdWN0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnaW5ncmVkaWVudC1pdGVtJzsKICAgICAgICAgICAgICAgIGl0ZW0udGl0bGUgPSAiQ2xpY2sgdG8gYWRkIHRoaXMgaXRlbSB0byB0aGUgY3VycmVudCByZWNpcGUuIjsKICAgICAgICAgICAgICAgIGl0ZW0uaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJuYW1lIj4ke3Byb2R1Y3QubmFtZX08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ1b20iPigke3Byb2R1Y3QudW9tfSk8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImNvc3QiPlIke3Byb2R1Y3QuY29zdC50b0ZpeGVkKDIpfTwvc3Bhbj4KICAgICAgICAgICAgICAgIGA7CiAgICAgICAgICAgICAgICBpdGVtLm9uY2xpY2sgPSAoKSA9PiBhZGRQcm9kdWN0VG9SZWNpcGUocHJvZHVjdCk7CiAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRhYkNvbnRlbnQuYXBwZW5kQ2hpbGQoc2VhcmNoSW5wdXQpOwogICAgICAgICAgICB0YWJDb250ZW50LmFwcGVuZENoaWxkKGxpc3QpOwogICAgICAgICAgICB0YWJDb250ZW50cy5hcHBlbmRDaGlsZCh0YWJDb250ZW50KTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gLS0tIEZpbmFsaXplIFRhYnMgLS0tCiAgICAgICAgbGlicmFyeVRhYnMucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1idXR0b24nKS5mb3JFYWNoKGJ0biA9PiB7CiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHN3aXRjaFRhYihidG4uZGF0YXNldC50YWIpKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gQWN0aXZhdGUgdGhlICdBbGwnIHRhYiBieSBkZWZhdWx0CiAgICAgICAgc3dpdGNoVGFiKGFsbFRhYklkKTsKICAgIH0KCgogICAgZnVuY3Rpb24gc3dpdGNoVGFiKHRhYklkKSB7CiAgICAgICAgbGlicmFyeVRhYnMucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1idXR0b24nKS5mb3JFYWNoKGJ0biA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgIHRhYkNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItY29udGVudCcpLmZvckVhY2goY29udGVudCA9PiBjb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAKICAgICAgICBjb25zdCBhY3RpdmVCdXR0b24gPSBsaWJyYXJ5VGFicy5xdWVyeVNlbGVjdG9yKGAudGFiLWJ1dHRvbltkYXRhLXRhYj0nJHt0YWJJZH0nXWApOwogICAgICAgIGNvbnN0IGFjdGl2ZUNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCk7CgogICAgICAgIGlmKGFjdGl2ZUJ1dHRvbikgYWN0aXZlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgIGlmKGFjdGl2ZUNvbnRlbnQpIGFjdGl2ZUNvbnRlbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICB9CgogICAgZnVuY3Rpb24gZmlsdGVySW5ncmVkaWVudHMoc2VhcmNoVGVybSwgdGFiSWQpIHsKICAgICAgICBjb25zdCBsaXN0SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHt0YWJJZH0gLmluZ3JlZGllbnQtaXRlbWApOwogICAgICAgIGNvbnN0IGxvd2VyQ2FzZVNlYXJjaFRlcm0gPSBzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgbGlzdEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy5uYW1lJykudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gbmFtZS5pbmNsdWRlcyhsb3dlckNhc2VTZWFyY2hUZXJtKSA/ICdmbGV4JyA6ICdub25lJzsKICAgICAgICB9KTsKICAgIH0KCiAgICAvLyAtLS0gUmVjaXBlIExvZ2ljIC0tLQogICAgZnVuY3Rpb24gaGFuZGxlTWFzdGVyUHJvZHVjdElucHV0KGV2ZW50KSB7CiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZTsKICAgICAgICBjb25zdCBvcHRpb24gPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtYXN0ZXJQcm9kdWN0TGlzdCBvcHRpb24nKSkuZmluZChvcHQgPT4gb3B0LnZhbHVlID09PSBpbnB1dFZhbHVlKTsKICAgICAgICBzZWxlY3RlZE1hc3RlclByb2R1Y3QgPSBvcHRpb24gPyBpbXBvcnRlZFByb2R1Y3RzLmZpbmQocCA9PiBwLnBsdS50b1N0cmluZygpID09PSBvcHRpb24uZGF0YXNldC5wbHUpIDogbnVsbDsKICAgICAgICAKICAgICAgICBpZiAoc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0ICYmIHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSkgewogICAgICAgICAgICB5aWVsZEZpZWxkc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2dyaWQnOwogICAgICAgICAgICB5aWVsZFF0eUlucHV0LnZhbHVlID0gc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0Lm9yaWdpbmFsWWllbGRRdHkgfHwgMTsKICAgICAgICAgICAgeWllbGRVb21JbnB1dC52YWx1ZSA9IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5vcmlnaW5hbFVvbTsKICAgICAgICAgICAgc2V0WWllbGRGaWVsZHNSZWFkT25seSh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB5aWVsZEZpZWxkc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0KCiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgICAgIG1hc3RlclByb2R1Y3RDbGVhckJ0bi5zdHlsZS5kaXNwbGF5ID0gaW5wdXRWYWx1ZS5sZW5ndGggPiAwID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhck1hc3RlclByb2R1Y3RJbnB1dCgpIHsKICAgICAgICBtYXN0ZXJQcm9kdWN0SW5wdXQudmFsdWUgPSAnJzsKICAgICAgICBzZWxlY3RlZE1hc3RlclByb2R1Y3QgPSBudWxsOwogICAgICAgIHVwZGF0ZVN1bW1hcnkoKTsKICAgICAgICBtYXN0ZXJQcm9kdWN0Q2xlYXJCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICB5aWVsZEZpZWxkc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIG1hc3RlclByb2R1Y3RJbnB1dC5mb2N1cygpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBhZGRQcm9kdWN0VG9SZWNpcGUocHJvZHVjdCkgewogICAgICAgIC8vIENoZWNrIGlmIHRoZSBwcm9kdWN0IGlzIGEgKE1BTikgaXRlbSB0aGF0IGRvZXNuJ3QgaGF2ZSBhIHNhdmVkIHJlY2lwZSB5ZXQKICAgICAgICBpZiAocHJvZHVjdC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSkgewogICAgICAgICAgICBjb25zdCBpc01hblJlY2lwZVNhdmVkID0gc2F2ZWRSZWNpcGVzLnNvbWUociA9PiByLm1hc3Rlci5wbHUudG9TdHJpbmcoKSA9PT0gcHJvZHVjdC5wbHUudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGlmICghaXNNYW5SZWNpcGVTYXZlZCkgewogICAgICAgICAgICAgICAgYWxlcnQoYEEgcmVjaXBlIGZvciAiJHtwcm9kdWN0Lm5hbWV9IiBtdXN0IGJlIGJ1aWx0IGFuZCBzYXZlZCBmaXJzdCBiZWZvcmUgaXQgY2FuIGJlIHVzZWQgYXMgYW4gaW5ncmVkaWVudC5gKTsKICAgICAgICAgICAgICAgIHJldHVybjsgLy8gU3RvcCB0aGUgZnVuY3Rpb24KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHJlY2lwZUl0ZW1zLnNvbWUoaXRlbSA9PiBpdGVtLnBsdSA9PT0gcHJvZHVjdC5wbHUpKSB7CiAgICAgICAgICAgIGFsZXJ0KGAke3Byb2R1Y3QubmFtZX0gaXMgYWxyZWFkeSBpbiB0aGUgcmVjaXBlLmApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJlY2lwZUl0ZW1zLnB1c2goeyAuLi5wcm9kdWN0LCBxdWFudGl0eTogJycgfSk7CiAgICAgICAgcmVuZGVyUmVjaXBlVGFibGUoKTsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHVwZGF0ZVJlY2lwZVF1YW50aXR5KHBsdSwgcXVhbnRpdHkpIHsKICAgICAgICBjb25zdCBpdGVtID0gcmVjaXBlSXRlbXMuZmluZChpID0+IGkucGx1LnRvU3RyaW5nKCkgPT09IHBsdS50b1N0cmluZygpKTsKICAgICAgICBpZiAoaXRlbSkgaXRlbS5xdWFudGl0eSA9IHBhcnNlRmxvYXQocXVhbnRpdHkpIHx8IDA7CiAgICAgICAgcmVuZGVyUmVjaXBlVGFibGUoKTsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVtb3ZlUmVjaXBlSXRlbShwbHUpIHsKICAgICAgICByZWNpcGVJdGVtcyA9IHJlY2lwZUl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0ucGx1LnRvU3RyaW5nKCkgIT09IHBsdS50b1N0cmluZygpKTsKICAgICAgICByZW5kZXJSZWNpcGVUYWJsZSgpOwogICAgICAgIHVwZGF0ZVN1bW1hcnkoKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJSZWNpcGVUYWJsZSgpIHsKICAgICAgICByZWNpcGVUYWJsZUJvZHkuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgcmVjaXBlSXRlbXMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgY29uc3QgaXRlbVRvdGFsQ29zdCA9IGl0ZW0uY29zdCAqIGl0ZW0ucXVhbnRpdHk7CiAgICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8dGQ+JHtpdGVtLnBsdX08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7aXRlbS5uYW1lfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+JHtpdGVtLnVvbX08L3RkPgogICAgICAgICAgICAgICAgPHRkPlIke2l0ZW0uY29zdC50b0ZpeGVkKDIpfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+PGlucHV0IHR5cGU9Im51bWJlciIgdmFsdWU9IiR7aXRlbS5xdWFudGl0eX0iIHBsYWNlaG9sZGVyPSIwLjAwMCIgbWluPSIwIiBzdGVwPSIwLjAwMSIgb25jaGFuZ2U9InVwZGF0ZVJlY2lwZVF1YW50aXR5KCcke2l0ZW0ucGx1fScsIHRoaXMudmFsdWUpIj48L3RkPgogICAgICAgICAgICAgICAgPHRkPlIke2l0ZW1Ub3RhbENvc3QudG9GaXhlZCgyKX08L3RkPgogICAgICAgICAgICAgICAgPHRkPjxidXR0b24gY2xhc3M9InJlbW92ZS1idG4iIHRpdGxlPSJSZW1vdmUgdGhpcyBpbmdyZWRpZW50IGZyb20gdGhlIGN1cnJlbnQgcmVjaXBlLiIgb25jbGljaz0icmVtb3ZlUmVjaXBlSXRlbSgnJHtpdGVtLnBsdX0nKSI+JnRpbWVzOzwvYnV0dG9uPjwvdGQ+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIHJlY2lwZVRhYmxlQm9keS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVN1bW1hcnkoKSB7CiAgICAgICAgLy8gMS4gQ2FsY3VsYXRlIGFuZCBkaXNwbGF5IHRvdGFsIGNvc3QKICAgICAgICBjb25zdCB0b3RhbCA9IHJlY2lwZUl0ZW1zLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyAoaXRlbS5jb3N0ICogaXRlbS5xdWFudGl0eSksIDApOwogICAgICAgIHRvdGFsQ29zdERpc3BsYXkudGV4dENvbnRlbnQgPSBgUiR7dG90YWwudG9GaXhlZCgyKX1gOwoKICAgICAgICAvLyAyLiBEaXNwbGF5IHNlbGxpbmcgcHJpY2UgYW5kIEdQJSBpZiBhIG1hc3RlciBwcm9kdWN0IGlzIHNlbGVjdGVkCiAgICAgICAgaWYgKHNlbGVjdGVkTWFzdGVyUHJvZHVjdCAmJiB0eXBlb2Ygc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0LnNlbGxpbmdQcmljZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgY29uc3Qgc2VsbGluZ1ByaWNlID0gc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0LnNlbGxpbmdQcmljZTsKICAgICAgICAgICAgbWFzdGVyU2VsbGluZ1ByaWNlRGlzcGxheS50ZXh0Q29udGVudCA9IGBSJHtzZWxsaW5nUHJpY2UudG9GaXhlZCgyKX1gOwogICAgICAgICAgICBzZWxsaW5nUHJpY2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CgogICAgICAgICAgICBsZXQgZ3AgPSAwOwogICAgICAgICAgICBpZiAoc2VsbGluZ1ByaWNlID4gMCkgewogICAgICAgICAgICAgICAgZ3AgPSAoKHNlbGxpbmdQcmljZSAtIHRvdGFsKSAvIHNlbGxpbmdQcmljZSkgKiAxMDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgZ3AgPSAtMTAwOyAvLyBPciBoYW5kbGUgYXMgeW91IHNlZSBmaXQgaWYgc2VsbGluZyBwcmljZSBpcyB6ZXJvCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGdwUGVyY2VudGFnZURpc3BsYXkudGV4dENvbnRlbnQgPSBgJHtncC50b0ZpeGVkKDIpfSVgOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ29sb3IgY29kZSB0aGUgR1AlCiAgICAgICAgICAgIGlmIChncCA8IDMwKSB7CiAgICAgICAgICAgICAgICBncFBlcmNlbnRhZ2VEaXNwbGF5LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXlvY28tcmVkKSc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3AgPCA2MCkgewogICAgICAgICAgICAgICAgZ3BQZXJjZW50YWdlRGlzcGxheS5zdHlsZS5jb2xvciA9ICd2YXIoLS15b2NvLW9yYW5nZSknOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZ3BQZXJjZW50YWdlRGlzcGxheS5zdHlsZS5jb2xvciA9ICd2YXIoLS15b2NvLWdyZWVuKSc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGdwUGVyY2VudGFnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gSGlkZSBpZiBubyBtYXN0ZXIgcHJvZHVjdCBpcyBzZWxlY3RlZAogICAgICAgICAgICBzZWxsaW5nUHJpY2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgZ3BQZXJjZW50YWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgfQogICAgfQoKCiAgICAvLyAtLS0gU2F2ZWQgUmVjaXBlcyBMb2dpYyAtLS0KICAgIGZ1bmN0aW9uIHNhdmVDdXJyZW50UmVjaXBlKCkgewogICAgICAgIGlmICghc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0KSB7CiAgICAgICAgICAgIGFsZXJ0KCdQbGVhc2Ugc2VsZWN0IGEgdmFsaWQgTWFzdGVyIFByb2R1Y3QgYmVmb3JlIHNhdmluZy4nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAocmVjaXBlSXRlbXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGFsZXJ0KCdDYW5ub3Qgc2F2ZSBhbiBlbXB0eSByZWNpcGUuJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY29uc3QgaXRlbVdpdGhOb1F1YW50aXR5ID0gcmVjaXBlSXRlbXMuZmluZChpdGVtID0+ICFpdGVtLnF1YW50aXR5IHx8IHBhcnNlRmxvYXQoaXRlbS5xdWFudGl0eSkgPD0gMCk7CiAgICAgICAgaWYgKGl0ZW1XaXRoTm9RdWFudGl0eSkgewogICAgICAgICAgICBhbGVydChgUGxlYXNlIHByb3ZpZGUgYSBxdWFudGl0eSBncmVhdGVyIHRoYW4gMCBmb3IgYWxsIGluZ3JlZGllbnRzLiBUaGUgaXRlbSAiJHtpdGVtV2l0aE5vUXVhbnRpdHkubmFtZX0iIG5lZWRzIGEgcXVhbnRpdHkuYCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlzTWFuUHJvZHVjdCA9IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKTsKICAgICAgICBjb25zdCB5aWVsZFF0eSA9IHBhcnNlRmxvYXQoeWllbGRRdHlJbnB1dC52YWx1ZSk7CiAgICAgICAgCiAgICAgICAgaWYgKGlzTWFuUHJvZHVjdCAmJiAoIXlpZWxkUXR5IHx8IHlpZWxkUXR5IDw9IDApKSB7CiAgICAgICAgICAgIGFsZXJ0KCdNYW51ZmFjdHVyZWQgcHJvZHVjdHMgbXVzdCBoYXZlIGEgWWllbGQgUXVhbnRpdHkgZ3JlYXRlciB0aGFuIDAuJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIFJlbWVtYmVyIHRoZSBjYXRlZ29yeSBiZWZvcmUgc2F2aW5nCiAgICAgICAgY29uc3QgbGFzdFNlbGVjdGVkQ2F0ZWdvcnkgPSBtZW51Q2F0ZWdvcnlGaWx0ZXIudmFsdWU7CgogICAgICAgIGNvbnN0IHRvdGFsQ29zdCA9IHJlY2lwZUl0ZW1zLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyAoaXRlbS5jb3N0ICogaXRlbS5xdWFudGl0eSksIDApOwogICAgICAgIAogICAgICAgIGNvbnN0IG1hc3RlckRhdGFGb3JSZWNpcGUgPSB7CiAgICAgICAgICAgIC4uLnNlbGVjdGVkTWFzdGVyUHJvZHVjdAogICAgICAgIH07CgogICAgICAgIC8vIElmIHRoZSBzYXZlZCByZWNpcGUgaXMgZm9yIGEgKE1BTikgcHJvZHVjdCwgdXBkYXRlIGl0cyBjb3N0IGluIHRoZSBtYWluIHByb2R1Y3QgbGlzdAogICAgICAgIGlmIChpc01hblByb2R1Y3QpIHsKICAgICAgICAgICAgY29uc3QgeWllbGRVb20gPSB5aWVsZFVvbUlucHV0LnZhbHVlLnRyaW0oKSB8fCBzZWxlY3RlZE1hc3RlclByb2R1Y3QudW9tOwogICAgICAgICAgICBjb25zdCBjb3N0UGVyWWllbGRVbml0ID0gdG90YWxDb3N0IC8geWllbGRRdHk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBBZGQgeWllbGQgaW5mbyB0byB0aGUgcmVjaXBlIG1hc3RlciBkYXRhCiAgICAgICAgICAgIG1hc3RlckRhdGFGb3JSZWNpcGUueWllbGRRdHkgPSB5aWVsZFF0eTsKICAgICAgICAgICAgbWFzdGVyRGF0YUZvclJlY2lwZS55aWVsZFVvbSA9IHlpZWxkVW9tOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBtYXN0ZXIgcHJvZHVjdCBsaXN0IGZvciBmdXR1cmUgdXNlIGFzIGFuIGluZ3JlZGllbnQKICAgICAgICAgICAgY29uc3QgcHJvZHVjdEluZGV4ID0gaW1wb3J0ZWRQcm9kdWN0cy5maW5kSW5kZXgocCA9PiBwLnBsdS50b1N0cmluZygpID09PSBzZWxlY3RlZE1hc3RlclByb2R1Y3QucGx1LnRvU3RyaW5nKCkpOwogICAgICAgICAgICBpZiAocHJvZHVjdEluZGV4ID4gLTEpIHsKICAgICAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHNbcHJvZHVjdEluZGV4XS5jb3N0ID0gY29zdFBlcllpZWxkVW5pdDsKICAgICAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHNbcHJvZHVjdEluZGV4XS51b20gPSB5aWVsZFVvbTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgZXhpc3RpbmdJbmRleCA9IHNhdmVkUmVjaXBlcy5maW5kSW5kZXgociA9PiByLm1hc3Rlci5wbHUgPT09IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5wbHUpOwogICAgICAgIGNvbnN0IHJlY2lwZVRvU2F2ZSA9IHsgbWFzdGVyOiBtYXN0ZXJEYXRhRm9yUmVjaXBlLCBpdGVtczogWy4uLnJlY2lwZUl0ZW1zXSB9OwogICAgICAgIAogICAgICAgIGlmIChleGlzdGluZ0luZGV4ID4gLTEpIHsKICAgICAgICAgICAgLy8gTm8gbmVlZCB0byBjb25maXJtIHdoZW4gdXBkYXRpbmcsIGFzIGl0J3MgYW4gZXhwbGljaXQgYWN0aW9uIGZyb20gIkVkaXQiCiAgICAgICAgICAgIHNhdmVkUmVjaXBlc1tleGlzdGluZ0luZGV4XSA9IHJlY2lwZVRvU2F2ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzYXZlZFJlY2lwZXMucHVzaChyZWNpcGVUb1NhdmUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjbGVhckN1cnJlbnRSZWNpcGVCdWlsZGVyKCk7CiAgICAgICAgcmVuZGVyU2F2ZWRSZWNpcGVzKCk7CiAgICAgICAgcmVuZGVyWWllbGRFZGl0b3IoKTsKICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICAKICAgICAgICAvLyBSZXBvcHVsYXRlIG1hc3RlciBkYXRhCiAgICAgICAgcG9wdWxhdGVDYXRlZ29yeUZpbHRlcigpOyAKICAgICAgICBzZXR1cExpYnJhcnlUYWJzKCk7IC8vIFJlLXJlbmRlciBsaWJyYXJ5IHRvIHJlZmxlY3QgbmV3IGNvc3RzL1VPTXMKICAgICAgICBzYXZlZFJlY2lwZVNlYXJjaC52YWx1ZSA9ICcnOwoKICAgICAgICAvLyBDaGVjayBpZiB0aGUgbGFzdCB1c2VkIGNhdGVnb3J5IGlzIG5vdyBlbXB0eQogICAgICAgIGNvbnN0IHNhdmVkTWFzdGVyUHJvZHVjdFBMVXMgPSBuZXcgU2V0KHNhdmVkUmVjaXBlcy5tYXAociA9PiByLm1hc3Rlci5wbHUpKTsKICAgICAgICBjb25zdCBlbGlnaWJsZVByb2R1Y3RzID0gaW1wb3J0ZWRQcm9kdWN0cy5maWx0ZXIocHJvZHVjdCA9PgogICAgICAgICAgICAhcHJvZHVjdC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKHJhdyknKSAmJgogICAgICAgICAgICAhc2F2ZWRNYXN0ZXJQcm9kdWN0UExVcy5oYXMocHJvZHVjdC5wbHUpCiAgICAgICAgKTsKCiAgICAgICAgbGV0IHByb2R1Y3RzTGVmdEluQ2F0ZWdvcnkgPSBbXTsKICAgICAgICBpZiAobGFzdFNlbGVjdGVkQ2F0ZWdvcnkgPT09ICdhbGwnKSB7CiAgICAgICAgICAgIHByb2R1Y3RzTGVmdEluQ2F0ZWdvcnkgPSBlbGlnaWJsZVByb2R1Y3RzOwogICAgICAgIH0gZWxzZSBpZiAobGFzdFNlbGVjdGVkQ2F0ZWdvcnkgPT09ICdtYW51ZmFjdHVyZWQnKSB7CiAgICAgICAgICAgIHByb2R1Y3RzTGVmdEluQ2F0ZWdvcnkgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+IHAubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb2R1Y3RzTGVmdEluQ2F0ZWdvcnkgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+IChwLm1lbnVDYXRlZ29yeSB8fCAnVW5jYXRlZ29yaXplZCcpID09PSBsYXN0U2VsZWN0ZWRDYXRlZ29yeSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvZHVjdHNMZWZ0SW5DYXRlZ29yeS5sZW5ndGggPiAwICYmIGxhc3RTZWxlY3RlZENhdGVnb3J5ICE9PSAnYWxsJykgewogICAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgc3RpbGwgcHJvZHVjdHMsIGtlZXAgdGhlIGZpbHRlciBvbiB0aGF0IGNhdGVnb3J5CiAgICAgICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci52YWx1ZSA9IGxhc3RTZWxlY3RlZENhdGVnb3J5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIElmIHRoZSBjYXRlZ29yeSBpcyBlbXB0eSBvciB3YXMgJ2FsbCcsIHJlc2V0IHRvICdhbGwnCiAgICAgICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci52YWx1ZSA9ICdhbGwnOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBGaW5hbGx5LCBwb3B1bGF0ZSB0aGUgbWFzdGVyIHByb2R1Y3QgbGlzdCBiYXNlZCBvbiB0aGUgKHBvdGVudGlhbGx5IHN0aWNreSkgY2F0ZWdvcnkKICAgICAgICBwb3B1bGF0ZU1hc3RlclByb2R1Y3REYXRhbGlzdCgpOyAKICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhckN1cnJlbnRSZWNpcGVCdWlsZGVyKCkgewogICAgICAgIGNsZWFyTWFzdGVyUHJvZHVjdElucHV0KCk7CiAgICAgICAgcmVjaXBlSXRlbXMgPSBbXTsKICAgICAgICB5aWVsZFF0eUlucHV0LnZhbHVlID0gJyc7CiAgICAgICAgeWllbGRVb21JbnB1dC52YWx1ZSA9ICcnOwogICAgICAgIHlpZWxkRmllbGRzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgcmVuZGVyUmVjaXBlVGFibGUoKTsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICAgICAgCiAgICAgICAgLy8gUmVzZXQgZnJvbSBlZGl0IG1vZGUgaWYgYWN0aXZlCiAgICAgICAgaXNFZGl0aW5nUmVjaXBlID0gZmFsc2U7IAogICAgICAgIHNhdmVSZWNpcGVCdG4udGV4dENvbnRlbnQgPSAnU2F2ZSBSZWNpcGUnOyAKICAgICAgICBzYXZlUmVjaXBlQnRuLnRpdGxlID0gIlNhdmUgdGhlIGN1cnJlbnQgcmVjaXBlIGluIHRoZSBidWlsZGVyIHRvIHRoZSAnU2F2ZWQgUmVjaXBlcycgbGlzdCBiZWxvdy4iOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbmRlclNhdmVkUmVjaXBlcyhyZWNpcGVzVG9SZW5kZXIgPSBzYXZlZFJlY2lwZXMpIHsKICAgICAgICBzYXZlZFJlY2lwZXNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgaWYgKHJlY2lwZXNUb1JlbmRlci5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgc2F2ZWRSZWNpcGVzQ29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmctdG9wOiAyMHB4OyI+Tm8gc2F2ZWQgcmVjaXBlcyBmb3VuZC48L3A+YDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpOwogICAgICAgIHRhYmxlLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgICAgIDx0aD5SZWNpcGUgTmFtZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPkl0ZW1zPC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+WWllbGQ8L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5Ub3RhbCBDb3N0PC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+Q29zdC9ZaWVsZCBVT008L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5HUCU8L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz0iYWN0aW9ucy1jb2wiPkFjdGlvbnM8L3RoPgogICAgICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPC90aGVhZD4KICAgICAgICBgOwogICAgICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKTsKCiAgICAgICAgcmVjaXBlc1RvUmVuZGVyLnNvcnQoKGEsYikgPT4gYS5tYXN0ZXIubmFtZS5sb2NhbGVDb21wYXJlKGIubWFzdGVyLm5hbWUpKS5mb3JFYWNoKHJlY2lwZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRvdGFsQ29zdCA9IHJlY2lwZS5pdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKGl0ZW0uY29zdCAqIGl0ZW0ucXVhbnRpdHkpLCAwKTsKICAgICAgICAgICAgY29uc3Qgc2VsbGluZ1ByaWNlID0gcmVjaXBlLm1hc3Rlci5zZWxsaW5nUHJpY2UgfHwgMDsKICAgICAgICAgICAgbGV0IGdwID0gMDsKICAgICAgICAgICAgbGV0IGVmZmVjdGl2ZUNvc3QgPSB0b3RhbENvc3Q7CgogICAgICAgICAgICAvLyBGb3IgKE1BTikgcHJvZHVjdHMsIHRoZSBHUCBzaG91bGQgYmUgYmFzZWQgb24gdGhlIGNvc3QgcGVyIFNJTkdMRSBzZWxsaW5nIHVuaXQsIG5vdCB0aGUgd2hvbGUgYmF0Y2ggY29zdAogICAgICAgICAgICBpZiAocmVjaXBlLm1hc3Rlci5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSkgewogICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdEluZm8gPSBpbXBvcnRlZFByb2R1Y3RzLmZpbmQocCA9PiBwLnBsdSA9PT0gcmVjaXBlLm1hc3Rlci5wbHUpOwogICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RJbmZvKSB7CiAgICAgICAgICAgICAgICAgICAgZWZmZWN0aXZlQ29zdCA9IHByb2R1Y3RJbmZvLmNvc3Q7IAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2VsbGluZ1ByaWNlID4gMCkgewogICAgICAgICAgICAgICAgZ3AgPSAoKHNlbGxpbmdQcmljZSAtIGVmZmVjdGl2ZUNvc3QpIC8gc2VsbGluZ1ByaWNlKSAqIDEwMDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGdwID0gLTEwMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGdwQ29sb3JDbGFzcyA9ICcnOwogICAgICAgICAgICBpZiAoZ3AgPCAzMCkgewogICAgICAgICAgICAgICAgZ3BDb2xvckNsYXNzID0gJ2dwLWxvdyc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3AgPCA2MCkgewogICAgICAgICAgICAgICAgZ3BDb2xvckNsYXNzID0gJ2dwLW1lZGl1bSc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBncENvbG9yQ2xhc3MgPSAnZ3AtaGlnaCc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHlpZWxkRGlzcGxheSA9IChyZWNpcGUubWFzdGVyLnlpZWxkUXR5ICYmIHJlY2lwZS5tYXN0ZXIueWllbGRVb20pID8gYCR7cmVjaXBlLm1hc3Rlci55aWVsZFF0eX0gJHtyZWNpcGUubWFzdGVyLnlpZWxkVW9tfWAgOiAnTi9BJzsKICAgICAgICAgICAgY29uc3QgY29zdFBlcllpZWxkVW5pdCA9IChyZWNpcGUubWFzdGVyLnlpZWxkUXR5ID4gMCkgPyAodG90YWxDb3N0IC8gcmVjaXBlLm1hc3Rlci55aWVsZFF0eSkgOiAwOwoKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgcm93LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDx0ZCB0aXRsZT0iJHtyZWNpcGUubWFzdGVyLm5hbWV9Ij4ke3JlY2lwZS5tYXN0ZXIubmFtZX08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7cmVjaXBlLml0ZW1zLmxlbmd0aH08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7eWllbGREaXNwbGF5fTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+UiR7dG90YWxDb3N0LnRvRml4ZWQoMil9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD5SJHtjb3N0UGVyWWllbGRVbml0LnRvRml4ZWQoMil9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iJHtncENvbG9yQ2xhc3N9Ij4ke2dwLnRvRml4ZWQoMil9JTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImFjdGlvbnMtY29sIj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImNvcHlSZWNpcGUoJyR7cmVjaXBlLm1hc3Rlci5wbHV9JykiIHRpdGxlPSJDb3B5IGluZ3JlZGllbnRzIGZyb20gdGhpcyByZWNpcGUgdG8gdGhlIGJ1aWxkZXIuIFlvdSBtdXN0IHNlbGVjdCBhIG5ldyBtYXN0ZXIgcHJvZHVjdCBmaXJzdC4iPkNvcHk8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImxvYWRSZWNpcGUoJyR7cmVjaXBlLm1hc3Rlci5wbHV9JykiIHRpdGxlPSJMb2FkIHRoaXMgcmVjaXBlIGludG8gdGhlIGJ1aWxkZXIgZm9yIGVkaXRpbmcuIFRoaXMgd2lsbCByZW1vdmUgaXQgZnJvbSB0aGUgc2F2ZWQgbGlzdCB1bnRpbCBpdCdzIHNhdmVkIGFnYWluLiI+RWRpdDwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZGVsZXRlUmVjaXBlKCcke3JlY2lwZS5tYXN0ZXIucGx1fScpIiB0aXRsZT0iUGVybWFuZW50bHkgZGVsZXRlIHRoaXMgc2F2ZWQgcmVjaXBlLiI+RGVsZXRlPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L3RkPgogICAgICAgICAgICBgOwogICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgIH0pOwoKICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Ym9keSk7CiAgICAgICAgc2F2ZWRSZWNpcGVzQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhYmxlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVTYXZlZFJlY2lwZVNlYXJjaChldmVudCkgewogICAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSBldmVudC50YXJnZXQudmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCBmaWx0ZXJlZFJlY2lwZXMgPSBzYXZlZFJlY2lwZXMuZmlsdGVyKHJlY2lwZSA9PgogICAgICAgICAgICByZWNpcGUubWFzdGVyLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKQogICAgICAgICk7CiAgICAgICAgcmVuZGVyU2F2ZWRSZWNpcGVzKGZpbHRlcmVkUmVjaXBlcyk7CiAgICB9CgogICAgZnVuY3Rpb24gY29weVJlY2lwZShtYXN0ZXJQbHUpIHsKICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY2lwZUJ1aWxkZXJQYW5lbCcpLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHN3aXRjaCB0byB0aGUgJ1JlY2lwZSBCdWlsZGVyJyB0YWIgZmlyc3QuIik7CiAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0KSB7CiAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgbmV3IE1hc3RlciBQcm9kdWN0IGluIHRoZSBSZWNpcGUgQnVpbGRlciBiZWZvcmUgY29weWluZyBpbmdyZWRpZW50cy4iKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVjaXBlVG9Db3B5ID0gc2F2ZWRSZWNpcGVzLmZpbmQociA9PiByLm1hc3Rlci5wbHUudG9TdHJpbmcoKSA9PT0gbWFzdGVyUGx1LnRvU3RyaW5nKCkpOwogICAgICAgIGlmICghcmVjaXBlVG9Db3B5KSByZXR1cm47CgogICAgICAgIGlmIChyZWNpcGVJdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGlmICghY29uZmlybSgiVGhpcyB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnQgaW5ncmVkaWVudHMgaW4gdGhlIFJlY2lwZSBCdWlsZGVyLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY29udGludWU/IikpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIGEgZGVlcCBjb3B5IG9mIHRoZSBpdGVtcyB0byBhdm9pZCByZWZlcmVuY2UgaXNzdWVzCiAgICAgICAgcmVjaXBlSXRlbXMgPSByZWNpcGVUb0NvcHkuaXRlbXMubWFwKGl0ZW0gPT4gKHsgLi4uaXRlbSB9KSk7CiAgICAgICAgcmVuZGVyUmVjaXBlVGFibGUoKTsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9hZFJlY2lwZShtYXN0ZXJQbHUpIHsKICAgICAgICBjb25zdCByZWNpcGVUb0xvYWQgPSBzYXZlZFJlY2lwZXMuZmluZChyID0+IHIubWFzdGVyLnBsdS50b1N0cmluZygpID09PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSk7CiAgICAgICAgaWYgKCFyZWNpcGVUb0xvYWQpIHJldHVybjsKICAgICAgICAKICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY2lwZUJ1aWxkZXJQYW5lbCcpLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICBpZighY29uZmlybSgiVGhpcyB3aWxsIHN3aXRjaCB5b3UgdG8gdGhlICdSZWNpcGUgQnVpbGRlcicgdGFiIGFuZCBkaXNjYXJkIGFueSB1bnNhdmVkIHdvcmsgdGhlcmUuIENvbnRpbnVlPyIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBzd2l0Y2hSaWdodFRhYigncmVjaXBlQnVpbGRlclBhbmVsJyk7CiAgICAgICAgfQoKICAgICAgICBpZiAocmVjaXBlSXRlbXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBpZighY29uZmlybSgiTG9hZGluZyB0aGlzIHJlY2lwZSB3aWxsIGRpc2NhcmQgdGhlIGN1cnJlbnQgdW5zYXZlZCByZWNpcGUgaW4gdGhlIGJ1aWxkZXIuIENvbnRpbnVlPyIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gVGVtcG9yYXJpbHkgc3RvcmUgdGhlIHJlY2lwZSBkYXRhIGJlY2F1c2Ugd2UncmUgYWJvdXQgdG8gZGVsZXRlIGl0IGZyb20gdGhlIHNhdmVkIGxpc3QKICAgICAgICBjb25zdCByZWNpcGVEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZWNpcGVUb0xvYWQpKTsKCiAgICAgICAgLy8gUmVtb3ZlIHRoZSByZWNpcGUgZnJvbSB0aGUgbWFpbiBsaXN0LiBUaGlzIGFsc28gcmVmcmVzaGVzIHRoZSBhdmFpbGFibGUgbWFzdGVyIHByb2R1Y3RzLgogICAgICAgIGRlbGV0ZVJlY2lwZShtYXN0ZXJQbHUsIGZhbHNlKTsKICAgICAgICAKICAgICAgICAvLyBDbGVhciB0aGUgY3VycmVudCBidWlsZGVyIFVJCiAgICAgICAgY2xlYXJDdXJyZW50UmVjaXBlQnVpbGRlcigpOwoKICAgICAgICAvLyBTZXQgdGhlIGNhdGVnb3J5IGZpbHRlciB0byBtYXRjaCB0aGUgcHJvZHVjdCBiZWluZyBsb2FkZWQKICAgICAgICBjb25zdCBwcm9kdWN0Q2F0ZWdvcnkgPSByZWNpcGVEYXRhLm1hc3Rlci5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSA/ICdtYW51ZmFjdHVyZWQnIDogcmVjaXBlRGF0YS5tYXN0ZXIubWVudUNhdGVnb3J5OwogICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci52YWx1ZSA9IHByb2R1Y3RDYXRlZ29yeTsKCiAgICAgICAgLy8gUmVwb3B1bGF0ZSB0aGUgZGF0YWxpc3QgZm9yIHRoZSBjb3JyZWN0IGNhdGVnb3J5LiBOb3cgdGhlIHByb2R1Y3QgdG8gYmUgZWRpdGVkIHdpbGwgYmUgaW4gdGhlIGxpc3QuCiAgICAgICAgcG9wdWxhdGVNYXN0ZXJQcm9kdWN0RGF0YWxpc3QoKTsKCiAgICAgICAgLy8gU2V0IHRoZSBidWlsZGVyJ3Mgc3RhdGUgd2l0aCB0aGUgbG9hZGVkIHJlY2lwZSBkYXRhCiAgICAgICAgbWFzdGVyUHJvZHVjdElucHV0LnZhbHVlID0gYCR7cmVjaXBlRGF0YS5tYXN0ZXIubmFtZX0gKCR7cmVjaXBlRGF0YS5tYXN0ZXIucGx1fSlgOwogICAgICAgIGhhbmRsZU1hc3RlclByb2R1Y3RJbnB1dCh7dGFyZ2V0OiBtYXN0ZXJQcm9kdWN0SW5wdXR9KTsgLy8gVGhpcyB3aWxsIG5vdyBjb3JyZWN0bHkgZmluZCB0aGUgcHJvZHVjdCBhbmQgc2V0IHNlbGVjdGVkTWFzdGVyUHJvZHVjdAogICAgICAgIHJlY2lwZUl0ZW1zID0gWy4uLnJlY2lwZURhdGEuaXRlbXNdOwogICAgICAgIAogICAgICAgIC8vIFRoZSBoYW5kbGVNYXN0ZXJQcm9kdWN0SW5wdXQgZnVuY3Rpb24gYWxyZWFkeSBzZXRzIHRoZSB5aWVsZCBmcm9tIHRoZSBvcmlnaW5hbCBpbXBvcnRlZCBkYXRhLgogICAgICAgIC8vIE5vIG5lZWQgdG8gb3ZlcnJpZGUgaXQgd2l0aCB0aGUgc2F2ZWQgcmVjaXBlJ3MgeWllbGQgZGF0YSBoZXJlLgogICAgICAgIHNldFlpZWxkRmllbGRzUmVhZE9ubHkodHJ1ZSk7CgogICAgICAgIC8vIFVwZGF0ZSBVSQogICAgICAgIHJlbmRlclJlY2lwZVRhYmxlKCk7CiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgICAgIAogICAgICAgIGlzRWRpdGluZ1JlY2lwZSA9IHRydWU7CiAgICAgICAgc2F2ZVJlY2lwZUJ0bi50ZXh0Q29udGVudCA9ICdVcGRhdGUgUmVjaXBlJzsKICAgICAgICBzYXZlUmVjaXBlQnRuLnRpdGxlID0gJ1VwZGF0ZSB0aGUgcmVjaXBlIGZvciB0aGlzIHByb2R1Y3QgaW4gdGhlIHNhdmVkIGxpc3QuJzsKICAgIH0KCgogICAgZnVuY3Rpb24gZGVsZXRlUmVjaXBlKG1hc3RlclBsdSwgYXNrQ29uZmlybSA9IHRydWUpIHsKICAgICAgICBjb25zdCByZWNpcGVUb0RlbGV0ZSA9IHNhdmVkUmVjaXBlcy5maW5kKHIgPT4gci5tYXN0ZXIucGx1LnRvU3RyaW5nKCkgPT09IG1hc3RlclBsdS50b1N0cmluZygpKTsKICAgICAgICBpZiAoIXJlY2lwZVRvRGVsZXRlKSByZXR1cm47CgogICAgICAgIGlmIChhc2tDb25maXJtKSB7CiAgICAgICAgICAgIGlmICghY29uZmlybShgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGUgcmVjaXBlIGZvciAiJHtyZWNpcGVUb0RlbGV0ZS5tYXN0ZXIubmFtZX0iP2ApKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2F2ZWRSZWNpcGVzID0gc2F2ZWRSZWNpcGVzLmZpbHRlcihyID0+IHIubWFzdGVyLnBsdS50b1N0cmluZygpICE9PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSk7CiAgICAgICAgcmVuZGVyU2F2ZWRSZWNpcGVzKCk7CiAgICAgICAgcmVuZGVyWWllbGRFZGl0b3IoKTsKICAgICAgICBzYXZlU3RhdGUoKTsKCiAgICAgICAgLy8gQWZ0ZXIgZGVsZXRpbmcsIHJlZnJlc2ggdGhlIGNhdGVnb3J5IGZpbHRlciBhbmQgcHJvZHVjdCBsaXN0CiAgICAgICAgcG9wdWxhdGVDYXRlZ29yeUZpbHRlcigpOwogICAgICAgIHBvcHVsYXRlTWFzdGVyUHJvZHVjdERhdGFsaXN0KCk7CiAgICB9CiAgICAKICAgIC8vIC0tLSBZaWVsZCBFZGl0b3IgJiBCdWlsZGVyIExvZ2ljIC0tLQogICAgZnVuY3Rpb24gdG9nZ2xlWWllbGRFZGl0aW5nKGUpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgY29uc3QgaXNSZWFkT25seSA9IHlpZWxkUXR5SW5wdXQucmVhZE9ubHk7CiAgICAgICAgc2V0WWllbGRGaWVsZHNSZWFkT25seSghaXNSZWFkT25seSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0WWllbGRGaWVsZHNSZWFkT25seShpc1JlYWRPbmx5KSB7CiAgICAgICAgeWllbGRRdHlJbnB1dC5yZWFkT25seSA9IGlzUmVhZE9ubHk7CiAgICAgICAgeWllbGRVb21JbnB1dC5yZWFkT25seSA9IGlzUmVhZE9ubHk7CgogICAgICAgIGNvbnN0IGVkaXRJY29uID0gZWRpdFlpZWxkQnRuLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0LWljb24nKTsKICAgICAgICBjb25zdCBzYXZlSWNvbiA9IGVkaXRZaWVsZEJ0bi5xdWVyeVNlbGVjdG9yKCcuc2F2ZS1pY29uJyk7CgogICAgICAgIGlmIChpc1JlYWRPbmx5KSB7CiAgICAgICAgICAgIGVkaXRZaWVsZEJ0bi50aXRsZSA9ICJFZGl0IFlpZWxkIjsKICAgICAgICAgICAgZWRpdEljb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIHNhdmVJY29uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWRpdFlpZWxkQnRuLnRpdGxlID0gIlNhdmUgWWllbGQiOwogICAgICAgICAgICBlZGl0SWNvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBzYXZlSWNvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgeWllbGRRdHlJbnB1dC5mb2N1cygpOwogICAgICAgIH0KICAgIH0KCgogICAgZnVuY3Rpb24gcmVuZGVyWWllbGRFZGl0b3IoKSB7CiAgICAgICAgY29uc3Qgc2VhcmNoVGVybSA9IHlpZWxkRWRpdG9yU2VhcmNoLnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgY29uc3QgbWFuUmVjaXBlcyA9IHNhdmVkUmVjaXBlcy5maWx0ZXIociA9PiAKICAgICAgICAgICAgci5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykgJiYKICAgICAgICAgICAgci5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pCiAgICAgICAgKTsKCiAgICAgICAgaWYgKG1hblJlY2lwZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHlpZWxkRWRpdG9yQ29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmctdG9wOiAyMHB4OyI+Tm8gc2F2ZWQgbWFudWZhY3R1cmVkIHByb2R1Y3RzIGZvdW5kLjwvcD5gOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RhYmxlJyk7CiAgICAgICAgdGFibGUuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8dGhlYWQ+CiAgICAgICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgICAgICAgPHRoPlByb2R1Y3QgTmFtZTwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPkN1cnJlbnQgWWllbGQ8L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5OZXcgWWllbGQgUXR5PC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+TmV3IFlpZWxkIFVPTTwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPkFjdGlvbjwvdGg+CiAgICAgICAgICAgICAgICA8L3RyPgogICAgICAgICAgICA8L3RoZWFkPgogICAgICAgIGA7CiAgICAgICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpOwoKICAgICAgICBtYW5SZWNpcGVzLnNvcnQoKGEsYikgPT4gYS5tYXN0ZXIubmFtZS5sb2NhbGVDb21wYXJlKGIubWFzdGVyLm5hbWUpKS5mb3JFYWNoKHJlY2lwZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHBsdSA9IHJlY2lwZS5tYXN0ZXIucGx1OwogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOwogICAgICAgICAgICByb3cuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPHRkPiR7cmVjaXBlLm1hc3Rlci5uYW1lfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+JHtyZWNpcGUubWFzdGVyLnlpZWxkUXR5IHx8ICdOL0EnfSAke3JlY2lwZS5tYXN0ZXIueWllbGRVb20gfHwgJyd9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD48aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0ieWllbGQtcXR5LSR7cGx1fSIgdmFsdWU9IiR7cmVjaXBlLm1hc3Rlci55aWVsZFF0eSB8fCAnJ30iIHN0ZXA9IjAuMDAxIiBtaW49IjAuMDAxIj48L3RkPgogICAgICAgICAgICAgICAgPHRkPjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ieWllbGQtdW9tLSR7cGx1fSIgdmFsdWU9IiR7cmVjaXBlLm1hc3Rlci55aWVsZFVvbSB8fCAnJ30iPjwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+PGJ1dHRvbiBjbGFzcz0iYWN0aW9uLWJ0biB1cGRhdGUteWllbGQtYnRuIiBvbmNsaWNrPSJ1cGRhdGVZaWVsZCgnJHtwbHV9JykiPlVwZGF0ZTwvYnV0dG9uPjwvdGQ+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7CiAgICAgICAgfSk7CiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGJvZHkpOwogICAgICAgIHlpZWxkRWRpdG9yQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOyAvLyBDbGVhciBwcmV2aW91cyBjb250ZW50CiAgICAgICAgeWllbGRFZGl0b3JDb250YWluZXIuYXBwZW5kQ2hpbGQodGFibGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVlpZWxkKG1hc3RlclBsdSkgewogICAgICAgIGNvbnN0IHJlY2lwZUluZGV4ID0gc2F2ZWRSZWNpcGVzLmZpbmRJbmRleChyID0+IHIubWFzdGVyLnBsdS50b1N0cmluZygpID09PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSk7CiAgICAgICAgaWYgKHJlY2lwZUluZGV4ID09PSAtMSkgcmV0dXJuOwoKICAgICAgICBjb25zdCBuZXdZaWVsZFF0eUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHlpZWxkLXF0eS0ke21hc3RlclBsdX1gKTsKICAgICAgICBjb25zdCBuZXdZaWVsZFVvbUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHlpZWxkLXVvbS0ke21hc3RlclBsdX1gKTsKICAgICAgICAKICAgICAgICBjb25zdCBuZXdZaWVsZFF0eSA9IHBhcnNlRmxvYXQobmV3WWllbGRRdHlJbnB1dC52YWx1ZSk7CiAgICAgICAgY29uc3QgbmV3WWllbGRVb20gPSBuZXdZaWVsZFVvbUlucHV0LnZhbHVlLnRyaW0oKTsKCiAgICAgICAgaWYgKCFuZXdZaWVsZFF0eSB8fCBuZXdZaWVsZFF0eSA8PSAwKSB7CiAgICAgICAgICAgIGFsZXJ0KCdZaWVsZCBRdWFudGl0eSBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyLicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCByZWNpcGVUb1VwZGF0ZSA9IHNhdmVkUmVjaXBlc1tyZWNpcGVJbmRleF07CiAgICAgICAgY29uc3QgdG90YWxSZWNpcGVDb3N0ID0gcmVjaXBlVG9VcGRhdGUuaXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIChpdGVtLmNvc3QgKiBpdGVtLnF1YW50aXR5KSwgMCk7CiAgICAgICAgY29uc3QgbmV3Q29zdFBlcllpZWxkVW5pdCA9IHRvdGFsUmVjaXBlQ29zdCAvIG5ld1lpZWxkUXR5OwoKICAgICAgICAvLyAxLiBVcGRhdGUgdGhlIChNQU4pIHByb2R1Y3QncyBtYWluIGVudHJ5IGluIGltcG9ydGVkUHJvZHVjdHMKICAgICAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBpbXBvcnRlZFByb2R1Y3RzLmZpbmRJbmRleChwID0+IHAucGx1LnRvU3RyaW5nKCkgPT09IG1hc3RlclBsdS50b1N0cmluZygpKTsKICAgICAgICBpZiAocHJvZHVjdEluZGV4ID4gLTEpIHsKICAgICAgICAgICAgaW1wb3J0ZWRQcm9kdWN0c1twcm9kdWN0SW5kZXhdLmNvc3QgPSBuZXdDb3N0UGVyWWllbGRVbml0OwogICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzW3Byb2R1Y3RJbmRleF0udW9tID0gbmV3WWllbGRVb207CiAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHNbcHJvZHVjdEluZGV4XS55aWVsZFF0eSA9IG5ld1lpZWxkUXR5OyAvLyBLZWVwIG9yaWdpbmFsIHlpZWxkIGluZm8gY29uc2lzdGVudCB0b28KICAgICAgICAgICAgaW1wb3J0ZWRQcm9kdWN0c1twcm9kdWN0SW5kZXhdLnlpZWxkVW9tID0gbmV3WWllbGRVb207CiAgICAgICAgfQoKICAgICAgICAvLyAyLiBVcGRhdGUgdGhlIG1hc3RlciBkYXRhIHdpdGhpbiB0aGUgc2F2ZWQgcmVjaXBlIGl0c2VsZgogICAgICAgIHJlY2lwZVRvVXBkYXRlLm1hc3Rlci55aWVsZFF0eSA9IG5ld1lpZWxkUXR5OwogICAgICAgIHJlY2lwZVRvVXBkYXRlLm1hc3Rlci55aWVsZFVvbSA9IG5ld1lpZWxkVW9tOwoKICAgICAgICAvLyAzLiAtLS0gQ0FTQ0FESU5HIFVQREFURSAtLS0KICAgICAgICAvLyBGaW5kIGFueSBvdGhlciBzYXZlZCByZWNpcGVzIHRoYXQgdXNlIHRoaXMgcHJvZHVjdCBhcyBhbiBpbmdyZWRpZW50IGFuZCB1cGRhdGUgdGhlaXIgY29zdAogICAgICAgIHNhdmVkUmVjaXBlcy5mb3JFYWNoKHJlY2lwZSA9PiB7CiAgICAgICAgICAgIHJlY2lwZS5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgaWYgKGl0ZW0ucGx1LnRvU3RyaW5nKCkgPT09IG1hc3RlclBsdS50b1N0cmluZygpKSB7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5jb3N0ID0gbmV3Q29zdFBlcllpZWxkVW5pdDsKICAgICAgICAgICAgICAgICAgICBpdGVtLnVvbSA9IG5ld1lpZWxkVW9tOyAvLyBBbHNvIHVwZGF0ZSBVT00gaW4gY2FzZSBpdCBjaGFuZ2VkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICAvLyA0LiBTYXZlIHN0YXRlIGFuZCByZS1yZW5kZXIgYWxsIHJlbGV2YW50IFVJIGNvbXBvbmVudHMKICAgICAgICBzYXZlU3RhdGUoKTsKICAgICAgICByZW5kZXJZaWVsZEVkaXRvcigpOwogICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcygpOwogICAgICAgIHNldHVwTGlicmFyeVRhYnMoKTsgLy8gVGhpcyByZWZyZXNoZXMgdGhlIGluZ3JlZGllbnQgbGlicmFyeSB3aXRoIHRoZSBuZXcgY29zdAoKICAgICAgICBhbGVydChgIiR7cmVjaXBlVG9VcGRhdGUubWFzdGVyLm5hbWV9IiB5aWVsZCB1cGRhdGVkLiBBbGwgcmVsYXRlZCBjb3N0cyBoYXZlIGJlZW4gcmVjYWxjdWxhdGVkLmApOwogICAgfQoKICAgIC8vIC0tLSBHbG9iYWwgQWN0aW9ucyAtLS0KICAgIGZ1bmN0aW9uIGNsZWFyQWxsRGF0YShhc2tDb25maXJtID0gdHJ1ZSkgewogICAgICAgIGlmIChhc2tDb25maXJtKSB7CiAgICAgICAgICAgIGlmICghY29uZmlybSgiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBpbXBvcnRlZCBwcm9kdWN0cyBhbmQgc2F2ZWQgcmVjaXBlcz8gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHVuZG9uZS4iKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGltcG9ydGVkUHJvZHVjdHMgPSBbXTsKICAgICAgICBzYXZlZFJlY2lwZXMgPSBbXTsKICAgICAgICAKICAgICAgICBmaWxlTmFtZURpc3BsYXkudGV4dENvbnRlbnQgPSAnJzsKICAgICAgICBleGNlbEZpbGVJbnB1dC52YWx1ZSA9ICIiOwogICAgICAgIAogICAgICAgIGNsZWFyQ3VycmVudFJlY2lwZUJ1aWxkZXIoKTsKICAgICAgICBzZXR1cExpYnJhcnlUYWJzKCk7CiAgICAgICAgcmVuZGVyU2F2ZWRSZWNpcGVzKCk7CiAgICAgICAgcmVuZGVyWWllbGRFZGl0b3IoKTsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncmVjaXBlQnVpbGRlclN0YXRlJyk7CiAgICAgICAgCiAgICAgICAgbWFzdGVyUHJvZHVjdExpc3QuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgbWFzdGVyUHJvZHVjdElucHV0LnBsYWNlaG9sZGVyID0gIi0tIEltcG9ydCBwcm9kdWN0cyBmaXJzdCAtLSI7CiAgICAgICAgbWVudUNhdGVnb3J5RmlsdGVyLmlubmVySFRNTCA9ICcnOwogICAgfQovLyBTaG93IHR1dG9yaWFsIGFnYWluIGFmdGVyIGNsZWFyaW5nIGFsbCBkYXRhCnRyeSB7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcm9tcHQtbW9kYWwnKS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7IH0gY2F0Y2goZSkge30KCiAgICAvLyAtLS0gRXhwb3J0IExvZ2ljIC0tLQogICAgZnVuY3Rpb24gZXhwb3J0QWxsUmVjaXBlcygpIHsKICAgICAgICBpZiAoc2F2ZWRSZWNpcGVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBhbGVydCgnVGhlcmUgYXJlIG5vIHNhdmVkIHJlY2lwZXMgdG8gZXhwb3J0LicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIWNvbmZpcm0oIkFyZSB5b3Ugc3VyZSB5b3UgaGF2ZSBjb21wbGV0ZWQgYWxsIHJlY2lwZXM/IFRoaXMgd2lsbCBleHBvcnQgdGhlIGRhdGEgYW5kIGNsZWFyIHRoZSBhcHBsaWNhdGlvbi4iKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBsZXQgcmVjaXBlRXhwb3J0RGF0YSA9IFtdOwogICAgICAgIGxldCB5aWVsZEV4cG9ydERhdGEgPSBbXTsKCiAgICAgICAgc2F2ZWRSZWNpcGVzLmZvckVhY2gocmVjaXBlID0+IHsKICAgICAgICAgICAgLy8gUG9wdWxhdGUgdGhlIHJlY2lwZSBkYXRhIHRhYgogICAgICAgICAgICBjb25zdCByZWNpcGVSb3dzID0gcmVjaXBlLml0ZW1zLm1hcChpdGVtID0+ICh7CiAgICAgICAgICAgICAgICAnTWFzdGVyIFByb2R1Y3QgUExVJzogcmVjaXBlLm1hc3Rlci5wbHUsCiAgICAgICAgICAgICAgICAnUHJvZHVjdCBUeXBlJzogcmVjaXBlLm1hc3Rlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJyhtYW4pJykgPyAnUHJlcGFyYXRpb24nIDogJ0NvbXBvc2l0ZScsCiAgICAgICAgICAgICAgICAnTWFzdGVyIFByb2R1Y3QgTmFtZSc6IHJlY2lwZS5tYXN0ZXIubmFtZSwKICAgICAgICAgICAgICAgICdSZWNpcGUgUHJvZHVjdCBQTFUnOiBpdGVtLnBsdSwKICAgICAgICAgICAgICAgICdSZWNpcGUgUHJvZHVjdCBOYW1lJzogaXRlbS5uYW1lLAogICAgICAgICAgICAgICAgJ1VuaXQgb2YgTWVhc3VyZSc6IGl0ZW0udW9tLAogICAgICAgICAgICAgICAgJ1F1YW50aXR5JzogaXRlbS5xdWFudGl0eQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJlY2lwZUV4cG9ydERhdGEgPSByZWNpcGVFeHBvcnREYXRhLmNvbmNhdChyZWNpcGVSb3dzKTsKCiAgICAgICAgICAgIC8vIFBvcHVsYXRlIHRoZSB5aWVsZCBkYXRhIHRhYiBpZiBpdCdzIGEgbWFudWZhY3R1cmVkIHByb2R1Y3QKICAgICAgICAgICAgaWYgKHJlY2lwZS5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCcobWFuKScpKSB7CiAgICAgICAgICAgICAgICB5aWVsZEV4cG9ydERhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgJ01hc3RlciBQcm9kdWN0IFBMVSc6IHJlY2lwZS5tYXN0ZXIucGx1LAogICAgICAgICAgICAgICAgICAgICdNYXN0ZXIgUHJvZHVjdCBOYW1lJzogcmVjaXBlLm1hc3Rlci5uYW1lLAogICAgICAgICAgICAgICAgICAgICdZaWVsZCBRdWFudGl0eSc6IHJlY2lwZS5tYXN0ZXIueWllbGRRdHkgfHwgJycsCiAgICAgICAgICAgICAgICAgICAgJ1lpZWxkIFVPTSc6IHJlY2lwZS5tYXN0ZXIueWllbGRVb20gfHwgJycKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOwoKICAgICAgICAvLyBDcmVhdGUgYW5kIGFwcGVuZCB0aGUgUmVjaXBlcyBzaGVldAogICAgICAgIGNvbnN0IHJlY2lwZV93cyA9IFhMU1gudXRpbHMuanNvbl90b19zaGVldChyZWNpcGVFeHBvcnREYXRhKTsKICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCByZWNpcGVfd3MsICJSZWNpcGVzIik7CgogICAgICAgIC8vIENyZWF0ZSBhbmQgYXBwZW5kIHRoZSBZaWVsZHMgc2hlZXQgb25seSBpZiB0aGVyZSBpcyBkYXRhIGZvciBpdAogICAgICAgIGlmICh5aWVsZEV4cG9ydERhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCB5aWVsZF93cyA9IFhMU1gudXRpbHMuanNvbl90b19zaGVldCh5aWVsZEV4cG9ydERhdGEpOwogICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB5aWVsZF93cywgIllpZWxkcyIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYGFsbF9yZWNpcGVzX2V4cG9ydC54bHN4YCk7CiAgICAgICAgCiAgICAgICAgY2xlYXJBbGxEYXRhKGZhbHNlKTsKICAgIH0KICAgIAogICAgLy8gLS0tIFRVVE9SSUFMIExPR0lDIC0tLQogICAgY29uc3QgdHV0b3JpYWxQcm9tcHRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcm9tcHQtbW9kYWwnKTsKICAgIGNvbnN0IHN0YXJ0VHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQtdHV0b3JpYWwtYnRuJyk7CiAgICBjb25zdCBza2lwVHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2tpcC10dXRvcmlhbC1idG4nKTsKICAgIAogICAgc3RhcnRUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVjaXBlTG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICAgICAgc3RhcnRUdXRvcmlhbCgpOwogICAgfSk7CgogICAgc2tpcFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyZWNpcGVMb2FkZXJUdXRvcmlhbFNob3duJywgJ3RydWUnKTsKICAgIH0pOwoKICAgIGNvbnN0IHR1dG9yaWFsU3RlcHMgPSBbCiAgICB7CiAgICAgICAgZWxlbWVudDogJyN0dXRvcmlhbC1ob3ctdG8tZ3VpZGUnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5XZWxjb21lITwvYj4gTmVlZCBtb3JlIGRldGFpbD8gQ2xpY2sgdGhpcyBkb2N1bWVudCBpY29uIGFueXRpbWUgdG8gb3BlbiB0aGUgZnVsbCA8Yj5Ib3figJFUbyBHdWlkZTwvYj4gaW4gYSBuZXcgdGFiLicsCiAgICAgICAgcG9zaXRpb246ICdyaWdodCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJyN0dXRvcmlhbC1pbXBvcnQnLAogICAgICAgIGNvbnRlbnQ6ICdTdGFydCBoZXJlOiBjbGljayA8Yj7igJxDaG9vc2UgRmlsZeKAnTwvYj4gYW5kIHVwbG9hZCB5b3VyIDxiPlByb2R1Y3QgRXhjZWw8L2I+IHNoZWV0LiBUaGlzIGxvYWRzIHlvdXIgcHJvZHVjdCBsaXN0IGFuZCB1bmxvY2tzIHlvdXIgaW5ncmVkaWVudCBsaWJyYXJ5LicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtbGlicmFyeScsCiAgICAgICAgY29udGVudDogJ0Jyb3dzZSB5b3VyIDxiPkluZ3JlZGllbnQgTGlicmFyeTwvYj4uIENsaWNrIGFuIGluZ3JlZGllbnQgdG8gYWRkIGl0IHRvIHlvdXIgY3VycmVudCByZWNpcGUuIFVzZSB0aGUgc2VhcmNoIGJhciBhbmQgdGFicyB0byBmaW5kIGl0ZW1zIGZhc3QuJywKICAgICAgICBwb3NpdGlvbjogJ3JpZ2h0JwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLW1hc3Rlci1wcm9kdWN0JywKICAgICAgICBjb250ZW50OiAnU2VsZWN0IHRoZSA8Yj5NYXN0ZXIgUHJvZHVjdDwvYj4geW91IGFyZSBidWlsZGluZyBhIHJlY2lwZSBmb3IuIElmIGl04oCZcyBhIDxiPihNQU4pPC9iPiBwcm9kdWN0LCB5b3UgY2FuIHNldCBpdHMgPGI+WWllbGQgUXVhbnRpdHk8L2I+IGFuZCA8Yj5VT008L2I+LicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtcmVjaXBlLXRhYmxlJywKICAgICAgICBjb250ZW50OiAnWW91ciBzZWxlY3RlZCBpbmdyZWRpZW50cyBhcHBlYXIgaGVyZS4gRW50ZXIgYSA8Yj5RdWFudGl0eTwvYj4gZm9yIGVhY2guIFdl4oCZbGwgY2FsY3VsYXRlIHRoZSA8Yj5Ub3RhbCBDb3N0PC9iPiBhdXRvbWF0aWNhbGx5LicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjc2F2ZVJlY2lwZUJ0bicsCiAgICAgICAgY29udGVudDogJ0FsbCBzZXQ/IENsaWNrIDxiPlNhdmUgUmVjaXBlPC9iPi4gSWYgYSA8Yj4oTUFOKTwvYj4gcHJvZHVjdCBpcyBzYXZlZCwgaXRzIGNvc3QgcGVyIHlpZWxkIHVuaXQgdXBkYXRlcyBldmVyeXdoZXJlIGl04oCZcyB1c2VkLicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtc2F2ZWQtcmVjaXBlcycsCiAgICAgICAgY29udGVudDogJ0ZpbmQgeW91ciA8Yj5TYXZlZCBSZWNpcGVzPC9iPiBoZXJlLiBZb3UgY2FuIDxiPkVkaXQ8L2I+LCA8Yj5Db3B5PC9iPiwgb3IgPGI+RGVsZXRlPC9iPi4gVXNlIHRoZSBzZWFyY2ggYmFyIHRvIGZpbHRlciBxdWlja2x5LicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtYWN0aW9ucycsCiAgICAgICAgY29udGVudDogJ1JlYWR5IHRvIGhhbmQgb2ZmPyA8Yj5FeHBvcnQgQWxsIFJlY2lwZXM8L2I+IHRvIEV4Y2VsICh0aGVuIHRoZSBhcHAgY2xlYXJzKSwgb3IgPGI+Q2xlYXIgQWxsIERhdGE8L2I+IHRvIHN0YXJ0IGZyZXNoLicsCiAgICAgICAgcG9zaXRpb246ICdsZWZ0JwogICAgfQpdOwoKICAgIGxldCBjdXJyZW50VHV0b3JpYWxTdGVwID0gMDsKICAgIGNvbnN0IHR1dG9yaWFsT3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5Jyk7CiAgICBjb25zdCB0dXRvcmlhbFBvcG92ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3ZlcicpOwogICAgY29uc3QgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3Zlci1jb250ZW50Jyk7CiAgICBjb25zdCBzdGVwQ291bnRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1zdGVwLWNvdW50ZXInKTsKICAgIGNvbnN0IHByZXZCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJldi1idG4nKTsKICAgIGNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtbmV4dC1idG4nKTsKICAgIGxldCBoaWdobGlnaHRlZEVsZW1lbnQgPSBudWxsOwoKICAgIGZ1bmN0aW9uIHN0YXJ0VHV0b3JpYWwoKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9CgogICAgZnVuY3Rpb24gZW5kVHV0b3JpYWwoKSB7CiAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnR1dG9yaWFsLW92ZXJsYXktcGFydCcpLmZvckVhY2gocGFydCA9PiB7CiAgICAgICAgICAgIHBhcnQuc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgICAgIHBhcnQuc3R5bGUuaGVpZ2h0ID0gJzAnOwogICAgICAgIH0pOwogICAgICAgIHR1dG9yaWFsUG9wb3Zlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGlmIChoaWdobGlnaHRlZEVsZW1lbnQpIHsKICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dUdXRvcmlhbFN0ZXAoaW5kZXgpIHsKICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3RlcCA9IHR1dG9yaWFsU3RlcHNbaW5kZXhdOwogICAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0ZXAuZWxlbWVudCk7CgogICAgICAgIGlmICghdGFyZ2V0RWxlbWVudCkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oJ1R1dG9yaWFsIGVsZW1lbnQgbm90IGZvdW5kOicsIHN0ZXAuZWxlbWVudCk7CiAgICAgICAgICAgIGlmIChpbmRleCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgICAgc2hvd1R1dG9yaWFsU3RlcChpbmRleCArIDEpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kVHV0b3JpYWwoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHR1dG9yaWFsUG9wb3Zlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50OwogICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgIAogICAgICAgIHRhcmdldEVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnY2VudGVyJywgaW5saW5lOiAnY2VudGVyJyB9KTsKCiAgICAgICAgcG9wb3ZlckNvbnRlbnQuaW5uZXJIVE1MID0gc3RlcC5jb250ZW50OwogICAgICAgIHN0ZXBDb3VudGVyLnRleHRDb250ZW50ID0gYFN0ZXAgJHtpbmRleCArIDF9IG9mICR7dHV0b3JpYWxTdGVwcy5sZW5ndGh9YDsKICAgICAgICAKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgcG9zaXRpb25Qb3BvdmVyKHRhcmdldEVsZW1lbnQsIHN0ZXAucG9zaXRpb24pOwogICAgICAgICAgICBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXRFbGVtZW50KTsKICAgICAgICB9LCAzMDApOwoKICAgICAgICBwcmV2QnRuLmRpc2FibGVkID0gaW5kZXggPT09IDA7CiAgICAgICAgbmV4dEJ0bi50ZXh0Q29udGVudCA9IGluZGV4ID09PSB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEgPyAnRmluaXNoJyA6ICdOZXh0JzsKICAgIH0KCiAgICBmdW5jdGlvbiBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXQpIHsKICAgICAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXRvcCcpLnN0eWxlLmhlaWdodCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS10b3AnKS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CiAgICAgICAgCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC5ib3R0b219cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLmhlaWdodCA9IGBjYWxjKDEwMHZoIC0gJHt0YXJnZXRSZWN0LmJvdHRvbX1weClgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKS5zdHlsZS53aWR0aCA9IGAke3RhcmdldFJlY3QubGVmdH1weGA7CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUubGVmdCA9IGAke3RhcmdldFJlY3QucmlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUud2lkdGggPSBgY2FsYygxMDB2dyAtICR7dGFyZ2V0UmVjdC5yaWdodH1weClgOwogICAgfQoKICAgIGZ1bmN0aW9uIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXQsIHBvc2l0aW9uKSB7CiAgICAgICAgY29uc3QgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBjb25zdCBwb3BvdmVyTm9kZSA9IHR1dG9yaWFsUG9wb3ZlcjsKICAgICAgICAKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7CiAgICAgICAgY29uc3QgcG9wb3ZlclJlY3QgPSBwb3BvdmVyTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJyc7CgogICAgICAgIGNvbnN0IHNwYWNpbmcgPSAxNTsKICAgICAgICBwb3BvdmVyTm9kZS5jbGFzc05hbWUgPSAndHV0b3JpYWwtcG9wb3Zlcic7IC8vIFJlc2V0IGNsYXNzZXMKICAgICAgICBsZXQgdG9wLCBsZWZ0OwoKICAgICAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgJ3RvcCc6CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgKHRhcmdldFJlY3Qud2lkdGggLyAyKSAtIChwb3BvdmVyUmVjdC53aWR0aCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LmJvdHRvbSArIHNwYWNpbmc7CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgKHRhcmdldFJlY3Qud2lkdGggLyAyKSAtIChwb3BvdmVyUmVjdC53aWR0aCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOgogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCAtIHBvcG92ZXJSZWN0LndpZHRoIC0gc3BhY2luZzsKICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QucmlnaHQgKyBzcGFjaW5nOwogICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyAodGFyZ2V0UmVjdC5oZWlnaHQgLyAyKSAtIChwb3BvdmVyUmVjdC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAobGVmdCA8IHNwYWNpbmcpIGxlZnQgPSBzcGFjaW5nOwogICAgICAgIGlmICgobGVmdCArIHBvcG92ZXJSZWN0LndpZHRoKSA+IHdpbmRvdy5pbm5lcldpZHRoIC0gc3BhY2luZykgbGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcG9wb3ZlclJlY3Qud2lkdGggLSBzcGFjaW5nOwogICAgICAgIGlmICh0b3AgPCBzcGFjaW5nKSB0b3AgPSBzcGFjaW5nOwogICAgICAgIGlmICgodG9wICsgcG9wb3ZlclJlY3QuaGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCAtIHNwYWNpbmcpIHRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CgogICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnRvcCA9IGAke3RvcH1weGA7CiAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgOwogICAgICAgIHBvcG92ZXJOb2RlLmNsYXNzTGlzdC5hZGQoYGFycm93LSR7cG9zaXRpb259YCk7CiAgICB9CgogICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBpZiAoY3VycmVudFR1dG9yaWFsU3RlcCA+IDApIHsKICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcC0tOwogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgIH0KICAgIH0pOwoKICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPCB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCsrOwogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICAgICAgfQogICAgfSk7Cgo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==</script>

  <!-- === Yoco: Session Defaults helper (non-destructive) === -->
<style>
  #yoco-session-defaults-btn {
    position: fixed; right: 16px; bottom: 16px; z-index: 999999;
    padding: 10px 14px; border-radius: 10px; border: 1px solid #2a2d35;
    background: #23252a; color: #fff; font-weight: 600; cursor: pointer;
    box-shadow: 0 6px 18px rgba(0,0,0,.3);
  }
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
  /* removed shell modal css */
</style>

    
    <div class="row" id="yoco-identifiers-choice" style="margin-top:6px">
      <div style="font-weight:600;margin-bottom:6px">PLU/SKU identifiers</div>
      <label style="display:flex;gap:8px;align-items:center;margin:4px 0">
        <input type="radio" name="yoco-ident-mode" id="yoco-mode-random" value="random">
        <span>Use random PLUs/SKUs (auto-generate)</span>
      </label>
      <label style="display:flex;gap:8px;align-items:center;margin:4px 0">
        <input type="radio" name="yoco-ident-mode" id="yoco-mode-manual" value="manual">
        <span>We'll enter PLUs/SKUs ourselves</span>
      </label>
    </div>
    <div class="actions">
      <button id="yoco-session-cancel">Cancel</button>
      <button id="yoco-session-save" class="primary">Save</button>
    </div>
  </div>
</div>
<script>
(function(){
  const STORAGE_KEY = 'yoco.product.sessionDefaults';
  function getDefaults(){
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch(e){ return {}; }
  }
  function setDefaults(cfg){
    try { localStorage.setItem(STORAGE_KEY, JSON.stringify(cfg||{})); } catch(e){}
  }
  function extractSiteName(){
    const frame = document.getElementById('main');
    const doc = frame && frame.contentDocument;
    if (!doc) return '';
    // 1) Labeled inputs
    const labels = Array.from(doc.querySelectorAll('label'));
    for (const lab of labels){
      const txt = (lab.textContent||'').toLowerCase();
      if (txt.includes('site') && txt.includes('name')){
        const forId = lab.getAttribute('for');
        if (forId){
          const inp = doc.getElementById(forId);
          if (inp && 'value' in inp && (inp.value||'').trim()) return inp.value.trim();
        }
        const sib = lab.nextElementSibling;
        if (sib && 'value' in sib && (sib.value||'').trim()) return sib.value.trim();
      }
    }
    // 2) Inputs with id/name including site+name
    const inps = Array.from(doc.querySelectorAll('input[type="text"], input:not([type])'));
    for (const el of inps){
      const id = (el.id||'').toLowerCase(), name = (el.name||'').toLowerCase(), ph = (el.placeholder||'').toLowerCase();
      const score = +(id.includes('site')&&id.includes('name')) + +(name.includes('site')&&name.includes('name')) + +(ph.includes('site')&&ph.includes('name'));
      if (score >= 1 && (el.value||'').trim()) return el.value.trim();
    }
    // 3) Contenteditable cells
    const cells = Array.from(doc.querySelectorAll('td[contenteditable="true"]'));
    for (const td of cells){
      const hint = (td.getAttribute('data-hint')||'').toLowerCase();
      const title = (td.getAttribute('title')||'').toLowerCase();
      if ((hint.includes('site')&&hint.includes('name')) || (title.includes('site')&&title.includes('name'))){
        const v = (td.textContent||'').trim(); if (v) return v;
      }
    }
    return '';
  }

  // Wire modal
  const bd  = document.getElementById('yoco-session-modal-backdrop');
  const inp = document.getElementById('yoco-default-site');
  const save= document.getElementById('yoco-session-save');
  const cancel= document.getElementById('yoco-session-cancel');
  const modeRandom = document.getElementById('yoco-mode-random');
  const modeManual = document.getElementById('yoco-mode-manual');

  function openModal(){
  var bd = document.getElementById('yoco-session-modal-backdrop');
  var modal = document.getElementById('yoco-session-modal');
  var inp = document.getElementById('yoco-default-site');
  var modeRandom = document.getElementById('yoco-mode-random');
  var modeManual = document.getElementById('yoco-mode-manual');

  if (bd && modal) {
    try {
      var def = JSON.parse(localStorage.getItem('yoco.product.sessionDefaults') || '{}') || {};
      if (inp) inp.value = (def.siteName || '');
      if (modeRandom && modeManual) {
        var useRandom = !!def.useRandomIdentifiers;
        modeRandom.checked = !!useRandom;
        modeManual.checked = !useRandom;
      }
    } catch(e){}
    bd.style.display = 'flex';
    if (inp) { try { inp.focus(); inp.select(); } catch(e){} }
    return;
  }

  // Fallback: shell modal not present -> go straight to Product Loader
  if (typeof ensureMounted === 'function') { try { ensureMounted('app1'); } catch(e){} }
  if (typeof show === 'function') { try { show('app1'); } catch(e){} }
}
function closeModal(){ bd.style.display = 'none'; }

  window.__yocoOpenSessionModal = openModal;
if (cancel) cancel.addEventListener('click', function(){
    closeModal();
    if (window.__yocoProceedToProductLoader) { window.__yocoProceedToProductLoader(); window.__yocoProceedToProductLoader = null; }
  });

  // ✅ Fixed: keep everything inside this handler, and close it once.
if (save) save.addEventListener('click', function(){
    const pickedRandom = modeRandom.checked && !modeManual.checked;
    const cfg = Object.assign({}, getDefaults(), {
      siteName: (inp.value||'').trim(),
      useRandomIdentifiers: !!pickedRandom,
      manualSKUs: !pickedRandom,
      manualPLUs: !pickedRandom
    });
    setDefaults(cfg);
    closeModal();
    // continue to Product Loader if we were waiting
    if (window.__yocoProceedToProductLoader) { window.__yocoProceedToProductLoader(); window.__yocoProceedToProductLoader = null; }

    // brief toast
    try {
      const n = document.createElement('div');
      n.textContent = 'Saved Product Loader defaults';
      n.style.cssText = 'position:fixed;bottom:70px;right:16px;background:#00A3FF;color:#000;padding:8px 10px;border-radius:8px;font-weight:700;z-index:1000001;';
      document.body.appendChild(n);
      setTimeout(()=>n.remove(), 1600);
    } catch(e){}
  });

  // On page ready: if no defaults yet, attempt to prefill from the Data Manager automatically
  document.addEventListener('DOMContentLoaded', function(){
    const def = getDefaults();
    if (!def.siteName){
      const name = extractSiteName();
      if (name) setDefaults(Object.assign({}, def, {siteName: name}));
    }
  });

  // Optional: observe changes to candidate site-name inputs to keep defaults fresh
  const mo = new MutationObserver(()=>{
    // throttle via microtask
    clearTimeout(window.__yocoPrefillT||0);
    window.__yocoPrefillT = setTimeout(()=>{
      const name = extractSiteName();
      if (name){
        const def = getDefaults();
        if (def.siteName !== name) setDefaults(Object.assign({}, def, {siteName: name}));
      }
    }, 200);
  });
  try {
    mo.observe(document.body, {subtree:true, childList:true, characterData:true, attributes:true});
  } catch(e){}
})();
</script>

</body>
</html>
